## C√°lculo Detalhado das Matrizes A e D na Fatora√ß√£o Triangular
### Introdu√ß√£o
Em continuidade ao cap√≠tulo anterior, onde introduzimos a **fatora√ß√£o triangular** e suas aplica√ß√µes [^4], este cap√≠tulo detalha o procedimento recursivo para calcular os elementos das matrizes $A$ e $D$ na decomposi√ß√£o $\Omega = ADA'$. A compreens√£o deste processo √© fundamental para a implementa√ß√£o pr√°tica e eficiente das proje√ß√µes lineares e regress√µes OLS.

### Processo Recursivo para o C√°lculo de A e D
Como vimos anteriormente [^4.4.2], a matriz $\Omega$ √© transformada atrav√©s da pr√©-multiplica√ß√£o por matrizes de elimina√ß√£o $E_i$. Este processo iterativo tem como objetivo zerar os elementos abaixo da diagonal principal de $\Omega$ [^4.4.3, 4.4.6]. Formalmente, a sequ√™ncia de opera√ß√µes √© dada por:

$$
E_{n-1} \ldots E_2 E_1 \Omega (E_{n-1} \ldots E_2 E_1)' = D
$$

O c√°lculo das matrizes $A$ e $D$ ocorre atrav√©s da aplica√ß√£o sucessiva destas matrizes de elimina√ß√£o, seguida do c√°lculo das matrizes inversas dessas opera√ß√µes.

**C√°lculo dos Elementos de A:**
A matriz $A$ √© formada pelos elementos que s√£o utilizados para transformar $\Omega$ em uma matriz diagonal $D$. Estes elementos podem ser encontrados por meio do c√°lculo das inversas das matrizes $E_i$ [^4.4.10], e pela multiplica√ß√£o dessas inversas:
$$
A = (E_{n-1} \ldots E_2 E_1)^{-1} = E_1^{-1} E_2^{-1} \ldots E_{n-1}^{-1}
$$
Os elementos da matriz $A$ s√£o constru√≠dos de forma recursiva. Primeiro, os elementos da primeira coluna de $A$ s√£o calculados como os multiplicadores negativos usados para zerar os elementos abaixo da diagonal da primeira coluna de $\Omega$:
$$
a_{i1} = -\Omega_{i1} \Omega_{11}^{-1}, \quad i = 2, 3, \ldots, n
$$
Em geral, os elementos da j-√©sima coluna de $A$ s√£o obtidos como os multiplicadores negativos utilizados para zerar os elementos abaixo da diagonal na j-√©sima coluna da matriz resultante ap√≥s as transforma√ß√µes anteriores, da seguinte maneira:
$$
a_{ij} = -h_{ij} h_{jj}^{-1}, \quad  i = j+1, j+2, \ldots, n
$$
onde $h_{ij}$ s√£o os elementos da matriz resultante ap√≥s a aplica√ß√£o das matrizes de elimina√ß√£o $E_1, E_2, \ldots, E_{j-1}$ [^4.4.5]. Os elementos da diagonal principal de $A$ s√£o sempre iguais a 1. Formalmente, o elemento $a_{ij}$ da matriz $A$ pode ser calculado como o elemento da coluna $j$ da matriz $E_{j-1}^{-1}$ com linha $i$ e a seguinte rela√ß√£o de recorr√™ncia:
$$a_{ij} = - (E_{j-1} \ldots E_1 \Omega (E_{j-1} \ldots E_1)')_{ij} (E_{j-1} \ldots E_1 \Omega (E_{j-1} \ldots E_1)')_{jj}^{-1}$$
Note que os termos da matriz $A$ s√£o sempre relativos ao processo de elimina√ß√£o na matriz resultante ap√≥s as opera√ß√µes anteriores.
**Lema 1:** *A matriz A √© triangular inferior com elementos diagonais iguais a 1.*
*Demonstra√ß√£o:*
I. Cada matriz de elimina√ß√£o $E_i$ √© uma matriz triangular inferior com 1's na diagonal e zeros acima da diagonal.
II. A inversa de uma matriz triangular inferior √© tamb√©m triangular inferior. Assim, cada $E_i^{-1}$ √© uma matriz triangular inferior.
III. O produto de matrizes triangulares inferiores √© tamb√©m uma matriz triangular inferior. Portanto, $A = E_1^{-1} E_2^{-1} \ldots E_{n-1}^{-1}$ √© triangular inferior.
IV.  Como cada matriz $E_i$ tem 1's na diagonal principal, ent√£o a sua inversa tamb√©m tem 1's na diagonal.
V. O produto de matrizes triangulares inferiores com 1's na diagonal resulta em uma matriz triangular inferior com 1's na diagonal. Portanto, a matriz A tem elementos diagonais iguais a 1.
VI. Concluindo, a matriz A √© triangular inferior com elementos diagonais iguais a 1. ‚ñ†

**C√°lculo dos Elementos de D:**
Os elementos da matriz diagonal $D$ s√£o as vari√¢ncias das vari√°veis transformadas $\tilde{Y_i}$.  Eles s√£o calculados como os elementos da diagonal principal da matriz resultante ap√≥s a aplica√ß√£o de todas as matrizes de elimina√ß√£o $E_i$ em $\Omega$.
Os elementos $d_{ii}$ da matriz $D$ s√£o os termos resultantes nas posi√ß√µes diagonais ap√≥s cada opera√ß√£o de elimina√ß√£o, da seguinte forma:
$$
d_{ii} = h_{ii} = (E_{i-1} \ldots E_1 \Omega (E_{i-1} \ldots E_1)')_{ii}
$$
onde, novamente, $h_{ii}$ representa os elementos da diagonal principal ap√≥s a aplica√ß√£o das transforma√ß√µes lineares nas colunas anteriores.

Os elementos diagonais de $D$ s√£o sempre positivos, garantindo que $\Omega$ seja uma matriz definida positiva.

**Proposi√ß√£o 1:** *Se $\Omega$ √© uma matriz sim√©trica definida positiva, ent√£o todos os elementos diagonais de $D$ s√£o estritamente positivos, ou seja, $d_{ii} > 0$ para todo $i$.*
*Demonstra√ß√£o:*
I.  Seja $\Omega$ uma matriz sim√©trica definida positiva, isto significa que $x'\Omega x > 0$ para qualquer vetor n√£o nulo $x$.
II. A transforma√ß√£o $H = E_{i-1} \ldots E_1 \Omega (E_{i-1} \ldots E_1)'$ preserva a propriedade de ser definida positiva. Isso √© demonstrado observando que para qualquer vetor n√£o nulo $y$, podemos definir $x = (E_{i-1} \ldots E_1)'y$ e ter $y' H y = y' (E_{i-1} \ldots E_1) \Omega (E_{i-1} \ldots E_1)' y = x' \Omega x > 0$. Portanto, $H$ √© definida positiva.
III. A matriz $H$ √© definida positiva se e somente se todos seus autovalores forem positivos. 
IV.  Os elementos diagonais de uma matriz definida positiva s√£o sempre positivos.
V.  Como $d_{ii} = h_{ii}$ s√£o os elementos diagonais de $H$, ent√£o $d_{ii} > 0$ para todo $i$.
VI. Concluindo, todos os elementos diagonais de $D$ s√£o estritamente positivos. ‚ñ†

> üí° **Exemplo Num√©rico (C√°lculo dos elementos da matriz A):**  Vamos detalhar o c√°lculo dos elementos da matriz $A$ para uma matriz $\Omega$ de 4x4. Para isso, considere:
> $$
> \Omega = \begin{bmatrix}
> 16 & 4 & 8 & 4 \\
> 4 & 5 & 6 & 1 \\
> 8 & 6 & 10 & 4 \\
> 4 & 1 & 4 & 6
> \end{bmatrix}
> $$
>
> **Passo 1:** Calculamos $E_1$ para zerar os elementos abaixo da diagonal na primeira coluna:
> $$
> E_1 = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> -\frac{4}{16} & 1 & 0 & 0 \\
> -\frac{8}{16} & 0 & 1 & 0 \\
> -\frac{4}{16} & 0 & 0 & 1
> \end{bmatrix} = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> -0.25 & 1 & 0 & 0 \\
> -0.5 & 0 & 1 & 0 \\
> -0.25 & 0 & 0 & 1
> \end{bmatrix}
> $$
>
> Os elementos da primeira coluna de A s√£o:
> $$
> a_{21} = -\frac{4}{16} = 0.25, \quad a_{31} = -\frac{8}{16} = 0.5, \quad a_{41} = -\frac{4}{16} = 0.25
> $$
>
> **Passo 2:** Calcule $E_1 \Omega$:
>
> $$
> E_1 \Omega = \begin{bmatrix}
> 16 & 4 & 8 & 4 \\
> 0 & 4 & 4 & 0 \\
> 0 & 4 & 6 & 2 \\
> 0 & 0 & 2 & 5
> \end{bmatrix}
> $$
>
> **Passo 3:**  Calcule $E_2$ para zerar os elementos abaixo da diagonal na segunda coluna:
> $$
> E_2 = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0 & 1 & 0 & 0 \\
> 0 & -\frac{4}{4} & 1 & 0 \\
> 0 & -\frac{0}{4} & 0 & 1
> \end{bmatrix} = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0 & 1 & 0 & 0 \\
> 0 & -1 & 1 & 0 \\
> 0 & 0 & 0 & 1
> \end{bmatrix}
> $$
>
> Os elementos da segunda coluna de A s√£o:
> $$
> a_{32} = -(-1) = 1, \quad a_{42} = 0
> $$
>
> **Passo 4:** Calcule $E_2 E_1 \Omega$:
>
> $$
> E_2 E_1 \Omega = \begin{bmatrix}
> 16 & 4 & 8 & 4 \\
> 0 & 4 & 4 & 0 \\
> 0 & 0 & 2 & 2 \\
> 0 & 0 & 2 & 5
> \end{bmatrix}
> $$
>
> **Passo 5:** Calcule $E_3$ para zerar o elemento abaixo da diagonal na terceira coluna:
> $$
> E_3 = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0 & 1 & 0 & 0 \\
> 0 & 0 & 1 & 0 \\
> 0 & 0 & -\frac{2}{2} & 1
> \end{bmatrix} = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0 & 1 & 0 & 0 \\
> 0 & 0 & 1 & 0 \\
> 0 & 0 & -1 & 1
> \end{bmatrix}
> $$
>
> O elemento da terceira coluna de A √©:
> $$
> a_{43} = -(-1) = 1
> $$
>
> **Passo 6:** Calcule $E_3 E_2 E_1 \Omega$
> $$
> E_3 E_2 E_1 \Omega = \begin{bmatrix}
> 16 & 4 & 8 & 4 \\
> 0 & 4 & 4 & 0 \\
> 0 & 0 & 2 & 2 \\
> 0 & 0 & 0 & 3
> \end{bmatrix}
> $$
>
> Portanto, a matriz $A$ ser√°:
> $$
> A = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0.25 & 1 & 0 & 0 \\
> 0.5 & 1 & 1 & 0 \\
> 0.25 & 0 & 1 & 1
> \end{bmatrix}
> $$
>
> Os elementos diagonais de $D$ s√£o:
>
> $$ d_{11} = 16, \quad d_{22} = 4, \quad d_{33} = 2, \quad d_{44} = 3 $$
>
> Portanto, a matriz $D$ ser√°:
>
> $$
> D = \begin{bmatrix}
> 16 & 0 & 0 & 0 \\
> 0 & 4 & 0 & 0 \\
> 0 & 0 & 2 & 0 \\
> 0 & 0 & 0 & 3
> \end{bmatrix}
> $$
>
> Verificando, temos:
>
> $$ ADA' = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0.25 & 1 & 0 & 0 \\
> 0.5 & 1 & 1 & 0 \\
> 0.25 & 0 & 1 & 1
> \end{bmatrix} \begin{bmatrix}
> 16 & 0 & 0 & 0 \\
> 0 & 4 & 0 & 0 \\
> 0 & 0 & 2 & 0 \\
> 0 & 0 & 0 & 3
> \end{bmatrix} \begin{bmatrix}
> 1 & 0.25 & 0.5 & 0.25 \\
> 0 & 1 & 1 & 0 \\
> 0 & 0 & 1 & 1 \\
> 0 & 0 & 0 & 1
> \end{bmatrix} = \begin{bmatrix}
> 16 & 4 & 8 & 4 \\
> 4 & 5 & 6 & 1 \\
> 8 & 6 & 10 & 4 \\
> 4 & 1 & 4 & 6
> \end{bmatrix}
> $$
>
> Este exemplo demonstra concretamente como as matrizes $A$ e $D$ s√£o constru√≠das passo a passo, aplicando a elimina√ß√£o de Gauss para triangularizar e diagonalizar a matriz $\Omega$. Observe que a matriz $A$ √© triangular inferior com 1s na diagonal, como demonstrado no Lema 1, e que os elementos da matriz $D$ s√£o todos positivos, como esperado pela proposi√ß√£o 1.
>
> üí° **Exemplo Num√©rico (Impacto de $\Omega$ na Fatora√ß√£o):** Suponha que a matriz $\Omega$ represente a matriz de covari√¢ncia de um conjunto de vari√°veis. Se aumentarmos a covari√¢ncia entre as vari√°veis, por exemplo, aumentando os elementos fora da diagonal em $\Omega$, isso afetaria diretamente os elementos de $A$ e $D$. Vamos ilustrar isso com uma modifica√ß√£o na matriz $\Omega$ do exemplo anterior, aumentando as covari√¢ncias:
>
> $$
> \Omega_{mod} = \begin{bmatrix}
> 16 & 8 & 12 & 8 \\
> 8 & 10 & 12 & 5 \\
> 12 & 12 & 20 & 10 \\
> 8 & 5 & 10 & 12
> \end{bmatrix}
> $$
>
> Repetindo o processo de fatora√ß√£o:
>
> **Passo 1:**
> $$
> E_1 = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> -0.5 & 1 & 0 & 0 \\
> -0.75 & 0 & 1 & 0 \\
> -0.5 & 0 & 0 & 1
> \end{bmatrix}
> $$
>
> **Passo 2:**
> $$
> E_1 \Omega_{mod} = \begin{bmatrix}
> 16 & 8 & 12 & 8 \\
> 0 & 6 & 6 & 1 \\
> 0 & 6 & 11 & 4 \\
> 0 & 1 & 4 & 8
> \end{bmatrix}
> $$
>
> **Passo 3:**
> $$
> E_2 = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0 & 1 & 0 & 0 \\
> 0 & -1 & 1 & 0 \\
> 0 & -1/6 & 0 & 1
> \end{bmatrix}
> $$
>
> **Passo 4:**
>
> $$
> E_2 E_1 \Omega_{mod} = \begin{bmatrix}
> 16 & 8 & 12 & 8 \\
> 0 & 6 & 6 & 1 \\
> 0 & 0 & 5 & 3 \\
> 0 & 0 & 3.33 & 7.83
> \end{bmatrix}
> $$
>
> **Passo 5:**
> $$
> E_3 = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0 & 1 & 0 & 0 \\
> 0 & 0 & 1 & 0 \\
> 0 & 0 & -3.33/5 & 1
> \end{bmatrix} = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0 & 1 & 0 & 0 \\
> 0 & 0 & 1 & 0 \\
> 0 & 0 & -0.666 & 1
> \end{bmatrix}
> $$
>
> **Passo 6:**
>
> $$
> E_3 E_2 E_1 \Omega_{mod} = \begin{bmatrix}
> 16 & 8 & 12 & 8 \\
> 0 & 6 & 6 & 1 \\
> 0 & 0 & 5 & 3 \\
> 0 & 0 & 0 & 5.83
> \end{bmatrix}
> $$
>
> Portanto, as novas matrizes $A_{mod}$ e $D_{mod}$ s√£o:
> $$
> A_{mod} = \begin{bmatrix}
> 1 & 0 & 0 & 0 \\
> 0.5 & 1 & 0 & 0 \\
> 0.75 & 1 & 1 & 0 \\
> 0.5 & 1/6 & 0.666 & 1
> \end{bmatrix}
> $$
>
> $$
> D_{mod} = \begin{bmatrix}
> 16 & 0 & 0 & 0 \\
> 0 & 6 & 0 & 0 \\
> 0 & 0 & 5 & 0 \\
> 0 & 0 & 0 & 5.83
> \end{bmatrix}
> $$
>
> Observa-se que ao aumentarmos os elementos fora da diagonal de $\Omega$, os elementos de $A$ e $D$ tamb√©m se modificaram. Especificamente, os elementos de $A$ (fora da diagonal) aumentaram, refletindo as maiores covari√¢ncias entre as vari√°veis originais, e os elementos de $D$, que representam as vari√¢ncias das vari√°veis transformadas, tamb√©m foram afetados. Este exemplo ilustra como a estrutura de covari√¢ncia, representada por $\Omega$, impacta diretamente a decomposi√ß√£o triangular.
>

**Corol√°rio 1.1:** *A matriz $\Omega$ pode ser reconstru√≠da a partir da fatora√ß√£o triangular como $\Omega = ADA'$.*
*Demonstra√ß√£o:*
I. A decomposi√ß√£o de $\Omega$ √© realizada atrav√©s da aplica√ß√£o sucessiva de matrizes de elimina√ß√£o $E_i$ de forma que $E_{n-1} \ldots E_1 \Omega (E_{n-1} \ldots E_1)' = D$.
II. Multiplicando ambos os lados pela inversa de $E_{n-1} \ldots E_1$ √† esquerda e pela inversa de $(E_{n-1} \ldots E_1)'$ √† direita, temos: $(E_{n-1} \ldots E_1)^{-1} E_{n-1} \ldots E_1 \Omega (E_{n-1} \ldots E_1)' (E_{n-1} \ldots E_1)'^{-1} = (E_{n-1} \ldots E_1)^{-1} D (E_{n-1} \ldots E_1)'^{-1}$
III. Como $(E_{n-1} \ldots E_1)^{-1} = A$ e $((E_{n-1} \ldots E_1)')^{-1} = A'$, a equa√ß√£o se simplifica para $\Omega = ADA'$.
IV. Portanto, a matriz $\Omega$ pode ser reconstru√≠da a partir da fatora√ß√£o triangular como $\Omega = ADA'$. ‚ñ†

### Conclus√£o
O processo de c√°lculo dos elementos das matrizes $A$ e $D$ envolve uma sequ√™ncia de opera√ß√µes recursivas, incluindo a aplica√ß√£o de matrizes de elimina√ß√£o e o c√°lculo das inversas dessas matrizes. Este processo, embora possa parecer complexo, pode ser implementado de forma eficiente, especialmente em softwares de c√°lculo matricial. Ao compreender este processo detalhadamente, podemos apreciar como a **fatora√ß√£o triangular** fornece uma ferramenta poderosa para an√°lises de s√©ries temporais e na estat√≠stica em geral, por meio da simplifica√ß√£o de opera√ß√µes e do uso de matrizes auxiliares.

### Refer√™ncias
[^4]: Texto referente a se√ß√£o anterior
[^4.4.2]: A matriz $\Omega$ pode ser transformada em uma matriz com zeros nas posi√ß√µes (2,1), (3,1), etc., atrav√©s da multiplica√ß√£o pela matriz $E_1$.
[^4.4.3]: A matriz $E_1$ √© definida como uma matriz de transforma√ß√£o com elementos espec√≠ficos.
[^4.4.5]:  Express√£o [4.4.5] define a matriz H, obtida ap√≥s transformar a primeira coluna de $\Omega$.
[^4.4.6]: A matriz $E_2$ e suas seguintes realizam transforma√ß√µes similares para colunas subsequentes da matriz.
[^4.4.10]: A matriz $E_1^{-1}$ √© a inversa da matriz $E_1$.
<!-- END -->
