## A Fatora√ß√£o de Cholesky e sua Rela√ß√£o com a Fatora√ß√£o Triangular

### Introdu√ß√£o
Este cap√≠tulo aprofunda a discuss√£o sobre a **fatora√ß√£o triangular**, com foco espec√≠fico na **fatora√ß√£o de Cholesky**, uma forma particular desta decomposi√ß√£o matricial que desempenha um papel crucial em diversas aplica√ß√µes, especialmente em estat√≠stica e computa√ß√£o [^4.4.16]. Como j√° explorado, a fatora√ß√£o triangular decomp√µe uma matriz sim√©trica positiva definida em tr√™s componentes: uma matriz triangular inferior com 1s na diagonal, uma matriz diagonal e a transposta da matriz triangular inferior. A fatora√ß√£o de Cholesky, por sua vez, leva esta decomposi√ß√£o um passo adiante ao expressar a matriz diagonal como o produto de duas matrizes, cada uma sendo a raiz quadrada da matriz original, resultando em um produto de uma matriz triangular inferior e sua transposta.

Este t√≥pico expande os conceitos apresentados anteriormente, construindo sobre a base da fatora√ß√£o triangular e introduzindo a fatora√ß√£o de Cholesky como uma ferramenta espec√≠fica para resolver problemas relacionados √† an√°lise de dados, simula√ß√µes e otimiza√ß√µes. O conhecimento pr√©vio sobre **proje√ß√µes lineares** e a **fatora√ß√£o triangular** √© essencial para uma compreens√£o completa dos temas abordados neste cap√≠tulo.

### Conceitos Fundamentais
Como vimos anteriormente, qualquer matriz sim√©trica positiva definida $\Omega$ pode ser fatorada como:

$$ \Omega = ADA' $$,

onde **A** √© uma matriz triangular inferior com 1s na diagonal principal e **D** √© uma matriz diagonal com elementos estritamente positivos [^4.4.1]. A **fatora√ß√£o de Cholesky** surge como uma representa√ß√£o alternativa, onde a matriz diagonal *D* √© expressa como o quadrado de outra matriz diagonal,  **D¬π/¬≤**, tal que:

$$ \Omega = AD^{1/2}D^{1/2}A' = (AD^{1/2})(AD^{1/2})' $$.

Definindo **P = AD¬π/¬≤**, temos a fatora√ß√£o de Cholesky:

$$ \Omega = PP' $$.

Aqui, **P** √© uma matriz triangular inferior, assim como *A*, mas com a diferen√ßa que os elementos diagonais de P n√£o s√£o necessariamente iguais a 1, sendo, na verdade, a raiz quadrada dos elementos correspondentes de D. Essa forma de fatora√ß√£o √© particularmente √∫til em diversas aplica√ß√µes devido √† simplicidade da opera√ß√£o e ao fato de que *P* √© uma matriz triangular inferior, como demonstrado no **Lema 2**.

> üí° **Exemplo Num√©rico:**
>
> Retomando o exemplo da fatora√ß√£o triangular da matriz $\Omega$, vamos calcular as matrizes D¬π/¬≤ e P:
>
> $$ \Omega = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix} $$
>
>  Ap√≥s a aplica√ß√£o das opera√ß√µes $E_k$  na se√ß√£o anterior, obtivemos a matriz diagonal *D*:
>
> $$ D =  \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 4 \end{bmatrix} $$
>
>  A matriz  **D¬π/¬≤**  √© ent√£o:
>
> $$ D^{1/2} =  \begin{bmatrix} \sqrt{4} & 0 & 0 \\ 0 & \sqrt{4} & 0 \\ 0 & 0 & \sqrt{4} \end{bmatrix} =  \begin{bmatrix} 2 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bmatrix} $$
>
> E a matriz *A* obtida por meio do produto das inversas de $E_k$:
>
> $$ A =  \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0.5 & 1 \end{bmatrix}$$
>
> Finalmente, a matriz **P** da fatora√ß√£o de Cholesky √© dada por:
>
> $$ P = AD^{1/2} =  \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0.5 & 1 \end{bmatrix}  \begin{bmatrix} 2 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bmatrix} = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix}$$
>
>
>
> üí° **Exemplo Num√©rico:**
>
> Vamos considerar outra matriz sim√©trica positiva definida:
>
> $$ \Omega_2 = \begin{bmatrix} 9 & 3 & 6 \\ 3 & 5 & 4 \\ 6 & 4 & 21 \end{bmatrix} $$
>
> Para realizar a fatora√ß√£o de Cholesky $\Omega_2 = PP'$, podemos usar o seguinte algoritmo:
>
> 1.  Inicializar $P$ como uma matriz de zeros.
>
> 2.  Para cada $i$ de 1 at√© o tamanho da matriz:
>     *   Calcular $P_{ii} = \sqrt{\Omega_{ii} - \sum_{k=1}^{i-1} P_{ik}^2}$
>     *   Para cada $j$ de $i+1$ at√© o tamanho da matriz:
>         *   Calcular $P_{ji} = \frac{1}{P_{ii}} (\Omega_{ji} - \sum_{k=1}^{i-1} P_{jk}P_{ik})$
>
> Aplicando este algoritmo, obtemos:
>
> $$
> P = \begin{bmatrix}
> \sqrt{9} & 0 & 0 \\
> \frac{3}{\sqrt{9}} & \sqrt{5 - (\frac{3}{\sqrt{9}})^2} & 0 \\
> \frac{6}{\sqrt{9}} & \frac{4 - (\frac{3}{\sqrt{9}})(\frac{6}{\sqrt{9}})}{\sqrt{5 - (\frac{3}{\sqrt{9}})^2}}  & \sqrt{21 - (\frac{6}{\sqrt{9}})^2 - (\frac{4 - (\frac{3}{\sqrt{9}})(\frac{6}{\sqrt{9}})}{\sqrt{5 - (\frac{3}{\sqrt{9}})^2}})^2}
> \end{bmatrix}
> $$
>
> Simplificando:
>
> $$
> P = \begin{bmatrix}
> 3 & 0 & 0 \\
> 1 & 2 & 0 \\
> 2 & 1 & 4
> \end{bmatrix}
> $$
>
> Para verificar a fatora√ß√£o, multiplicamos $PP'$:
>
> $$ PP' = \begin{bmatrix} 3 & 0 & 0 \\ 1 & 2 & 0 \\ 2 & 1 & 4 \end{bmatrix} \begin{bmatrix} 3 & 1 & 2 \\ 0 & 2 & 1 \\ 0 & 0 & 4 \end{bmatrix} = \begin{bmatrix} 9 & 3 & 6 \\ 3 & 5 & 4 \\ 6 & 4 & 21 \end{bmatrix} = \Omega_2$$
>
>
>
> Este exemplo num√©rico demonstra o processo de c√°lculo da matriz P, confirmando a fatora√ß√£o de Cholesky.

**Propriedades da Fatora√ß√£o de Cholesky**
A matriz *P* na fatora√ß√£o de Cholesky possui algumas propriedades importantes:
1.  √â uma **matriz triangular inferior**: Todos os elementos acima da diagonal principal s√£o zero. Isso facilita a resolu√ß√£o de sistemas lineares e o c√°lculo de determinantes [Lema 2].
2.  Possui **elementos diagonais positivos**: Os elementos diagonais de *P* s√£o as ra√≠zes quadradas dos elementos diagonais da matriz *D*, que s√£o estritamente positivos [Lema 2].
3.  **√â √∫nica**: Para uma matriz sim√©trica positiva definida, a fatora√ß√£o de Cholesky √© √∫nica. Ou seja, n√£o existem outras matrizes triangulares inferiores $P$ diferentes que satisfazem $\Omega = PP'$.

> üí° **Exemplo Num√©rico (Verifica√ß√£o):**
> Para verificar a fatora√ß√£o de Cholesky da matriz $\Omega$, calculamos $PP'$:
>
> $$ PP' = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix} \begin{bmatrix} 2 & 1 & 1 \\ 0 & 2 & 1 \\ 0 & 0 & 2 \end{bmatrix} = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix} = \Omega$$
>
> Como resultado da multiplica√ß√£o de $P$ pela sua transposta, obtemos a matriz $\Omega$ original, confirmando a fatora√ß√£o de Cholesky.
>
> üí° **Exemplo Num√©rico (Unicidade):**
> Suponha que tiv√©ssemos outra matriz triangular inferior $Q$ tal que $\Omega = QQ'$.  No entanto, devido √† unicidade da fatora√ß√£o de Cholesky, $Q$ deve ser igual a $P$. Para ilustrar, se tentarmos encontrar uma matriz $Q \neq P$ que satisfa√ßa $QQ' = \Omega$, rapidamente perceberemos que tal matriz n√£o existe, dada a natureza das opera√ß√µes de decomposi√ß√£o. A unicidade garante que a matriz $P$ obtida atrav√©s do processo de Cholesky √© a √∫nica matriz triangular inferior que satisfaz a igualdade $\Omega = PP'$.
>

**Aplica√ß√µes da Fatora√ß√£o de Cholesky**
A fatora√ß√£o de Cholesky possui diversas aplica√ß√µes, incluindo:

1.  **Simula√ß√£o de dados:** Permite gerar n√∫meros aleat√≥rios com uma dada matriz de covari√¢ncia. Para gerar um vetor aleat√≥rio com distribui√ß√£o normal multivariada, por exemplo, pode-se gerar um vetor de n√∫meros aleat√≥rios com distribui√ß√£o normal padr√£o e multiplic√°-lo pela matriz *P*.
2.  **Resolu√ß√£o de sistemas lineares:** Em sistemas lineares da forma $\Omega x = b$, onde $\Omega$ √© sim√©trica positiva definida, a fatora√ß√£o de Cholesky pode ser usada para simplificar o c√°lculo da solu√ß√£o, dividindo o sistema em dois sistemas triangulares, que s√£o mais f√°ceis de resolver.
3.  **Otimiza√ß√£o:** A fatora√ß√£o de Cholesky pode ser utilizada para calcular m√≠nimos quadrados de forma eficiente, pois simplifica a invers√£o de matrizes de covari√¢ncia.
4. **Atualiza√ß√£o de Proje√ß√µes Lineares**: Como visto no cap√≠tulo anterior, as proje√ß√µes lineares podem ser atualizadas recursivamente atrav√©s do uso da fatora√ß√£o triangular [^4.5.12].

> üí° **Exemplo Num√©rico (Simula√ß√£o de Dados):**
>
> Suponha que queremos gerar um vetor aleat√≥rio $Y$ de dimens√£o 3, com distribui√ß√£o normal multivariada, m√©dia zero e matriz de covari√¢ncia $\Omega = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix}$.
>
> 1.  Calculamos a fatora√ß√£o de Cholesky de $\Omega$, obtendo $P = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix}$.
> 2.  Geramos um vetor $Z$ de 3 vari√°veis aleat√≥rias independentes, cada uma com distribui√ß√£o normal padr√£o. Por exemplo, usando Python:
>
> ```python
> import numpy as np
>
> Z = np.random.normal(0, 1, 3)
> print("Vetor Z:", Z)
> # Output (pode variar devido a aleatoriedade): [ 0.3  -1.2   0.8]
> ```
>
> 3.  Calculamos $Y = PZ$:
>
> ```python
> P = np.array([[2, 0, 0], [1, 2, 0], [1, 1, 2]])
> Y = np.dot(P, Z)
> print("Vetor Y:", Y)
> # Output (pode variar): [ 0.6  -2.1  -0.7]
> ```
>
> O vetor $Y$ gerado ter√° a matriz de covari√¢ncia $\Omega$. Repetindo este processo v√°rias vezes e calculando a matriz de covari√¢ncia amostral de $Y$, obter√≠amos um resultado pr√≥ximo de $\Omega$.
>
> üí° **Exemplo Num√©rico (Resolu√ß√£o de Sistema Linear):**
>
> Vamos resolver o sistema linear $\Omega x = b$, onde $\Omega = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix}$ e $b = \begin{bmatrix} 10 \\ 15 \\ 20 \end{bmatrix}$.
>
> 1.  Calculamos a fatora√ß√£o de Cholesky de $\Omega$, obtendo $P = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix}$.
>
> 2.  Resolvemos $Py = b$ por substitui√ß√£o progressiva:
>
>   *  $2y_1 = 10 \Rightarrow y_1 = 5$
>   *  $1y_1 + 2y_2 = 15 \Rightarrow 5 + 2y_2 = 15 \Rightarrow y_2 = 5$
>   *  $1y_1 + 1y_2 + 2y_3 = 20 \Rightarrow 5 + 5 + 2y_3 = 20 \Rightarrow y_3 = 5$
>
>  Assim, $y = \begin{bmatrix} 5 \\ 5 \\ 5 \end{bmatrix}$.
>
> 3. Resolvemos $P^T x = y$ por substitui√ß√£o retroativa:
>
>   * $2x_3 = 5 \Rightarrow x_3 = 2.5$
>   * $2x_2 + x_3 = 5 \Rightarrow 2x_2 + 2.5 = 5 \Rightarrow x_2 = 1.25$
>   * $2x_1 + x_2 + x_3 = 5 \Rightarrow 2x_1 + 1.25 + 2.5 = 5 \Rightarrow x_1 = 0.625$
>
>  Portanto, $x = \begin{bmatrix} 0.625 \\ 1.25 \\ 2.5 \end{bmatrix}$. Podemos verificar:
>
> $$\Omega x = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix} \begin{bmatrix} 0.625 \\ 1.25 \\ 2.5 \end{bmatrix} = \begin{bmatrix} 10 \\ 15 \\ 20 \end{bmatrix} = b$$
>
> A solu√ß√£o do sistema linear √© obtida de forma eficiente usando a fatora√ß√£o de Cholesky.

**Teorema 2**
A fatora√ß√£o de Cholesky de uma matriz de covari√¢ncia $\Omega$ pode ser utilizada para gerar um vetor aleat√≥rio $Y$ com matriz de covari√¢ncia $\Omega$.

*Proof:*
Seja $Z$ um vetor de vari√°veis aleat√≥rias independentes com distribui√ß√£o normal padr√£o. Para obter um vetor $Y$ com matriz de covari√¢ncia $\Omega$, podemos usar a fatora√ß√£o de Cholesky para obter uma matriz $P$ tal que $\Omega=PP^T$. Ent√£o, definimos $Y=PZ$. A matriz de covari√¢ncia de $Y$ √© dada por:
$$Cov(Y) = Cov(PZ) = PCov(Z)P^T = PIP^T = PP^T = \Omega$$
Assim, o vetor aleat√≥rio $Y$ tem matriz de covari√¢ncia $\Omega$.

I. Seja $Z$ um vetor de vari√°veis aleat√≥rias independentes com distribui√ß√£o normal padr√£o, onde a matriz de covari√¢ncia √© a identidade, $Cov(Z) = I$.

II. Seja $\Omega$ uma matriz sim√©trica positiva definida e $P$ a matriz triangular inferior da fatora√ß√£o de Cholesky de $\Omega$ de forma que $\Omega = PP^T$.

III. Definimos um novo vetor de vari√°veis aleat√≥rias $Y = PZ$.

IV. A matriz de covari√¢ncia de $Y$ √© dada por:
  $$Cov(Y) = Cov(PZ) = E[(PZ)(PZ)^T] - E[PZ]E[PZ]^T = E[PZZ^TP^T]-E[PZ]E[PZ]^T = P E[ZZ^T]P^T- P E[Z] E[Z]^T P^T= PICov(Z)P^T$$

V.  Como $Cov(Z) = I$, a matriz de covari√¢ncia de Y √©:
 $$Cov(Y) = P I P^T = PP^T = \Omega$$
 VI. Portanto, $Y = PZ$ √© um vetor de vari√°veis aleat√≥rias com matriz de covari√¢ncia igual a $\Omega$. $\blacksquare$

Este resultado mostra que a fatora√ß√£o de Cholesky pode ser usada para transformar um vetor de vari√°veis aleat√≥rias independentes com vari√¢ncia unit√°ria em um vetor de vari√°veis aleat√≥rias com uma matriz de covari√¢ncia desejada, $\Omega$.

**Teorema 2.1**
A fatora√ß√£o de Cholesky √© computacionalmente eficiente para resolver sistemas lineares da forma $\Omega x = b$, onde $\Omega$ √© uma matriz sim√©trica positiva definida.

*Proof:*
Dado o sistema $\Omega x = b$, e a fatora√ß√£o de Cholesky $\Omega = PP^T$, podemos reescrever o sistema como $PP^T x = b$. Definindo $y = P^T x$, temos $Py = b$, que √© um sistema triangular inferior. Podemos resolver este sistema para $y$ por substitui√ß√£o progressiva. Uma vez obtido $y$, resolvemos $P^T x = y$, que √© um sistema triangular superior, para obter $x$ por substitui√ß√£o retroativa. Ambas as substitui√ß√µes s√£o computacionalmente eficientes, necessitando de $O(n^2)$ opera√ß√µes cada, enquanto a fatora√ß√£o de Cholesky tamb√©m tem complexidade $O(n^3)$.  Portanto, a solu√ß√£o do sistema linear por meio da fatora√ß√£o de Cholesky √© muito eficiente, evitando a invers√£o da matriz $\Omega$, que teria uma complexidade computacional muito maior. $\blacksquare$

Al√©m da aplica√ß√£o na resolu√ß√£o de sistemas lineares, a fatora√ß√£o de Cholesky tamb√©m √© √∫til para o c√°lculo do determinante de uma matriz sim√©trica positiva definida.

**Lema 3**
O determinante de uma matriz sim√©trica positiva definida $\Omega$ √© igual ao quadrado do produto dos elementos diagonais da matriz P da fatora√ß√£o de Cholesky, $\Omega=PP^T$.

*Proof:*
Dado $\Omega = PP^T$, podemos usar a propriedade de que o determinante do produto de matrizes √© o produto dos determinantes, $\det(\Omega) = \det(PP^T) = \det(P)\det(P^T)$. Al√©m disso, como o determinante da transposta de uma matriz √© igual ao determinante da matriz original, $\det(P^T) = \det(P)$. Portanto, $\det(\Omega) = \det(P)^2$. Como $P$ √© uma matriz triangular inferior, seu determinante √© o produto de seus elementos diagonais. Denotando os elementos diagonais de $P$ por $p_{ii}$, temos $\det(P) = \prod_{i=1}^n p_{ii}$. Consequentemente, $\det(\Omega) = (\prod_{i=1}^n p_{ii})^2$. $\blacksquare$
> üí° **Exemplo Num√©rico (Determinante):**
>
> Para a matriz $\Omega = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix}$, obtivemos a matriz de Cholesky $P = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix}$.
>
> Os elementos diagonais de $P$ s√£o $p_{11} = 2$, $p_{22} = 2$ e $p_{33} = 2$.
>
> O determinante de $P$ √© o produto desses elementos: $\det(P) = 2 \times 2 \times 2 = 8$.
>
> Portanto, o determinante de $\Omega$ √© $\det(\Omega) = \det(P)^2 = 8^2 = 64$.
>
> Podemos verificar esse resultado usando o m√©todo tradicional de c√°lculo de determinantes (que √© mais custoso computacionalmente):
>
> $\det(\Omega) = 4(5\times6 - 3\times3) - 2(2\times6 - 2\times3) + 2(2\times3 - 2\times5) = 4(30-9) - 2(12-6) + 2(6-10) = 4(21) - 2(6) + 2(-4) = 84 - 12 - 8 = 64$
>
> A fatora√ß√£o de Cholesky fornece uma forma eficiente de calcular o determinante da matriz sim√©trica positiva definida.

Este resultado permite o c√°lculo do determinante de $\Omega$ sem a necessidade de um c√°lculo direto da defini√ß√£o, o que pode ser muito mais eficiente computacionalmente.

### Conclus√£o
A **fatora√ß√£o de Cholesky** surge como uma forma especial da **fatora√ß√£o triangular**, onde a matriz diagonal √© decomposta em uma matriz e sua transposta. Essa fatora√ß√£o oferece uma ferramenta poderosa para simplificar c√°lculos e implementar algoritmos em estat√≠stica e computa√ß√£o.  As aplica√ß√µes em simula√ß√µes, resolu√ß√£o de sistemas lineares e otimiza√ß√£o ressaltam a import√¢ncia da fatora√ß√£o de Cholesky e a sua rela√ß√£o com as proje√ß√µes lineares e a fatora√ß√£o triangular, ambos temas discutidos anteriormente [^4.5.13]. O entendimento desses conceitos permite a constru√ß√£o de modelos mais eficientes e uma an√°lise mais profunda dos processos estoc√°sticos.

### Refer√™ncias
[^4.4.1]: Qualquer matriz sim√©trica positiva definida $\Omega$ pode ser expressa como $\Omega = ADA'$, onde A √© uma matriz triangular inferior com 1s na diagonal principal, e D √© uma matriz diagonal com elementos positivos.
[^4.4.16]: Express√£o [4.4.16] √© conhecida como a fatora√ß√£o de Cholesky de $\Omega$...
[^4.5.12]: ...o √≥timo forecast de Y3 condicional em Y2 e Y1 pode ser lido da √∫ltima linha em bloco de A: $\hat{P}(Y_3|Y_2,Y_1) = \Omega_{31} \Omega_{11}^{-1} Y_1 + H_{32}H_{22}^{-1} (Y_2 - \Omega_{21}\Omega_{11}^{-1} Y_1) = P(Y_3|Y_1) + H_{32}H_{22}^{-1} [Y_2-P(Y_2|Y_1)]$
[^4.5.13]: O MSE da proje√ß√£o linear √© a vari√¢ncia de $Y_3$, que de [4.5.5] √© dada por $d_{33}$: $E[Y_3 - P(Y_3|Y_2,Y_1)]^2 = h_{33} - h_{32}h_{22}^{-1}h_{23}$
<!-- END -->
