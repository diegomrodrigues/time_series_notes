## Atualiza√ß√£o de Proje√ß√µes Lineares via Fatora√ß√£o Triangular
### Introdu√ß√£o
Este cap√≠tulo expande os conceitos de proje√ß√µes lineares e como elas podem ser atualizadas usando a fatora√ß√£o triangular da matriz de momentos. Como vimos anteriormente, a proje√ß√£o linear fornece a melhor previs√£o linear de uma vari√°vel aleat√≥ria com base em um conjunto de outras vari√°veis aleat√≥rias [^4.1.10]. No entanto, em muitas situa√ß√µes, novas informa√ß√µes podem se tornar dispon√≠veis, e √© essencial atualizar as proje√ß√µes lineares existentes para incorporar essa nova informa√ß√£o. A fatora√ß√£o triangular desempenha um papel crucial neste processo, permitindo que as proje√ß√µes sejam atualizadas de forma eficiente e precisa [^4.4.1].

### Conceitos Fundamentais

A fatora√ß√£o triangular, representada por $\Omega = ADA'$, decomp√µe a matriz de covari√¢ncia $\Omega$ em um produto de matrizes triangulares inferiores ($A$), uma matriz diagonal ($D$) e a transposta da matriz triangular inferior ($A'$). Esta decomposi√ß√£o facilita o c√°lculo de proje√ß√µes lineares e a atualiza√ß√£o dessas proje√ß√µes quando novas informa√ß√µes se tornam dispon√≠veis [^4.4.1].

#### Atualiza√ß√£o de Proje√ß√µes Lineares
Considere o problema de prever $Y_3$ com base em alguma informa√ß√£o inicial $Y_1$. A proje√ß√£o de $Y_3$ com base em $Y_1$ √© dada por:
$$P(Y_3|Y_1) = \Omega_{31} \Omega_{11}^{-1} Y_1$$ [^4.5.12]
> üí° **Exemplo Num√©rico:** Suponha que temos as seguintes covari√¢ncias: $\Omega_{11} = 4$, $\Omega_{31} = 2$. E que a observa√ß√£o inicial seja $Y_1 = 3$. A proje√ß√£o de $Y_3$ em $Y_1$ seria:
> $$P(Y_3|Y_1) = 2 \cdot 4^{-1} \cdot 3 = 1.5$$
> Isso significa que, com base apenas em $Y_1$, nossa melhor estimativa linear para $Y_3$ √© 1.5.

Agora, suponha que uma nova informa√ß√£o $Y_2$ esteja dispon√≠vel. Podemos atualizar nossa proje√ß√£o inicial de $Y_3$ usando $Y_2$. A nova proje√ß√£o, com base em $Y_1$ e $Y_2$, √© dada por:
$$P(Y_3|Y_2, Y_1) = P(Y_3|Y_1) + h_{32}h_{22}^{-1} [Y_2 - P(Y_2|Y_1)]$$ [^4.5.14]
onde
$$h_{22} = E[Y_2 - P(Y_2|Y_1)]^2$$
e
$$h_{32} = E\{[Y_3 - P(Y_3|Y_1)][Y_2 - P(Y_2|Y_1)]\}$$
Como visto na se√ß√£o anterior, $h_{22}$ e $h_{32}$ podem ser calculados de forma eficiente usando a fatora√ß√£o triangular da matriz de momentos. A equa√ß√£o acima mostra que a proje√ß√£o inicial, $P(Y_3|Y_1)$, √© atualizada adicionando a ela um m√∫ltiplo da surpresa na nova informa√ß√£o, ou seja, o termo $[Y_2 - P(Y_2|Y_1)]$.
> üí° **Exemplo Num√©rico (cont.):** Vamos continuar com o exemplo anterior. Suponha que tamb√©m tenhamos: $\Omega_{21} = 1$, $\Omega_{22} = 2$, $\Omega_{32} = 0.5$. Vamos calcular $P(Y_2|Y_1)$ primeiro.
> $$P(Y_2|Y_1) = \Omega_{21} \Omega_{11}^{-1} Y_1 = 1 \cdot 4^{-1} \cdot 3 = 0.75$$
> Agora, suponha que observamos $Y_2 = 1$. Precisamos de $h_{22}$ e $h_{32}$. 
> $h_{22}$ √© a vari√¢ncia do res√≠duo de $Y_2$ ap√≥s projetar em $Y_1$. Do exemplo posterior, sabemos que $h_{22} = d_{22}$. Assumindo que $d_{22} = 1.75$ e que $h_{32} = 0.375$, podemos calcular a nova proje√ß√£o:
> $$P(Y_3|Y_2, Y_1) = 1.5 + 0.375 \cdot (1.75)^{-1} \cdot [1 - 0.75] = 1.5 + 0.214 * 0.25 = 1.553$$
> Assim, ao incluir $Y_2$ em nossa previs√£o, a proje√ß√£o de $Y_3$ √© atualizada de 1.5 para 1.553. Note como a nova proje√ß√£o se move na dire√ß√£o da nova informa√ß√£o ($Y_2$).

**Lema 1:** *A proje√ß√£o $P(Y_2|Y_1)$ pode ser expressa em termos da matriz de covari√¢ncia da seguinte forma:*
$$P(Y_2|Y_1) = \Omega_{21}\Omega_{11}^{-1}Y_1$$
*Demonstra√ß√£o:* Esta √© uma aplica√ß√£o direta da defini√ß√£o de proje√ß√£o linear, como indicado anteriormente na se√ß√£o [^4.5.12].

**Proposi√ß√£o 1:** *A quantidade $h_{22}$ corresponde ao elemento $d_{22}$ da matriz diagonal $D$ na fatora√ß√£o triangular $\Omega = ADA'$.*
*Demonstra√ß√£o:*
I. Temos que $h_{22} = E[Y_2 - P(Y_2|Y_1)]^2$.
II. Da se√ß√£o anterior sabemos que $Y_2 - P(Y_2|Y_1) = \tilde{Y}_2$, ent√£o $h_{22} = E[\tilde{Y}_2^2]$.
III. Dado que a matriz de covari√¢ncia das vari√°veis transformadas $\tilde{Y}$ √© diagonal e dada por $D$, e que $d_{ii} = E[\tilde{Y}_i^2]$, segue que $h_{22} = d_{22}$. ‚ñ†
> üí° **Exemplo Num√©rico:** Continuando o exemplo, $h_{22}= d_{22} = 1.75$, isto √© a vari√¢ncia do res√≠duo de $Y_2$ depois da proje√ß√£o em $Y_1$.

#### Fatora√ß√£o Triangular e Proje√ß√µes Lineares
Para entender melhor a conex√£o entre fatora√ß√£o triangular e proje√ß√µes lineares, podemos reescrever o vetor de vari√°veis originais $Y$ como um vetor de vari√°veis transformadas $\tilde{Y}$, onde $\tilde{Y} = A^{-1}Y$ [^4.5.2]. A matriz de covari√¢ncia dessas vari√°veis transformadas √© diagonal e dada por $D$ [^4.5.4], o que significa que as vari√°veis em $\tilde{Y}$ s√£o n√£o correlacionadas entre si [^4.5.5]. As vari√°veis originais podem ser recuperadas da rela√ß√£o $Y = A\tilde{Y}$ [^4.5.6], que pode ser expandida como:

$$
\begin{bmatrix}
  Y_1 \\
  Y_2 \\
  Y_3 \\
  \vdots \\
  Y_n
\end{bmatrix}
=
\begin{bmatrix}
  1 & 0 & 0 & \cdots & 0 \\
  \Omega_{21}\Omega_{11}^{-1} & 1 & 0 & \cdots & 0 \\
  \Omega_{31}\Omega_{11}^{-1} & h_{32}h_{22}^{-1} & 1 & \cdots & 0 \\
  \vdots & \vdots & \vdots & \ddots & \vdots \\
  \Omega_{n1}\Omega_{11}^{-1} & \Omega_{n2}h_{22}^{-1} & \Omega_{n3}h_{33}^{-1} & \cdots & 1 \\
\end{bmatrix}
\begin{bmatrix}
  \tilde{Y}_1 \\
  \tilde{Y}_2 \\
  \tilde{Y}_3 \\
  \vdots \\
  \tilde{Y}_n
\end{bmatrix}
$$
[^4.5.7]
A primeira linha desta equa√ß√£o mostra que $Y_1 = \tilde{Y}_1$, ou seja, o primeiro elemento dos vetores $Y$ e $\tilde{Y}$ s√£o iguais. A segunda linha, $Y_2 = \Omega_{21}\Omega_{11}^{-1} \tilde{Y}_1 + \tilde{Y}_2$, mostra que $\tilde{Y}_2$ √© o res√≠duo ap√≥s projetar $Y_2$ em $Y_1$. Em geral, o i-√©simo elemento $\tilde{Y}_i$ de $\tilde{Y}$ representa o res√≠duo ap√≥s projetar $Y_i$ nas vari√°veis anteriores $Y_1, Y_2, \ldots, Y_{i-1}$.
> üí° **Exemplo Num√©rico:** Usando os valores de covari√¢ncia anteriores, a matriz A para os tr√™s primeiros elementos seria:
> $$A = \begin{bmatrix}
>   1 & 0 & 0  \\
>   \frac{1}{4} & 1 & 0 \\
>   \frac{2}{4} & \frac{0.375}{1.75} & 1 \\
> \end{bmatrix} = \begin{bmatrix}
>   1 & 0 & 0  \\
>   0.25 & 1 & 0 \\
>   0.5 & 0.214 & 1 \\
> \end{bmatrix}$$
> Assim, podemos expressar $Y$ em fun√ß√£o de $\tilde{Y}$:
> $$
> \begin{bmatrix}
>   Y_1 \\
>   Y_2 \\
>   Y_3 \\
> \end{bmatrix}
> =
> \begin{bmatrix}
>   1 & 0 & 0  \\
>   0.25 & 1 & 0 \\
>   0.5 & 0.214 & 1 \\
> \end{bmatrix}
> \begin{bmatrix}
>   \tilde{Y}_1 \\
>   \tilde{Y}_2 \\
>   \tilde{Y}_3 \\
> \end{bmatrix}
> $$
> Note que se substituirmos os valores de $\tilde{Y}$ por $Y_1$, $Y_2 - P(Y_2|Y_1)$, e $Y_3 - P(Y_3|Y_1,Y_2)$ iremos obter $Y_1$, $Y_2$ e $Y_3$ respectivamente.

Al√©m disso, a vari√¢ncia de $\tilde{Y}_i$ √© fornecida pelo i-√©simo elemento diagonal de $D$, que tamb√©m pode ser encontrado como $d_{ii} = E[\tilde{Y}_i]^2$. Os elementos da matriz $A$ (a parte triangular inferior da decomposi√ß√£o de Cholesky de $\Omega$) permitem inferir os coeficientes das proje√ß√µes lineares [^4.4.11].

**Lema 1.1:** *A express√£o $Y_i - P(Y_i|Y_1, ..., Y_{i-1})$ √© equivalente a $\tilde{Y}_i$.*
*Demonstra√ß√£o:* Pela representa√ß√£o de $Y$ em fun√ß√£o de $\tilde{Y}$ e pela defini√ß√£o de $\tilde{Y}_i$ como o res√≠duo ap√≥s projetar $Y_i$ nas vari√°veis anteriores $Y_1, \dots, Y_{i-1}$, temos que $\tilde{Y}_i = Y_i - P(Y_i | Y_1, \ldots, Y_{i-1})$.

A f√≥rmula geral para atualizar uma proje√ß√£o linear, que √© derivada a partir da fatora√ß√£o triangular [^4.5.16], √© dada por:
$$
P(Y_3|Y_2,Y_1) = P(Y_3|Y_1) + \frac{E\{[Y_3 - P(Y_3|Y_1)][Y_2 - P(Y_2|Y_1)]\}}{E[Y_2 - P(Y_2|Y_1)]^2} [Y_2 - P(Y_2|Y_1)]
$$
> üí° **Exemplo Num√©rico:**  Usando os valores do exemplo anterior temos:
> $$P(Y_3|Y_2,Y_1) = 1.5 + \frac{0.375}{1.75} [Y_2 - 0.75] = 1.5 + 0.214[Y_2 - 0.75]$$
> Se $Y_2 = 1$, temos $P(Y_3|Y_2,Y_1) = 1.5 + 0.214 * 0.25 = 1.553$

**Teorema 1:** *A atualiza√ß√£o da proje√ß√£o linear pode ser expressa de forma geral como:*
$$P(Y_i | Y_1, \ldots, Y_{i-1}) = \sum_{k=1}^{i-1} a_{ik} \tilde{Y}_k$$
*onde $a_{ik}$ s√£o os elementos da matriz A na fatora√ß√£o triangular $\Omega = ADA'$ e $\tilde{Y}_k$ s√£o os res√≠duos das proje√ß√µes lineares.*
*Demonstra√ß√£o:*
I. Da rela√ß√£o $Y=A\tilde{Y}$ e expandindo a linha $i$, temos que:
   $$Y_i = \sum_{k=1}^{i} a_{ik}\tilde{Y}_k$$
II. Podemos separar o √∫ltimo termo da soma:
$$Y_i = \sum_{k=1}^{i-1} a_{ik}\tilde{Y}_k + a_{ii}\tilde{Y}_i$$
III. Como $A$ √© uma matriz triangular inferior com diagonal unit√°ria, $a_{ii}=1$. Assim,
$$Y_i = \sum_{k=1}^{i-1} a_{ik}\tilde{Y}_k + \tilde{Y}_i$$
IV. Pelo Lema 1.1, sabemos que $\tilde{Y}_i = Y_i - P(Y_i|Y_1,\ldots,Y_{i-1})$. Substituindo isso na equa√ß√£o acima, temos:
$$Y_i = \sum_{k=1}^{i-1} a_{ik}\tilde{Y}_k + Y_i - P(Y_i|Y_1,\ldots,Y_{i-1})$$
V. Rearranjando, obtemos:
$$P(Y_i|Y_1,\ldots,Y_{i-1}) = \sum_{k=1}^{i-1} a_{ik}\tilde{Y}_k$$
Assim, provamos que $P(Y_i | Y_1, \ldots, Y_{i-1}) = \sum_{k=1}^{i-1} a_{ik} \tilde{Y}_k$. ‚ñ†
> üí° **Exemplo Num√©rico:** Para $i=3$, temos:
> $$P(Y_3|Y_1, Y_2) = a_{31}\tilde{Y}_1 + a_{32}\tilde{Y}_2$$
> Usando os valores de $A$ encontrados antes:
> $$P(Y_3|Y_1, Y_2) = 0.5\tilde{Y}_1 + 0.214\tilde{Y}_2$$
> Como sabemos que $\tilde{Y}_1 = Y_1$ e $\tilde{Y}_2 = Y_2 - P(Y_2|Y_1)$, podemos substituir:
> $$P(Y_3|Y_1, Y_2) = 0.5Y_1 + 0.214(Y_2 - 0.25Y_1) = 0.4465Y_1 + 0.214Y_2$$
> Ou seja, a proje√ß√£o de $Y_3$ sobre $Y_1$ e $Y_2$ √© uma combina√ß√£o linear de $Y_1$ e $Y_2$ com coeficientes 0.4465 e 0.214 respectivamente.

### Conclus√£o
Este cap√≠tulo mostrou como a fatora√ß√£o triangular da matriz de momentos fornece um mecanismo elegante para atualizar proje√ß√µes lineares de maneira eficiente e precisa. Ao expressar os dados em termos de vari√°veis transformadas que s√£o n√£o correlacionadas, facilita a atualiza√ß√£o das proje√ß√µes iniciais ao incorporar novas informa√ß√µes de maneira ideal. Isso √© especialmente √∫til em cen√°rios de s√©ries temporais onde novas observa√ß√µes est√£o continuamente chegando. Como veremos mais tarde, este m√©todo forma a base para t√©cnicas de filtragem recursiva, como o filtro de Kalman, que s√£o usados para muitas aplica√ß√µes no tratamento de s√©ries temporais. A capacidade de realizar essas atualiza√ß√µes de forma eficiente √© essencial para muitas tarefas de an√°lise de s√©ries temporais.

### Refer√™ncias
[^4.1.10]:  *Se√ß√£o 4.1, p√°gina 73*
[^4.4.1]:  *Se√ß√£o 4.4, p√°gina 87*
[^4.5.2]:  *Se√ß√£o 4.5, p√°gina 92*
[^4.5.4]:  *Se√ß√£o 4.5, p√°gina 92*
[^4.5.5]:  *Se√ß√£o 4.5, p√°gina 92*
[^4.5.6]:  *Se√ß√£o 4.5, p√°gina 92*
[^4.5.7]:  *Se√ß√£o 4.5, p√°gina 93*
[^4.4.11]: *Se√ß√£o 4.4, p√°gina 89*
[^4.5.12]: *Se√ß√£o 4.5, p√°gina 93*
[^4.5.14]: *Se√ß√£o 4.5, p√°gina 94*
[^4.5.16]: *Se√ß√£o 4.5, p√°gina 94*
<!-- END -->
