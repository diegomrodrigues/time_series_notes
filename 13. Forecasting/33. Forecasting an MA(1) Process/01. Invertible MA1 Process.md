## Forecasts Baseadas em uma Representa√ß√£o Autorregressiva Infinita de um MA(1) Invert√≠vel
### Introdu√ß√£o
Este cap√≠tulo dedica-se √† an√°lise detalhada das previs√µes de s√©ries temporais. Anteriormente, exploramos a otimalidade das previs√µes atrav√©s da expectativa condicional e da proje√ß√£o linear [^1]. Agora, vamos explorar a rela√ß√£o entre a representa√ß√£o de m√©dias m√≥veis (MA) e as representa√ß√µes autorregressivas (AR), com foco espec√≠fico em como um processo MA(1) invert√≠vel pode ser expresso de forma autorregressiva e como essa representa√ß√£o influencia as previs√µes. Em particular, vamos analisar a obten√ß√£o das previs√µes utilizando essa representa√ß√£o para um processo MA(1) invert√≠vel.

### Conceitos Fundamentais
Como vimos na se√ß√£o anterior, para um processo MA(1), a representa√ß√£o geral √© dada por
$$Y_t = \mu + \varepsilon_t + \theta\varepsilon_{t-1},$$ [^4]
onde $\varepsilon_t$ √© ru√≠do branco e $\theta$ √© um par√¢metro que define a correla√ß√£o entre $\varepsilon_t$ e $\varepsilon_{t-1}$. Quando $|\theta| < 1$, o processo MA(1) √© considerado *invert√≠vel*, o que implica que ele pode ser expresso como um processo autorregressivo de ordem infinita, conforme apresentado na se√ß√£o anterior [^4].

> üí° **Exemplo Num√©rico:**
>
> Suponha que temos um processo MA(1) com $\mu = 10$ e $\theta = 0.5$. A equa√ß√£o do processo √© ent√£o:
> $$Y_t = 10 + \varepsilon_t + 0.5\varepsilon_{t-1}$$
> Onde $\varepsilon_t$ representa o ru√≠do branco em cada instante de tempo.

Para um processo MA(1) invert√≠vel, ou seja, com $|\theta|<1$, podemos reescrever a equa√ß√£o anterior de forma que $\varepsilon_t$ seja expresso em termos dos valores passados de $Y_t$:
$$\varepsilon_t = (Y_t - \mu) - \theta\varepsilon_{t-1}.$$ [^4]
Esta equa√ß√£o recursiva √© fundamental. Podemos substituir $\varepsilon_{t-1}$ iterativamente em fun√ß√£o de valores de $Y$ passados, conforme segue:
$$\varepsilon_t = (Y_t - \mu) - \theta(Y_{t-1} - \mu) + \theta^2(Y_{t-2} - \mu) - \theta^3(Y_{t-3} - \mu) + \ldots.$$ [^4]
Este √© um processo AR de ordem infinita que representa a estrutura temporal de um processo MA(1) invert√≠vel. Esta representa√ß√£o √© importante pois permite expressar a previs√£o de $Y_t$ como uma combina√ß√£o linear dos seus valores passados, o que √© pr√°tico quando se tem acesso a um hist√≥rico de dados, mas n√£o se tem acesso aos choques $\epsilon_t$.

**Observa√ß√£o 1:** A representa√ß√£o autorregressiva infinita do processo MA(1) invert√≠vel, expressa por
$$\varepsilon_t = (Y_t - \mu) - \theta(Y_{t-1} - \mu) + \theta^2(Y_{t-2} - \mu) - \theta^3(Y_{t-3} - \mu) + \ldots,$$
pode ser escrita de forma mais compacta utilizando a nota√ß√£o de somat√≥rio:
$$\varepsilon_t = \sum_{j=0}^{\infty} (-\theta)^j (Y_{t-j}-\mu).$$
Esta forma compacta facilita a manipula√ß√£o e an√°lise da representa√ß√£o autorregressiva. Al√©m disso, esta express√£o tamb√©m revela a rela√ß√£o entre os coeficientes da representa√ß√£o AR infinita e o par√¢metro $\theta$ do MA(1).

Utilizando essa representa√ß√£o para o processo MA(1) invert√≠vel, e com a representa√ß√£o geral da previs√£o linear dada na se√ß√£o anterior [^4]
$$\hat{Y}_{t+s|t} = \mu + \sum_{j=s}^{\infty} \psi_j \epsilon_{t+s-j},$$
 podemos derivar a previs√£o de um per√≠odo √† frente ($s=1$) para o processo MA(1) invert√≠vel da seguinte forma
$$\hat{Y}_{t+1|t} = \mu + \theta\varepsilon_t.$$ [^4]
Substituindo a express√£o para $\varepsilon_t$ obtida anteriormente na equa√ß√£o acima
$$\hat{Y}_{t+1|t} = \mu + \theta(Y_t - \mu) - \theta^2(Y_{t-1} - \mu) + \theta^3(Y_{t-2} - \mu) - \ldots$$ [^4]
ou seja, a previs√£o √© expressa como fun√ß√£o dos valores passados da s√©rie temporal $Y_t$.
A previs√£o para $s>1$ √© simplesmente $\mu$, pois $\mathbb{E}(\varepsilon_{t+s}|Y_t, Y_{t-1}, ...)=0$ para $s>0$.

> üí° **Exemplo Num√©rico:**
>
> Continuando o exemplo anterior com $\mu = 10$ e $\theta = 0.5$, se tivermos os valores de $Y_t$ como $Y_t = 12$, $Y_{t-1} = 11$, $Y_{t-2} = 9$, e assim por diante, a previs√£o de um passo √† frente $\hat{Y}_{t+1|t}$ seria:
> $$\hat{Y}_{t+1|t} = 10 + 0.5(12 - 10) - 0.5^2(11 - 10) + 0.5^3(9 - 10) - \ldots$$
> $$\hat{Y}_{t+1|t} = 10 + 0.5(2) - 0.25(1) + 0.125(-1) - \ldots$$
> $$\hat{Y}_{t+1|t} = 10 + 1 - 0.25 - 0.125 - \ldots$$
>
> Note que esta soma se torna cada vez menor, pois $\theta$ √© menor que 1. A aproxima√ß√£o da previs√£o depende de quantos termos consideramos.

√â importante notar que a express√£o para a previs√£o do processo MA(1) invert√≠vel que obtivemos √© id√™ntica √† express√£o obtida por meio da aplica√ß√£o da f√≥rmula de Wiener-Kolmogorov, quando consideramos a representa√ß√£o como uma m√©dia m√≥vel [^4]:
$$\hat{Y}_{t+1|t} = \mu + \frac{\theta}{1+\theta L}(Y_t-\mu).$$ [^4]
Desenvolvendo a express√£o acima, obtemos a mesma previs√£o recursiva:
$$\hat{Y}_{t+1|t} = \mu + \theta(Y_t - \mu) - \theta^2(Y_{t-1} - \mu) + \theta^3(Y_{t-2} - \mu) - \ldots$$ [^4]

Essa equival√™ncia entre as abordagens (autorregressiva e m√©dias m√≥veis) para previs√µes sublinha a import√¢ncia de compreender os diferentes aspectos das s√©ries temporais. Em particular, a capacidade de representar um MA(1) invert√≠vel como uma representa√ß√£o AR de ordem infinita, nos permite utilizar uma formula√ß√£o em termos de valores passados da s√©rie temporal para fazer previs√µes.

**Lema 1.**  A express√£o da previs√£o $\hat{Y}_{t+1|t}$ pode ser escrita de forma recursiva.

**Prova:**
I.  Come√ßamos com a express√£o da previs√£o de um passo √† frente:
    $$\hat{Y}_{t+1|t} = \mu + \theta(Y_t - \mu) - \theta^2(Y_{t-1} - \mu) + \theta^3(Y_{t-2} - \mu) - \ldots$$
    
II.  Reorganizamos a express√£o, fatorando $\theta$ do segundo termo em diante:
    $$\hat{Y}_{t+1|t} = \mu + \theta(Y_t - \mu) + \theta(-\theta(Y_{t-1} - \mu) + \theta^2(Y_{t-2} - \mu) - \ldots)$$

III.  Reconhecemos que a parte entre par√™nteses, multiplicada por $\theta$, se assemelha √† previs√£o $\hat{Y}_{t|t-1}$ exceto pelo termo $\mu$:
  $$ -\theta(Y_{t-1} - \mu) + \theta^2(Y_{t-2} - \mu) - \ldots = \hat{Y}_{t|t-1} - \mu $$
    
IV. Substituindo essa igualdade na express√£o original:
     $$\hat{Y}_{t+1|t} = \mu + \theta (Y_t - \mu) + \theta (\hat{Y}_{t|t-1} - \mu)$$
V.  Simplificando, obtemos a forma recursiva:
    $$\hat{Y}_{t+1|t} = \mu + \theta (Y_t - \mu) - \theta(\hat{Y}_{t|t-1} - \mu)$$
  $$\hat{Y}_{t+1|t} = \mu + \theta (Y_t - \hat{Y}_{t|t-1})$$
    
Esta express√£o mostra que a previs√£o para o pr√≥ximo per√≠odo √© igual √† m√©dia do processo, mais um termo proporcional √† diferen√ßa entre o valor observado em $t$ e a previs√£o feita em $t-1$. Esta forma recursiva √© computacionalmente mais eficiente do que a forma infinita. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> Vamos usar o mesmo exemplo com $\mu = 10$ e $\theta = 0.5$. Suponha que $Y_t = 12$ e a previs√£o anterior $\hat{Y}_{t|t-1} = 11.5$. Usando a forma recursiva:
> $$\hat{Y}_{t+1|t} = 10 + 0.5 (12 - 11.5)$$
> $$\hat{Y}_{t+1|t} = 10 + 0.5(0.5)$$
> $$\hat{Y}_{t+1|t} = 10 + 0.25$$
> $$\hat{Y}_{t+1|t} = 10.25$$
>
> Assim, a previs√£o para o pr√≥ximo per√≠odo √© 10.25. Esta abordagem recursiva √© mais f√°cil de calcular do que a vers√£o de soma infinita.

**Corol√°rio 1.1** A representa√ß√£o recursiva do Lema 1 pode ser usada para calcular previs√µes de forma iterativa.

**Prova:**
I.  Come√ßamos com a representa√ß√£o recursiva da previs√£o:
    $$\hat{Y}_{t+1|t} = \mu + \theta (Y_t - \hat{Y}_{t|t-1})$$

II. Para iniciar o processo iterativo, precisamos de uma previs√£o inicial. Assumimos que $\hat{Y}_{1|0} = \mu$, ou seja, a previs√£o do primeiro valor √© a m√©dia do processo.

III. Dado $Y_1$, calculamos a previs√£o para $t=2$ usando a f√≥rmula recursiva:
    $$\hat{Y}_{2|1} = \mu + \theta (Y_1 - \hat{Y}_{1|0}) = \mu + \theta (Y_1 - \mu)$$

IV. Em geral, dado $Y_t$ e a previs√£o anterior $\hat{Y}_{t|t-1}$, podemos calcular $\hat{Y}_{t+1|t}$ da seguinte forma:
    $$\hat{Y}_{t+1|t} = \mu + \theta (Y_t - \hat{Y}_{t|t-1})$$
    
V.  Este processo pode ser repetido recursivamente para qualquer $t$, ou seja, podemos calcular $\hat{Y}_{3|2}$ dado $Y_2$, $\hat{Y}_{4|3}$ dado $Y_3$, e assim por diante.

Este procedimento demonstra que a representa√ß√£o recursiva elimina a necessidade de utilizar toda a hist√≥ria passada da s√©rie, tornando o processo de c√°lculo de previs√µes mais eficiente. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> Continuando com $\mu = 10$ e $\theta = 0.5$, e supondo que observamos a seguinte s√©rie temporal: $Y_1 = 11, Y_2 = 12, Y_3 = 10.5, Y_4 = 11.8$. Vamos calcular as previs√µes iterativamente:
>
> *   Inicializa√ß√£o: $\hat{Y}_{1|0} = 10$
> *   $t=1$: $\hat{Y}_{2|1} = 10 + 0.5 (11 - 10) = 10.5$
> *   $t=2$: $\hat{Y}_{3|2} = 10 + 0.5 (12 - 10.5) = 10.75$
> *   $t=3$: $\hat{Y}_{4|3} = 10 + 0.5 (10.5 - 10.75) = 9.875$
> *   $t=4$: $\hat{Y}_{5|4} = 10 + 0.5 (11.8 - 9.875) = 10.9625$
>
> Este exemplo mostra como a previs√£o de cada passo depende do valor observado e da previs√£o anterior, usando a formula√ß√£o recursiva.

### Conclus√£o
Nesta se√ß√£o, exploramos a rela√ß√£o entre as representa√ß√µes de m√©dias m√≥veis (MA) e autorregressivas (AR), especificamente para um processo MA(1) invert√≠vel. Demonstramos como um processo MA(1) invert√≠vel pode ser expresso como um processo autorregressivo de ordem infinita e como essa representa√ß√£o afeta as previs√µes. A equival√™ncia das abordagens, tanto na representa√ß√£o MA como na representa√ß√£o AR para o c√°lculo da previs√£o, demonstram a consist√™ncia da teoria. A representa√ß√£o autorregressiva permite obter as previs√µes do processo MA(1) invert√≠vel utilizando uma formula√ß√£o recursiva em fun√ß√£o dos valores passados da s√©rie temporal. Esta abordagem √© √∫til quando se pretende calcular previs√µes e se tem acesso a dados passados, mas n√£o se tem acesso aos choques $\epsilon_t$.

### Refer√™ncias
[^1]: Express√£o [4.1.1], [4.1.2], [4.1.9]
[^4]: Se√ß√£o 4.2, [4.2.10], [4.2.28], [4.2.29], [4.2.30], [4.2.16]
<!-- END -->
