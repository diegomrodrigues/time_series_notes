## Previs√µes de Longo Prazo em Processos MA(1) e a Converg√™ncia para a M√©dia

### Introdu√ß√£o
Neste cap√≠tulo, expandimos nossa discuss√£o sobre previs√£o de s√©ries temporais, com foco espec√≠fico no comportamento das previs√µes em processos de m√©dias m√≥veis de primeira ordem, MA(1), quando o horizonte de tempo da previs√£o se estende para al√©m de um passo √† frente. Nos cap√≠tulos anteriores, exploramos a otimalidade das previs√µes [^1] e o c√°lculo eficiente de previs√µes de um passo √† frente [^4] para processos MA(1) utilizando representa√ß√µes autorregressivas e recursivas. Agora, vamos investigar a natureza das previs√µes de longo prazo, mostrando como elas convergem para a m√©dia incondicional do processo, e como essa converg√™ncia se manifesta em modelos MA(1). Al√©m disso, exploraremos as implica√ß√µes desse comportamento para a previs√£o em diferentes horizontes temporais.

### Conceitos Fundamentais
Um processo MA(1) √© definido como:
$$Y_t = \mu + \varepsilon_t + \theta\varepsilon_{t-1},$$ [^4]
onde $\mu$ √© a m√©dia do processo, $\varepsilon_t$ representa ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$, e $\theta$ √© o par√¢metro que define a correla√ß√£o entre $\varepsilon_t$ e $\varepsilon_{t-1}$.

Como vimos anteriormente, para um processo MA(1) invert√≠vel, ou seja, com $|\theta| < 1$, podemos expressar o ru√≠do branco $\varepsilon_t$ atrav√©s da representa√ß√£o autorregressiva de ordem infinita [^4]:
$$\varepsilon_t = (Y_t - \mu) - \theta(Y_{t-1} - \mu) + \theta^2(Y_{t-2} - \mu) - \theta^3(Y_{t-3} - \mu) + \ldots$$
ou, de forma recursiva:
$$\varepsilon_t = (Y_t - \mu) - \theta\varepsilon_{t-1}.$$ [^4]

A previs√£o de um passo √† frente para um processo MA(1) √© dada por:
$$\hat{Y}_{t+1|t} = \mu + \theta\varepsilon_t,$$ [^4]
que, utilizando a forma recursiva do ru√≠do branco, pode ser expressa como:
$$\hat{Y}_{t+1|t} = \mu + \theta(Y_t - \hat{Y}_{t|t-1}).$$ [^4]

Agora, vamos considerar a previs√£o para um horizonte de tempo maior que um passo √† frente, isto √©, com $s > 1$. Em geral, a previs√£o de *s* passos √† frente no tempo *t* √© dada por:
$$\hat{Y}_{t+s|t} = E[Y_{t+s} | Y_t, Y_{t-1}, \ldots],$$
onde $E[\cdot | Y_t, Y_{t-1}, \ldots]$ denota o valor esperado condicional no conjunto de informa√ß√µes at√© o tempo $t$.

**Lema 3**. Para um processo MA(1), a previs√£o de $s$ passos √† frente, com $s>1$, converge para a m√©dia incondicional do processo, $\mu$.

*Prova:*
 Partimos da defini√ß√£o do processo MA(1):
 $$Y_{t+s} = \mu + \varepsilon_{t+s} + \theta\varepsilon_{t+s-1}.$$
 I. Para obter a previs√£o $s$ passos √† frente, calculamos o valor esperado condicional:
 $$ \hat{Y}_{t+s|t} = E[Y_{t+s}|Y_t, Y_{t-1}, \dots] = E[\mu + \varepsilon_{t+s} + \theta\varepsilon_{t+s-1} | Y_t, Y_{t-1}, \dots].$$
 II. Dado que os ru√≠dos $\varepsilon_{t+s}$ e $\varepsilon_{t+s-1}$ s√£o n√£o correlacionados com as informa√ß√µes at√© o tempo $t$ para $s>1$, temos que
$$ E[\varepsilon_{t+s} | Y_t, Y_{t-1}, \dots] = 0 $$
e
$$ E[\varepsilon_{t+s-1} | Y_t, Y_{t-1}, \dots] = 0. $$
III. Assim, a previs√£o $s$ passos √† frente, com $s > 1$, torna-se:
$$\hat{Y}_{t+s|t} = E[\mu | Y_t, Y_{t-1}, \dots] + E[\varepsilon_{t+s}|Y_t, Y_{t-1}, \dots] + \theta E[\varepsilon_{t+s-1} | Y_t, Y_{t-1}, \dots] = \mu + 0 + \theta(0) = \mu.$$
Portanto, a previs√£o de $s$ passos √† frente para um processo MA(1) com $s > 1$ √© igual √† m√©dia do processo, $\mu$. ‚ñ†

Este resultado demonstra que, em processos MA(1), a informa√ß√£o dos valores passados da s√©rie temporal torna-se irrelevante para previs√µes de longo prazo, pois o valor esperado de $Y_{t+s}$ dado o hist√≥rico da s√©rie temporal at√© $t$ converge para a m√©dia incondicional, $\mu$.

> üí° **Exemplo Num√©rico:**
>
> Suponha que temos um processo MA(1) com m√©dia $\mu = 50$, par√¢metro $\theta = 0.6$, e vari√¢ncia do ru√≠do $\sigma^2 = 4$. Vamos demonstrar a converg√™ncia da previs√£o para a m√©dia do processo.
>
> 1.  **Definindo os Par√¢metros:**
>     *   $\mu = 50$
>     *   $\theta = 0.6$
>     *   $\sigma^2 = 4$
> 2.  **Simulando um Processo MA(1):**
>     Para ilustrar, simularemos alguns valores de um processo MA(1) usando ru√≠do branco. Assumiremos que $\varepsilon_0 = 0$.
>     ```python
>     import numpy as np
>     import matplotlib.pyplot as plt
>
>     np.random.seed(42)  # Para reprodutibilidade
>     mu = 50
>     theta = 0.6
>     sigma = np.sqrt(4)
>     n = 20 # N√∫mero de pontos na s√©rie temporal
>
>     epsilon = np.random.normal(0, sigma, n)
>     Y = np.zeros(n)
>
>     Y[0] = mu + epsilon[0]
>     for t in range(1, n):
>         Y[t] = mu + epsilon[t] + theta * epsilon[t-1]
>
>     plt.plot(Y, label = 'S√©rie MA(1) simulada')
>     plt.axhline(y=mu, color='r', linestyle='--', label = 'M√©dia do processo')
>     plt.xlabel('Tempo (t)')
>     plt.ylabel('Valor Y(t)')
>     plt.title('Simula√ß√£o de um Processo MA(1)')
>     plt.legend()
>     plt.show()
>     ```
>
> 3.  **Previs√£o de Um Passo √† Frente:**
>     Se no tempo *t*, tivermos $Y_t = 52$ e $\hat{Y}_{t|t-1} = 51$, ent√£o a previs√£o de um passo √† frente seria:
>     $$\hat{Y}_{t+1|t} = \mu + \theta(Y_t - \hat{Y}_{t|t-1}) = 50 + 0.6(52 - 51) = 50 + 0.6(1) = 50.6.$$
>
> 4. **Previs√£o de Dois Passos √† Frente:**
> A previs√£o de dois passos √† frente √© simplesmente a m√©dia do processo:
>     $$\hat{Y}_{t+2|t} = \mu = 50.$$
> 5. **Previs√£o de Tr√™s Passos √† Frente:**
> Similarmente, para tr√™s passos √† frente, a previs√£o √© tamb√©m a m√©dia do processo:
>     $$\hat{Y}_{t+3|t} = \mu = 50.$$
>
>
>   Este exemplo demonstra que a previs√£o de um passo √† frente √© influenciada pelo valor da s√©rie no instante $t$ ($Y_t$), enquanto que as previs√µes para horizontes maiores que um passo convergem para a m√©dia incondicional do processo ($\mu = 50$).

**Corol√°rio 3.1.** A converg√™ncia da previs√£o para a m√©dia incondicional em processos MA(1) para horizontes maiores que um passo √† frente indica uma perda progressiva de informa√ß√£o sobre o processo ao longo do tempo.
*Prova:*
I. A previs√£o para um passo √† frente em um processo MA(1) √© dada por $\hat{Y}_{t+1|t} = \mu + \theta(Y_t - \hat{Y}_{t|t-1})$. Esta previs√£o utiliza tanto o valor m√©dio do processo $\mu$ quanto informa√ß√µes espec√≠ficas sobre o comportamento da s√©rie em $t$.
II. Por outro lado, a previs√£o para um horizonte $s>1$ √© dada por $\hat{Y}_{t+s|t}=\mu$.
III. Ao comparar as duas express√µes, notamos que a previs√£o de longo prazo ($\hat{Y}_{t+s|t}$) n√£o utiliza nenhuma informa√ß√£o espec√≠fica sobre o passado da s√©rie temporal, dependendo apenas da m√©dia do processo $\mu$, o que significa que, √† medida que aumentamos o horizonte de previs√£o, a informa√ß√£o contida nos valores observados se torna menos relevante para a previs√£o, ou seja, perde-se poder preditivo.
IV. Essa perda de poder preditivo implica que, para previs√µes de longo prazo, os resultados n√£o se distanciam muito do valor m√©dio do processo.‚ñ†

> üí° **Exemplo Num√©rico (Corol√°rio 3.1):**
>
> Vamos considerar o mesmo processo MA(1) do exemplo anterior, com $\mu = 50$ e $\theta = 0.6$. Imagine que, no instante $t$, temos:
>
> *   $Y_t = 53$
> *   $\hat{Y}_{t|t-1} = 51$
>
> 1.  **Previs√£o de Um Passo √† Frente:**
>     $$\hat{Y}_{t+1|t} = 50 + 0.6(53 - 51) = 50 + 0.6(2) = 51.2$$
>     Observe que a previs√£o incorpora informa√ß√µes sobre o valor corrente e a previs√£o anterior.
>
> 2.  **Previs√£o de Dois Passos √† Frente:**
>     $$\hat{Y}_{t+2|t} = 50$$
>     A previs√£o agora √© simplesmente a m√©dia do processo, ignorando os valores passados da s√©rie.
>
> 3.  **Interpreta√ß√£o:**
>     A previs√£o de um passo √† frente (51.2) est√° mais pr√≥xima do valor observado $Y_t=53$, mostrando que ainda h√° algum poder preditivo no curto prazo, ao contr√°rio da previs√£o de dois passos √† frente que se iguala √† m√©dia, perdendo a capacidade de capturar as particularidades da s√©rie no momento *t*.
>
> 4. **Visualiza√ß√£o da perda de informa√ß√£o:**
>
> ```mermaid
> graph LR
>     A[Informa√ß√µes Passadas da S√©rie Temporal Yt, Yt-1, ...] --> B{Previs√£o de 1 passo};
>     B --> C[Previs√£o Yt+1|t];
>     A --> D{Previs√£o de 2 passos};
>     D --> E[Previs√£o Yt+2|t = Œº];
>     style E fill:#f9f,stroke:#333,stroke-width:2px
>     style C fill:#ccf,stroke:#333,stroke-width:2px
>     C --> F[Informa√ß√µes s√£o utilizadas];
>     E --> G[Informa√ß√µes s√£o ignoradas];
> ```
>
> Este exemplo demonstra que a capacidade de prever a s√©rie diminui com o aumento do horizonte de previs√£o, convergindo para a m√©dia do processo.

**Observa√ß√£o 3.1.** √â importante notar que a converg√™ncia para a m√©dia incondicional, $\mu$, n√£o implica que a vari√¢ncia da previs√£o de longo prazo seja nula. A vari√¢ncia da previs√£o, $Var(\hat{Y}_{t+s|t})$, √© um indicador da incerteza em torno da previs√£o. Embora a previs√£o em si convirja para $\mu$, a incerteza associada a essa previs√£o pode ser substancial, dependendo da vari√¢ncia do ru√≠do branco, $\sigma^2$, e do par√¢metro $\theta$. Para horizontes $s>1$, a vari√¢ncia da previs√£o √© igual √† vari√¢ncia do processo, o que ser√° demonstrado posteriormente.

### Implica√ß√µes Pr√°ticas
A converg√™ncia da previs√£o para a m√©dia incondicional do processo em horizontes de previs√£o maiores que um passo √† frente tem v√°rias implica√ß√µes pr√°ticas:

1.  **Limita√ß√£o da Previsibilidade:** Processos MA(1) s√£o mais previs√≠veis no curto prazo. Para horizontes de previs√£o longos, a previs√£o tende a se tornar um valor constante, a m√©dia do processo, o que limita o benef√≠cio da modelagem da s√©rie temporal para esses horizontes.

2.  **Import√¢ncia do Modelo para o Curto Prazo:** Modelos MA(1) s√£o √∫teis para capturar as depend√™ncias temporais de curto prazo nas s√©ries temporais. Se o objetivo √© realizar previs√µes de longo prazo, outros modelos com uma melhor capacidade de modelar as depend√™ncias de longo prazo podem ser mais adequados.

3. **Avalia√ß√£o da Qualidade da Previs√£o:** A converg√™ncia para a m√©dia incondicional para horizontes $s>1$ implica que n√£o h√° necessidade de avaliar as previs√µes em diferentes horizontes, j√° que todos convergem para o mesmo valor.

**Teorema 3.1** A vari√¢ncia da previs√£o $s$-passos √† frente, $Var(\hat{Y}_{t+s|t})$, para um processo MA(1) com $s > 1$, √© igual √† vari√¢ncia do processo, $Var(Y_t) = (1 + \theta^2)\sigma^2$.

*Prova:*

I. A previs√£o de $s$ passos √† frente para $s>1$ √© $\hat{Y}_{t+s|t} = \mu$.
II.  A vari√¢ncia da previs√£o para $s > 1$ √© $Var(\hat{Y}_{t+s|t}) = Var(\mu)$. Dado que $\mu$ √© uma constante, $Var(\mu)=0$.
III. No entanto, a vari√¢ncia do erro de previs√£o para $s>1$ √© dada por
$Var(Y_{t+s} - \hat{Y}_{t+s|t}) = Var(Y_{t+s} - \mu)$.
IV. Usando a defini√ß√£o do processo MA(1), $Y_{t+s} = \mu + \varepsilon_{t+s} + \theta \varepsilon_{t+s-1}$, temos
$Var(Y_{t+s} - \mu) = Var(\mu + \varepsilon_{t+s} + \theta \varepsilon_{t+s-1} - \mu) = Var(\varepsilon_{t+s} + \theta \varepsilon_{t+s-1})$.
V. Como $\varepsilon_{t+s}$ e $\varepsilon_{t+s-1}$ s√£o n√£o correlacionados, $Var(\varepsilon_{t+s} + \theta \varepsilon_{t+s-1}) = Var(\varepsilon_{t+s}) + \theta^2 Var(\varepsilon_{t+s-1}) = \sigma^2 + \theta^2 \sigma^2$.
VI. Portanto, $Var(Y_{t+s} - \hat{Y}_{t+s|t}) = (1 + \theta^2)\sigma^2$, que √© igual √† vari√¢ncia do processo $Y_t$, que pode ser encontrada por $Var(Y_t) = Var(\mu + \varepsilon_t + \theta \varepsilon_{t-1}) = Var(\varepsilon_t + \theta \varepsilon_{t-1}) = Var(\varepsilon_t) + \theta^2 Var(\varepsilon_{t-1}) = (1 + \theta^2)\sigma^2$.
VII. Ou seja, a vari√¢ncia do erro de previs√£o de longo prazo √© igual √† vari√¢ncia do processo. ‚ñ†

> üí° **Exemplo Num√©rico (Teorema 3.1):**
>
> Usando o mesmo processo MA(1) com $\mu=50$, $\theta=0.6$ e $\sigma^2=4$, vamos calcular a vari√¢ncia da previs√£o para $s > 1$ e comparar com a vari√¢ncia do processo.
>
> 1.  **Vari√¢ncia do Processo:**
>     $$Var(Y_t) = (1 + \theta^2)\sigma^2 = (1 + 0.6^2) \times 4 = (1 + 0.36) \times 4 = 1.36 \times 4 = 5.44$$
>
> 2.  **Vari√¢ncia da Previs√£o de Longo Prazo:**
>     Como a previs√£o de longo prazo √© $\hat{Y}_{t+s|t} = \mu$, a vari√¢ncia da previs√£o √© $Var(\mu) = 0$. No entanto, o que realmente importa √© a vari√¢ncia do erro de previs√£o, que, como demonstrado no teorema, √© igual √† vari√¢ncia do processo.
>
> 3.  **Vari√¢ncia do Erro de Previs√£o:**
>     $Var(Y_{t+s} - \hat{Y}_{t+s|t}) = Var(Y_{t+s} - \mu) = (1 + \theta^2)\sigma^2 = 5.44$.
>
> 4. **Interpreta√ß√£o:**
>    Este exemplo demonstra que, embora a previs√£o de longo prazo convirja para a m√©dia, a incerteza associada a essa previs√£o √© a mesma que a variabilidade inerente do processo, ou seja, $5.44$. Isso significa que, mesmo que a previs√£o seja igual √† m√©dia, h√° uma variabilidade em torno dela.
>
> 5. **Calculando a vari√¢ncia da s√©rie simulada:**
>
> ```python
>     variance_y = np.var(Y)
>     print(f'Vari√¢ncia da s√©rie simulada: {variance_y}')
>     print(f'Vari√¢ncia te√≥rica da s√©rie: {5.44}')
> ```
>
> Ao calcular a vari√¢ncia da s√©rie simulada no exemplo anterior, o valor obtido ser√° pr√≥ximo ao valor te√≥rico, evidenciando o resultado demonstrado no Teorema 3.1.

Este resultado complementa a ideia de que, apesar da previs√£o de longo prazo convergir para a m√©dia, a incerteza associada a essa previs√£o √© a mesma que a incerteza associada ao processo em geral, ou seja, a variabilidade inerente do processo MA(1) n√£o desaparece em previs√µes de longo prazo.

### Conclus√£o
Nesta se√ß√£o, demonstramos que, em modelos MA(1), as previs√µes para horizontes de tempo maiores que um passo √† frente convergem para a m√©dia incondicional do processo, $\mu$. Este resultado, formalizado pelo Lema 3, indica uma limita√ß√£o na previsibilidade a longo prazo para processos MA(1). O Corol√°rio 3.1 mostrou que, ao aumentar o horizonte de previs√£o, a informa√ß√£o contida nos valores passados da s√©rie temporal torna-se irrelevante para a previs√£o, perdendo o poder preditivo. A Observa√ß√£o 3.1 salientou que, embora a previs√£o convirja para a m√©dia, a incerteza da previs√£o n√£o √© nula, sendo igual √† variabilidade do pr√≥prio processo, como demonstrado pelo Teorema 3.1. A an√°lise de longo prazo em modelos MA(1) destaca a import√¢ncia de escolher modelos adequados para diferentes horizontes de previs√£o, em especial quando h√° o interesse em modelos que permitam a previs√£o em horizontes temporais mais longos.

### Refer√™ncias
[^1]: Express√£o [4.1.1], [4.1.2], [4.1.9]
[^4]: Se√ß√£o 4.2, [4.2.10], [4.2.28], [4.2.29], [4.2.30], [4.2.16], Lema 1, Corol√°rio 1.1
<!-- END -->
