## A Fatora√ß√£o Triangular de uma Matriz Sim√©trica Definida Positiva
### Introdu√ß√£o
Este cap√≠tulo do livro explora em detalhes o processo de fatora√ß√£o triangular de uma matriz sim√©trica definida positiva, um conceito fundamental na an√°lise de s√©ries temporais e em diversas √°reas da matem√°tica e da estat√≠stica. A fatora√ß√£o triangular, que expressa uma matriz $\Omega$ como o produto de uma matriz triangular inferior $A$, uma matriz diagonal $D$ e a transposta de $A$, $A'$, ou seja, $\Omega = ADA'$, √© crucial para simplificar c√°lculos complexos envolvendo matrizes. Como veremos, essa decomposi√ß√£o possibilita a resolu√ß√£o eficiente de sistemas de equa√ß√µes lineares e facilita o c√°lculo de determinantes e inversas de matrizes, al√©m de desempenhar um papel fundamental na compreens√£o das proje√ß√µes lineares [^4].

### Conceitos Fundamentais
Uma matriz sim√©trica definida positiva $\Omega$ de dimens√µes $n \times n$ possui uma representa√ß√£o √∫nica na forma $\Omega = ADA'$ [^4.4.1], onde:
  - $A$ √© uma matriz triangular inferior com elementos unit√°rios ao longo da diagonal principal.
  - $D$ √© uma matriz diagonal.

Essa representa√ß√£o, conhecida como fatora√ß√£o triangular de $\Omega$, √© essencial em muitos c√°lculos estat√≠sticos e econom√©tricos. A matriz A assume a seguinte forma:

$$
A = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
a_{21} & 1 & 0 & \cdots & 0 \\
a_{31} & a_{32} & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & a_{n3} & \cdots & 1
\end{bmatrix}
$$

E a matriz diagonal D √© dada por:

$$
D = \begin{bmatrix}
d_{11} & 0 & 0 & \cdots & 0 \\
0 & d_{22} & 0 & \cdots & 0 \\
0 & 0 & d_{33} & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & d_{nn}
\end{bmatrix}
$$
onde $d_{ii} > 0$ para todo $i$.

**Observa√ß√£o:** A positividade dos elementos diagonais de $D$, $d_{ii} > 0$, √© uma consequ√™ncia direta da propriedade de $\Omega$ ser definida positiva. Essa caracter√≠stica √© fundamental para garantir a exist√™ncia e unicidade da fatora√ß√£o triangular e tamb√©m para a exist√™ncia da fatora√ß√£o de Cholesky, como veremos mais adiante.

> üí° **Exemplo Num√©rico:** Considere uma matriz sim√©trica definida positiva 2x2:
> $$\Omega = \begin{bmatrix} 4 & 2 \\ 2 & 5 \end{bmatrix}$$
>
> Aqui,  $\Omega_{11} = 4$, $\Omega_{12} = \Omega_{21} = 2$ e $\Omega_{22} = 5$. A fatora√ß√£o triangular visa encontrar $A$ e $D$ tais que $\Omega = ADA'$.

**Procedimento para Obter a Fatora√ß√£o Triangular**

O processo para calcular a fatora√ß√£o triangular envolve transformar a matriz $\Omega$ em uma matriz com zeros abaixo da diagonal principal atrav√©s de multiplica√ß√µes e subtra√ß√µes de linhas. Inicialmente, transforma-se $\Omega$ em uma matriz $H$ com zeros na primeira coluna abaixo da diagonal principal atrav√©s de uma matriz $E_1$ [^4.4.3]:

$$
E_1 = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
-\Omega_{21}\Omega_{11}^{-1} & 1 & 0 & \cdots & 0 \\
-\Omega_{31}\Omega_{11}^{-1} & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
-\Omega_{n1}\Omega_{11}^{-1} & 0 & 0 & \cdots & 1
\end{bmatrix}
$$

A matriz $H$ √© obtida atrav√©s da seguinte opera√ß√£o: $H=E_1\Omega E_1'$ [^4.4.4], onde $E_1'$ √© a transposta de $E_1$. Este processo √© repetido para as colunas subsequentes da matriz, transformando-a em uma matriz diagonal $D$ utilizando matrizes $E_2, E_3, \ldots, E_{n-1}$ [^4.4.7].

> üí° **Exemplo Num√©rico (Continua√ß√£o):** Usando a matriz $\Omega$ do exemplo anterior, temos:
>
> $$E_1 = \begin{bmatrix} 1 & 0 \\ -\frac{2}{4} & 1 \end{bmatrix} = \begin{bmatrix} 1 & 0 \\ -0.5 & 1 \end{bmatrix}$$
>
> Calculamos $E_1'$, a transposta de $E_1$:
>
> $$E_1' = \begin{bmatrix} 1 & -0.5 \\ 0 & 1 \end{bmatrix}$$
>
> Agora, calculamos $H$:
>
> $$H = E_1 \Omega E_1' = \begin{bmatrix} 1 & 0 \\ -0.5 & 1 \end{bmatrix} \begin{bmatrix} 4 & 2 \\ 2 & 5 \end{bmatrix} \begin{bmatrix} 1 & -0.5 \\ 0 & 1 \end{bmatrix} = \begin{bmatrix} 4 & 0 \\ 0 & 4 \end{bmatrix}$$
>
> Observe que $H$ √© agora uma matriz diagonal. Neste caso espec√≠fico, $H$ √© igual a $D$.
>

Por exemplo, a matriz $E_2$ √© definida como:

$$
E_2 = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
0 & 1 & 0 & \cdots & 0 \\
0 & -h_{32}h_{22}^{-1} & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & -h_{n2}h_{22}^{-1} & 0 & \cdots & 1
\end{bmatrix}
$$
onde $h_{ij}$ s√£o os elementos da matriz $H$.

A matriz $A$ √© obtida pela inversa das matrizes $E$:

$A = (E_{n-1} \cdots E_2E_1)^{-1}$  [^4.4.8]

A matriz $A$ pode ser obtida diretamente a partir da matriz $\Omega$, notando que a $j$-√©sima coluna de $A$ corresponde √† $j$-√©sima coluna de $E_j^{-1}$ [^4.4.11], o que simplifica o processo.

**Lema 1**
A inversa de uma matriz elementar $E_k$ do tipo descrito √© obtida simplesmente trocando o sinal dos elementos fora da diagonal principal. Ou seja, se
$E_k = I - v_k e_k^T$ onde $I$ √© a matriz identidade, $e_k$ √© o k-√©simo vetor can√¥nico e $v_k$ √© um vetor com zeros at√© a k-√©sima posi√ß√£o, ent√£o $E_k^{-1} = I + v_k e_k^T$.

*Prova:* A prova √© direta pela multiplica√ß√£o de $E_k$ por $I+v_ke_k^T$.
I.  Definimos $E_k = I - v_k e_k^T$ e queremos mostrar que $E_k^{-1} = I + v_k e_k^T$.
II.  Vamos multiplicar $E_k$ por $I + v_k e_k^T$:
    $E_k (I + v_k e_k^T) = (I - v_k e_k^T)(I + v_k e_k^T) = I + v_k e_k^T - v_k e_k^T - v_k e_k^T v_k e_k^T$
III. Como $e_k^T v_k$ √© um escalar que √© igual a 0 (pois $v_k$ tem zeros nas primeiras $k-1$ posi√ß√µes e $e_k$ tem um 1 na k-√©sima posi√ß√£o e zeros no resto), temos que $v_k e_k^T v_k e_k^T= v_k (e_k^T v_k) e_k^T = v_k(0) e_k^T=0$.
IV. Portanto, $E_k (I + v_k e_k^T) = I + v_k e_k^T - v_k e_k^T = I$.
V. De forma similar, $(I + v_k e_k^T)E_k = (I + v_k e_k^T)(I - v_k e_k^T) = I - v_k e_k^T + v_k e_k^T - v_k e_k^T v_k e_k^T = I $.
VI. Como $E_k (I + v_k e_k^T) = (I + v_k e_k^T)E_k = I$, conclu√≠mos que $E_k^{-1} = I + v_k e_k^T$. ‚ñ†

> üí° **Exemplo Num√©rico (Continua√ß√£o):** Para a matriz $E_1$ do exemplo anterior, sua inversa $E_1^{-1}$ √© obtida trocando o sinal do elemento fora da diagonal:
>
> $$E_1^{-1} = \begin{bmatrix} 1 & 0 \\ 0.5 & 1 \end{bmatrix}$$
>
> Neste caso, como s√≥ tivemos $E_1$, ent√£o $A = E_1^{-1}$:
> $$A = \begin{bmatrix} 1 & 0 \\ 0.5 & 1 \end{bmatrix}$$

**Lema 1.1**
O produto das matrizes elementares inversas  $E_1^{-1}E_2^{-1}\ldots E_{n-1}^{-1}$  resulta em uma matriz triangular inferior com uns na diagonal, onde as entradas abaixo da diagonal na j-√©sima coluna correspondem a  $v_j$.

*Prova:* Este resultado segue diretamente do Lema 1. Cada matriz $E_k^{-1}$ adiciona uma coluna √† matriz inferior com os elementos $v_k$. Ao multiplicar essas matrizes, as colunas s√£o adicionadas sequencialmente, resultando na matriz $A$.

I. Do Lema 1, sabemos que $E_k^{-1} = I + v_k e_k^T$.
II. A matriz $E_1^{-1}$ √© da forma:
$$
E_1^{-1} = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
\Omega_{21}\Omega_{11}^{-1} & 1 & 0 & \cdots & 0 \\
\Omega_{31}\Omega_{11}^{-1} & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
\Omega_{n1}\Omega_{11}^{-1} & 0 & 0 & \cdots & 1
\end{bmatrix}
$$
Onde $v_1$ √© a primeira coluna abaixo da diagonal principal.
III. A matriz $E_2^{-1}$ √© da forma:
$$
E_2^{-1} = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
0 & 1 & 0 & \cdots & 0 \\
0 & h_{32}h_{22}^{-1} & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & h_{n2}h_{22}^{-1} & 0 & \cdots & 1
\end{bmatrix}
$$
Onde $v_2$ √© a segunda coluna abaixo da diagonal principal.
IV. Note que as entradas da matriz $E_k^{-1}$ s√£o os elementos $v_k$ na coluna $k$ e zeros em todas as outras entradas fora da diagonal principal.
V. Ao multiplicar $E_1^{-1}E_2^{-1}\ldots E_{n-1}^{-1}$, cada $E_k^{-1}$ adiciona sua coluna $v_k$ √† matriz resultante, sem alterar as colunas anteriores.
VI. O produto resulta em uma matriz triangular inferior com 1's na diagonal, e as entradas abaixo da diagonal na j-√©sima coluna correspondem a $v_j$. Logo, o produto $E_1^{-1}E_2^{-1}\ldots E_{n-1}^{-1}$ resulta na matriz $A$ onde a $j$-√©sima coluna de $A$ corresponde √† $j$-√©sima coluna de $E_j^{-1}$. ‚ñ†

> üí° **Exemplo Num√©rico (Continua√ß√£o):**  Neste exemplo, j√° obtivemos  $A$ e $D$:
> $$A = \begin{bmatrix} 1 & 0 \\ 0.5 & 1 \end{bmatrix}, \quad D = \begin{bmatrix} 4 & 0 \\ 0 & 4 \end{bmatrix}$$
> Vamos verificar se $\Omega = ADA'$:
> $$ADA' = \begin{bmatrix} 1 & 0 \\ 0.5 & 1 \end{bmatrix} \begin{bmatrix} 4 & 0 \\ 0 & 4 \end{bmatrix} \begin{bmatrix} 1 & 0.5 \\ 0 & 1 \end{bmatrix} = \begin{bmatrix} 4 & 0 \\ 2 & 4 \end{bmatrix} \begin{bmatrix} 1 & 0.5 \\ 0 & 1 \end{bmatrix} = \begin{bmatrix} 4 & 2 \\ 2 & 5 \end{bmatrix} = \Omega$$
> A fatora√ß√£o triangular foi verificada.

**Unicidade da Fatora√ß√£o Triangular**

A fatora√ß√£o triangular de uma matriz sim√©trica definida positiva √© √∫nica [^4.4.14]. Isto √©, se $\Omega = A_1D_1A_1' = A_2D_2A_2'$, ent√£o $A_1=A_2$ e $D_1=D_2$. Esta propriedade garante que o processo descrito anteriormente sempre produzir√° uma representa√ß√£o √∫nica para qualquer matriz $\Omega$.

**Fatora√ß√£o de Cholesky**

Uma fatora√ß√£o intimamente relacionada √† fatora√ß√£o triangular √© a fatora√ß√£o de Cholesky, que expressa uma matriz $\Omega$ como:

$\Omega=PP'$  [^4.4.16]

Onde $P = AD^{1/2}$ √© a matriz de Cholesky, e $D^{1/2}$ √© uma matriz diagonal cujos elementos s√£o as ra√≠zes quadradas dos elementos correspondentes da matriz $D$. A fatora√ß√£o de Cholesky fornece uma forma alternativa de decompor a matriz $\Omega$, com propriedades similares √† fatora√ß√£o triangular.

> üí° **Exemplo Num√©rico (Continua√ß√£o):** Usando as matrizes $A$ e $D$ do exemplo anterior, podemos calcular a matriz de Cholesky $P$. Primeiro, encontramos $D^{1/2}$:
>
> $$D^{1/2} = \begin{bmatrix} \sqrt{4} & 0 \\ 0 & \sqrt{4} \end{bmatrix} = \begin{bmatrix} 2 & 0 \\ 0 & 2 \end{bmatrix}$$
>
> Agora, calculamos $P = AD^{1/2}$:
>
> $$P = \begin{bmatrix} 1 & 0 \\ 0.5 & 1 \end{bmatrix} \begin{bmatrix} 2 & 0 \\ 0 & 2 \end{bmatrix} = \begin{bmatrix} 2 & 0 \\ 1 & 2 \end{bmatrix}$$
>
> Finalmente, verificamos se $\Omega = PP'$:
>
> $$PP' = \begin{bmatrix} 2 & 0 \\ 1 & 2 \end{bmatrix} \begin{bmatrix} 2 & 1 \\ 0 & 2 \end{bmatrix} = \begin{bmatrix} 4 & 2 \\ 2 & 5 \end{bmatrix} = \Omega$$

**Proposi√ß√£o 1:** A matriz de Cholesky $P$ √© uma matriz triangular inferior com entradas positivas na diagonal.

*Prova:* Como $A$ √© uma matriz triangular inferior com 1's na diagonal e $D^{1/2}$ √© uma matriz diagonal com entradas positivas, o produto $P = AD^{1/2}$ resultar√° numa matriz triangular inferior com entradas positivas na diagonal. Os elementos diagonais de $P$ s√£o $p_{ii} = 1\cdot \sqrt{d_{ii}} = \sqrt{d_{ii}} > 0$.
I. Seja $A$ uma matriz triangular inferior com 1's na diagonal.
II. Seja $D$ uma matriz diagonal com entradas positivas $d_{ii} > 0$.
III. Seja $D^{1/2}$ a matriz diagonal com entradas $\sqrt{d_{ii}} > 0$.
IV. Defina $P = AD^{1/2}$.
V. O produto de uma matriz triangular inferior ($A$) por uma matriz diagonal ($D^{1/2}$) resulta em uma matriz triangular inferior ($P$).
VI. Os elementos diagonais de $P$ s√£o dados por $p_{ii} = a_{ii} \cdot \sqrt{d_{ii}} = 1 \cdot \sqrt{d_{ii}} = \sqrt{d_{ii}}$.
VII. Como $d_{ii} > 0$, segue que $\sqrt{d_{ii}} > 0$. Portanto, $p_{ii} > 0$.
VIII. Conclu√≠mos que $P$ √© uma matriz triangular inferior com entradas positivas na diagonal. ‚ñ†

**Corol√°rio 1:** A fatora√ß√£o de Cholesky tamb√©m √© √∫nica.

*Prova:* Se $\Omega = P_1P_1' = P_2P_2'$, ent√£o $P_1 = A_1 D_1^{1/2}$ e $P_2 = A_2 D_2^{1/2}$. Como a fatora√ß√£o triangular √© √∫nica, $A_1 = A_2$ e $D_1 = D_2$, o que implica que $P_1=P_2$.
I.  Assumimos que $\Omega$ tem duas fatora√ß√µes de Cholesky: $\Omega = P_1P_1' = P_2P_2'$.
II.  Sabemos que $P_1 = A_1D_1^{1/2}$ e $P_2 = A_2D_2^{1/2}$, onde $A_1$ e $A_2$ s√£o matrizes triangulares inferiores com uns na diagonal, e $D_1$ e $D_2$ s√£o matrizes diagonais.
III. Substituindo na fatora√ß√£o de Cholesky, temos:
    $A_1D_1^{1/2}(A_1D_1^{1/2})' = A_1D_1^{1/2}D_1^{1/2}A_1' = A_1D_1A_1'$ e
    $A_2D_2^{1/2}(A_2D_2^{1/2})' = A_2D_2^{1/2}D_2^{1/2}A_2' = A_2D_2A_2'$.
IV. Da unicidade da fatora√ß√£o triangular, se $A_1D_1A_1'=A_2D_2A_2'$, ent√£o $A_1 = A_2$ e $D_1 = D_2$.
V. Se $A_1 = A_2$ e $D_1 = D_2$, ent√£o $D_1^{1/2} = D_2^{1/2}$.
VI. Assim, $P_1 = A_1D_1^{1/2} = A_2D_2^{1/2} = P_2$.
VII. Portanto, a fatora√ß√£o de Cholesky √© √∫nica. ‚ñ†

### Conclus√£o
A fatora√ß√£o triangular de uma matriz sim√©trica definida positiva $\Omega$, expressa como $\Omega = ADA'$, √© uma ferramenta poderosa na an√°lise de s√©ries temporais e em diversos campos da matem√°tica aplicada. Este processo, que envolve a decomposi√ß√£o da matriz $\Omega$ em tr√™s componentes distintos ($A$, $D$ e $A'$), permite simplificar c√°lculos complexos e possibilita uma melhor compreens√£o das rela√ß√µes entre vari√°veis. A unicidade da fatora√ß√£o garante uma representa√ß√£o consistente para cada matriz $\Omega$, e a fatora√ß√£o de Cholesky fornece uma alternativa igualmente v√°lida. A compreens√£o destes conceitos √© fundamental para a aplica√ß√£o eficaz de m√©todos estat√≠sticos e econom√©tricos na modelagem de s√©ries temporais e outros tipos de an√°lise de dados.

### Refer√™ncias
[^4]:  *A refer√™ncia geral ao cap√≠tulo 4 do livro √© utilizada para contextualizar as informa√ß√µes apresentadas.*
[^4.4.1]:  *Define a forma √∫nica da representa√ß√£o de uma matriz positiva definida sim√©trica.*
[^4.4.3]: *Apresenta a matriz E‚ÇÅ utilizada na primeira transforma√ß√£o de linhas.*
[^4.4.4]: *Define a rela√ß√£o entre Œ©, E‚ÇÅ e H.*
[^4.4.7]: *Descreve o processo de transforma√ß√£o da matriz atrav√©s de multiplica√ß√µes por matrizes E, resultando em uma matriz diagonal D.*
[^4.4.8]: *Apresenta a rela√ß√£o entre as matrizes E e a matriz A.*
[^4.4.11]: *Explica como a matriz A pode ser obtida diretamente.*
[^4.4.14]: *Enfatiza a unicidade da fatora√ß√£o triangular.*
[^4.4.16]: *Apresenta a fatora√ß√£o de Cholesky, uma alternativa √† fatora√ß√£o triangular.*
<!-- END -->
