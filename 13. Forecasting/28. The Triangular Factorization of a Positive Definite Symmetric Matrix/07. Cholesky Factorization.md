## A FatoraÃ§Ã£o de Cholesky e OtimizaÃ§Ã£o de CÃ¡lculos Matriciais
### IntroduÃ§Ã£o
Este capÃ­tulo aborda a **fatoraÃ§Ã£o de Cholesky**, uma variaÃ§Ã£o da fatoraÃ§Ã£o triangular que utiliza a raiz quadrada dos elementos da matriz diagonal $D$, e como essa fatoraÃ§Ã£o Ã© crucial para otimizar cÃ¡lculos envolvendo matrizes simÃ©tricas definidas positivas e sistemas computacionais [^4]. Exploraremos como a fatoraÃ§Ã£o de Cholesky Ã© derivada da fatoraÃ§Ã£o triangular e como a sua estrutura peculiar permite otimizar cÃ¡lculos em diversas Ã¡reas, como a estatÃ­stica, a econometria e a anÃ¡lise de dados.

### A DerivaÃ§Ã£o da FatoraÃ§Ã£o de Cholesky
A fatoraÃ§Ã£o de Cholesky Ã© uma forma especÃ­fica de fatoraÃ§Ã£o triangular que se baseia na decomposiÃ§Ã£o de uma matriz simÃ©trica definida positiva $\Omega$ em um produto de uma matriz triangular inferior $P$ por sua transposta, $P'$, tal que $\Omega = PP'$. Esta fatoraÃ§Ã£o Ã© derivada diretamente da fatoraÃ§Ã£o triangular $\Omega = ADA'$, explorando as propriedades da matriz diagonal $D$.

**DefiniÃ§Ã£o da Matriz Diagonal DÂ¹/Â²**
A matriz diagonal $D$, obtida na fatoraÃ§Ã£o triangular $\Omega = ADA'$, possui elementos diagonais positivos. Definimos a matriz diagonal $D^{1/2}$ como a matriz cujos elementos diagonais sÃ£o as raÃ­zes quadradas dos elementos correspondentes em $D$:

$$
D^{1/2} = \begin{bmatrix}
\sqrt{d_{11}} & 0 & \cdots & 0 \\
0 & \sqrt{d_{22}} & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & \sqrt{d_{nn}}
\end{bmatrix}
$$
Como $d_{ii} > 0$ para todo $i$, a raiz quadrada de cada elemento existe e Ã© real.

> ðŸ’¡ **Exemplo NumÃ©rico:** Seja uma matriz diagonal $D$ dada por:
>$$
D = \begin{bmatrix}
9 & 0 & 0 \\
0 & 4 & 0 \\
0 & 0 & 16
\end{bmatrix}
$$
>A matriz $D^{1/2}$ Ã©:
>
>$$
D^{1/2} = \begin{bmatrix}
\sqrt{9} & 0 & 0 \\
0 & \sqrt{4} & 0 \\
0 & 0 & \sqrt{16}
\end{bmatrix} = \begin{bmatrix}
3 & 0 & 0 \\
0 & 2 & 0 \\
0 & 0 & 4
\end{bmatrix}
$$
> A matriz $D^{1/2}$ Ã© obtida, simplesmente, calculando a raiz quadrada de cada elemento da matriz original.

**A Matriz P na FatoraÃ§Ã£o de Cholesky**
Utilizando a matriz $D^{1/2}$, definimos a matriz $P$ como:
$$
P = AD^{1/2}
$$
Onde $A$ Ã© a matriz triangular inferior obtida na fatoraÃ§Ã£o triangular.
A matriz $P$ Ã© tambÃ©m uma matriz triangular inferior, obtida multiplicando as colunas de $A$ pelas raÃ­zes quadradas dos elementos diagonais correspondentes de $D$.

> ðŸ’¡ **Exemplo NumÃ©rico:**  Tomando a matriz $A$ e $D$ da seÃ§Ã£o anterior, onde:
>$$A = \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0.5 & 1 \end{bmatrix} \quad \text{e} \quad D = \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 4 \end{bmatrix}$$
>
> Temos que $D^{1/2}$ Ã©:
>$$D^{1/2} = \begin{bmatrix} \sqrt{4} & 0 & 0 \\ 0 & \sqrt{4} & 0 \\ 0 & 0 & \sqrt{4} \end{bmatrix} = \begin{bmatrix} 2 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bmatrix}$$
>
>E a matriz $P$ Ã© obtida por:
>
>$$ P = AD^{1/2} = \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0.5 & 1 \end{bmatrix} \begin{bmatrix} 2 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bmatrix} = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix}$$
> Observe que a matriz $P$ Ã© uma matriz triangular inferior, em que cada coluna de $A$ foi multiplicada pela raiz quadrada correspondente de $D$.

**A FatoraÃ§Ã£o de Cholesky**
A fatoraÃ§Ã£o de Cholesky Ã© entÃ£o dada por:
$$
\Omega = PP'
$$
Essa representaÃ§Ã£o Ã© obtida substituindo $AD^{1/2}D^{1/2}A'$ por $ADA'$ em $\Omega = ADA'$, o que leva a:

$$
\Omega = A D^{1/2} D^{1/2} A' = (AD^{1/2})(AD^{1/2})' = PP'
$$
A matriz $P$ Ã© conhecida como o fator de Cholesky de $\Omega$. A fatoraÃ§Ã£o de Cholesky, portanto, Ã© uma especializaÃ§Ã£o da fatoraÃ§Ã£o triangular, onde a matriz diagonal $D$ Ã© substituÃ­da pela matriz $D^{1/2}$ e utilizada para criar a matriz $P$, de modo que $\Omega$ seja escrita como o produto de uma matriz triangular inferior por sua transposta.

> ðŸ’¡ **Exemplo NumÃ©rico:** Usando a matriz $\Omega$ do exemplo anterior e as matrizes $P$ e $P'$, temos:
>
> $$ \Omega = \begin{bmatrix}
4 & 2 & 2 \\
2 & 5 & 3 \\
2 & 3 & 6
\end{bmatrix} $$
>
>$$ P = \begin{bmatrix}
2 & 0 & 0 \\
1 & 2 & 0 \\
1 & 1 & 2
\end{bmatrix}  $$
>
>$$ P' = \begin{bmatrix}
2 & 1 & 1 \\
0 & 2 & 1 \\
0 & 0 & 2
\end{bmatrix}  $$
>
> Verifica-se, entÃ£o, que $\Omega = PP'$
>
> $$ PP' = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix} \begin{bmatrix} 2 & 1 & 1 \\ 0 & 2 & 1 \\ 0 & 0 & 2 \end{bmatrix} = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix} = \Omega $$
>
> Como se observa, o produto de $P$ por sua transposta resulta na matriz $\Omega$.

**Teorema 1:** A fatoraÃ§Ã£o de Cholesky de uma matriz simÃ©trica definida positiva $\Omega$ Ã© dada por $\Omega = PP'$, onde $P$ Ã© uma matriz triangular inferior com elementos na diagonal principal dados pelas raÃ­zes quadradas dos elementos diagonais da matriz $D$ obtida na fatoraÃ§Ã£o triangular.

*Prova:*
I. Partimos da fatoraÃ§Ã£o triangular $\Omega = ADA'$, onde $D$ Ã© uma matriz diagonal com elementos positivos.
II. Definimos a matriz $D^{1/2}$ como a matriz diagonal cujos elementos sÃ£o as raÃ­zes quadradas dos elementos correspondentes em $D$.
III. Definimos a matriz $P = AD^{1/2}$. A matriz $P$ Ã© triangular inferior.
IV. Calculamos o produto $PP'$.
V. Pela propriedade da transposta, temos $(D^{1/2}A')' = AD^{1/2}$. Logo, $PP' = (AD^{1/2})(AD^{1/2})' = AD^{1/2}D^{1/2}A' = ADA' = \Omega$
VI. Portanto, a fatoraÃ§Ã£o de Cholesky Ã© dada por $\Omega = PP'$. $\blacksquare$

**CorolÃ¡rio 1:** A matriz $P$ na fatoraÃ§Ã£o de Cholesky Ã© Ãºnica e tem elementos na diagonal principal estritamente positivos.

*Prova:*
I. A fatoraÃ§Ã£o de Cholesky Ã© obtida da fatoraÃ§Ã£o triangular, onde a matriz $D$ possui elementos positivos na diagonal.
II. A matriz $D^{1/2}$ Ã© Ãºnica, pois as raÃ­zes quadradas dos elementos positivos sÃ£o reais e Ãºnicas.
III. A matriz triangular inferior $A$ Ã© Ãºnica na fatoraÃ§Ã£o triangular, conforme demonstrado no capÃ­tulo anterior.
IV. Como $P = AD^{1/2}$, o produto de matrizes Ãºnicas tambÃ©m resulta em uma matriz Ãºnica.
V. AlÃ©m disso, a matriz $P$ Ã© triangular inferior e os elementos da diagonal principal sÃ£o as raÃ­zes quadradas dos elementos da matriz diagonal $D$, que sÃ£o estritamente positivos, garantindo que os elementos da diagonal de $P$ tambÃ©m sejam estritamente positivos. $\blacksquare$

**ObservaÃ§Ã£o 1** A fatoraÃ§Ã£o de Cholesky Ã© uma ferramenta fundamental na anÃ¡lise numÃ©rica, devido a sua unicidade e ao fato que pode ser calculada de forma eficiente. Essa forma especial de fatoraÃ§Ã£o Ã© usada em algoritmos de otimizaÃ§Ã£o e sistemas de equaÃ§Ãµes lineares devido Ã  sua eficiÃªncia computacional.

### OtimizaÃ§Ã£o de CÃ¡lculos Matriciais com a FatoraÃ§Ã£o de Cholesky
A fatoraÃ§Ã£o de Cholesky Ã© uma ferramenta valiosa na otimizaÃ§Ã£o de cÃ¡lculos matriciais devido a diversas vantagens computacionais:

1.  **Menor Custo Computacional:** A fatoraÃ§Ã£o de Cholesky permite realizar a decomposiÃ§Ã£o de uma matriz em um produto de uma matriz triangular inferior por sua transposta. A manipulaÃ§Ã£o de matrizes triangulares inferiores tem um custo computacional menor do que matrizes gerais, reduzindo o tempo de processamento.
2.  **Estabilidade NumÃ©rica:** Os algoritmos de Cholesky sÃ£o mais estÃ¡veis numericamente do que outras formas de decomposiÃ§Ã£o, como a decomposiÃ§Ã£o LU. A estabilidade numÃ©rica Ã© importante para evitar erros de arredondamento que possam comprometer os resultados.
3.  **EficiÃªncia de Armazenamento:** A matriz $P$ na fatoraÃ§Ã£o de Cholesky Ã© triangular inferior. Ao armazenar os elementos de uma matriz triangular inferior, Ã© necessÃ¡rio alocar memÃ³ria apenas para a metade da matriz (sem contar a diagonal), reduzindo assim o uso de memÃ³ria em relaÃ§Ã£o a uma matriz cheia.
4.  **AplicaÃ§Ãµes em Sistemas Lineares:** A fatoraÃ§Ã£o de Cholesky Ã© amplamente utilizada na resoluÃ§Ã£o de sistemas lineares da forma $\Omega x = b$, transformando o problema em dois sistemas triangulares mais fÃ¡ceis de resolver.

**ResoluÃ§Ã£o de Sistemas Lineares com a FatoraÃ§Ã£o de Cholesky**
Dado o sistema linear $\Omega x = b$, e utilizando a fatoraÃ§Ã£o de Cholesky $\Omega = PP'$, podemos resolver o sistema da seguinte forma:
- SubstituÃ­mos $\Omega$ por $PP'$, obtendo $PP'x = b$.
- Definimos $y = P'x$. Resolvemos entÃ£o o sistema $Py = b$ para obter $y$, que Ã© um sistema linear triangular inferior, muito mais fÃ¡cil de resolver.
- Uma vez que temos $y$, resolvemos o sistema $P'x = y$ para obter $x$, que Ã© outro sistema linear triangular, embora seja superior.

> ðŸ’¡ **Exemplo NumÃ©rico:** Considere o sistema linear com a matriz $\Omega$ e o vetor $b$:
>
> $$
\Omega = \begin{bmatrix}
4 & 2 \\
2 & 5
\end{bmatrix} \quad b = \begin{bmatrix}
8 \\ 13
\end{bmatrix}
$$
>
> Temos que a matriz $P$ da fatoraÃ§Ã£o de Cholesky de $\Omega$ Ã©
>
> $$P = \begin{bmatrix}
2 & 0 \\
1 & 2
\end{bmatrix}
$$
>
>E $P'$ Ã©:
>
> $$P' = \begin{bmatrix}
2 & 1 \\
0 & 2
\end{bmatrix}$$
>
> Primeiro, resolvemos o sistema $Py=b$:
>
>$$
\begin{bmatrix}
2 & 0 \\
1 & 2
\end{bmatrix} \begin{bmatrix}
y_1 \\ y_2
\end{bmatrix} = \begin{bmatrix}
8 \\ 13
\end{bmatrix}
$$
>
>  O que leva a $2y_1 = 8$ e $y_1+2y_2 = 13$. Assim, $y_1 = 4$, $y_2 = (13 - 4)/2 = 4.5$. Logo, $y = \begin{bmatrix}
4 \\ 4.5
\end{bmatrix}$
>
> Em seguida, resolvemos o sistema $P'x = y$:
>
>$$
\begin{bmatrix}
2 & 1 \\
0 & 2
\end{bmatrix} \begin{bmatrix}
x_1 \\ x_2
\end{bmatrix} = \begin{bmatrix}
4 \\ 4.5
\end{bmatrix}
$$
>
>Assim, obtemos $2x_2 = 4.5$, $x_2 = 2.25$. E $2x_1 + 2.25 = 4$, $x_1 = (4-2.25)/2 = 0.875$. Logo, $x = \begin{bmatrix} 0.875 \\ 2.25 \end{bmatrix}$
>
>A soluÃ§Ã£o para o sistema $\Omega x = b$ Ã© $x = \begin{bmatrix} 0.875 \\ 2.25 \end{bmatrix}$
>
> Podemos verificar que $\Omega x = b$:
>$$
\begin{bmatrix}
4 & 2 \\
2 & 5
\end{bmatrix} \begin{bmatrix} 0.875 \\ 2.25 \end{bmatrix} = \begin{bmatrix}
4(0.875) + 2(2.25) \\
2(0.875) + 5(2.25)
\end{bmatrix} = \begin{bmatrix}
3.5 + 4.5 \\
1.75 + 11.25
\end{bmatrix} = \begin{bmatrix}
8 \\ 13
\end{bmatrix}
$$
>
>Confirmando a soluÃ§Ã£o.

**Outras AplicaÃ§Ãµes**
1.  **CÃ¡lculo de Determinantes:** A fatoraÃ§Ã£o de Cholesky simplifica o cÃ¡lculo do determinante de $\Omega$. O determinante de $\Omega$ Ã© igual ao quadrado do produto dos elementos diagonais da matriz $P$.
2.  **GeraÃ§Ã£o de NÃºmeros AleatÃ³rios:** A fatoraÃ§Ã£o de Cholesky Ã© usada na geraÃ§Ã£o de nÃºmeros aleatÃ³rios com correlaÃ§Ã£o. A matriz de covariÃ¢ncia desejada Ã© fatorada utilizando a fatoraÃ§Ã£o de Cholesky.
3.  **OtimizaÃ§Ã£o:** A fatoraÃ§Ã£o de Cholesky Ã© usada como uma sub-rotina em algoritmos de otimizaÃ§Ã£o que envolvem matrizes simÃ©tricas definidas positivas, como em algoritmos de programaÃ§Ã£o quadrÃ¡tica.
4.  **Filtragem de Kalman:** A fatoraÃ§Ã£o de Cholesky Ã© empregada na filtragem de Kalman para manter a matriz de covariÃ¢ncia dos estados sempre definida positiva.

> ðŸ’¡ **Exemplo NumÃ©rico:** Considere a matriz $\Omega$ do exemplo anterior:
>
> $$
\Omega = \begin{bmatrix}
4 & 2 \\
2 & 5
\end{bmatrix}
$$
>
> A matriz $P$ da fatoraÃ§Ã£o de Cholesky Ã©:
>
>$$
P = \begin{bmatrix}
2 & 0 \\
1 & 2
\end{bmatrix}
$$
>
>O determinante de $\Omega$ Ã© calculado como o quadrado do produto dos elementos diagonais de $P$:
>
>$$\det(\Omega) = (2 \cdot 2)^2 = 4^2 = 16$$
>
>Podemos verificar que o determinante calculado diretamente Ã©:
>
>$$\det(\Omega) = (4 \cdot 5) - (2 \cdot 2) = 20 - 4 = 16$$
>
>Confirmando o resultado obtido pela fatoraÃ§Ã£o de Cholesky.

**Teorema 2** O determinante de $\Omega$ Ã© igual ao quadrado do produto dos elementos da diagonal de $P$, ou seja, $\det(\Omega) = (\prod_{i=1}^n p_{ii})^2$.
*Prova:*
I. Pela fatoraÃ§Ã£o de Cholesky, temos $\Omega = PP'$.
II. O determinante de um produto de matrizes Ã© o produto dos seus determinantes: $\det(\Omega) = \det(P)\det(P')$.
III. Como o determinante da transposta de uma matriz Ã© igual ao determinante da matriz, $\det(P') = \det(P)$.
IV. A matriz $P$ Ã© triangular inferior e, portanto, o determinante de $P$ Ã© o produto dos elementos da sua diagonal: $\det(P) = \prod_{i=1}^n p_{ii}$.
V. Logo, $\det(\Omega) = \det(P) \det(P') = (\det(P))^2 = (\prod_{i=1}^n p_{ii})^2$.
VI. Portanto, o determinante de $\Omega$ Ã© igual ao quadrado do produto dos elementos diagonais da matriz $P$. $\blacksquare$

**Lema 2.1:** A fatoraÃ§Ã£o de Cholesky de uma matriz simÃ©trica definida positiva Ã© Ãºnica.

*Prova:*
I. Suponha que $\Omega$ tenha duas fatoraÃ§Ãµes de Cholesky, $\Omega = P_1P_1' = P_2P_2'$.
II. Como $\Omega$ Ã© definida positiva, as matrizes $P_1$ e $P_2$ sÃ£o inversÃ­veis.
III. Multiplicando a equaÃ§Ã£o $P_1P_1' = P_2P_2'$ por $P_2^{-1}$ Ã  esquerda e $(P_1')^{-1}$ Ã  direita, obtemos $P_2^{-1}P_1 = P_2'(P_1')^{-1}$.
IV.  O lado esquerdo, $P_2^{-1}P_1$, Ã© o produto de duas matrizes triangulares inferiores, que resulta em uma matriz triangular inferior.
V.  O lado direito, $P_2'(P_1')^{-1}$, Ã© o produto de duas matrizes triangulares superiores, que resulta em uma matriz triangular superior.
VI. Uma matriz que Ã© simultaneamente triangular inferior e superior deve ser diagonal. Seja $D = P_2^{-1}P_1 = P_2'(P_1')^{-1}$.
VII.  Portanto, $P_1 = P_2D$. Substituindo na fatoraÃ§Ã£o de Cholesky, temos $\Omega = P_1P_1' = P_2DD'P_2'$.
VIII. Como $P_1P_1' = P_2P_2'$, temos $P_2P_2' = P_2DD'P_2'$, o que implica $P_2' = DD'P_2'$. Multiplicando por $(P_2')^{-1}$ Ã  direita, obtemos $I = DD'$, onde $I$ Ã© a matriz identidade.
IX. Como $D$ Ã© diagonal e $DD'=I$, entÃ£o $D$ deve ser uma matriz identidade ou uma matriz diagonal com elementos diagonais iguais a $\pm 1$. Como os elementos diagonais de $P_1$ e $P_2$ sÃ£o positivos (pelo CorolÃ¡rio 1), a matriz $D$ deve ter elementos diagonais iguais a 1, o que implica $D=I$.
X.  Portanto, $P_1 = P_2$, e a fatoraÃ§Ã£o de Cholesky Ã© Ãºnica. $\blacksquare$

**Teorema 2.1:** Se $\Omega$ Ã© uma matriz simÃ©trica definida positiva, entÃ£o $\Omega^{-1}$ tambÃ©m Ã© simÃ©trica definida positiva e sua fatoraÃ§Ã£o de Cholesky pode ser obtida a partir da fatoraÃ§Ã£o de Cholesky de $\Omega$.

*Prova:*
I. Seja $\Omega$ uma matriz simÃ©trica definida positiva. EntÃ£o $\Omega = PP'$, onde $P$ Ã© uma matriz triangular inferior com elementos diagonais positivos.
II. Sabemos que $\Omega^{-1}$ existe e Ã© tambÃ©m simÃ©trica. Para mostrar que Ã© definida positiva, precisamos mostrar que $x^T\Omega^{-1}x > 0$ para todo $x \neq 0$.
III. Seja $y = P'x$. EntÃ£o $x = (P')^{-1}y$, e $x^T = y^T(P^{-1})$.
IV. Substituindo na expressÃ£o, temos $x^T\Omega^{-1}x = y^T(P^{-1})(PP')^{-1}(P')^{-1}y = y^T(P^{-1})(P')^{-1}P^{-1}y = y^T(P^{-1})(P^{-1})^Ty = (P^{-1}y)^T(P^{-1}y)$.
V. Seja $z = P^{-1}y$. EntÃ£o $x^T\Omega^{-1}x = z^Tz = \sum_i z_i^2 > 0$ para todo $x \neq 0$, jÃ¡ que $P$ e portanto $P^{-1}$ sÃ£o invertÃ­veis, o que implica que $z \ne 0$ quando $x \ne 0$. Portanto, $\Omega^{-1}$ Ã© definida positiva.
VI. AlÃ©m disso, $\Omega^{-1} = (PP')^{-1} = (P')^{-1}P^{-1} = (P^{-1})^T P^{-1}$. Se definirmos $Q = P^{-1}$, que Ã© triangular inferior pois $P$ tambÃ©m o Ã©, temos que $\Omega^{-1} = Q'Q$, que Ã© uma fatoraÃ§Ã£o de Cholesky de $\Omega^{-1}$.
VII. Logo, a fatoraÃ§Ã£o de Cholesky de $\Omega^{-1}$ Ã© obtida pelo inverso da matriz $P$ da fatoraÃ§Ã£o de Cholesky de $\Omega$. $\blacksquare$

### ConclusÃ£o
A fatoraÃ§Ã£o de Cholesky, como uma forma especializada de fatoraÃ§Ã£o triangular que envolve a raiz quadrada dos elementos da matriz diagonal $D$, Ã© uma ferramenta essencial para otimizar cÃ¡lculos com matrizes simÃ©tricas definidas positivas. As propriedades de unicidade, eficiÃªncia computacional e estabilidade numÃ©rica da fatoraÃ§Ã£o de Cholesky fazem com que ela seja amplamente utilizada em diversas aplicaÃ§Ãµes, desde a resoluÃ§Ã£o de sistemas lineares atÃ© a otimizaÃ§Ã£o e a simulaÃ§Ã£o numÃ©rica. A representaÃ§Ã£o da matriz original atravÃ©s de um produto de uma matriz triangular inferior por sua transposta simplifica os cÃ¡lculos e possibilita a criaÃ§Ã£o de rotinas computacionais mais rÃ¡pidas e eficientes.

### ReferÃªncias
[^4]: *A referÃªncia geral ao capÃ­tulo 4 do livro Ã© utilizada para contextualizar as informaÃ§Ãµes apresentadas.*
<!-- END -->
