## A Fatora√ß√£o de Cholesky e Otimiza√ß√£o de C√°lculos Matriciais
### Introdu√ß√£o
Este cap√≠tulo aborda a **fatora√ß√£o de Cholesky**, uma varia√ß√£o da fatora√ß√£o triangular que utiliza a raiz quadrada dos elementos da matriz diagonal $D$, e como essa fatora√ß√£o √© crucial para otimizar c√°lculos envolvendo matrizes sim√©tricas definidas positivas e sistemas computacionais [^4]. Exploraremos como a fatora√ß√£o de Cholesky √© derivada da fatora√ß√£o triangular e como a sua estrutura peculiar permite otimizar c√°lculos em diversas √°reas, como a estat√≠stica, a econometria e a an√°lise de dados.

### A Deriva√ß√£o da Fatora√ß√£o de Cholesky
A fatora√ß√£o de Cholesky √© uma forma espec√≠fica de fatora√ß√£o triangular que se baseia na decomposi√ß√£o de uma matriz sim√©trica definida positiva $\Omega$ em um produto de uma matriz triangular inferior $P$ por sua transposta, $P'$, tal que $\Omega = PP'$. Esta fatora√ß√£o √© derivada diretamente da fatora√ß√£o triangular $\Omega = ADA'$, explorando as propriedades da matriz diagonal $D$.

**Defini√ß√£o da Matriz Diagonal D¬π/¬≤**
A matriz diagonal $D$, obtida na fatora√ß√£o triangular $\Omega = ADA'$, possui elementos diagonais positivos. Definimos a matriz diagonal $D^{1/2}$ como a matriz cujos elementos diagonais s√£o as ra√≠zes quadradas dos elementos correspondentes em $D$:

$$
D^{1/2} = \begin{bmatrix}
\sqrt{d_{11}} & 0 & \cdots & 0 \\
0 & \sqrt{d_{22}} & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & \sqrt{d_{nn}}
\end{bmatrix}
$$
Como $d_{ii} > 0$ para todo $i$, a raiz quadrada de cada elemento existe e √© real.

> üí° **Exemplo Num√©rico:** Seja uma matriz diagonal $D$ dada por:
>$$
D = \begin{bmatrix}
9 & 0 & 0 \\
0 & 4 & 0 \\
0 & 0 & 16
\end{bmatrix}
$$
>A matriz $D^{1/2}$ √©:
>
>$$
D^{1/2} = \begin{bmatrix}
\sqrt{9} & 0 & 0 \\
0 & \sqrt{4} & 0 \\
0 & 0 & \sqrt{16}
\end{bmatrix} = \begin{bmatrix}
3 & 0 & 0 \\
0 & 2 & 0 \\
0 & 0 & 4
\end{bmatrix}
$$
> A matriz $D^{1/2}$ √© obtida, simplesmente, calculando a raiz quadrada de cada elemento da matriz original.

**A Matriz P na Fatora√ß√£o de Cholesky**
Utilizando a matriz $D^{1/2}$, definimos a matriz $P$ como:
$$
P = AD^{1/2}
$$
Onde $A$ √© a matriz triangular inferior obtida na fatora√ß√£o triangular.
A matriz $P$ √© tamb√©m uma matriz triangular inferior, obtida multiplicando as colunas de $A$ pelas ra√≠zes quadradas dos elementos diagonais correspondentes de $D$.

> üí° **Exemplo Num√©rico:**  Tomando a matriz $A$ e $D$ da se√ß√£o anterior, onde:
>$$A = \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0.5 & 1 \end{bmatrix} \quad \text{e} \quad D = \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 4 \end{bmatrix}$$
>
> Temos que $D^{1/2}$ √©:
>$$D^{1/2} = \begin{bmatrix} \sqrt{4} & 0 & 0 \\ 0 & \sqrt{4} & 0 \\ 0 & 0 & \sqrt{4} \end{bmatrix} = \begin{bmatrix} 2 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bmatrix}$$
>
>E a matriz $P$ √© obtida por:
>
>$$ P = AD^{1/2} = \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0.5 & 1 \end{bmatrix} \begin{bmatrix} 2 & 0 & 0 \\ 0 & 2 & 0 \\ 0 & 0 & 2 \end{bmatrix} = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix}$$
> Observe que a matriz $P$ √© uma matriz triangular inferior, em que cada coluna de $A$ foi multiplicada pela raiz quadrada correspondente de $D$.

**A Fatora√ß√£o de Cholesky**
A fatora√ß√£o de Cholesky √© ent√£o dada por:
$$
\Omega = PP'
$$
Essa representa√ß√£o √© obtida substituindo $AD^{1/2}D^{1/2}A'$ por $ADA'$ em $\Omega = ADA'$, o que leva a:

$$
\Omega = A D^{1/2} D^{1/2} A' = (AD^{1/2})(AD^{1/2})' = PP'
$$
A matriz $P$ √© conhecida como o fator de Cholesky de $\Omega$. A fatora√ß√£o de Cholesky, portanto, √© uma especializa√ß√£o da fatora√ß√£o triangular, onde a matriz diagonal $D$ √© substitu√≠da pela matriz $D^{1/2}$ e utilizada para criar a matriz $P$, de modo que $\Omega$ seja escrita como o produto de uma matriz triangular inferior por sua transposta.

> üí° **Exemplo Num√©rico:** Usando a matriz $\Omega$ do exemplo anterior e as matrizes $P$ e $P'$, temos:
>
> $$ \Omega = \begin{bmatrix}
4 & 2 & 2 \\
2 & 5 & 3 \\
2 & 3 & 6
\end{bmatrix} $$
>
>$$ P = \begin{bmatrix}
2 & 0 & 0 \\
1 & 2 & 0 \\
1 & 1 & 2
\end{bmatrix}  $$
>
>$$ P' = \begin{bmatrix}
2 & 1 & 1 \\
0 & 2 & 1 \\
0 & 0 & 2
\end{bmatrix}  $$
>
> Verifica-se, ent√£o, que $\Omega = PP'$
>
> $$ PP' = \begin{bmatrix} 2 & 0 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 2 \end{bmatrix} \begin{bmatrix} 2 & 1 & 1 \\ 0 & 2 & 1 \\ 0 & 0 & 2 \end{bmatrix} = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix} = \Omega $$
>
> Como se observa, o produto de $P$ por sua transposta resulta na matriz $\Omega$.

**Teorema 1:** A fatora√ß√£o de Cholesky de uma matriz sim√©trica definida positiva $\Omega$ √© dada por $\Omega = PP'$, onde $P$ √© uma matriz triangular inferior com elementos na diagonal principal dados pelas ra√≠zes quadradas dos elementos diagonais da matriz $D$ obtida na fatora√ß√£o triangular.

*Prova:*
I. Partimos da fatora√ß√£o triangular $\Omega = ADA'$, onde $D$ √© uma matriz diagonal com elementos positivos.
II. Definimos a matriz $D^{1/2}$ como a matriz diagonal cujos elementos s√£o as ra√≠zes quadradas dos elementos correspondentes em $D$.
III. Definimos a matriz $P = AD^{1/2}$. A matriz $P$ √© triangular inferior.
IV. Calculamos o produto $PP'$.
V. Pela propriedade da transposta, temos $(D^{1/2}A')' = AD^{1/2}$. Logo, $PP' = (AD^{1/2})(AD^{1/2})' = AD^{1/2}D^{1/2}A' = ADA' = \Omega$
VI. Portanto, a fatora√ß√£o de Cholesky √© dada por $\Omega = PP'$. $\blacksquare$

**Corol√°rio 1:** A matriz $P$ na fatora√ß√£o de Cholesky √© √∫nica e tem elementos na diagonal principal estritamente positivos.

*Prova:*
I. A fatora√ß√£o de Cholesky √© obtida da fatora√ß√£o triangular, onde a matriz $D$ possui elementos positivos na diagonal.
II. A matriz $D^{1/2}$ √© √∫nica, pois as ra√≠zes quadradas dos elementos positivos s√£o reais e √∫nicas.
III. A matriz triangular inferior $A$ √© √∫nica na fatora√ß√£o triangular, conforme demonstrado no cap√≠tulo anterior.
IV. Como $P = AD^{1/2}$, o produto de matrizes √∫nicas tamb√©m resulta em uma matriz √∫nica.
V. Al√©m disso, a matriz $P$ √© triangular inferior e os elementos da diagonal principal s√£o as ra√≠zes quadradas dos elementos da matriz diagonal $D$, que s√£o estritamente positivos, garantindo que os elementos da diagonal de $P$ tamb√©m sejam estritamente positivos. $\blacksquare$

**Observa√ß√£o 1** A fatora√ß√£o de Cholesky √© uma ferramenta fundamental na an√°lise num√©rica, devido a sua unicidade e ao fato que pode ser calculada de forma eficiente. Essa forma especial de fatora√ß√£o √© usada em algoritmos de otimiza√ß√£o e sistemas de equa√ß√µes lineares devido √† sua efici√™ncia computacional.

### Otimiza√ß√£o de C√°lculos Matriciais com a Fatora√ß√£o de Cholesky
A fatora√ß√£o de Cholesky √© uma ferramenta valiosa na otimiza√ß√£o de c√°lculos matriciais devido a diversas vantagens computacionais:

1.  **Menor Custo Computacional:** A fatora√ß√£o de Cholesky permite realizar a decomposi√ß√£o de uma matriz em um produto de uma matriz triangular inferior por sua transposta. A manipula√ß√£o de matrizes triangulares inferiores tem um custo computacional menor do que matrizes gerais, reduzindo o tempo de processamento.
2.  **Estabilidade Num√©rica:** Os algoritmos de Cholesky s√£o mais est√°veis numericamente do que outras formas de decomposi√ß√£o, como a decomposi√ß√£o LU. A estabilidade num√©rica √© importante para evitar erros de arredondamento que possam comprometer os resultados.
3.  **Efici√™ncia de Armazenamento:** A matriz $P$ na fatora√ß√£o de Cholesky √© triangular inferior. Ao armazenar os elementos de uma matriz triangular inferior, √© necess√°rio alocar mem√≥ria apenas para a metade da matriz (sem contar a diagonal), reduzindo assim o uso de mem√≥ria em rela√ß√£o a uma matriz cheia.
4.  **Aplica√ß√µes em Sistemas Lineares:** A fatora√ß√£o de Cholesky √© amplamente utilizada na resolu√ß√£o de sistemas lineares da forma $\Omega x = b$, transformando o problema em dois sistemas triangulares mais f√°ceis de resolver.

**Resolu√ß√£o de Sistemas Lineares com a Fatora√ß√£o de Cholesky**
Dado o sistema linear $\Omega x = b$, e utilizando a fatora√ß√£o de Cholesky $\Omega = PP'$, podemos resolver o sistema da seguinte forma:
- Substitu√≠mos $\Omega$ por $PP'$, obtendo $PP'x = b$.
- Definimos $y = P'x$. Resolvemos ent√£o o sistema $Py = b$ para obter $y$, que √© um sistema linear triangular inferior, muito mais f√°cil de resolver.
- Uma vez que temos $y$, resolvemos o sistema $P'x = y$ para obter $x$, que √© outro sistema linear triangular, embora seja superior.

> üí° **Exemplo Num√©rico:** Considere o sistema linear com a matriz $\Omega$ e o vetor $b$:
>
> $$
\Omega = \begin{bmatrix}
4 & 2 \\
2 & 5
\end{bmatrix} \quad b = \begin{bmatrix}
8 \\ 13
\end{bmatrix}
$$
>
> Temos que a matriz $P$ da fatora√ß√£o de Cholesky de $\Omega$ √©
>
> $$P = \begin{bmatrix}
2 & 0 \\
1 & 2
\end{bmatrix}
$$
>
>E $P'$ √©:
>
> $$P' = \begin{bmatrix}
2 & 1 \\
0 & 2
\end{bmatrix}$$
>
> Primeiro, resolvemos o sistema $Py=b$:
>
>$$
\begin{bmatrix}
2 & 0 \\
1 & 2
\end{bmatrix} \begin{bmatrix}
y_1 \\ y_2
\end{bmatrix} = \begin{bmatrix}
8 \\ 13
\end{bmatrix}
$$
>
>  O que leva a $2y_1 = 8$ e $y_1+2y_2 = 13$. Assim, $y_1 = 4$, $y_2 = (13 - 4)/2 = 4.5$. Logo, $y = \begin{bmatrix}
4 \\ 4.5
\end{bmatrix}$
>
> Em seguida, resolvemos o sistema $P'x = y$:
>
>$$
\begin{bmatrix}
2 & 1 \\
0 & 2
\end{bmatrix} \begin{bmatrix}
x_1 \\ x_2
\end{bmatrix} = \begin{bmatrix}
4 \\ 4.5
\end{bmatrix}
$$
>
>Assim, obtemos $2x_2 = 4.5$, $x_2 = 2.25$. E $2x_1 + 2.25 = 4$, $x_1 = (4-2.25)/2 = 0.875$. Logo, $x = \begin{bmatrix} 0.875 \\ 2.25 \end{bmatrix}$
>
>A solu√ß√£o para o sistema $\Omega x = b$ √© $x = \begin{bmatrix} 0.875 \\ 2.25 \end{bmatrix}$
>
> Podemos verificar que $\Omega x = b$:
>$$
\begin{bmatrix}
4 & 2 \\
2 & 5
\end{bmatrix} \begin{bmatrix} 0.875 \\ 2.25 \end{bmatrix} = \begin{bmatrix}
4(0.875) + 2(2.25) \\
2(0.875) + 5(2.25)
\end{bmatrix} = \begin{bmatrix}
3.5 + 4.5 \\
1.75 + 11.25
\end{bmatrix} = \begin{bmatrix}
8 \\ 13
\end{bmatrix}
$$
>
>Confirmando a solu√ß√£o.

**Outras Aplica√ß√µes**
1.  **C√°lculo de Determinantes:** A fatora√ß√£o de Cholesky simplifica o c√°lculo do determinante de $\Omega$. O determinante de $\Omega$ √© igual ao quadrado do produto dos elementos diagonais da matriz $P$.
2.  **Gera√ß√£o de N√∫meros Aleat√≥rios:** A fatora√ß√£o de Cholesky √© usada na gera√ß√£o de n√∫meros aleat√≥rios com correla√ß√£o. A matriz de covari√¢ncia desejada √© fatorada utilizando a fatora√ß√£o de Cholesky.
3.  **Otimiza√ß√£o:** A fatora√ß√£o de Cholesky √© usada como uma sub-rotina em algoritmos de otimiza√ß√£o que envolvem matrizes sim√©tricas definidas positivas, como em algoritmos de programa√ß√£o quadr√°tica.
4.  **Filtragem de Kalman:** A fatora√ß√£o de Cholesky √© empregada na filtragem de Kalman para manter a matriz de covari√¢ncia dos estados sempre definida positiva.

> üí° **Exemplo Num√©rico:** Considere a matriz $\Omega$ do exemplo anterior:
>
> $$
\Omega = \begin{bmatrix}
4 & 2 \\
2 & 5
\end{bmatrix}
$$
>
> A matriz $P$ da fatora√ß√£o de Cholesky √©:
>
>$$
P = \begin{bmatrix}
2 & 0 \\
1 & 2
\end{bmatrix}
$$
>
>O determinante de $\Omega$ √© calculado como o quadrado do produto dos elementos diagonais de $P$:
>
>$$\det(\Omega) = (2 \cdot 2)^2 = 4^2 = 16$$
>
>Podemos verificar que o determinante calculado diretamente √©:
>
>$$\det(\Omega) = (4 \cdot 5) - (2 \cdot 2) = 20 - 4 = 16$$
>
>Confirmando o resultado obtido pela fatora√ß√£o de Cholesky.

**Teorema 2** O determinante de $\Omega$ √© igual ao quadrado do produto dos elementos da diagonal de $P$, ou seja, $\det(\Omega) = (\prod_{i=1}^n p_{ii})^2$.
*Prova:*
I. Pela fatora√ß√£o de Cholesky, temos $\Omega = PP'$.
II. O determinante de um produto de matrizes √© o produto dos seus determinantes: $\det(\Omega) = \det(P)\det(P')$.
III. Como o determinante da transposta de uma matriz √© igual ao determinante da matriz, $\det(P') = \det(P)$.
IV. A matriz $P$ √© triangular inferior e, portanto, o determinante de $P$ √© o produto dos elementos da sua diagonal: $\det(P) = \prod_{i=1}^n p_{ii}$.
V. Logo, $\det(\Omega) = \det(P) \det(P') = (\det(P))^2 = (\prod_{i=1}^n p_{ii})^2$.
VI. Portanto, o determinante de $\Omega$ √© igual ao quadrado do produto dos elementos diagonais da matriz $P$. $\blacksquare$

**Lema 2.1:** A fatora√ß√£o de Cholesky de uma matriz sim√©trica definida positiva √© √∫nica.

*Prova:*
I. Suponha que $\Omega$ tenha duas fatora√ß√µes de Cholesky, $\Omega = P_1P_1' = P_2P_2'$.
II. Como $\Omega$ √© definida positiva, as matrizes $P_1$ e $P_2$ s√£o invers√≠veis.
III. Multiplicando a equa√ß√£o $P_1P_1' = P_2P_2'$ por $P_2^{-1}$ √† esquerda e $(P_1')^{-1}$ √† direita, obtemos $P_2^{-1}P_1 = P_2'(P_1')^{-1}$.
IV.  O lado esquerdo, $P_2^{-1}P_1$, √© o produto de duas matrizes triangulares inferiores, que resulta em uma matriz triangular inferior.
V.  O lado direito, $P_2'(P_1')^{-1}$, √© o produto de duas matrizes triangulares superiores, que resulta em uma matriz triangular superior.
VI. Uma matriz que √© simultaneamente triangular inferior e superior deve ser diagonal. Seja $D = P_2^{-1}P_1 = P_2'(P_1')^{-1}$.
VII.  Portanto, $P_1 = P_2D$. Substituindo na fatora√ß√£o de Cholesky, temos $\Omega = P_1P_1' = P_2DD'P_2'$.
VIII. Como $P_1P_1' = P_2P_2'$, temos $P_2P_2' = P_2DD'P_2'$, o que implica $P_2' = DD'P_2'$. Multiplicando por $(P_2')^{-1}$ √† direita, obtemos $I = DD'$, onde $I$ √© a matriz identidade.
IX. Como $D$ √© diagonal e $DD'=I$, ent√£o $D$ deve ser uma matriz identidade ou uma matriz diagonal com elementos diagonais iguais a $\pm 1$. Como os elementos diagonais de $P_1$ e $P_2$ s√£o positivos (pelo Corol√°rio 1), a matriz $D$ deve ter elementos diagonais iguais a 1, o que implica $D=I$.
X.  Portanto, $P_1 = P_2$, e a fatora√ß√£o de Cholesky √© √∫nica. $\blacksquare$

**Teorema 2.1:** Se $\Omega$ √© uma matriz sim√©trica definida positiva, ent√£o $\Omega^{-1}$ tamb√©m √© sim√©trica definida positiva e sua fatora√ß√£o de Cholesky pode ser obtida a partir da fatora√ß√£o de Cholesky de $\Omega$.

*Prova:*
I. Seja $\Omega$ uma matriz sim√©trica definida positiva. Ent√£o $\Omega = PP'$, onde $P$ √© uma matriz triangular inferior com elementos diagonais positivos.
II. Sabemos que $\Omega^{-1}$ existe e √© tamb√©m sim√©trica. Para mostrar que √© definida positiva, precisamos mostrar que $x^T\Omega^{-1}x > 0$ para todo $x \neq 0$.
III. Seja $y = P'x$. Ent√£o $x = (P')^{-1}y$, e $x^T = y^T(P^{-1})$.
IV. Substituindo na express√£o, temos $x^T\Omega^{-1}x = y^T(P^{-1})(PP')^{-1}(P')^{-1}y = y^T(P^{-1})(P')^{-1}P^{-1}y = y^T(P^{-1})(P^{-1})^Ty = (P^{-1}y)^T(P^{-1}y)$.
V. Seja $z = P^{-1}y$. Ent√£o $x^T\Omega^{-1}x = z^Tz = \sum_i z_i^2 > 0$ para todo $x \neq 0$, j√° que $P$ e portanto $P^{-1}$ s√£o invert√≠veis, o que implica que $z \ne 0$ quando $x \ne 0$. Portanto, $\Omega^{-1}$ √© definida positiva.
VI. Al√©m disso, $\Omega^{-1} = (PP')^{-1} = (P')^{-1}P^{-1} = (P^{-1})^T P^{-1}$. Se definirmos $Q = P^{-1}$, que √© triangular inferior pois $P$ tamb√©m o √©, temos que $\Omega^{-1} = Q'Q$, que √© uma fatora√ß√£o de Cholesky de $\Omega^{-1}$.
VII. Logo, a fatora√ß√£o de Cholesky de $\Omega^{-1}$ √© obtida pelo inverso da matriz $P$ da fatora√ß√£o de Cholesky de $\Omega$. $\blacksquare$

### Conclus√£o
A fatora√ß√£o de Cholesky, como uma forma especializada de fatora√ß√£o triangular que envolve a raiz quadrada dos elementos da matriz diagonal $D$, √© uma ferramenta essencial para otimizar c√°lculos com matrizes sim√©tricas definidas positivas. As propriedades de unicidade, efici√™ncia computacional e estabilidade num√©rica da fatora√ß√£o de Cholesky fazem com que ela seja amplamente utilizada em diversas aplica√ß√µes, desde a resolu√ß√£o de sistemas lineares at√© a otimiza√ß√£o e a simula√ß√£o num√©rica. A representa√ß√£o da matriz original atrav√©s de um produto de uma matriz triangular inferior por sua transposta simplifica os c√°lculos e possibilita a cria√ß√£o de rotinas computacionais mais r√°pidas e eficientes.

### Refer√™ncias
[^4]: *A refer√™ncia geral ao cap√≠tulo 4 do livro √© utilizada para contextualizar as informa√ß√µes apresentadas.*
<!-- END -->
