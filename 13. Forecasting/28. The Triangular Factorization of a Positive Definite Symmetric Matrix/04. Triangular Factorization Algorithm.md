## Fatora√ß√£o Triangular: O Algoritmo de Elimina√ß√£o e Matrizes Elementares
### Introdu√ß√£o
Este cap√≠tulo do livro aprofunda o algoritmo para a obten√ß√£o da fatora√ß√£o triangular de uma matriz sim√©trica definida positiva $\Omega$, descrevendo detalhadamente como a elimina√ß√£o de elementos por meio de opera√ß√µes de linha resulta em uma sequ√™ncia de matrizes com 1s na diagonal principal [^4]. Exploraremos como essa elimina√ß√£o progressiva, com o aux√≠lio de matrizes elementares, constr√≥i a fatora√ß√£o triangular, um processo fundamental em muitas aplica√ß√µes estat√≠sticas e econom√©tricas [^4]. Ao entendermos o algoritmo, teremos um controle completo sobre a manipula√ß√£o de matrizes para a resolu√ß√£o de sistemas lineares e outras opera√ß√µes.

### O Algoritmo de Elimina√ß√£o e as Matrizes Elementares
O algoritmo para a fatora√ß√£o triangular de uma matriz sim√©trica definida positiva $\Omega$ envolve uma sequ√™ncia de opera√ß√µes de elimina√ß√£o que visam zerar os elementos abaixo da diagonal principal. Essas opera√ß√µes s√£o realizadas por meio de pr√©-multiplica√ß√£o e p√≥s-multiplica√ß√£o da matriz $\Omega$ por matrizes elementares.

**Matrizes Elementares e Opera√ß√µes de Linha**
As matrizes elementares $E_k$ s√£o matrizes triangulares inferiores com 1s na diagonal principal e um √∫nico elemento diferente de zero abaixo da diagonal, na $k$-√©sima coluna. Cada $E_k$ √© projetada para eliminar os elementos abaixo da diagonal na $k$-√©sima coluna da matriz que est√° sendo transformada.

>üí° **Exemplo Gen√©rico:**  Uma matriz elementar $E_k$ tem a forma:
>
>$$
E_k = \begin{bmatrix}
1 & 0 & \cdots & 0 & \cdots & 0 \\
0 & 1 & \cdots & 0 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & 1 & \cdots & 0 \\
0 & 0 & \cdots & -l_{ik} & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & 0 & \cdots & 1
\end{bmatrix}
$$
>
>Onde $-l_{ik}$ √© um multiplicador utilizado para zerar o elemento na posi√ß√£o $(i,k)$ na matriz que est√° sendo transformada. Observe que todos os outros elementos fora da diagonal principal s√£o zero, e na diagonal principal, todos s√£o 1.

Ao pr√©-multiplicar a matriz $\Omega$ por $E_k$, realizamos opera√ß√µes de linha na matriz $\Omega$ da seguinte forma:

- A $k$-√©sima linha permanece inalterada.
- As linhas abaixo da $k$-√©sima linha t√™m um m√∫ltiplo da linha $k$ subtra√≠do.
  Especificamente, a $i$-√©sima linha de $\Omega$ passa a ser a linha $i$ de $\Omega$ menos $l_{ik}$ vezes a linha $k$ de $\Omega$.

Ao p√≥s-multiplicar a matriz resultante por $E_k'$, onde $E_k'$ √© a transposta de $E_k$, realizamos opera√ß√µes de coluna da seguinte forma:
- A $k$-√©sima coluna permanece inalterada.
- As colunas √† direita da $k$-√©sima coluna tem um m√∫ltiplo da coluna $k$ subtra√≠do.

**Processo Iterativo de Elimina√ß√£o**
O algoritmo de fatora√ß√£o triangular envolve um processo iterativo, onde as matrizes elementares s√£o aplicadas sequencialmente para eliminar os elementos abaixo da diagonal principal, linha a linha e coluna a coluna:

1.  **Primeira Etapa (k=1):**
    -  Definimos a matriz elementar $E_1$ como:
$$
E_1 = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
-\Omega_{21}\Omega_{11}^{-1} & 1 & 0 & \cdots & 0 \\
-\Omega_{31}\Omega_{11}^{-1} & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
-\Omega_{n1}\Omega_{11}^{-1} & 0 & 0 & \cdots & 1
\end{bmatrix}
$$
     onde $-\Omega_{i1}\Omega_{11}^{-1}$ s√£o os elementos da primeira coluna abaixo da diagonal principal utilizados para zerar os elementos abaixo do piv√¥ $(1,1)$.
    - Pr√©-multiplicamos $\Omega$ por $E_1$ e p√≥s-multiplicamos por $E_1'$ :
    $$ H_1 = E_1 \Omega E_1' $$
     O resultado dessa opera√ß√£o √© a matriz $H_1$, que possui zeros abaixo da diagonal principal na primeira coluna.

2.  **Segunda Etapa (k=2):**
    -  Definimos a matriz elementar $E_2$ com base na matriz $H_1$. Utilizamos o piv√¥ na posi√ß√£o (2,2) para zerar os elementos abaixo dele:
       $$
E_2 = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
0 & 1 & 0 & \cdots & 0 \\
0 & -h_{32}h_{22}^{-1} & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & -h_{n2}h_{22}^{-1} & 0 & \cdots & 1
\end{bmatrix}
$$
        onde $-h_{i2}h_{22}^{-1}$ s√£o os elementos da segunda coluna abaixo da diagonal principal da matriz $H_1$ utilizados para zerar os elementos abaixo do piv√¥ (2,2).
    - Pr√©-multiplicamos $H_1$ por $E_2$ e p√≥s-multiplicamos por $E_2'$:
     $$ H_2 = E_2 H_1 E_2'$$
      O resultado dessa opera√ß√£o √© a matriz $H_2$, que possui zeros abaixo da diagonal principal na primeira e segunda colunas.

3.  **Etapas Subsequentes:** Este processo √© repetido para as colunas subsequentes at√© a $(n-1)$-√©sima coluna. Ap√≥s $n-1$ etapas, obtemos a matriz diagonal $D$:
   $$D = E_{n-1} \cdots E_2 E_1 \Omega E_1' E_2' \cdots E_{n-1}'$$

>üí° **Exemplo Num√©rico:**  Vamos considerar uma matriz $\Omega$ 3x3:
>$$
\Omega = \begin{bmatrix}
4 & 2 & 2 \\
2 & 5 & 3 \\
2 & 3 & 6
\end{bmatrix}
$$
>Na primeira etapa, calculamos $E_1$. Os multiplicadores s√£o:
>
> $l_{21} = \Omega_{21}\Omega_{11}^{-1} = 2/4 = 0.5$
>
> $l_{31} = \Omega_{31}\Omega_{11}^{-1} = 2/4 = 0.5$
>
> Assim, a matriz $E_1$ √©:
>$$
E_1 = \begin{bmatrix}
1 & 0 & 0 \\
-0.5 & 1 & 0 \\
-0.5 & 0 & 1
\end{bmatrix}
$$
>
>Calculamos $H_1 = E_1\Omega E_1'$:
>
>$\text{Step 1: } E_1\Omega = \begin{bmatrix} 1 & 0 & 0 \\ -0.5 & 1 & 0 \\ -0.5 & 0 & 1 \end{bmatrix} \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix} = \begin{bmatrix} 4 & 2 & 2 \\ 0 & 4 & 2 \\ 0 & 2 & 5 \end{bmatrix}$
>
>$\text{Step 2: } H_1 = (E_1\Omega)E_1' =  \begin{bmatrix} 4 & 2 & 2 \\ 0 & 4 & 2 \\ 0 & 2 & 5 \end{bmatrix}\begin{bmatrix} 1 & -0.5 & -0.5 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix} = \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 2 \\ 0 & 2 & 5 \end{bmatrix}$
>
>
>
>Na segunda etapa, $E_2$ √© calculada usando $H_1$:
>
>$l_{32} = h_{32}h_{22}^{-1} = 2/4 = 0.5$
>
>
>$$
E_2 = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -0.5 & 1
\end{bmatrix}
$$
>e a matriz $H_2 = E_2 H_1 E_2'$ √©:
>
>$\text{Step 1: } E_2 H_1 = \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & -0.5 & 1 \end{bmatrix} \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 2 \\ 0 & 2 & 5 \end{bmatrix} = \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 2 \\ 0 & 0 & 4 \end{bmatrix}$
>
>$\text{Step 2: } H_2 = (E_2 H_1)E_2' = \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 2 \\ 0 & 0 & 4 \end{bmatrix} \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & -0.5 \\ 0 & 0 & 1 \end{bmatrix} = \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 4 \end{bmatrix}$
>
>Assim, $D = H_2$.
>
>Observe como a matriz $H_1$ tem zeros na primeira coluna abaixo da diagonal, e $H_2$ tem zeros na primeira e segunda colunas abaixo da diagonal.

**Matrizes A e D a partir das Transforma√ß√µes**
A matriz $A$ √© obtida pela combina√ß√£o das inversas das matrizes elementares:
$$
A = (E_{n-1} \cdots E_2 E_1)^{-1} = E_1^{-1}E_2^{-1} \cdots E_{n-1}^{-1}
$$
Como cada $E_k$ √© uma matriz triangular inferior com 1s na diagonal, sua inversa $E_k^{-1}$ tamb√©m √© uma matriz triangular inferior com 1s na diagonal. A inversa $E_k^{-1}$ √© obtida trocando o sinal do elemento abaixo da diagonal em $E_k$. O produto das inversas $E_k^{-1}$ resulta na matriz $A$ da fatora√ß√£o triangular.

> üí° **Exemplo Num√©rico:**  No exemplo anterior, calculamos as inversas de $E_1$ e $E_2$:
>$$
E_1^{-1} = \begin{bmatrix}
1 & 0 & 0 \\
0.5 & 1 & 0 \\
0.5 & 0 & 1
\end{bmatrix}
$$
>$$
E_2^{-1} = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0.5 & 1
\end{bmatrix}
$$
>
>A matriz $A$ √© ent√£o calculada como:
>$$
A = E_1^{-1}E_2^{-1} = \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0 & 1 \end{bmatrix}\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0.5 & 1 \end{bmatrix} = \begin{bmatrix}
1 & 0 & 0 \\
0.5 & 1 & 0 \\
0.5 & 0.5 & 1
\end{bmatrix}
$$
>Observe que a matriz A tem 1s na diagonal principal, e os elementos abaixo da diagonal s√£o os multiplicadores utilizados nas opera√ß√µes de elimina√ß√£o (com sinal oposto). A matriz diagonal $D$ √© a matriz resultante da transforma√ß√£o completa, $D = H_2 = E_2 H_1 E_2'$.
>
>Finalmente, podemos verificar que $\Omega = ADA'$:
>
>$\text{Step 1: } DA' = \begin{bmatrix} 4 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 4 \end{bmatrix} \begin{bmatrix} 1 & 0.5 & 0.5 \\ 0 & 1 & 0.5 \\ 0 & 0 & 1 \end{bmatrix} = \begin{bmatrix} 4 & 2 & 2 \\ 0 & 4 & 2 \\ 0 & 0 & 4 \end{bmatrix}$
>
>$\text{Step 2: } ADA' =  \begin{bmatrix} 1 & 0 & 0 \\ 0.5 & 1 & 0 \\ 0.5 & 0.5 & 1 \end{bmatrix}\begin{bmatrix} 4 & 2 & 2 \\ 0 & 4 & 2 \\ 0 & 0 & 4 \end{bmatrix} = \begin{bmatrix} 4 & 2 & 2 \\ 2 & 5 & 3 \\ 2 & 3 & 6 \end{bmatrix} = \Omega$

**Lema 2** A matriz elementar inversa $E_k^{-1}$ √© obtida trocando o sinal dos elementos abaixo da diagonal principal.
*Prova:*
I. Seja $E_k$ uma matriz elementar com elementos n√£o nulos abaixo da diagonal principal na $k$-√©sima coluna, denotados por $-l_{ik}$.
II.  Definimos a inversa $E_k^{-1}$ como uma matriz id√™ntica a $E_k$ exceto por ter os elementos $l_{ik}$ em vez de $-l_{ik}$.
III.  Ao multiplicar $E_k$ por $E_k^{-1}$, verificamos que o resultado √© a matriz identidade, $I$, pois o produto cancela os elementos fora da diagonal principal. Ou seja, cada entrada fora da diagonal principal de $E_k E_k^{-1}$ corresponde a uma opera√ß√£o da forma $(-l_{ik})+(l_{ik}) = 0$.
IV.  De forma similar, o produto $E_k^{-1} E_k$ tamb√©m resulta na matriz identidade. Portanto, $E_k^{-1}$ √© de fato a inversa de $E_k$. $\blacksquare$

**Teorema 2** O algoritmo de elimina√ß√£o de elementos abaixo da diagonal principal por meio de opera√ß√µes de linha, representadas por matrizes elementares, resulta na fatora√ß√£o triangular $\Omega = ADA'$, onde $A$ √© uma matriz triangular inferior com 1s na diagonal principal e $D$ √© uma matriz diagonal com entradas positivas.
*Prova:*
I.  O algoritmo de elimina√ß√£o transforma a matriz $\Omega$ em uma matriz diagonal $D$ por meio de uma sequ√™ncia de opera√ß√µes de pr√© e p√≥s-multiplica√ß√£o com matrizes elementares $E_k$.
II.  A matriz $A$ √© obtida pela combina√ß√£o das inversas das matrizes elementares: $A = (E_{n-1} \cdots E_2 E_1)^{-1}$.
III. A inversa $E_k^{-1}$ √© uma matriz triangular inferior com 1s na diagonal, com as entradas abaixo da diagonal sendo o oposto dos elementos da matriz $E_k$.
IV.  O produto das inversas das matrizes elementares, $E_1^{-1} E_2^{-1} \cdots E_{n-1}^{-1}$, resulta em uma matriz triangular inferior $A$ com 1s na diagonal principal.
V.  A fatora√ß√£o $\Omega = ADA'$ √© obtida aplicando as matrizes $E_k$ de forma iterativa, conforme demonstrado nas proposi√ß√µes anteriores.
VI.  Portanto, o algoritmo resulta na fatora√ß√£o triangular $\Omega = ADA'$, onde $A$ √© uma matriz triangular inferior com 1s na diagonal principal e $D$ √© uma matriz diagonal com entradas positivas. $\blacksquare$

**Teorema 2.1** A matriz $A$ obtida no Teorema 2, al√©m de ser triangular inferior com 1s na diagonal, tem a propriedade de que seus elementos abaixo da diagonal na $k$-√©sima coluna s√£o exatamente os multiplicadores $l_{ik}$ utilizados na elimina√ß√£o da $k$-√©sima coluna, para $i > k$.
*Prova:*
I.  Pelo Lema 2, a inversa de uma matriz elementar $E_k$ √© obtida trocando o sinal dos elementos abaixo da diagonal principal.
II.  A matriz $A$ √© o produto das inversas das matrizes elementares, ou seja, $A = E_1^{-1}E_2^{-1}\cdots E_{n-1}^{-1}$.
III. Cada matriz $E_k^{-1}$ introduz os multiplicadores $l_{ik}$ nas posi√ß√µes $(i,k)$ para $i>k$ na $k$-√©sima coluna.
IV. Como as matrizes $E_k^{-1}$ s√£o triangulares inferiores, o produto $E_1^{-1}E_2^{-1}\cdots E_{n-1}^{-1}$ acumula esses multiplicadores abaixo da diagonal, mantendo os 1s na diagonal.
V. Portanto, os elementos abaixo da diagonal na $k$-√©sima coluna da matriz $A$ correspondem aos multiplicadores $l_{ik}$ utilizados na elimina√ß√£o da $k$-√©sima coluna. $\blacksquare$

**Lema 2.1** A matriz diagonal $D$ obtida no Teorema 2 √© dada por $D_{ii} = h_{ii}$ em cada etapa do processo de elimina√ß√£o.
*Prova:*
I.  A matriz diagonal $D$ √© o resultado final da aplica√ß√£o das matrizes elementares na matriz $\Omega$, ou seja, $D= E_{n-1} \cdots E_2 E_1 \Omega E_1' E_2' \cdots E_{n-1}'$.
II. Em cada etapa $k$ do processo, a matriz $H_k = E_k H_{k-1} E_k'$ possui zeros abaixo da diagonal principal nas primeiras $k$ colunas.
III. Os elementos diagonais $h_{ii}$ das matrizes $H_k$ para cada etapa $k$ s√£o mantidos inalterados pelas matrizes elementares subsequentes $E_{k+1}, \dots, E_{n-1}$.
IV. Ao final das $n-1$ etapas, a matriz resultante $D$ √© diagonal, e seus elementos diagonais correspondem aos elementos $h_{ii}$ das matrizes $H_k$ nas respectivas posi√ß√µes.
V.  Portanto, $D_{ii} = h_{ii}$ em cada etapa do processo de elimina√ß√£o. $\blacksquare$

**Observa√ß√£o 1** Uma vez que $\Omega$ √© sim√©trica e definida positiva, os elementos diagonais de $D$ s√£o estritamente positivos, e a fatora√ß√£o $ADA'$ √© √∫nica. Isso √© importante para garantir que a raiz quadrada da matriz $D$ seja bem definida e possa ser utilizada na decomposi√ß√£o de Cholesky.

### Conclus√£o
O algoritmo para obter a fatora√ß√£o triangular de uma matriz sim√©trica definida positiva $\Omega$ envolve a aplica√ß√£o sequencial de matrizes elementares que, por meio de pr√© e p√≥s-multiplica√ß√£o, transformam a matriz original em uma matriz diagonal $D$. A matriz $A$ √© obtida pela combina√ß√£o das inversas dessas matrizes elementares, formando uma matriz triangular inferior com 1s na diagonal. Este processo, que se baseia na elimina√ß√£o de elementos fora da diagonal principal, √© fundamental para diversas aplica√ß√µes em estat√≠stica, econometria e outras √°reas da matem√°tica aplicada. A compreens√£o detalhada do algoritmo e do papel das matrizes elementares √© essencial para a implementa√ß√£o eficiente e para a interpreta√ß√£o dos resultados obtidos com a fatora√ß√£o triangular.

### Refer√™ncias
[^4]: *A refer√™ncia geral ao cap√≠tulo 4 do livro √© utilizada para contextualizar as informa√ß√µes apresentadas.*
<!-- END -->
