## Previs√£o com o Modelo ARMA(1,1)
### Introdu√ß√£o
Neste cap√≠tulo, vamos aprofundar o conceito de previs√£o, concentrando-nos especificamente no modelo ARMA(1,1). Este modelo, como mencionado anteriormente, combina as caracter√≠sticas dos modelos autorregressivos (AR) e de m√©dias m√≥veis (MA) [^44]. O modelo ARMA(1,1) oferece uma abordagem flex√≠vel para modelar dados que exibem tanto uma estrutura de decaimento exponencial, capturada pelo componente AR, quanto o impacto de eventos de curto prazo, capturado pelo componente MA. Como vimos em cap√≠tulos anteriores, os modelos AR e MA t√™m suas pr√≥prias for√ßas e limita√ß√µes, e a combina√ß√£o desses dois aspectos no modelo ARMA(1,1) oferece uma maior capacidade de adapta√ß√£o a uma variedade de padr√µes de s√©ries temporais.

### Conceitos Fundamentais
O modelo ARMA(1,1) √© definido como [^44]:
$$ (1 - \phi L)(Y_t - \mu) = (1 + \theta L)\epsilon_t $$
Onde:
- $Y_t$ representa a s√©rie temporal no tempo *t*.
- $\mu$ √© a m√©dia da s√©rie temporal.
- $L$ √© o operador de defasagem.
- $\phi$ √© o par√¢metro autoregressivo.
- $\theta$ √© o par√¢metro de m√©dia m√≥vel.
- $\epsilon_t$ √© o ru√≠do branco, com m√©dia zero e vari√¢ncia $\sigma^2$ [^44].

A equa√ß√£o acima pode ser reescrita para expressar $Y_t$ em termos de seus valores passados e do ru√≠do branco atual e passado:
$$ Y_t = \mu + \phi(Y_{t-1} - \mu) + \epsilon_t + \theta \epsilon_{t-1} $$
Para realizar a previs√£o com o modelo ARMA(1,1), utilizamos a f√≥rmula de Wiener-Kolmogorov [^44], que, conforme visto anteriormente, √© uma forma de obter a proje√ß√£o linear √≥tima de $Y_{t+s}$ dados os valores passados da s√©rie. A equa√ß√£o [4.2.16] do contexto nos fornece esta f√≥rmula como:
$$ \hat{Y}_{t+s|t} = \mu + \frac{[\frac{\psi(L)}{L^s}]_+}{\psi(L)}(Y_t - \mu) $$
onde $\psi(L)$ √© o polin√¥mio MA, definido como $\psi(L) = \sum_{j=0}^{\infty} \psi_jL^j$ [^44]. No caso do modelo ARMA(1,1), temos $\psi(L) = \frac{1+\theta L}{1-\phi L}$ [^44].

Para o modelo ARMA(1,1), onde a equa√ß√£o √© dada por:
$$(1-\phi L)(Y_t - \mu) = (1+\theta L)\epsilon_t$$
podemos obter a seguinte rela√ß√£o para a previs√£o de um per√≠odo √† frente ($s=1$):
$$\hat{Y}_{t+1|t} = \mu + \frac{1+\theta L}{1-\phi L}\frac{1}{L}(Y_t - \mu)$$
Utilizando a expans√£o em s√©rie para obter o termo $[(1+\theta L)/L]_+$ e usando o resultado apresentado em [^44] (4.2.38), obtemos:
$$
\frac{[\frac{1+\theta L}{1-\phi L}]_+}{L}=\frac{\phi + \theta \phi^{-1}}{1-\phi L}
$$
Ent√£o a previs√£o de um passo a frente pode ser escrita como:
$$\hat{Y}_{t+1|t} = \mu + \frac{\phi + \theta}{1-\phi L}(Y_t - \mu)$$
$$
\hat{Y}_{t+1|t} = \mu + \frac{\phi + \theta\phi^{-1}}{1-\phi L}(Y_t - \mu) = \mu + \frac{\phi + \theta}{1 - \phi L}(Y_t - \mu)
$$
Aplicando o resultado da equa√ß√£o [4.2.39] temos:
$$ \hat{Y}_{t+1|t} = \mu + \frac{\phi + \theta}{1+\theta L} (Y_t - \mu) $$
Ao considerar a previs√£o para um horizonte *s*, a f√≥rmula geral se torna:
$$ \hat{Y}_{t+s|t} = \mu + \frac{(\phi + \theta \phi^{s-1})}{1+\theta L}(Y_t - \mu) $$
ou, usando a equa√ß√£o [4.2.40] como refer√™ncia e generalizando, a previs√£o para um per√≠odo √† frente √© dada por:
$$ \hat{Y}_{t+1|t} = \mu + \frac{\phi + \theta}{1+\theta L}(Y_t - \mu) $$
que pode ser reescrita como
$$ \hat{Y}_{t+1|t} = \mu + \phi (Y_t - \mu) + \theta\epsilon_t $$
onde $\epsilon_t$ √© definido de forma recursiva utilizando os dados hist√≥ricos, como apresentado em [^44] (4.2.42). De maneira similar √† previs√£o para um passo a frente, a previs√£o para m√∫ltiplos passos √© obtida de forma iterativa atrav√©s do uso de valores estimados para a previs√£o do passo anterior.
Para previs√µes com horizonte *s* > 1, o termo $(Y_t - \mu)$ √© substitu√≠do pela previs√£o de $Y_t$ no passo anterior e o termo $\epsilon_t$ √© substitu√≠do por zero. Para simplificar a nota√ß√£o, vamos denotar $\hat{Y}_{t+k|t}$ por $\hat{Y}_{t+k}$. Ent√£o, as previs√µes para horizonte maior que 1 podem ser expressas recursivamente como:
$$ \hat{Y}_{t+s} = \mu + \phi (\hat{Y}_{t+s-1} - \mu), \quad \text{para} \quad s > 1. $$
Onde $\hat{Y}_{t+s-1}$ √© a previs√£o de um passo anterior, ou seja, $\hat{Y}_{t+s-1|t}$. Notavelmente, para a previs√£o de dois passos √† frente, temos:
$$ \hat{Y}_{t+2} = \mu + \phi (\hat{Y}_{t+1} - \mu) $$
onde  $\hat{Y}_{t+1}$ foi calculado pelo passo anterior.

√â importante notar que, na pr√°tica, a estimativa do termo $\epsilon_t$ para o c√°lculo de $\hat{Y}_{t+1|t}$ requer o conhecimento dos res√≠duos at√© o tempo *t*. Como $\epsilon_t$ n√£o √© diretamente observ√°vel, ele √© geralmente aproximado pelos res√≠duos do modelo, ou seja, a diferen√ßa entre os valores observados e os valores ajustados do modelo.
> üí° **Exemplo Num√©rico:**
>
> Suponha que temos uma s√©rie temporal com os seguintes par√¢metros do modelo ARMA(1,1):
> - M√©dia ($\mu$) = 10
> - Par√¢metro AR ($\phi$) = 0.7
> - Par√¢metro MA ($\theta$) = 0.4
> - Observa√ß√£o no tempo *t* ($Y_t$) = 12
> - Erro no tempo *t* ($\epsilon_t$) = 0.5 (estimado a partir dos res√≠duos do modelo).
>
> Podemos calcular a previs√£o de um passo √† frente ($\hat{Y}_{t+1|t}$) usando a f√≥rmula:
> $$ \hat{Y}_{t+1|t} = \mu + \phi (Y_t - \mu) + \theta\epsilon_t $$
>
> Substituindo os valores:
> $$ \hat{Y}_{t+1|t} = 10 + 0.7 (12 - 10) + 0.4 \times 0.5 $$
> $$ \hat{Y}_{t+1|t} = 10 + 0.7 \times 2 + 0.2 $$
> $$ \hat{Y}_{t+1|t} = 10 + 1.4 + 0.2 $$
> $$ \hat{Y}_{t+1|t} = 11.6 $$
>
> Portanto, a previs√£o para o pr√≥ximo per√≠odo √© 11.6. Este valor √© influenciado pela observa√ß√£o anterior (12), pela m√©dia da s√©rie (10), pelo par√¢metro AR (0.7), e pelo erro do per√≠odo anterior (0.5) com peso 0.4.

**Observa√ß√£o 1:** *A recursividade na previs√£o do modelo ARMA(1,1) introduz uma depend√™ncia das previs√µes em rela√ß√£o aos valores previstos anteriormente. Este comportamento √© caracter√≠stico de modelos autorregressivos, onde erros em previs√µes anteriores podem se propagar e afetar previs√µes futuras.*
> üí° **Exemplo Num√©rico (Previs√£o Multi-passo):**
>
> Continuando o exemplo anterior, vamos calcular a previs√£o para dois passos √† frente ($\hat{Y}_{t+2|t}$). Utilizamos a f√≥rmula recursiva:
> $$ \hat{Y}_{t+2} = \mu + \phi (\hat{Y}_{t+1} - \mu) $$
>
> Usando a previs√£o de um passo √† frente ($\hat{Y}_{t+1} = 11.6$) e os mesmos par√¢metros:
> $$ \hat{Y}_{t+2} = 10 + 0.7 (11.6 - 10) $$
> $$ \hat{Y}_{t+2} = 10 + 0.7 \times 1.6 $$
> $$ \hat{Y}_{t+2} = 10 + 1.12 $$
> $$ \hat{Y}_{t+2} = 11.12 $$
>
> Observe que para calcular $\hat{Y}_{t+2}$ n√£o usamos o termo $\theta \epsilon_{t+1}$ , pois no horizonte de dois passos o erro $\epsilon_{t+1}$ √© assumido como zero, e usamos o valor previsto $\hat{Y}_{t+1}$ no lugar de uma observa√ß√£o real.
>
> Se quisermos calcular $\hat{Y}_{t+3}$, teremos:
>
>$$ \hat{Y}_{t+3} = 10 + 0.7 (11.12 - 10) $$
>$$ \hat{Y}_{t+3} = 10 + 0.7 \times 1.12 $$
>$$ \hat{Y}_{t+3} = 10 + 0.784 $$
>$$ \hat{Y}_{t+3} = 10.784 $$
>
> Observe como a previs√£o est√° tendendo para a m√©dia de 10.

Adicionalmente, podemos analisar o comportamento das previs√µes a longo prazo. Para o modelo ARMA(1,1), como $\abs{\phi}<1$, as previs√µes convergem para a m√©dia $\mu$ conforme o horizonte de previs√£o *s* aumenta. Formalmente, isso pode ser expresso como:

**Proposi√ß√£o 1:** *Para o modelo ARMA(1,1), √† medida que o horizonte de previs√£o s tende ao infinito, a previs√£o $\hat{Y}_{t+s|t}$ converge para a m√©dia da s√©rie temporal $\mu$ , i.e.,*
$$ \lim_{s \to \infty} \hat{Y}_{t+s|t} = \mu $$

*Prova:*
Vamos provar que $\lim_{s \to \infty} \hat{Y}_{t+s|t} = \mu$.

I. A previs√£o recursiva para o modelo ARMA(1,1) √© dada por:
   $$ \hat{Y}_{t+s} = \mu + \phi (\hat{Y}_{t+s-1} - \mu) $$

II. Podemos reescrever a equa√ß√£o acima como:
   $$ \hat{Y}_{t+s} - \mu = \phi (\hat{Y}_{t+s-1} - \mu) $$
    
III. Seja $z_s = \hat{Y}_{t+s} - \mu$. Ent√£o temos
  $$ z_s = \phi z_{s-1} $$

IV. Aplicando a recorr√™ncia, temos:
  $$ z_s = \phi z_{s-1} = \phi^2 z_{s-2} = \cdots = \phi^{s-1} z_1 $$
   onde $z_1 = \hat{Y}_{t+1} - \mu$.

V. Portanto,
  $$ \hat{Y}_{t+s} - \mu = \phi^{s-1} (\hat{Y}_{t+1} - \mu) $$
  $$ \hat{Y}_{t+s} = \mu + \phi^{s-1} (\hat{Y}_{t+1} - \mu) $$

VI. Dado que $|\phi| < 1$, quando $s \to \infty$, temos $\phi^{s-1} \to 0$. Logo,

$$ \lim_{s \to \infty} \hat{Y}_{t+s|t} = \lim_{s \to \infty} [\mu + \phi^{s-1} (\hat{Y}_{t+1} - \mu)] = \mu + 0 \cdot (\hat{Y}_{t+1} - \mu) = \mu $$

Portanto, a previs√£o $\hat{Y}_{t+s|t}$ converge para a m√©dia $\mu$ quando $s \to \infty$. ‚ñ†

A converg√™ncia das previs√µes para a m√©dia a longo prazo demonstra a estabilidade do modelo ARMA(1,1) e seu comportamento previs√≠vel em horizontes mais distantes, que se torna um valor estacion√°rio independente dos valores observados no tempo *t*.
> üí° **Exemplo Num√©rico (Converg√™ncia para a M√©dia):**
>
> Continuando o exemplo anterior, onde $\mu = 10$ e $\phi = 0.7$, vamos demonstrar a converg√™ncia da previs√£o a longo prazo. Calculamos as previs√µes para os pr√≥ximos 10 passos:
>
>   | Passo (s) | Previs√£o ($\hat{Y}_{t+s}$) |
>   |----------|---------------------------|
>   | 1         | 11.6                     |
>   | 2         | 11.12                    |
>   | 3         | 10.784                   |
>   | 4         | 10.5488                  |
>   | 5         | 10.3842                  |
>   | 6         | 10.2689                  |
>   | 7         | 10.1882                  |
>   | 8         | 10.1317                  |
>   | 9         | 10.0922                  |
>   | 10        | 10.0645                  |
>
> Observe como as previs√µes se aproximam da m√©dia de 10 √† medida que o horizonte de previs√£o aumenta. Isso ilustra a propriedade de converg√™ncia demonstrada na proposi√ß√£o 1. A influ√™ncia da observa√ß√£o inicial ($Y_t$) diminui com o tempo, e a previs√£o se torna cada vez mais dependente apenas da m√©dia da s√©rie temporal.

### Conclus√£o
O modelo ARMA(1,1) oferece uma ferramenta flex√≠vel e poderosa para modelar e prever s√©ries temporais. A combina√ß√£o de componentes autorregressivos e de m√©dia m√≥vel permite que este modelo capture uma variedade mais ampla de padr√µes, incluindo o decaimento exponencial e os impactos de curto prazo. Atrav√©s da aplica√ß√£o da f√≥rmula de Wiener-Kolmogorov e das rela√ß√µes apresentadas, podemos obter previs√µes precisas e consistentes, com o cuidado devido √†s particularidades de cada modelo. As previs√µes de m√∫ltiplos passos podem ser obtidas de forma iterativa atrav√©s do uso de valores estimados para o passo anterior. A an√°lise detalhada e a aplica√ß√£o cuidadosa dessas t√©cnicas podem levar a uma previs√£o de s√©ries temporais mais eficaz.
### Refer√™ncias
[^44]: Contexto fornecido.
<!-- END -->
