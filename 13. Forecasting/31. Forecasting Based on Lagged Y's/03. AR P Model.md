## O Modelo AR(p): Uma Aproxima√ß√£o Pr√°tica para a Modelagem Autorregressiva

### Introdu√ß√£o
Em continuidade √† discuss√£o sobre a modelagem de s√©ries temporais usando representa√ß√µes autorregressivas, este cap√≠tulo se concentra no modelo **Autorregressivo de ordem p (AR(p))**. Como vimos anteriormente, a representa√ß√£o AR(‚àû) expressa uma s√©rie temporal como uma fun√ß√£o linear de todos os seus valores passados, o que, na pr√°tica, √© invi√°vel de implementar devido ao n√∫mero infinito de par√¢metros [^1, 2]. O modelo AR(p), como um caso especial da representa√ß√£o AR(‚àû), oferece uma forma pr√°tica e eficiente de modelar o componente autorregressivo de uma s√©rie temporal, utilizando apenas um n√∫mero finito *p* de defasagens [^2]. Este cap√≠tulo explorar√° em profundidade as caracter√≠sticas e propriedades do modelo AR(p), al√©m de sua relev√¢ncia para a modelagem e previs√£o de s√©ries temporais.

### Conceitos Fundamentais do Modelo AR(p)
O modelo AR(p) √© descrito pela seguinte equa√ß√£o:
$$(1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)(Y_t - \mu) = \epsilon_t$$
que pode ser expressa de forma mais compacta como $\phi(L)(Y_t - \mu) = \epsilon_t$ [^1], onde $\phi(L) = 1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p$ √© o operador autorregressivo de ordem *p*, $Y_t$ √© a s√©rie temporal, $\mu$ √© a m√©dia da s√©rie, e $\epsilon_t$ √© o termo de erro, um ru√≠do branco com m√©dia zero e vari√¢ncia constante [^1, 2]. A ordem *p* do modelo determina o n√∫mero de defasagens de $Y_t$ que s√£o usadas para prever o valor atual da s√©rie [^2].

**Observa√ß√£o 1**: O modelo AR(p) assume que o valor atual da s√©rie temporal, $Y_t$, depende apenas dos seus *p* valores passados mais um choque aleat√≥rio. Esta √© uma aproxima√ß√£o da representa√ß√£o AR(‚àû), onde a depend√™ncia se estende por todos os valores passados da s√©rie.

> üí° **Exemplo Num√©rico:** Considere um modelo AR(2) definido por $Y_t = 0.8Y_{t-1} - 0.3Y_{t-2} + \epsilon_t$. Neste caso, o valor de $Y_t$ depende linearmente dos dois valores passados, $Y_{t-1}$ e $Y_{t-2}$, al√©m de um choque aleat√≥rio $\epsilon_t$. Note que o modelo ignora qualquer influ√™ncia de $Y_{t-3}, Y_{t-4}$, e assim por diante, o que simplifica a estrutura do modelo e o processo de estima√ß√£o dos par√¢metros. Aqui $\phi_1 = 0.8$ e $\phi_2 = -0.3$. Se, por exemplo, $Y_{t-1} = 10$ e $Y_{t-2} = 5$, e considerando $\epsilon_t = 0.5$, ent√£o $Y_t = 0.8 * 10 - 0.3 * 5 + 0.5 = 8 - 1.5 + 0.5 = 7$.

Em contraste com o modelo MA(q), que modela a s√©rie temporal como uma fun√ß√£o linear de ru√≠dos brancos anteriores, o modelo AR(p) foca na rela√ß√£o linear entre o valor atual da s√©rie e seus valores defasados [^1, 2]. A escolha entre um modelo AR(p) e um modelo MA(q) ou ARMA(p,q) depender√° da natureza dos dados e do padr√£o de depend√™ncia temporal presente na s√©rie. Se a s√©rie apresentar uma forte depend√™ncia com os seus pr√≥prios valores passados, o modelo AR(p) pode ser uma escolha mais natural. Se, por outro lado, a s√©rie apresentar uma depend√™ncia mais forte com os ru√≠dos brancos anteriores, o modelo MA(q) pode ser mais apropriado. Os modelos ARMA(p,q) combinam ambas as estruturas, oferecendo maior flexibilidade para capturar diferentes padr√µes de depend√™ncia [^1].

**Proposi√ß√£o 1**: Um modelo AR(p) com $\mu = 0$ pode ser reescrito como $Y_t = \sum_{i=1}^{p} \phi_i Y_{t-i} + \epsilon_t$.
*Prova:*
I. A equa√ß√£o do modelo AR(p) √© dada por $(1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)(Y_t - \mu) = \epsilon_t$.
II. Se $\mu=0$, ent√£o $(1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)Y_t = \epsilon_t$.
III. Expandindo, temos $Y_t - \phi_1 Y_{t-1} - \phi_2 Y_{t-2} - \ldots - \phi_p Y_{t-p} = \epsilon_t$.
IV. Reorganizando, obtemos $Y_t = \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \ldots + \phi_p Y_{t-p} + \epsilon_t$, que pode ser expressa como $Y_t = \sum_{i=1}^{p} \phi_i Y_{t-i} + \epsilon_t$. ‚ñ†

O texto aborda a import√¢ncia da **estacionariedade** para o modelo AR(p) [^1]. Esta condi√ß√£o garante que as propriedades estat√≠sticas do processo (m√©dia, vari√¢ncia e autocovari√¢ncia) n√£o se alterem ao longo do tempo [^1]. A estacionariedade √© crucial para garantir que o modelo possa ser utilizado para previs√£o e an√°lise de s√©ries temporais.

**Lema 1.1**: Para um modelo AR(p) ser estacion√°rio, as ra√≠zes do polin√¥mio caracter√≠stico $\phi(z) = 1 - \phi_1 z - \phi_2 z^2 - \ldots - \phi_p z^p$ devem estar fora do c√≠rculo unit√°rio, ou seja, $|z_i| > 1$ para todas as ra√≠zes $z_i$.
*Prova:*
I. A equa√ß√£o de diferen√ßa do modelo AR(p) √© $(1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)(Y_t - \mu) = \epsilon_t$.
II. O polin√¥mio caracter√≠stico associado √© $\phi(z) = 1 - \phi_1 z - \phi_2 z^2 - \ldots - \phi_p z^p$.
III. A estacionariedade requer que a representa√ß√£o AR(‚àû) do modelo seja convergente.
IV. Isso implica que as ra√≠zes do polin√¥mio caracter√≠stico devem estar fora do c√≠rculo unit√°rio, ou seja, $|z_i| > 1$ para todas as ra√≠zes $z_i$. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere um modelo AR(1) dado por $Y_t = 0.9Y_{t-1} + \epsilon_t$. O polin√¥mio caracter√≠stico √© $\phi(z) = 1 - 0.9z$, cuja raiz √© $z = 1/0.9 = 1.11$. Como $|1.11| > 1$, o modelo AR(1) √© estacion√°rio. Se, em vez disso, tiv√©ssemos um modelo $Y_t = 1.1Y_{t-1} + \epsilon_t$, o polin√¥mio caracter√≠stico seria $1 - 1.1z$ com raiz $z = 1/1.1 = 0.9$. Como $|0.9| < 1$, o modelo n√£o seria estacion√°rio. Em termos pr√°ticos, se o coeficiente $\phi_1$ em um modelo AR(1) for maior ou igual a 1 em valor absoluto, a s√©rie n√£o retornar√° √† m√©dia ap√≥s um choque, o que torna a s√©rie n√£o estacion√°ria.

**Lema 1.2:** Um modelo AR(1) da forma $Y_t = \phi_1 Y_{t-1} + \epsilon_t$ √© estacion√°rio se $|\phi_1| < 1$.
*Prova:*
I. O polin√¥mio caracter√≠stico do modelo AR(1) √© $\phi(z) = 1 - \phi_1 z$.
II. A raiz do polin√¥mio √© $z = 1/\phi_1$.
III. Pelo Lema 1.1, a condi√ß√£o de estacionariedade √© $|z| > 1$, ou seja, $|1/\phi_1| > 1$.
IV. Isso implica que $|\phi_1| < 1$. ‚ñ†
Este resultado √© um caso especial do Lema 1.1 e √© √∫til para verificar a estacionariedade de modelos AR(1).

O texto explora a conex√£o entre o modelo AR(p) e a representa√ß√£o AR(‚àû) [^1, 2]. A representa√ß√£o AR(‚àû) pode ser vista como uma generaliza√ß√£o do modelo AR(p), onde o n√∫mero de defasagens √© infinito [^1]. O modelo AR(p) surge como uma aproxima√ß√£o pr√°tica dessa representa√ß√£o, truncando o n√∫mero de defasagens para um valor finito *p* [^2]. A escolha de um valor adequado para *p* √© crucial para garantir que o modelo AR(p) capture as caracter√≠sticas relevantes da s√©rie temporal, ao mesmo tempo que mant√©m um n√∫mero razo√°vel de par√¢metros para estimar [^2]. A an√°lise das fun√ß√µes de autocorrela√ß√£o e autocorrela√ß√£o parcial desempenha um papel importante na identifica√ß√£o de uma ordem apropriada para um modelo AR(p) ou ARMA(p,q) [^2].

**Teorema 2**: A representa√ß√£o AR(p) √© um caso especial da representa√ß√£o AR(‚àû) onde $\eta_j = 0$ para $j > p$.
*Prova:*
I. A representa√ß√£o AR(‚àû) √© definida como $\eta(L)(Y_t - \mu) = \epsilon_t$ onde $\eta(L) = \sum_{j=0}^{\infty} \eta_j L^j$.
II. O modelo AR(p) √© definido como $\phi(L)(Y_t - \mu) = \epsilon_t$ onde $\phi(L) = 1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p$.
III. Se definirmos $\eta_j = -\phi_j$ para $j=1,2,...,p$ e $\eta_j = 0$ para $j > p$, ent√£o $\eta(L) = 1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p$.
IV. Portanto, o modelo AR(p) √© um caso especial da representa√ß√£o AR(‚àû) onde $\eta_j = 0$ para $j > p$. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere a representa√ß√£o AR(‚àû) com coeficientes $\eta_j = 0.8^j$ para $j=1,2,...$. Se truncarmos esta representa√ß√£o em $p=2$, obteremos o modelo AR(2): $Y_t = 0.8Y_{t-1} + 0.64Y_{t-2} + \epsilon_t$. Isso demonstra como o modelo AR(p) emerge da representa√ß√£o AR(‚àû) atrav√©s do truncamento dos coeficientes de defasagem. Se truncarmos em $p=3$, ter√≠amos $Y_t = 0.8Y_{t-1} + 0.64Y_{t-2} + 0.512Y_{t-3} + \epsilon_t$.

O texto aborda as rela√ß√µes entre o modelo AR(p) e a previs√£o, enfatizando a import√¢ncia do operador de aniquila√ß√£o na express√£o da previs√£o √≥tima $\hat{E}[Y_{t+s}|Y_t, Y_{t-1},\ldots] = \mu + [\frac{\psi(L)}{L^s}]_+\eta(L)(Y_t-\mu)$ [^1, 2]. Para o modelo AR(p), o operador $\psi(L)$ √© igual a 1, o que simplifica a express√£o da previs√£o. Esta previs√£o utiliza recursivamente os valores passados de $Y_t$, com os pesos ajustados pelos coeficientes do modelo, e o operador de aniquila√ß√£o $[\cdot]_+$ para garantir que os termos com expoentes negativos de $L$ sejam ignorados [^1].

**Corol√°rio 2.1:** Para o modelo AR(p), a previs√£o de um passo √† frente √© dada por $\hat{E}[Y_{t+1}|Y_t, Y_{t-1},\ldots] = \mu + \phi_1(Y_t - \mu) + \phi_2(Y_{t-1} - \mu) + \ldots + \phi_p(Y_{t-p+1} - \mu)$.
*Prova:*
I. No modelo AR(p), $\psi(L) = 1$ e $\eta(L) = [\phi(L)]^{-1}$.
II. A previs√£o √≥tima √© dada por $\hat{E}[Y_{t+s}|Y_t, Y_{t-1},\ldots] = \mu + [\frac{\psi(L)}{L^s}]_+\eta(L)(Y_t-\mu)$.
III. Para um passo √† frente $(s=1)$, temos: $\hat{E}[Y_{t+1}|Y_t, Y_{t-1},\ldots] = \mu + [\frac{1}{L}]_+ [\phi(L)]^{-1} (Y_t - \mu)$.
IV. Como $[\frac{1}{L}]_+$ aniquila todos os termos com pot√™ncias negativas de $L$, a previs√£o de um passo √† frente corresponde √† express√£o: $\hat{E}[Y_{t+1}|Y_t, Y_{t-1},\ldots] = \mu + \phi_1(Y_t - \mu) + \phi_2(Y_{t-1} - \mu) + \ldots + \phi_p(Y_{t-p+1} - \mu)$. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere o modelo AR(2) definido por $Y_t = 0.8Y_{t-1} - 0.3Y_{t-2} + \epsilon_t$. A previs√£o de um passo √† frente √© $\hat{E}[Y_{t+1}|Y_t, Y_{t-1}, ...] = 0.8Y_t - 0.3Y_{t-1}$. Se, por exemplo, $Y_t = 20$ e $Y_{t-1} = 15$, ent√£o a previs√£o de um passo √† frente seria $\hat{E}[Y_{t+1}] = 0.8 * 20 - 0.3 * 15 = 16 - 4.5 = 11.5$. A previs√£o dois passos √† frente seria dada por $\hat{E}[Y_{t+2}|Y_t, Y_{t-1},...] = 0.8\hat{E}[Y_{t+1}|Y_t, Y_{t-1}, ...] - 0.3Y_t$, ou seja, a previs√£o depende recursivamente da previs√£o anterior e dos valores passados. Usando a previs√£o de um passo a frente calculada, $\hat{E}[Y_{t+2}|Y_t, Y_{t-1},...] = 0.8 * 11.5 - 0.3 * 20 = 9.2 - 6 = 3.2$

**Lema 2.1**: A fun√ß√£o de autocovari√¢ncia $\gamma(k)$ de um modelo AR(p) estacion√°rio satisfaz $\gamma(k) = \sum_{i=1}^{p} \phi_i \gamma(k-i)$ para $k > 0$.
*Prova:*
I. Para um modelo AR(p) estacion√°rio, $Y_t = \sum_{i=1}^{p} \phi_i Y_{t-i} + \epsilon_t$.
II. Multiplicando ambos os lados por $Y_{t-k}$ e tomando a esperan√ßa, temos $E[Y_t Y_{t-k}] = E[(\sum_{i=1}^{p} \phi_i Y_{t-i} + \epsilon_t) Y_{t-k}]$.
III. Usando a linearidade da esperan√ßa, temos $\gamma(k) = \sum_{i=1}^{p} \phi_i E[Y_{t-i}Y_{t-k}] + E[\epsilon_t Y_{t-k}]$.
IV. Como $\epsilon_t$ √© um ru√≠do branco, $E[\epsilon_t Y_{t-k}] = 0$ para $k > 0$, e $E[Y_{t-i}Y_{t-k}] = \gamma(k-i)$.
V. Portanto, $\gamma(k) = \sum_{i=1}^{p} \phi_i \gamma(k-i)$ para $k > 0$. ‚ñ†

**Observa√ß√£o 2**:  Para o modelo AR(p), a previs√£o √≥tima de um passo a frente  $\hat{E}[Y_{t+1}|Y_t, Y_{t-1},\ldots]$ √© a forma exata para o modelo quando todos os seus par√¢metros s√£o conhecidos. No entanto, na pr√°tica, os par√¢metros do modelo s√£o estimados a partir de um n√∫mero finito de observa√ß√µes, o que introduz incerteza nas previs√µes. Por exemplo, se estimarmos os par√¢metros $\phi_1$ e $\phi_2$ no exemplo acima usando dados amostrais, as previs√µes ter√£o uma componente de erro adicional devido √† incerteza nas estimativas desses par√¢metros. A an√°lise de res√≠duos tamb√©m √© importante para validar a adequa√ß√£o do modelo aos dados e verificar se as premissas sobre o ru√≠do branco s√£o v√°lidas.

### Conclus√£o
Este cap√≠tulo apresentou o modelo AR(p) como uma ferramenta pr√°tica e eficiente para a modelagem do componente autorregressivo de s√©ries temporais. Vimos que ele representa um caso especial do modelo AR(‚àû) e que utiliza um n√∫mero finito *p* de defasagens [^1, 2]. O modelo AR(p) oferece uma forma direta e computacionalmente eficiente de expressar previs√µes como fun√ß√µes dos dados hist√≥ricos, e sua an√°lise √© fundamental para entender e modelar a depend√™ncia temporal em s√©ries temporais. A condi√ß√£o de estacionariedade √© crucial para garantir que o modelo seja bem comportado, e o uso do operador de aniquila√ß√£o permite derivar as previs√µes √≥timas recursivamente. A escolha do valor apropriado para a ordem *p* √© um passo crucial na modelagem de uma s√©rie temporal com o modelo AR(p) e depende das caracter√≠sticas espec√≠ficas da s√©rie e de seus padr√µes de depend√™ncia temporal.

### Refer√™ncias
[^1]: [4.2. Forecasts Based on an Infinite Number of Observations, p√°ginas 77-79]
[^2]: [4.3. Forecasts Based on a Finite Number of Observations, p√°gina 85]
<!-- END -->
