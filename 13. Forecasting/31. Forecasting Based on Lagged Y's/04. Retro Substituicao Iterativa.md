## O M√©todo de Retro-Substitui√ß√£o Iterativa e a Extra√ß√£o de Ru√≠dos Brancos em Modelos de S√©ries Temporais

### Introdu√ß√£o
Dando continuidade √† discuss√£o sobre modelos autorregressivos, de m√©dias m√≥veis e ARMA, este cap√≠tulo explora o m√©todo de **retro-substitui√ß√£o iterativa** como um instrumento para extrair os ru√≠dos brancos subjacentes a esses modelos a partir das observa√ß√µes da s√©rie temporal [^1, 2]. Como vimos nos cap√≠tulos anteriores, tanto os modelos AR(‚àû) quanto os MA(‚àû) e ARMA expressam a s√©rie temporal $Y_t$ em fun√ß√£o de seus valores passados e/ou ru√≠dos brancos [^1]. No entanto, na pr√°tica, os ru√≠dos brancos $\epsilon_t$ n√£o s√£o diretamente observados [^1, 2]. Para implementar esses modelos e, em particular, para obter previs√µes, √© essencial ser capaz de extrair os ru√≠dos brancos a partir dos dados da s√©rie temporal $Y_t$. O m√©todo de retro-substitui√ß√£o iterativa permite aproximar esses ru√≠dos utilizando as pr√≥prias observa√ß√µes da s√©rie, e este cap√≠tulo detalhar√° o m√©todo e suas aplica√ß√µes no contexto de modelos AR(‚àû), MA(‚àû) e ARMA em sua forma invertida.

### O M√©todo de Retro-Substitui√ß√£o Iterativa
A **retro-substitui√ß√£o iterativa**, tamb√©m conhecida como m√©todo recursivo de extra√ß√£o de ru√≠dos, consiste em utilizar a estrutura do modelo para expressar os ru√≠dos brancos como fun√ß√£o dos valores passados da s√©rie e dos par√¢metros do modelo, e calcular esses ru√≠dos retroativamente, iterando sobre os dados observados [^1, 2]. O m√©todo envolve a reordena√ß√£o da equa√ß√£o do modelo de forma a expressar $\epsilon_t$ em termos de $Y_t$ e seus valores defasados, e calcular iterativamente os valores passados de $\epsilon_t$ utilizando essa rela√ß√£o.

**Observa√ß√£o 1**: O processo de retro-substitui√ß√£o iterativa depende da invertibilidade da representa√ß√£o do modelo. Modelos MA ou ARMA na forma invert√≠vel permitem expressar $\epsilon_t$ em fun√ß√£o dos valores passados de Y.

> üí° **Exemplo Num√©rico**: Considere um modelo AR(1) da forma $Y_t = \phi Y_{t-1} + \epsilon_t$. Para obter $\epsilon_t$ a partir das observa√ß√µes, rearranjamos a equa√ß√£o: $\epsilon_t = Y_t - \phi Y_{t-1}$. Se tivermos as observa√ß√µes $Y_1 = 10.5, Y_2 = 11.2, Y_3 = 10.8, ...$ e $\phi = 0.8$, podemos calcular $\epsilon_1 = Y_1 - \phi Y_0$ (assumindo $Y_0 = 0$ para iniciar o processo), ent√£o $\epsilon_1 = 10.5 - 0.8 * 0 = 10.5$, $\epsilon_2 = Y_2 - \phi Y_1 = 11.2 - 0.8 * 10.5 = 11.2 - 8.4 = 2.8$, $\epsilon_3 = Y_3 - \phi Y_2 = 10.8 - 0.8 * 11.2 = 10.8 - 8.96 = 1.84$, e assim por diante. Este processo mostra como podemos "extrair" os ru√≠dos brancos a partir dos dados observados, dado que conhecemos os par√¢metros do modelo.

O texto indica que, para um processo AR(‚àû) definido por $\eta(L)(Y_t - \mu) = \epsilon_t$ [^1], o ru√≠do branco $\epsilon_t$ pode ser expresso como:
$$ \epsilon_t = \eta(L)(Y_t - \mu) $$
onde $\eta(L)$ √© o operador autorregressivo, dado por $\eta(L) = \sum_{j=0}^\infty \eta_j L^j$ [^1]. Na pr√°tica, como o operador $\eta(L)$ √© de ordem infinita, o truncamento da s√©rie $\eta(L)$ √© necess√°rio para realizar os c√°lculos. Como j√° vimos, para o modelo AR(p) esta aproxima√ß√£o √© direta [^2].

Para um processo MA(1) na forma invert√≠vel, definido como $(1 + \theta L)^{-1}(Y_t - \mu) = \epsilon_t$ [^1], o ru√≠do branco $\epsilon_t$ pode ser obtido por:
$$ \epsilon_t = (1 + \theta L)^{-1}(Y_t - \mu) = (Y_t - \mu) - \theta (Y_{t-1} - \mu) + \theta^2 (Y_{t-2} - \mu) - \ldots $$
Esta expans√£o expressa o ru√≠do branco $\epsilon_t$ como uma fun√ß√£o linear de todos os valores passados de $Y_t$. A implementa√ß√£o pr√°tica dessa express√£o requer a retro-substitui√ß√£o iterativa, onde $\epsilon_t$ √© aproximado por:
$$ \hat{\epsilon}_t = (Y_t - \mu) - \theta \hat{\epsilon}_{t-1} $$
em que $\hat{\epsilon}_{t-1}$ √© o ru√≠do branco estimado no per√≠odo anterior, criando um processo recursivo para aproximar o valor de $\epsilon_t$ a partir de $Y_t$, seus valores defasados e um valor inicial para $\hat{\epsilon}$.

**Proposi√ß√£o 1**: A retro-substitui√ß√£o iterativa aplica a propriedade de que um operador invert√≠vel $\theta(L)$ pode ser expresso como um operador AR(‚àû).
*Proof:*
I. Para um modelo MA(1) invert√≠vel, temos $Y_t - \mu = (1 + \theta L) \epsilon_t$.
II. Para encontrar $\epsilon_t$ como uma fun√ß√£o de $Y_t$ e seus valores passados, multiplicamos ambos os lados por $(1 + \theta L)^{-1}$, obtendo $(1 + \theta L)^{-1}(Y_t - \mu) = \epsilon_t$.
III. Se o modelo √© invert√≠vel, a representa√ß√£o $(1 + \theta L)^{-1}$ pode ser expandida como $1 - \theta L + \theta^2 L^2 - \ldots = \sum_{j=0}^{\infty} (-\theta L)^j$.
IV. Portanto, podemos expressar $\epsilon_t = (1 - \theta L + \theta^2 L^2 - \ldots)(Y_t-\mu) = (Y_t - \mu) - \theta(Y_{t-1} - \mu) + \theta^2(Y_{t-2} - \mu) - \ldots$, o que demonstra que $\epsilon_t$ √© uma fun√ß√£o linear de todos os valores passados de $Y_t$. A retro-substitui√ß√£o iterativa aproxima essa representa√ß√£o. ‚ñ†

> üí° **Exemplo Num√©rico**: Considere um modelo MA(1) invert√≠vel com $\theta = 0.5$ e $\mu = 0$, ent√£o $Y_t = \epsilon_t + 0.5\epsilon_{t-1}$. A equa√ß√£o para $\epsilon_t$ √© $\epsilon_t = Y_t - 0.5\epsilon_{t-1}$. Inicializando com $\epsilon_0 = 0$, e com observa√ß√µes $Y_1 = 2, Y_2 = 1.5, Y_3 = 2.3, ...$ podemos calcular $\epsilon_1 = Y_1 - 0.5*0 = Y_1 = 2$, $\epsilon_2 = Y_2 - 0.5\epsilon_1 = 1.5 - 0.5 * 2 = 0.5$, $\epsilon_3 = Y_3 - 0.5\epsilon_2 = 2.3 - 0.5 * 0.5 = 2.05$, e assim por diante. Este processo demonstra como a retro-substitui√ß√£o iterativa calcula os ru√≠dos brancos $\epsilon_t$ recursivamente a partir de $Y_t$.

O texto tamb√©m discute o caso de um modelo ARMA(1,1) na forma invert√≠vel, definido como  $(1 - \phi L)(Y_t - \mu) = (1 + \theta L) \epsilon_t$. Para extrair $\epsilon_t$, reescrevemos a equa√ß√£o como:
$$ \epsilon_t = (1 + \theta L)^{-1}(1 - \phi L)(Y_t - \mu). $$
Utilizando o m√©todo de retro-substitui√ß√£o iterativa, aproximamos $\epsilon_t$ por:
$$ \hat{\epsilon}_t = (Y_t - \mu) - \phi(Y_{t-1} - \mu) - \theta \hat{\epsilon}_{t-1} $$
Esta equa√ß√£o mostra que a estimativa do ru√≠do branco $\epsilon_t$ depende tanto dos valores passados de $Y_t$ quanto do ru√≠do branco estimado no per√≠odo anterior. A retro-substitui√ß√£o √© feita retroativamente, come√ßando com um valor inicial arbitr√°rio para $\epsilon_t$, geralmente 0.

**Lema 1.1**: Se o modelo ARMA(p,q) for causal e invert√≠vel, a retro-substitui√ß√£o iterativa converge para o valor verdadeiro dos ru√≠dos brancos √† medida que o tempo retrocede.

*Proof:*
I. Um modelo ARMA(p,q) causal e invert√≠vel pode ser expressado tanto como um AR(‚àû) quanto como um MA(‚àû).
II. A representa√ß√£o AR(‚àû) nos permite expressar $\epsilon_t$ como uma fun√ß√£o linear de $Y_t$ e seus valores passados, e a representa√ß√£o MA(‚àû) nos permite expressar $Y_t$ como uma fun√ß√£o linear dos ru√≠dos brancos passados.
III. A retro-substitui√ß√£o iterativa aproxima a representa√ß√£o AR(‚àû) recursivamente. A converg√™ncia da representa√ß√£o AR(‚àû) garante que a aproxima√ß√£o dos ru√≠dos converge para o verdadeiro valor √† medida que o n√∫mero de itera√ß√µes aumenta.‚ñ†

**Lema 1.2**: O m√©todo de retro-substitui√ß√£o iterativa converge para o verdadeiro valor do ru√≠do branco $\epsilon_t$ √† medida que o n√∫mero de itera√ß√µes aumenta, se o modelo ARMA(p,q) for causal e invert√≠vel.
*Proof:*
I. Um modelo ARMA(p,q) causal e invert√≠vel possui uma representa√ß√£o equivalente AR(‚àû) e MA(‚àû) convergentes.
II. A representa√ß√£o AR(‚àû) expressa o ru√≠do branco como uma fun√ß√£o linear dos valores passados da s√©rie e a representa√ß√£o MA(‚àû) expressa a s√©rie em termos dos ru√≠dos passados.
III. A retro-substitui√ß√£o iterativa √© uma forma de aproximar esses valores e a converg√™ncia da s√©rie garantir√° que o erro da aproxima√ß√£o tenda a zero √† medida que os dados s√£o utilizados. ‚ñ†

> üí° **Exemplo Num√©rico**: Considere o modelo ARMA(1,1) dado por $(1 - 0.7L)(Y_t - 5) = (1 + 0.4L)\epsilon_t$. A equa√ß√£o para $\epsilon_t$ na forma recursiva √© $\hat{\epsilon}_t = (Y_t - 5) - 0.7(Y_{t-1} - 5) - 0.4\hat{\epsilon}_{t-1}$. Para iniciar o processo, assumimos $\hat{\epsilon}_0 = 0$. Com as observa√ß√µes $Y_1 = 10, Y_2 = 12, Y_3 = 11, ...$ podemos calcular, por exemplo: $\hat{\epsilon}_1 = (Y_1 - 5) - 0.7(0 - 5) = 10 - 5 + 3.5 = 8.5$, $\hat{\epsilon}_2 = (Y_2 - 5) - 0.7(Y_1 - 5) - 0.4\hat{\epsilon}_1 = (12 - 5) - 0.7(10 - 5) - 0.4 * 8.5 = 7 - 3.5 - 3.4 = 0.1$ e assim por diante, demonstrando como este processo obt√©m ru√≠dos brancos a partir de observa√ß√µes e valores passados estimados.

**Observa√ß√£o 2**: Em geral, para modelos ARMA(p, q), a retro-substitui√ß√£o iterativa pode ser aplicada de forma an√°loga, utilizando a forma invert√≠vel do modelo para expressar os ru√≠dos brancos em fun√ß√£o dos dados e dos par√¢metros, permitindo a extra√ß√£o aproximada dos ru√≠dos brancos subjacentes.

### Aplica√ß√µes da Retro-Substitui√ß√£o Iterativa
O m√©todo de retro-substitui√ß√£o iterativa tem diversas aplica√ß√µes pr√°ticas na modelagem de s√©ries temporais, principalmente:
1.  **Obten√ß√£o de ru√≠dos brancos estimados:** A principal aplica√ß√£o √© a extra√ß√£o de ru√≠dos brancos a partir de dados observacionais, o que permite a an√°lise desses ru√≠dos para verificar se os pressupostos do modelo s√£o v√°lidos [^1, 2].
2.  **Previs√£o:** A retro-substitui√ß√£o iterativa permite escrever o modelo de previs√£o em fun√ß√£o das observa√ß√µes passadas e dos ru√≠dos estimados, facilitando o c√°lculo das previs√µes e o acompanhamento das s√©ries temporais [^1, 2].
3.  **Estima√ß√£o de par√¢metros:** Alguns m√©todos de estima√ß√£o de par√¢metros de modelos de s√©ries temporais (como m√°xima verossimilhan√ßa) utilizam os ru√≠dos estimados como parte do processo de otimiza√ß√£o [^2].
4.  **Simula√ß√£o:** A gera√ß√£o de s√©ries temporais sint√©ticas tamb√©m se beneficia da extra√ß√£o dos ru√≠dos brancos e do processo de retro-substitui√ß√£o para simular diferentes cen√°rios com os modelos estimados [^2].

**Teorema 2**: A previs√£o de um passo √† frente para um modelo ARMA(p,q) pode ser expressa de forma recursiva utilizando o m√©todo de retro-substitui√ß√£o iterativa.
*Prova:*
I.  Dado um modelo ARMA(p,q) na forma invertida $\epsilon_t = [\theta(L)]^{-1}\phi(L)(Y_t-\mu)$.
II. Podemos aproximar $\epsilon_t$ como $\hat{\epsilon}_t = [\phi(L)](Y_t-\mu) -  \sum_{j=1}^\infty \theta_j\hat{\epsilon}_{t-j}$, onde $\theta_j$ s√£o os coeficientes do operador de m√©dias m√≥veis.
III. A previs√£o de um passo √† frente, $\hat{Y}_{t+1}$, pode ser expressa como  $\hat{Y}_{t+1} = \mu + \sum_{i=1}^p \phi_i(Y_{t+1-i} - \mu) + \sum_{j=1}^q \theta_j\hat{\epsilon}_{t+1-j}$.
IV. Usando $\hat{\epsilon}_t$ recursivamente, e assumindo $\hat{\epsilon}_{t+1-j}=0$ para $t+1-j > t$, temos que a previs√£o depende recursivamente dos ru√≠dos estimados e dos valores defasados da s√©rie. ‚ñ†

**Teorema 2.1**: Para modelos ARMA(p,q) causais e invert√≠veis, o erro de previs√£o de um passo √† frente converge para zero √† medida que $t$ tende a infinito, assumindo que os par√¢metros do modelo s√£o conhecidos.

*Prova:*
I.  Em modelos ARMA(p,q) causais e invert√≠veis, o ru√≠do branco $\epsilon_t$ tem m√©dia zero e vari√¢ncia finita.
II. O erro de previs√£o de um passo √† frente pode ser expresso como $Y_{t+1} - \hat{Y}_{t+1} = \epsilon_{t+1}$.
III. Como $\epsilon_{t+1}$ tem m√©dia zero e vari√¢ncia finita, a previs√£o converge para o valor verdadeiro, e o erro de previs√£o converge para o ru√≠do branco, que tem m√©dia zero.
IV. Portanto, a previs√£o √© n√£o viesada e o erro de previs√£o tende a zero em m√©dia √† medida que $t$ tende a infinito.‚ñ†

> üí° **Exemplo Num√©rico**: Para o modelo ARMA(1,1) apresentado acima, $(1 - 0.7L)(Y_t - 5) = (1 + 0.4L)\epsilon_t$, a previs√£o de um passo √† frente √© $\hat{Y}_{t+1} = 5 + 0.7(Y_t - 5) + 0.4\hat{\epsilon}_t$. Suponha que $Y_t = 12$ e que calculamos $\hat{\epsilon}_t = 0.1$ usando a retro-substitui√ß√£o iterativa. Ent√£o, $\hat{Y}_{t+1} = 5 + 0.7(12 - 5) + 0.4 * 0.1 = 5 + 0.7 * 7 + 0.04 = 5 + 4.9 + 0.04 = 9.94$. Para calcular $\hat{Y}_{t+2}$, precisamos de $Y_{t+1}$ (que seria o valor real, mas como √© uma previs√£o, usamos $\hat{Y}_{t+1}$) e $\hat{\epsilon}_{t+1}$, que ser√° calculada da mesma forma com $Y_{t+1}$ no lugar de $Y_t$, e assim sucessivamente. Isso demonstra que o m√©todo iterativo permite construir a previs√£o utilizando os ru√≠dos brancos estimados e os valores passados da s√©rie.

### Conclus√£o
O m√©todo de retro-substitui√ß√£o iterativa oferece um meio pr√°tico e eficiente de extrair os ru√≠dos brancos subjacentes aos modelos AR(‚àû), MA(‚àû) e ARMA em sua forma invertida [^1, 2]. A capacidade de obter esses ru√≠dos a partir dos dados observados √© fundamental para a an√°lise, previs√£o e simula√ß√£o de s√©ries temporais, permitindo que os modelos sejam utilizados de forma efetiva em aplica√ß√µes reais [^2]. Atrav√©s da recurs√£o nos c√°lculos, o m√©todo permite aproximar os ru√≠dos subjacentes a partir das observa√ß√µes da s√©rie e dos par√¢metros do modelo, sendo um passo crucial para a modelagem e previs√£o de s√©ries temporais em diversos contextos.

### Refer√™ncias
[^1]: [4.2. Forecasts Based on an Infinite Number of Observations, p√°ginas 77-79]
[^2]: [4.3. Forecasts Based on a Finite Number of Observations, p√°gina 85]
<!-- END -->
