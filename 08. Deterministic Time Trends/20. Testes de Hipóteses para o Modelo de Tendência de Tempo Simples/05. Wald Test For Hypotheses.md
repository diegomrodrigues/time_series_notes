## O Teste de Wald para Hip√≥teses Conjuntas em Modelos com Tend√™ncia de Tempo
### Introdu√ß√£o
Em continuidade √† an√°lise da validade assint√≥tica dos testes de hip√≥teses em modelos com tend√™ncia de tempo, exploramos a constru√ß√£o e as propriedades do teste de Wald para hip√≥teses conjuntas sobre os par√¢metros do modelo. Como vimos anteriormente, os estimadores de m√≠nimos quadrados ordin√°rios (OLS) dos par√¢metros de modelos com tend√™ncia de tempo, $\hat{\alpha}_T$ e $\hat{\delta}_T$, convergem a taxas diferentes, $T^{1/2}$ e $T^{3/2}$, respectivamente [^1, ^2]. No entanto, os testes $t$ padr√£o, quando apropriadamente normalizados, s√£o assintoticamente v√°lidos, convergindo para uma distribui√ß√£o normal padr√£o $N(0,1)$ [^2]. O teste de Wald, que √© uma estat√≠stica mais geral usada para testar restri√ß√µes conjuntas sobre os par√¢metros, tamb√©m pode ser aplicado neste contexto, e este cap√≠tulo detalha como sua distribui√ß√£o assint√≥tica √© derivada.

### Conceitos Fundamentais
O teste de Wald √© uma abordagem geral para testar restri√ß√µes sobre os par√¢metros de um modelo estat√≠stico. No contexto de modelos de regress√£o, o teste de Wald avalia se as restri√ß√µes impostas aos par√¢metros s√£o suportadas pelos dados [^2]. Para modelos com tend√™ncia de tempo, o teste de Wald √© particularmente √∫til para testar hip√≥teses conjuntas sobre o intercepto $\alpha$ e o coeficiente da tend√™ncia $\delta$.

Consideremos a hip√≥tese nula de que os par√¢metros $\alpha$ e $\delta$ satisfazem um conjunto de restri√ß√µes lineares expressas como:

$$
H_0: R\mathbf{\beta} = \mathbf{r}
$$

onde $R$ √© uma matriz de restri√ß√µes de dimens√£o $m \times (p+2)$, $\mathbf{\beta} = [\alpha, \delta]'$, e $\mathbf{r}$ √© um vetor de constantes de dimens√£o $m \times 1$, e $m$ √© o n√∫mero de restri√ß√µes lineares [^2]. A forma de Wald da estat√≠stica do teste de hip√≥teses √© dada por [^2]:

$$
\chi^2_T = (\mathbf{b}_T - \mathbf{b}_0)' [s_T^2(X'X)^{-1}]^{-1} (\mathbf{b}_T - \mathbf{b}_0)
$$

onde $\mathbf{b}_T = [\hat{\alpha}_T \, \hat{\delta}_T ]'$ √© o vetor de estimadores OLS, $\mathbf{b}_0 = [\alpha_0 \, \delta_0]' $ √© o vetor de valores hipot√©ticos sob $H_0$ e $s_T^2$ √© o estimador OLS da vari√¢ncia do erro. Note que, neste caso, $(X'X)^{-1}$ representa a inversa da matriz de momentos dos regressores, como definido em [16.1.16], e n√£o uma matriz de covari√¢ncia [^1]. A estat√≠stica de Wald $\chi^2_T$ quantifica a dist√¢ncia entre os estimadores OLS $\mathbf{b}_T$ e os valores hipot√©ticos $\mathbf{b}_0$, ajustada pela variabilidade dos estimadores.

No contexto de modelos com tend√™ncia de tempo, as diferentes taxas de converg√™ncia dos estimadores OLS $\hat{\alpha}_T$ e $\hat{\delta}_T$ e a necessidade de se usar matrizes transformadas para derivar a distribui√ß√£o limite das estat√≠sticas de teste poderiam levar √† pergunta se o teste de Wald ainda √© v√°lido e segue uma distribui√ß√£o assint√≥tica qui-quadrado, como em modelos de regress√£o padr√£o. No entanto, a transforma√ß√£o de Sims, Stock, e Watson, discutida em [16.3] e utilizada para derivar a distribui√ß√£o limite dos estimadores, leva a uma distribui√ß√£o limite que permite a aplica√ß√£o do teste de Wald de maneira an√°loga a um modelo de regress√£o com vari√°veis estacion√°rias [^1].

> üí° **Justificativa para o uso do Teste de Wald:** O teste de Wald √© uma ferramenta geral para testar restri√ß√µes sobre os par√¢metros de modelos estat√≠sticos. No caso de modelos com tend√™ncia de tempo, ele permite testar n√£o s√≥ hip√≥teses sobre um √∫nico par√¢metro, como tamb√©m hip√≥teses conjuntas, como $H_0: \alpha = \alpha_0$ e $\delta = \delta_0$, ou hip√≥teses lineares sobre os par√¢metros, como $H_0: r_1\alpha + r_2\delta = r$ [^2].

**Proposi√ß√£o 1** (Distribui√ß√£o Assint√≥tica da Estat√≠stica de Wald) Sob as condi√ß√µes usuais de regularidade, a estat√≠stica de Wald $\chi^2_T$, constru√≠da como acima, converge em distribui√ß√£o para uma vari√°vel aleat√≥ria qui-quadrado com $m$ graus de liberdade, denotada por $\chi^2(m)$, onde $m$ √© o n√∫mero de restri√ß√µes lineares na hip√≥tese nula, ou seja:
$$
\chi^2_T \xrightarrow{d} \chi^2(m)
$$
*Proof:*
A prova da distribui√ß√£o assint√≥tica da estat√≠stica de Wald para modelos com tend√™ncia de tempo segue uma l√≥gica similar √†quela utilizada para modelos de regress√£o padr√£o, com as devidas adapta√ß√µes devido √†s taxas de converg√™ncia distintas dos estimadores OLS, e se apoia nos resultados das se√ß√µes anteriores [^1, ^2]:

I. Come√ßamos com a defini√ß√£o da estat√≠stica de Wald:
$$\chi^2_T = (\mathbf{b}_T - \mathbf{b}_0)' [s_T^2(X'X)^{-1}]^{-1} (\mathbf{b}_T - \mathbf{b}_0)$$

II. A partir de [16.1.25] sabemos que o vetor de estimadores $\mathbf{b}_T$ converge assintoticamente para uma distribui√ß√£o normal multivariada, e que o vetor $Y_T(\mathbf{b}_T - \mathbf{b}_0)$ converge para uma normal multivariada com matriz de covari√¢ncia $\sigma^2 Q^{-1}$, onde $Q$ √© a matriz limite definida em [16.1.20] [^1]. Mais precisamente:
$$Y_T(\mathbf{b}_T - \mathbf{b}_0) \xrightarrow{d} N(0, \sigma^2 Q^{-1})$$

III. A matriz $Y_T$ √© definida em [16.1.17] e [16.3.14] e depende do tipo de modelo (com ou sem autorregress√£o) [^1]. Como $\hat{\alpha}_T$ converge a uma taxa de $T^{1/2}$ e $\hat{\delta}_T$ converge a uma taxa de $T^{3/2}$, a matriz $Y_T$ √© definida de modo a acomodar essas diferentes taxas de converg√™ncia.

IV. Substituindo o resultado de [16.1.19], que diz que $Y_T(X'X)^{-1}Y_T \xrightarrow{p} Q^{-1}$, na estat√≠stica de Wald, e utilizando o fato de que $s_T^2 \xrightarrow{p} \sigma^2$, reescrevemos a estat√≠stica:
$$\chi^2_T = (\mathbf{b}_T - \mathbf{b}_0)' [s_T^2(X'X)^{-1}]^{-1} (\mathbf{b}_T - \mathbf{b}_0) =  (\mathbf{b}_T - \mathbf{b}_0)' [Y_T^{-1} Y_T (s_T^2(X'X)^{-1})Y_T Y_T^{-1}]^{-1} (\mathbf{b}_T - \mathbf{b}_0)$$
$$ = Y_T(\mathbf{b}_T - \mathbf{b}_0)' [ s_T^2 (Y_T(X'X)^{-1}Y_T)^{-1}]^{-1} Y_T(\mathbf{b}_T - \mathbf{b}_0) \xrightarrow{d} (Y_T(\mathbf{b}_T - \mathbf{b}_0))' [\sigma^2Q^{-1}]^{-1}(Y_T(\mathbf{b}_T - \mathbf{b}_0))$$
$$ \xrightarrow{d} \chi^2(2)$$

V. A estat√≠stica $\chi^2_T$ √© uma forma quadr√°tica de uma vari√°vel aleat√≥ria normal multivariada, que converge para uma distribui√ß√£o $\chi^2(m)$, onde $m$ √© o n√∫mero de restri√ß√µes impostas √† hip√≥tese nula. Isso pode ser visto reescrevendo a estat√≠stica em termos do res√≠duo da regress√£o:
$$
\chi^2_T = \frac{ (R\mathbf{\hat{b}}_T - \mathbf{r})' [s_T^2 R(X'X)^{-1}R']^{-1} (R\mathbf{\hat{b}}_T - \mathbf{r}) }{m}
$$

VI. Sob a hip√≥tese nula, $R\mathbf{\beta}=\mathbf{r}$, podemos reescrever a estat√≠stica $\chi^2_T$ como:
$$
\chi^2_T = \frac{ (R\mathbf{\hat{b}}_T - R\mathbf{\beta})' [s_T^2 R(X'X)^{-1}R']^{-1} (R\mathbf{\hat{b}}_T - R\mathbf{\beta}) }{m}
$$

VII. Como sabemos que a estat√≠stica acima converge em distribui√ß√£o para uma vari√°vel aleat√≥ria qui-quadrado com graus de liberdade iguais √† dimens√£o do vetor, temos que:
$$
\chi^2_T \xrightarrow{d} \chi^2(m)
$$

Assim, demonstramos que a estat√≠stica de Wald converge para uma distribui√ß√£o qui-quadrado com $m$ graus de liberdade. $\blacksquare$

> üí° **Exemplo Num√©rico:** Vamos ilustrar o uso do teste de Wald para um teste conjunto com os dados simulados da se√ß√£o anterior. Suponha que queremos testar a hip√≥tese nula conjunta $H_0: \alpha = 5$ e $\delta = 0.2$ com $\hat{\alpha}_T = 5.3$, $\hat{\delta}_T = 0.19$ e $s_T^2 = 1.2$, onde a matriz $(X'X)^{-1} = \begin{bmatrix} 0.2 & 0.01 \\ 0.01 & 0.002 \end{bmatrix}$:
>
>  Primeiro, vamos calcular a estat√≠stica de Wald usando os valores fornecidos:
>
> $\mathbf{b}_T = \begin{bmatrix} 5.3 \\ 0.19 \end{bmatrix}$, $\mathbf{b}_0 = \begin{bmatrix} 5 \\ 0.2 \end{bmatrix}$, e $(X'X)^{-1} = \begin{bmatrix} 0.2 & 0.01 \\ 0.01 & 0.002 \end{bmatrix}$ e $s_T^2 = 1.2$.
>
> $\text{Step 1: } \mathbf{b}_T - \mathbf{b}_0 = \begin{bmatrix} 5.3 - 5 \\ 0.19 - 0.2 \end{bmatrix} = \begin{bmatrix} 0.3 \\ -0.01 \end{bmatrix}$
>
> $\text{Step 2: }  (X'X)^{-1} = \begin{bmatrix} 0.2 & 0.01 \\ 0.01 & 0.002 \end{bmatrix} $
>
> $\text{Step 3: } s_T^2(X'X)^{-1} = 1.2 \times \begin{bmatrix} 0.2 & 0.01 \\ 0.01 & 0.002 \end{bmatrix} = \begin{bmatrix} 0.24 & 0.012 \\ 0.012 & 0.0024 \end{bmatrix}$
>
> $\text{Step 4: } [s_T^2(X'X)^{-1}]^{-1} = \begin{bmatrix} 0.24 & 0.012 \\ 0.012 & 0.0024 \end{bmatrix}^{-1} \approx \begin{bmatrix} 4.21 & -21 \\ -21 & 420 \end{bmatrix}$
>
> $\text{Step 5: } \chi^2_T = \begin{bmatrix} 0.3 & -0.01 \end{bmatrix} \begin{bmatrix} 4.21 & -21 \\ -21 & 420 \end{bmatrix} \begin{bmatrix} 0.3 \\ -0.01 \end{bmatrix} \approx  4.21 * 0.3^2 - 2 * 21 * 0.3 * (-0.01) + 420 * (-0.01)^2 = 0.3789 + 0.126 + 0.042 = 0.5469$
>
> A estat√≠stica de Wald √© $\chi^2_T = 0.5469$. Para avaliar a signific√¢ncia estat√≠stica, comparamos este valor com o valor cr√≠tico da distribui√ß√£o qui-quadrado com 2 graus de liberdade. Usando um n√≠vel de signific√¢ncia de 5%, o valor cr√≠tico √© aproximadamente 5.99. Como $0.5469 < 5.99$, n√£o rejeitamos a hip√≥tese nula conjunta. Este exemplo mostra como, na pr√°tica, o teste de Wald √© aplicado para hip√≥teses conjuntas em modelos com tend√™ncia de tempo.
>
> ```python
> import numpy as np
> import statsmodels.api as sm
> from scipy.stats import chi2
>
> # Par√¢metros verdadeiros (os mesmos do exemplo anterior)
> alpha_true = 5
> delta_true = 0.2
> sigma_true = 1.5
> T = 200
>
> # Gera√ß√£o dos dados (os mesmos do exemplo anterior)
> t = np.arange(1, T + 1)
> X = np.column_stack((np.ones(T), t))
> errors = np.random.normal(0, sigma_true, T)
> y = alpha_true + delta_true * t + errors
>
> # Estima√ß√£o por OLS (os mesmos do exemplo anterior)
> model = sm.OLS(y, X)
> results = model.fit()
>
> # Extraindo os resultados (os mesmos do exemplo anterior)
> alpha_hat = results.params[0]
> delta_hat = results.params[1]
> s_squared = results.mse_resid
> cov_matrix = results.cov_params()
>
> # Defini√ß√£o dos valores hipot√©ticos para o teste conjunto
> b_0 = np.array([5, 0.2])
> b_hat = np.array([alpha_hat, delta_hat])
>
> # Definindo a matriz de restri√ß√£o
> R = np.eye(2)
>
> # C√°lculo da estat√≠stica de Wald
> chi2_stat = (b_hat - b_0).T @ np.linalg.inv(s_squared * cov_matrix) @ (b_hat - b_0)
>
> # Comparando com o valor cr√≠tico de uma qui-quadrado
> degrees_freedom = 2
> critical_value = chi2.ppf(0.95, degrees_freedom)
>
> # Imprimindo os resultados
> print(f"Estat√≠stica de Wald: {chi2_stat:.4f}")
> print(f"Valor cr√≠tico (chi-quadrado, 5%): {critical_value:.4f}")
>
> if chi2_stat > critical_value:
>    print("Rejeita-se a hip√≥tese nula conjunta")
> else:
>    print("N√£o se rejeita a hip√≥tese nula conjunta")
> ```
>
> Neste exemplo, constru√≠mos a estat√≠stica de Wald para testar a hip√≥tese nula conjunta de que $\alpha = 5$ e $\delta = 0.2$. O c√≥digo estima os par√¢metros do modelo usando OLS, calcula a estat√≠stica de Wald e compara com o valor cr√≠tico de uma distribui√ß√£o $\chi^2(2)$ para avaliar a signific√¢ncia estat√≠stica da hip√≥tese conjunta.

**Corol√°rio 1** (Robustez em rela√ß√£o √† n√£o-normalidade) A validade assint√≥tica do teste de Wald n√£o depende da hip√≥tese de normalidade dos erros, apenas da hip√≥tese de erros i.i.d. com vari√¢ncia finita. Isso √© uma consequ√™ncia do Teorema do Limite Central para vetores, que garante que a distribui√ß√£o amostral dos estimadores OLS, quando apropriadamente normalizada, converge para uma distribui√ß√£o normal multivariada, mesmo que a distribui√ß√£o original dos erros n√£o seja normal.

**Teorema 1** (Teste de Raz√£o de Verossimilhan√ßa e Teste de Multiplicadores de Lagrange) Al√©m do teste de Wald, outros testes assint√≥ticos podem ser usados para testar hip√≥teses conjuntas em modelos com tend√™ncia de tempo. Os testes da raz√£o de verossimilhan√ßa (LR) e dos multiplicadores de Lagrange (LM) tamb√©m convergem para uma distribui√ß√£o qui-quadrado sob a hip√≥tese nula, com os mesmos graus de liberdade do teste de Wald.
*Proof:*
A demonstra√ß√£o deste resultado envolve a an√°lise das propriedades assint√≥ticas dos estimadores de m√°xima verossimilhan√ßa e das fun√ß√µes de verossimilhan√ßa sob restri√ß√£o, similar aos resultados para modelos de regress√£o padr√£o. A distribui√ß√£o assint√≥tica qui-quadrado desses testes √© uma consequ√™ncia da expans√£o de Taylor da fun√ß√£o de verossimilhan√ßa e da consist√™ncia e normalidade assint√≥tica dos estimadores de m√°xima verossimilhan√ßa. A transforma√ß√£o de Sims, Stock, e Watson tamb√©m √© essencial para garantir a converg√™ncia dos testes LR e LM no contexto de modelos com tend√™ncia de tempo. Dada a equival√™ncia assint√≥tica desses testes sob hip√≥teses de regularidade, eles fornecem resultados consistentes com o teste de Wald. $\blacksquare$

**Corol√°rio 1.1** (Equival√™ncia Assint√≥tica dos Testes) Sob condi√ß√µes de regularidade, os testes de Wald, raz√£o de verossimilhan√ßa (LR), e multiplicadores de Lagrange (LM) s√£o assintoticamente equivalentes, ou seja, convergem para a mesma distribui√ß√£o qui-quadrado sob a hip√≥tese nula e apresentam o mesmo poder assint√≥tico sob hip√≥teses alternativas locais.

**Lema 1** (Converg√™ncia da Matriz de Informa√ß√£o) Para a prova do Teorema 1, √© importante notar que a matriz de informa√ß√£o observada, em modelos com tend√™ncia, quando corretamente normalizada, converge para uma matriz bem definida e n√£o singular. Este resultado √© an√°logo √† converg√™ncia da matriz de momentos $X'X/T$ para um limite n√£o singular em modelos de regress√£o padr√£o, por√©m com a normaliza√ß√£o $Y_T(X'X)^{-1}Y_T$. A converg√™ncia da matriz de informa√ß√£o √© fundamental para garantir a validade assint√≥tica dos testes LR e LM.

### Conclus√£o
Em conclus√£o, o teste de Wald para hip√≥teses conjuntas sobre os par√¢metros de modelos com tend√™ncia de tempo √© assintoticamente v√°lido, com uma distribui√ß√£o qui-quadrado com graus de liberdade iguais ao n√∫mero de restri√ß√µes. Este resultado garante que os testes estat√≠sticos usuais podem ser aplicados, n√£o apenas para modelos com vari√°veis estacion√°rias, mas tamb√©m para modelos com tend√™ncia de tempo determin√≠stica. As diferentes taxas de converg√™ncia dos estimadores s√£o acomodadas pelas transforma√ß√µes adequadas, que permitem obter distribui√ß√µes limites n√£o degeneradas, justificando a aplica√ß√£o dos testes de hip√≥teses padr√£o nesse contexto. A converg√™ncia assint√≥tica da estat√≠stica de Wald para uma distribui√ß√£o qui-quadrado √© uma prova da robustez dos m√©todos estat√≠sticos no tratamento de modelos com tend√™ncia de tempo. O teste de Wald √© uma ferramenta essencial na an√°lise de modelos com tend√™ncia de tempo, permitindo testar restri√ß√µes conjuntas sobre os par√¢metros do modelo e facilitando uma an√°lise mais completa das hip√≥teses de interesse. Adicionalmente, os testes de raz√£o de verossimilhan√ßa e multiplicadores de Lagrange tamb√©m s√£o assintoticamente v√°lidos e equivalentes ao teste de Wald nesse contexto, fornecendo uma variedade de ferramentas para a infer√™ncia estat√≠stica.

### Refer√™ncias
[^1]: Se√ß√£o 16.1 do texto fornecido.
[^2]: Se√ß√£o 16.2 do texto fornecido.
<!-- END -->
