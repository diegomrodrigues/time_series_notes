## Distribui√ß√£o Assint√≥tica do Coeficiente em AR(1) com Raiz Unit√°ria

### Introdu√ß√£o
Como vimos nos cap√≠tulos anteriores, a an√°lise de processos com ra√≠zes unit√°rias exige uma abordagem diferente da an√°lise de processos estacion√°rios, devido √†s diferentes taxas de converg√™ncia dos estimadores e √† natureza n√£o convencional das distribui√ß√µes assint√≥ticas [^1]. Os conceitos de movimento Browniano e funcionais do movimento Browniano emergem como elementos cruciais para descrever as distribui√ß√µes limite nesses processos [^1, ^2]. Neste cap√≠tulo, exploraremos como a distribui√ß√£o assint√≥tica do coeficiente estimado em uma **autorregress√£o de primeira ordem (AR(1))** com raiz unit√°ria, cujo verdadeiro processo subjacente √© um passeio aleat√≥rio, √© afetada pela inclus√£o de um termo constante ou uma tend√™ncia temporal na regress√£o estimada, bem como pela presen√ßa de um *drift* n√£o nulo no passeio aleat√≥rio.

### Conceitos Fundamentais
A an√°lise da distribui√ß√£o assint√≥tica do coeficiente estimado em um modelo AR(1) com raiz unit√°ria, quando o processo verdadeiro √© um passeio aleat√≥rio, requer uma aten√ß√£o especial. A presen√ßa ou aus√™ncia de um termo constante ou tend√™ncia temporal na regress√£o estimada, juntamente com a exist√™ncia ou n√£o de um *drift* no passeio aleat√≥rio verdadeiro, influencia significativamente a distribui√ß√£o assint√≥tica do estimador [^1].

Um **passeio aleat√≥rio** √© um tipo espec√≠fico de processo com raiz unit√°ria, que pode ser descrito pela equa√ß√£o:
$$y_t = y_{t-1} + e_t$$
onde $e_t$ representa um choque aleat√≥rio, normalmente considerado um ru√≠do branco [^1]. A adi√ß√£o de um **drift** $\mu$ ao passeio aleat√≥rio resulta em:
$$y_t = \mu + y_{t-1} + e_t$$
Em termos de distribui√ß√£o assint√≥tica, a presen√ßa de um *drift* altera o comportamento limitante do processo e, consequentemente, o comportamento do estimador dos coeficientes do modelo, como veremos.

Vamos considerar o modelo AR(1) estimado:
$$y_t = \rho y_{t-1} + u_t$$
onde $u_t$ s√£o os res√≠duos e o estimador de m√≠nimos quadrados ordin√°rios para $\rho$, $\hat{\rho}$, √© dado por
$$\hat{\rho} = \frac{\sum_{t=2}^T y_t y_{t-1}}{\sum_{t=2}^T y_{t-1}^2}$$
Nossa an√°lise se concentrar√° na distribui√ß√£o assint√≥tica deste estimador, $\hat{\rho}$, sob diferentes cen√°rios.
**Observa√ß√£o:** √â importante notar que, em todos os casos que analisaremos, assumimos que os erros $e_t$ s√£o independentes e identicamente distribu√≠dos (i.i.d.) com m√©dia zero e vari√¢ncia finita $\sigma^2$. Essa suposi√ß√£o √© fundamental para a deriva√ß√£o das distribui√ß√µes assint√≥ticas que veremos a seguir.

#### Caso 1: Passeio Aleat√≥rio sem Deriva (Drift) e Sem Constante ou Tend√™ncia na Regress√£o Estimada
Inicialmente, considere o caso mais simples em que o verdadeiro processo √© um passeio aleat√≥rio sem *drift* ($\mu = 0$):
$$y_t = y_{t-1} + e_t$$
E a regress√£o estimada √©:
$$y_t = \rho y_{t-1} + u_t$$
Neste caso, a distribui√ß√£o assint√≥tica de $\hat{\rho}$ n√£o √© normal, mas sim um funcional do movimento Browniano, que pode ser representado como:
$$T(\hat{\rho} - 1) \xrightarrow{d} \frac{\frac{1}{2}(W(1)^2 - 1)}{\int_0^1 W(r)^2 dr} $$
onde $W(r)$ √© um movimento Browniano padr√£o. A distribui√ß√£o limite do estimador √© um funcional do movimento Browniano, o que √© um resultado t√≠pico em modelos com ra√≠zes unit√°rias [^1, ^2].
> üí° **Exemplo Num√©rico:** Para ilustrar, vamos simular um passeio aleat√≥rio sem drift com $T=1000$ e erros $e_t \sim \mathcal{N}(0,1)$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)
> T = 1000
> errors = np.random.normal(0, 1, T)
> y = np.cumsum(errors)
>
> y_lag = y[:-1]
> y_current = y[1:]
>
> rho_hat = np.sum(y_current * y_lag) / np.sum(y_lag**2)
> print(f"Estimativa de rho (rho_hat): {rho_hat:.4f}")
>
> plt.plot(y)
> plt.title("Passeio Aleat√≥rio Simulado")
> plt.xlabel("Tempo")
> plt.ylabel("y_t")
> plt.show()
> ```
>
> Executando este c√≥digo, obteremos um valor de $\hat{\rho}$ pr√≥ximo de 1, confirmando a presen√ßa de uma raiz unit√°ria. O gr√°fico exibir√° um passeio aleat√≥rio t√≠pico. A distribui√ß√£o assint√≥tica de $T(\hat{\rho} - 1)$ seria, nesse caso, um funcional do movimento Browniano. Este exemplo pr√°tico ajuda a visualizar um processo com raiz unit√°ria e como o estimador se comporta.

#### Caso 2: Passeio Aleat√≥rio com Deriva (Drift) e Sem Constante ou Tend√™ncia na Regress√£o Estimada
Agora, considere o caso em que o verdadeiro processo √© um passeio aleat√≥rio com *drift* ($\mu \neq 0$):
$$y_t = \mu + y_{t-1} + e_t$$
E a regress√£o estimada √©:
$$y_t = \rho y_{t-1} + u_t$$
Nesse cen√°rio, a distribui√ß√£o assint√≥tica de $T(\hat{\rho}-1)$ ainda √© um funcional de um processo de movimento Browniano, mas diferente do caso sem *drift*. A distribui√ß√£o se torna:
$$T(\hat{\rho} - 1) \xrightarrow{d} \frac{\frac{1}{2}(W(1)^2 - 1) + \int_0^1 W(r) dr}{\int_0^1 W(r)^2 dr} $$
Note que a distribui√ß√£o do limite depende da integral de $W(r)$. A presen√ßa de um *drift* no verdadeiro processo afeta a distribui√ß√£o assint√≥tica do estimador, alterando a forma do funcional do movimento Browniano.
> üí° **Exemplo Num√©rico:** Vamos simular um passeio aleat√≥rio com drift $\mu = 0.1$ e $T = 1000$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)
> T = 1000
> mu = 0.1
> errors = np.random.normal(0, 1, T)
> y = np.cumsum(mu + errors)
>
> y_lag = y[:-1]
> y_current = y[1:]
>
> rho_hat = np.sum(y_current * y_lag) / np.sum(y_lag**2)
> print(f"Estimativa de rho (rho_hat): {rho_hat:.4f}")
>
> plt.plot(y)
> plt.title("Passeio Aleat√≥rio com Drift Simulado")
> plt.xlabel("Tempo")
> plt.ylabel("y_t")
> plt.show()
> ```
>
> Ao executar o c√≥digo, observamos que $\hat{\rho}$ ainda estar√° pr√≥ximo de 1, mas o passeio aleat√≥rio exibir√° uma tend√™ncia de crescimento devido ao drift. A distribui√ß√£o de $T(\hat{\rho} - 1)$ ser√° diferente do caso sem drift, mostrando o impacto do drift na distribui√ß√£o assint√≥tica do estimador.

**Teorema 2.1** A diferen√ßa na distribui√ß√£o assint√≥tica do estimador $\hat{\rho}$ entre os casos com e sem *drift* reside na presen√ßa do termo $\int_0^1 W(r) dr$ no numerador. Este termo, que surge devido √† acumula√ß√£o do *drift* ao longo do tempo, introduz uma assimetria na distribui√ß√£o assint√≥tica do estimador, tornando-a distinta daquela obtida no caso sem *drift*.
**Prova do Teorema 2.1:** A prova desse resultado pode ser obtida por meio da an√°lise da converg√™ncia do processo estoc√°stico que define a din√¢mica do modelo com *drift* para um processo de movimento Browniano com *drift* e a aplica√ß√£o do teorema de mapeamento cont√≠nuo. Os detalhes podem ser encontrados em [^3] e em textos avan√ßados sobre s√©ries temporais com ra√≠zes unit√°rias.

Para maior clareza, vamos detalhar a intui√ß√£o por tr√°s da prova do Teorema 2.1:
I. Primeiro, notamos que quando temos um passeio aleat√≥rio com drift, ou seja $y_t = \mu + y_{t-1} + e_t$, a acumula√ß√£o do termo $\mu$ ao longo do tempo torna o processo $y_t$ em um processo com uma componente linear crescente, dado que $\mathbb{E}(y_t) = \mu t$.

II. Em seguida, ao subtrairmos $y_{t-1}$ de ambos os lados, temos $y_t - y_{t-1} = \mu + e_t$. Ao somarmos essas diferen√ßas ao longo do tempo, temos que $y_T - y_0 = \sum_{t=1}^T (\mu + e_t) = \mu T + \sum_{t=1}^T e_t$.

III. O termo $\frac{1}{\sqrt{T}}\sum_{t=1}^T e_t$ converge em distribui√ß√£o para um processo de movimento browniano $W(1)$. No entanto, o termo $\mu T$ se torna dominante √† medida que $T$ cresce, gerando uma tend√™ncia linear no processo. Isso pode ser representado como $\frac{y_T}{\sqrt{T}} \xrightarrow{d} \mu \sqrt{T} + W(1)$.

IV. Aplicando os resultados da converg√™ncia funcional e do teorema de mapeamento cont√≠nuo, a distribui√ß√£o de $\frac{1}{T}\sum_{t=1}^{T}y_{t-1}e_t$ converge para $\frac{\sigma^2}{2}(W(1)^2-1)$, e $\frac{1}{T^2}\sum_{t=1}^T y_{t-1}^2$ converge para $\sigma^2 \int_0^1 W(r)^2dr$ quando o processo n√£o tem drift.

V. Quando o processo tem drift, a converg√™ncia de $\frac{1}{T}\sum_{t=1}^{T}y_{t-1}e_t$ √© afetada pelo drift $\mu$, resultando em um termo adicional $\sigma^2\int_0^1W(r)dr$. Assim, a distribui√ß√£o limite do termo $T(\hat{\rho}-1)$ inclui o termo adicional.

VI. Portanto, a presen√ßa do drift $\mu$ introduz o termo $\int_0^1 W(r) dr$ no numerador da distribui√ß√£o assint√≥tica, modificando sua forma e resultando na diferen√ßa observada no Teorema 2.1. ‚ñ†
#### Caso 3: Passeio Aleat√≥rio sem Deriva (Drift) e com Constante na Regress√£o Estimada
Neste cen√°rio, o verdadeiro processo √© um passeio aleat√≥rio sem *drift*:
$$y_t = y_{t-1} + e_t$$
E a regress√£o estimada inclui uma constante:
$$y_t = \alpha + \rho y_{t-1} + u_t$$
A inclus√£o de uma constante na regress√£o altera a distribui√ß√£o assint√≥tica do estimador de $\rho$, dada por
$$T(\hat{\rho} - 1) \xrightarrow{d} \frac{\frac{1}{2}(W(1)^2 - 1) - \int_0^1 W(r) dr \cdot W(1)}{\int_0^1 (W(r) - \bar{W})^2 dr} $$
onde $\bar{W} = \int_0^1 W(r)dr $. O funcional do movimento Browniano, nesse caso, √© mais complexo devido √† inclus√£o da m√©dia do movimento Browniano $\bar{W}$.
> üí° **Exemplo Num√©rico:** Vamos simular um passeio aleat√≥rio sem drift, com $T=1000$, e estimar o modelo com uma constante.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> import statsmodels.api as sm
>
> np.random.seed(42)
> T = 1000
> errors = np.random.normal(0, 1, T)
> y = np.cumsum(errors)
>
> y_lag = y[:-1]
> y_current = y[1:]
>
> X = sm.add_constant(y_lag)
> model = sm.OLS(y_current, X)
> results = model.fit()
> rho_hat = results.params[1]
> print(f"Estimativa de rho (rho_hat): {rho_hat:.4f}")
>
> plt.plot(y)
> plt.title("Passeio Aleat√≥rio com Constante na Regress√£o")
> plt.xlabel("Tempo")
> plt.ylabel("y_t")
> plt.show()
> ```
> Aqui, usamos `statsmodels` para incluir a constante na regress√£o. A distribui√ß√£o de $T(\hat{\rho} - 1)$ √© um funcional mais complexo do movimento Browniano.

**Corol√°rio 3.1** A inclus√£o de uma constante na regress√£o estimada, mesmo quando o processo verdadeiro n√£o possui *drift*, introduz um termo de corre√ß√£o que envolve a m√©dia do movimento Browniano ($\bar{W}$) na distribui√ß√£o limite. Essa corre√ß√£o √© crucial para garantir a consist√™ncia do estimador e para a realiza√ß√£o de infer√™ncia estat√≠stica adequada sobre o par√¢metro $\rho$.

Para entender a corre√ß√£o introduzida pelo Corol√°rio 3.1, vamos √† seguinte prova:

I. O estimador $\hat{\rho}$ no modelo com constante √© dado por:
$$\hat{\rho} = \frac{\sum_{t=2}^T (y_t - \bar{y})(y_{t-1} - \bar{y}_{-1})}{\sum_{t=2}^T (y_{t-1} - \bar{y}_{-1})^2}$$
Onde $\bar{y} = \frac{1}{T} \sum_{t=1}^T y_t$ e $\bar{y}_{-1} = \frac{1}{T} \sum_{t=0}^{T-1} y_t$.

II. No caso do passeio aleat√≥rio, temos que $y_t = y_{t-1} + e_t$. Assim, $y_t - y_{t-1} = e_t$ e $\sum_{t=2}^T (y_t - y_{t-1}) = y_T - y_1 = \sum_{t=2}^T e_t$.

III. A inclus√£o da constante na regress√£o resulta na necessidade de centrar os dados em torno de suas m√©dias amostrais. O termo $\bar{y}$ introduz a necessidade de considerar a m√©dia do processo em rela√ß√£o √† m√©dia amostral.

IV. Atrav√©s do teorema da converg√™ncia funcional, podemos escrever os termos como funcionais do movimento Browniano. A presen√ßa do termo $\int_0^1 W(r) dr$ surge da converg√™ncia da m√©dia amostral $\bar{y}$ para a integral do movimento browniano.

V. Ao expressar o numerador e o denominador da express√£o de $\hat{\rho}$ em termos de funcionais do movimento Browniano, o termo $\int_0^1 W(r) dr \cdot W(1)$ surge no numerador e $\int_0^1 (W(r) - \bar{W})^2 dr$ no denominador, capturando a corre√ß√£o introduzida pela inclus√£o da constante.

VI. Portanto, a presen√ßa da constante na regress√£o estimada altera o comportamento assint√≥tico do estimador $\hat{\rho}$, e a corre√ß√£o expressa pelo Corol√°rio 3.1 √© necess√°ria para o correto c√°lculo das distribui√ß√µes assint√≥ticas. ‚ñ†

#### Caso 4: Passeio Aleat√≥rio sem Deriva (Drift) e com Tend√™ncia na Regress√£o Estimada
Finalmente, considere o cen√°rio em que o verdadeiro processo √© um passeio aleat√≥rio sem *drift*:
$$y_t = y_{t-1} + e_t$$
E a regress√£o estimada inclui uma tend√™ncia temporal:
$$y_t = \alpha + \beta t + \rho y_{t-1} + u_t$$
Neste caso, a distribui√ß√£o assint√≥tica do estimador $\hat{\rho}$ √© ainda mais complexa, e √© dada por:
$$T(\hat{\rho} - 1) \xrightarrow{d} \frac{\frac{1}{2}(W(1)^2 - 1) - \int_0^1 r W(r) dr \cdot \left( 2W(1) - 3\int_0^1 W(r) dr \right)}{\int_0^1( W(r) - (\int_0^1 W(s) ds) (4-6r) - 2r W(1) + 3r^2 \int_0^1 W(s) ds)^2 dr}$$
Aqui, a presen√ßa da tend√™ncia temporal na regress√£o estimada modifica substancialmente a forma do funcional do movimento Browniano na distribui√ß√£o limite de $\hat{\rho}$.
> üí° **Exemplo Num√©rico:** Simulemos um passeio aleat√≥rio sem drift, com $T = 1000$, e ajustemos uma regress√£o com tend√™ncia.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> import statsmodels.api as sm
>
> np.random.seed(42)
> T = 1000
> errors = np.random.normal(0, 1, T)
> y = np.cumsum(errors)
>
> y_lag = y[:-1]
> y_current = y[1:]
>
> t = np.arange(1, T)
> X = np.column_stack([np.ones(T-1), t, y_lag])
> model = sm.OLS(y_current, X)
> results = model.fit()
> rho_hat = results.params[2]
> print(f"Estimativa de rho (rho_hat): {rho_hat:.4f}")
>
> plt.plot(y)
> plt.title("Passeio Aleat√≥rio com Tend√™ncia na Regress√£o")
> plt.xlabel("Tempo")
> plt.ylabel("y_t")
> plt.show()
> ```
> Aqui, adicionamos uma tend√™ncia temporal `t` e usamos `statsmodels` para estimar o modelo. A distribui√ß√£o assint√≥tica √© mais complexa.

**Proposi√ß√£o 4.1** A complexidade da distribui√ß√£o assint√≥tica no caso da inclus√£o de uma tend√™ncia temporal reflete a necessidade de levar em considera√ß√£o a din√¢mica temporal do processo na modelagem. A presen√ßa de termos envolvendo a integral de $rW(r)$ e combina√ß√µes lineares de $W(1)$ e $\int_0^1 W(r)dr$ na distribui√ß√£o limite indicam a forte intera√ß√£o entre a tend√™ncia temporal e o processo estoc√°stico.

**Lema 4:** A distribui√ß√£o assint√≥tica do estimador $\hat{\rho}$ em um modelo AR(1) com raiz unit√°ria √© n√£o convencional, sendo um funcional do movimento Browniano, e sua forma espec√≠fica depende de fatores como a presen√ßa ou aus√™ncia de uma constante ou tend√™ncia na regress√£o estimada, bem como a exist√™ncia ou n√£o de um drift n√£o nulo no processo verdadeiro.
**Prova do Lema 4:** A demonstra√ß√£o detalhada desse resultado envolve t√©cnicas de c√°lculo estoc√°stico, e pode ser encontrada em [^3]

A seguir detalhamos os principais pontos da prova do Lema 4:
I. O ponto de partida √© o estimador de m√≠nimos quadrados ordin√°rios (MQO) para $\rho$, que no modelo AR(1) √© dado por: $\hat{\rho} = \frac{\sum_{t=2}^T y_t y_{t-1}}{\sum_{t=2}^T y_{t-1}^2}$

II. O resultado assint√≥tico de $\hat{\rho}$ √© obtido usando converg√™ncia fraca (ou converg√™ncia em distribui√ß√£o). Ao analisarmos o processo $y_t$ como um passeio aleat√≥rio com poss√≠vel drift, n√≥s precisamos normalizar a s√©rie por $\sqrt{T}$ para obter converg√™ncia em um processo estoc√°stico cont√≠nuo, que no caso √© um movimento browniano.

III. Quando lidamos com um processo com raiz unit√°ria, a converg√™ncia do estimador de $\rho$ n√£o acontece na taxa usual $1/\sqrt{T}$ como no caso de processos estacion√°rios, mas na taxa $1/T$. Isso faz com que seja necess√°rio analisar a converg√™ncia de $T(\hat{\rho}-1)$ para que a distribui√ß√£o limite n√£o seja degenerada em um √∫nico ponto.

IV. Para provar o Lema 4, devemos utilizar ferramentas de converg√™ncia funcional e teoremas do limite central funcional. Ao trabalhar com as s√©ries normalizadas, mostramos que o comportamento assint√≥tico dos estimadores pode ser expresso em termos de integrais e funcionais do movimento Browniano, que s√£o os limites dos processos escalonados.

V. A diferen√ßa entre os casos que envolvem diferentes regress√µes (com ou sem intercepto, com ou sem tend√™ncia) reside na inclus√£o dos termos determin√≠sticos (constante ou tend√™ncia temporal), que causam a necessidade de centrar a s√©rie em rela√ß√£o √†s m√©dias amostrais e outras corre√ß√µes (ver prova do Corol√°rio 3.1), gerando distribui√ß√µes assint√≥ticas com termos adicionais.

VI. Finalmente, ao aplicar os resultados de converg√™ncia e t√©cnicas de c√°lculo estoc√°stico, podemos demonstrar que a distribui√ß√£o assint√≥tica de $T(\hat{\rho}-1)$ √© um funcional do movimento Browniano, como expresso no Lema 4 e nos diferentes casos analisados. A forma espec√≠fica do funcional depende da especifica√ß√£o da regress√£o, e esta demonstra√ß√£o detalhada pode ser encontrada em textos mais avan√ßados sobre s√©ries temporais com raiz unit√°ria [^3]. ‚ñ†

### Conclus√£o
Este cap√≠tulo analisou a influ√™ncia da inclus√£o de um termo constante, de uma tend√™ncia temporal na regress√£o estimada, e da presen√ßa de um *drift* no processo verdadeiro, na distribui√ß√£o assint√≥tica do coeficiente estimado em modelos AR(1) com raiz unit√°ria. Vimos que, diferentemente dos processos estacion√°rios, a distribui√ß√£o assint√≥tica n√£o converge para uma normal, mas sim para funcionais do movimento Browniano, cuja forma depende do modelo que √© estimado e do verdadeiro processo. Os resultados obtidos refor√ßam a complexidade do comportamento assint√≥tico de processos com ra√≠zes unit√°rias e destacam a import√¢ncia do movimento Browniano na descri√ß√£o das propriedades assint√≥ticas. Este conhecimento √© essencial para a realiza√ß√£o de testes de hip√≥teses sobre a presen√ßa de ra√≠zes unit√°rias, com especial cuidado para a inclus√£o de elementos como intercepto ou tend√™ncia, que afetam a distribui√ß√£o assint√≥tica dos testes.
**Observa√ß√£o Final:** A an√°lise apresentada neste cap√≠tulo √© fundamental para a compreens√£o do comportamento dos estimadores em modelos com ra√≠zes unit√°rias. Os resultados obtidos aqui servem de base para o desenvolvimento de testes de raiz unit√°ria, que s√£o cruciais para a an√°lise de s√©ries temporais em diversas √°reas do conhecimento. Al√©m disso, a compreens√£o da influ√™ncia da inclus√£o de termos determin√≠sticos na regress√£o estimada √© essencial para a modelagem adequada de processos com raiz unit√°ria.

### Refer√™ncias
[^1]: Cap√≠tulo 17 do texto base.
[^2]: Hamilton, James D. *Time series analysis*. Princeton university press, 2020.
[^3]: Davidson, James. *Stochastic limit theory: an introduction for econometricians*. Oxford University Press, 1994.
<!-- END -->
