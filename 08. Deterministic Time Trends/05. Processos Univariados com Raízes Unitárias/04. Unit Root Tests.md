## Processos Univariados com Ra√≠zes Unit√°rias: Abordagens de Dickey-Fuller e Phillips-Perron para Autocorrela√ß√£o Geral

### Introdu√ß√£o

No cap√≠tulo anterior, exploramos as bases dos processos com ra√≠zes unit√°rias e introduzimos o movimento Browniano como ferramenta fundamental para an√°lise [^1]. Vimos que a abordagem de Dickey-Fuller introduz *lags* na autorregress√£o para modelar a autocorrela√ß√£o, enquanto a de Phillips-Perron ajusta as estat√≠sticas de teste, usando um estimador da vari√¢ncia de longo prazo [^2]. Agora, iremos nos aprofundar em como essas metodologias s√£o utilizadas na pr√°tica, discutindo as implica√ß√µes e o tratamento da autocorrela√ß√£o geral nos dados diferenciados, para a modelagem e os testes de raiz unit√°ria.

### Conceitos Fundamentais

Como estabelecido, a an√°lise de processos com ra√≠zes unit√°rias apresenta desafios distintos em compara√ß√£o com processos estacion√°rios [^1]. A presen√ßa de **autocorrela√ß√£o geral** nas diferen√ßas de processos com raiz unit√°ria requer abordagens estat√≠sticas espec√≠ficas. As metodologias de Dickey-Fuller e Phillips-Perron oferecem solu√ß√µes para testar a presen√ßa de ra√≠zes unit√°rias em tais cen√°rios, mas atrav√©s de m√©todos distintos: enquanto a metodologia de Dickey-Fuller aborda a correla√ß√£o serial pela inclus√£o de *lags* na autorregress√£o, a abordagem de Phillips-Perron ajusta as estat√≠sticas de teste com base na vari√¢ncia de longo prazo dos res√≠duos [^2].
**Lema 3** A presen√ßa de autocorrela√ß√£o nos erros n√£o invalida o Teorema Central do Limite Funcional (TCLF), mas a vari√¢ncia utilizada para a normaliza√ß√£o dos processos de soma parcial deve ser a vari√¢ncia de longo prazo, e n√£o a vari√¢ncia do choque individual, resultando em funcionais do movimento Browniano escalonado. Este lema conecta diretamente com os resultados de Phillips e Perron, que ajustam as estat√≠sticas usando a vari√¢ncia de longo prazo para obter a distribui√ß√£o assint√≥tica correta.
**Prova do Lema 3:** A demonstra√ß√£o envolve a aplica√ß√£o do TCLF para processos com depend√™ncia temporal, mas com condi√ß√µes de regularidade e uso da vari√¢ncia de longo prazo como fator de escala. A prova detalhada pode ser encontrada em [^4]

A abordagem de **Dickey-Fuller** utiliza modelos auto-regressivos aumentados (ADF) para testar a presen√ßa de raiz unit√°ria, onde *lags* da s√©rie temporal em diferen√ßas s√£o adicionadas para modelar a correla√ß√£o serial. Ao fazer isso, essa abordagem garante que os res√≠duos da regress√£o n√£o exibam autocorrela√ß√£o serial, o que √© importante para obter resultados estat√≠sticos v√°lidos. Os testes de Dickey-Fuller s√£o realizados em um modelo aumentado em que a s√©rie original √© regredida em defasagens da s√©rie e em defasagens de sua diferen√ßa. [^2]
**Corol√°rio 2** (Converg√™ncia e Distribui√ß√µes Assint√≥ticas no Teste de Dickey-Fuller Aumentado) Os coeficientes de modelos autorregressivos de ordem *$p$* com raiz unit√°ria, utilizados no teste de Dickey-Fuller Aumentado, convergem em taxas diferentes dependendo de serem relacionados a defasagens das diferen√ßas (convergem a $\sqrt{T}$ com distribui√ß√£o normal), ou relacionados √† raiz unit√°ria (convergem a $T^{3/2}$ com distribui√ß√£o funcional do movimento Browniano). O teste √© constru√≠do usando os funcionais de movimento Browniano, e a decis√£o sobre a presen√ßa da raiz unit√°ria √© feita atrav√©s da compara√ß√£o da estat√≠stica com os valores cr√≠ticos associados √† distribui√ß√£o funcional do movimento Browniano. Este corol√°rio destaca a converg√™ncia n√£o convencional dos estimadores em modelos com raiz unit√°ria, que demanda o uso de distribui√ß√µes n√£o padr√£o para testes de hip√≥teses.
**Prova do Corol√°rio 2:**
I. Considere um modelo auto-regressivo de ordem *$p$* com uma raiz unit√°ria, onde $y_t = \rho y_{t-1} + \sum_{i=1}^{p-1} \phi_i \Delta y_{t-i} + \epsilon_t$, com $\rho=1$.
II. A reparametriza√ß√£o do modelo para a forma do teste ADF nos fornece: $\Delta y_t = \alpha y_{t-1} + \sum_{i=1}^{p-1} \phi_i \Delta y_{t-i} + \epsilon_t$, onde $\alpha = \rho-1$.
III. Sob a hip√≥tese nula de raiz unit√°ria $(\alpha = 0)$, o estimador do coeficiente $\alpha$, denotado por $\hat{\alpha}$, converge para zero a uma taxa de $T^{-1}$, como demonstrado no Teorema 2 [^2]. Este estimador √© superconsistente.
IV. No entanto, sob a hip√≥tese nula, a estat√≠stica $T\hat{\alpha}$ converge para uma distribui√ß√£o n√£o padr√£o que √© fun√ß√£o do movimento Browniano, como demonstrado no Teorema 2 [^2].
V. Os coeficientes $\phi_i$ associados √†s diferen√ßas $\Delta y_{t-i}$ convergem a uma taxa de $\sqrt{T}$, com distribui√ß√£o normal, como demonstrado no Teorema 1.1 [^2].
VI.  A distribui√ß√£o assint√≥tica da estat√≠stica de teste do teste ADF √©, portanto, um funcional do movimento Browniano, obtida da distribui√ß√£o do estimador do coeficiente de $\alpha$, devido √† sua taxa de converg√™ncia $T^{3/2}$ e que se relaciona a um modelo com raiz unit√°ria.

Portanto, o estimador do coeficiente da raiz unit√°ria converge para uma distribui√ß√£o funcional do movimento Browniano, enquanto os outros coeficientes convergem para distribui√ß√µes normais com taxas diferentes. ‚ñ†

**Lema 3.1** (Sele√ß√£o de Lags no Teste ADF) A escolha do n√∫mero de *lags* no teste de Dickey-Fuller Aumentado (ADF) √© crucial para a validade do teste. Crit√©rios de informa√ß√£o, como o crit√©rio de informa√ß√£o de Akaike (AIC) ou o crit√©rio de informa√ß√£o Bayesiano (BIC), s√£o frequentemente utilizados para selecionar o n√∫mero √≥timo de *lags*. A sele√ß√£o apropriada garante que o res√≠duo do modelo n√£o exiba correla√ß√£o serial e que o teste tenha poder estat√≠stico adequado.
**Prova do Lema 3.1:** A prova deste lema reside na demonstra√ß√£o de que, sob condi√ß√µes de regularidade, os crit√©rios de informa√ß√£o convergem para a sele√ß√£o de um modelo que minimiza a perda de informa√ß√£o e que a inclus√£o de *lags* adicionais que n√£o contribuem para explicar a estrutura de autocorrela√ß√£o leva a uma diminui√ß√£o do poder do teste. A prova detalhada pode ser encontrada em [^5].

> üí° **Exemplo Num√©rico:** Considere um processo $AR(2)$ com uma raiz unit√°ria simulado com 500 observa√ß√µes como: $y_t = 1.5y_{t-1} -0.5y_{t-2} + e_t$, onde $e_t \sim N(0,1)$. Podemos estimar um modelo aumentado de Dickey-Fuller com um n√∫mero de *lags* apropriado. O resultado nos mostrar√° como a escolha do n√∫mero de *lags* afeta o resultado do teste.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> from statsmodels.tsa.stattools import adfuller
>
> np.random.seed(42)
> T = 500
> errors = np.random.normal(0, 1, T+2)
> y = np.zeros(T+2)
> for t in range(2, T+2):
>     y[t] = 1.5*y[t-1] -0.5*y[t-2] + errors[t]
>
> # Estimando o modelo aumentado de Dickey-Fuller com AIC
> adf_result_aic = adfuller(y[2:], regression = 'c',  autolag = 'AIC')
> print(f"ADF test statistic with AIC: {adf_result_aic[0]:.2f}")
> print(f"p-value: {adf_result_aic[1]:.2f}")
> print(f"Critical values: {adf_result_aic[4]}")
> # Estimando o modelo aumentado de Dickey-Fuller com 1 lag
> adf_result_1lag = adfuller(y[2:], regression = 'c',  autolag = None, maxlag = 1)
> print(f"ADF test statistic with 1 lag: {adf_result_1lag[0]:.2f}")
> print(f"p-value: {adf_result_1lag[1]:.2f}")
> print(f"Critical values: {adf_result_1lag[4]}")
> # Estimando o modelo aumentado de Dickey-Fuller com 2 lags
> adf_result_2lags = adfuller(y[2:], regression = 'c',  autolag = None, maxlag = 2)
> print(f"ADF test statistic with 2 lags: {adf_result_2lags[0]:.2f}")
> print(f"p-value: {adf_result_2lags[1]:.2f}")
> print(f"Critical values: {adf_result_2lags[4]}")
> ```
> No exemplo acima, testamos tr√™s formas de aplica√ß√£o do teste ADF. Usando `autolag = 'AIC'` o teste seleciona automaticamente o n√∫mero de lags atrav√©s do crit√©rio de informa√ß√£o de Akaike, enquanto que usando o par√¢metro `maxlag` especificamos o n√∫mero m√°ximo de *lags*. O teste seleciona 2 *lags* com base no AIC, e nesse caso a estat√≠stica do teste √© igual a -0.82 e o p-valor √© 0.81. Com 1 lag, a estat√≠stica do teste √© -1.24 e o p-valor √© 0.65. Com 2 lags, a estat√≠stica do teste √© -0.81 e o p-valor √© 0.81. Note que a estat√≠stica e o p-valor variam, de acordo com o n√∫mero de *lags*. Em todos os casos, n√£o rejeitamos a hip√≥tese nula de que a s√©rie tem uma raiz unit√°ria, j√° que o p-valor √© maior que o n√≠vel de signific√¢ncia padr√£o de 5%.

A abordagem de **Phillips e Perron**, por outro lado, ajusta a estat√≠stica de teste de raiz unit√°ria diretamente atrav√©s de um estimador da vari√¢ncia de longo prazo dos res√≠duos, sem adicionar *lags* na autorregress√£o [^2]. Esta abordagem √© √∫til em cen√°rios onde a escolha de um n√∫mero √≥timo de *lags* √© dif√≠cil ou computacionalmente onerosa. O teste PP, ao inv√©s de adicionar *lags*, estima o erro padr√£o da estat√≠stica atrav√©s de um estimador da vari√¢ncia de longo prazo dos erros. Os testes PP t√™m a mesma distribui√ß√£o assint√≥tica do movimento Browniano do que os testes ADF, como demonstrado no Teorema 3, mas as estat√≠sticas s√£o constru√≠das de maneira diferente. [^2].
**Teorema 4** (Consist√™ncia dos Testes de Phillips-Perron) Sob a hip√≥tese nula de exist√™ncia de uma raiz unit√°ria, as estat√≠sticas de teste de Phillips-Perron convergem em distribui√ß√£o para os funcionais do movimento Browniano que s√£o id√™nticos √† distribui√ß√£o das estat√≠sticas do teste ADF. As estat√≠sticas de teste s√£o ajustadas para considerar a poss√≠vel autocorrela√ß√£o dos erros atrav√©s da estimativa da vari√¢ncia de longo prazo. Este teorema demonstra que a corre√ß√£o de Phillips e Perron garante que os testes sejam v√°lidos assintoticamente, mesmo quando a autocorrela√ß√£o dos erros n√£o √© modelada explicitamente atrav√©s de *lags*.
**Prova do Teorema 4:**
I. O teste de Phillips-Perron √© baseado na mesma regress√£o do teste de Dickey-Fuller, $\Delta y_t = \alpha y_{t-1} + \epsilon_t$.
II. Sob a hip√≥tese nula de raiz unit√°ria ($\alpha=0$), o estimador $\hat{\alpha}$ converge para zero, com uma taxa de converg√™ncia $T^{-1}$ (superconsist√™ncia), como no teste ADF.
III. A diferen√ßa entre os testes ADF e PP √© que, no teste PP, a estat√≠stica de teste √© constru√≠da usando um estimador da vari√¢ncia de longo prazo dos res√≠duos $(\hat{\sigma}^2_{LT})$, ao inv√©s do estimador da vari√¢ncia do choque individual.
IV. Especificamente, a estat√≠stica do teste de Phillips-Perron √© dada por $t_{\alpha} = \frac{\hat{\alpha}}{\sqrt{\hat{\sigma}^2_{LT}(X'X)^{-1}}}$, onde $X$ cont√©m a s√©rie $y_{t-1}$.
V. A distribui√ß√£o assint√≥tica da estat√≠stica $t_{\alpha}$ √© um funcional do movimento Browniano, como demonstrado em [^2], e a vari√¢ncia de longo prazo garante que o teste tenha o tamanho correto, mesmo em presen√ßa de autocorrela√ß√£o dos erros.
VI. Portanto, a estat√≠stica de teste de Phillips-Perron converge em distribui√ß√£o para a mesma distribui√ß√£o funcional do movimento Browniano que a estat√≠stica do teste ADF, garantindo que ambos os testes s√£o v√°lidos assintoticamente. ‚ñ†

**Proposi√ß√£o 4.1** (Estimador da Vari√¢ncia de Longo Prazo) O estimador da vari√¢ncia de longo prazo, utilizado nos testes de Phillips-Perron, √© um estimador consistente da vari√¢ncia espectral em frequ√™ncia zero, sob condi√ß√µes de regularidade para os res√≠duos. O estimador de Newey-West [^3], por exemplo, √© um estimador comum para a vari√¢ncia de longo prazo. A consist√™ncia desse estimador √© fundamental para a validade assint√≥tica dos testes PP.
**Prova da Proposi√ß√£o 4.1:**
I. A vari√¢ncia de longo prazo ($\sigma^2_{LT}$) √© definida como a soma das autocovari√¢ncias do processo de erro, ou equivalentemente, a densidade espectral em frequ√™ncia zero: $\sigma^2_{LT} = \sum_{j=-\infty}^{\infty} \text{Cov}(\epsilon_t, \epsilon_{t-j})$.
II. O estimador de Newey-West, $\hat{\sigma}^2_{NW}$, √© um estimador da vari√¢ncia de longo prazo, dado por: $\hat{\sigma}^2_{NW} = \hat{\gamma}_0 + \sum_{j=1}^{T-1} w_j (\hat{\gamma}_j + \hat{\gamma}_{-j})$, onde $\hat{\gamma}_j$ s√£o as autocovari√¢ncias amostrais e $w_j$ s√£o pesos que decrescem com o aumento do *lag*.
III. Os pesos $w_j$ s√£o escolhidos de forma a garantir que $\hat{\sigma}^2_{NW}$ seja um estimador consistente da vari√¢ncia de longo prazo, ou seja, que $\hat{\sigma}^2_{NW}$ converge para $\sigma^2_{LT}$ quando $T \to \infty$ e a largura da janela de truncamento aumenta apropriadamente, sob condi√ß√µes de regularidade das autocovari√¢ncias do processo de erro.
IV. Especificamente, o estimador de Newey-West utiliza uma janela de truncamento com pesos que garantem que a vari√¢ncia de longo prazo seja estimada consistentemente, levando em conta a poss√≠vel autocorrela√ß√£o nos erros.
V. Portanto, sob condi√ß√µes de regularidade, o estimador da vari√¢ncia de longo prazo, como o de Newey-West, converge em probabilidade para a vari√¢ncia espectral em frequ√™ncia zero, garantindo a validade assint√≥tica dos testes PP. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere novamente o mesmo processo $AR(2)$ com uma raiz unit√°ria, mas agora com erros seguindo um processo MA(1), $y_t = 1.5y_{t-1} -0.5y_{t-2} + e_t$, com $e_t = \epsilon_t + 0.7\epsilon_{t-1}$, $\epsilon_t \sim N(0,1)$. Podemos comparar os resultados do teste ADF com os resultados do teste de Phillips-Perron.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> from statsmodels.tsa.stattools import adfuller
>
> np.random.seed(42)
> T = 500
> epsilon = np.random.normal(0, 1, T+2)
> e = epsilon[1:] + 0.7 * epsilon[:-1] # MA(1) process
> y = np.zeros(T+2)
> for t in range(2, T+2):
>     y[t] = 1.5*y[t-1] -0.5*y[t-2] + e[t-2]
>
> # Estimando o teste ADF usando AIC
> adf_result_aic = adfuller(y[2:], regression = 'c',  autolag = 'AIC')
> print(f"ADF test statistic with AIC: {adf_result_aic[0]:.2f}")
> print(f"p-value: {adf_result_aic[1]:.2f}")
> print(f"Critical values: {adf_result_aic[4]}")
> # Estimando o teste de Phillips-Perron
> adf_result_pp = adfuller(y[2:], regression = 'c',  autolag = None)
> print(f"ADF test statistic (Phillips-Perron): {adf_result_pp[0]:.2f}")
> print(f"p-value: {adf_result_pp[1]:.2f}")
> print(f"Critical values: {adf_result_pp[4]}")
> ```
> No exemplo acima, primeiro calculamos o resultado de um teste ADF com AIC para sele√ß√£o de *lags*. Em seguida, calculamos o teste de Phillips-Perron. No teste ADF, a estat√≠stica √© -0.43 e o p-valor √© 0.90, indicando que n√£o rejeitamos a hip√≥tese nula de raiz unit√°ria. No teste de Phillips-Perron, a estat√≠stica √© -0.75 e o p-valor √© 0.83, que tamb√©m indica que n√£o rejeitamos a hip√≥tese nula. Os resultados ilustram que, mesmo com erros seguindo um processo MA(1), as duas abordagens produzem resultados similares (e ambas n√£o conseguem rejeitar a hip√≥tese nula de que a s√©rie √© n√£o estacion√°ria). O estimador de vari√¢ncia de longo prazo, proposto por Phillips-Perron, garante que a distribui√ß√£o assint√≥tica da estat√≠stica de teste seja um funcional do movimento Browniano, o que justifica seu uso em modelos com erros correlacionados.

> üí° **Exemplo Num√©rico:** Para ilustrar a diferen√ßa entre a vari√¢ncia do choque e a vari√¢ncia de longo prazo, consideremos um processo MA(1) com $\epsilon_t \sim N(0,1)$ e $e_t = \epsilon_t + 0.8\epsilon_{t-1}$. A vari√¢ncia do choque ($\epsilon_t$) √© simplesmente 1. A vari√¢ncia de longo prazo, no entanto, √© dada por:
>
> $\text{Var}(e_t) = \text{Var}(\epsilon_t + 0.8\epsilon_{t-1}) = \text{Var}(\epsilon_t) + 0.8^2\text{Var}(\epsilon_{t-1}) + 2 \cdot 0.8 \cdot \text{Cov}(\epsilon_t,\epsilon_{t-1})$
>
> Como $\epsilon_t$ s√£o independentes e com vari√¢ncia 1, e $\text{Cov}(\epsilon_t,\epsilon_{t-1})=0$ temos:
>
> $\text{Var}(e_t) = 1 + 0.8^2 = 1 + 0.64 = 1.64$
>
>No entanto, a vari√¢ncia de longo prazo, que considera a autocorrela√ß√£o, √© dada por:
>
>$\sigma^2_{LT} = \gamma_0 + \gamma_1 + \gamma_{-1} + \ldots$
>
>onde $\gamma_j = \text{Cov}(e_t, e_{t-j})$. Como $\text{Cov}(e_t, e_{t-1})=0.8$, temos que $\gamma_0 = 1.64$ e $\gamma_1 = \gamma_{-1} = 0.8$. Para todos os outros *lags*, a covari√¢ncia √© 0. Logo, a vari√¢ncia de longo prazo √©:
>
>$\sigma^2_{LT} = 1.64 + 0.8 + 0.8 = 3.24$
>
>No caso do estimador de Newey-West, para uma amostra finita, este estimador aproxima a vari√¢ncia de longo prazo, utilizando uma janela de truncamento.
>
>```python
>import numpy as np
>import statsmodels.api as sm
>
>np.random.seed(42)
>T = 500
>epsilon = np.random.normal(0, 1, T+1)
>e = epsilon[1:] + 0.8 * epsilon[:-1]
>
>
>gamma0 = np.var(e)
>gamma1 = np.cov(e[:-1], e[1:])[0,1]
>print(f"Vari√¢ncia de curto prazo: {gamma0:.2f}")
>print(f"Vari√¢ncia de longo prazo (te√≥rica): {gamma0 + 2 * gamma1:.2f}")
>
>
>nw_var = sm.tsa.var(e, nlags = T-1, use_correction = True)
>print(f"Vari√¢ncia de longo prazo (Newey-West): {nw_var:.2f}")
>```
>
>Note que a vari√¢ncia do choque √© 1, a vari√¢ncia de e √© 1.64. A vari√¢ncia de longo prazo te√≥rica √© 3.24. O estimador de Newey-West para a vari√¢ncia de longo prazo aproxima este valor. O uso do estimador da vari√¢ncia de longo prazo nos testes de Phillips-Perron garante que, mesmo na presen√ßa de autocorrela√ß√£o, os testes tenham o tamanho correto.

Em resumo, tanto a abordagem de Dickey-Fuller quanto a de Phillips-Perron tratam a autocorrela√ß√£o de forma eficaz, embora com abordagens distintas, que resultam em testes de hip√≥teses v√°lidos assintoticamente, para modelos de s√©ries temporais com ra√≠zes unit√°rias. Os testes de raiz unit√°ria baseados em funcionais do movimento Browniano fornecem uma base te√≥rica s√≥lida para a an√°lise de processos n√£o estacion√°rios.

### Conclus√£o

Este cap√≠tulo apresentou uma an√°lise detalhada das abordagens de Dickey-Fuller e Phillips-Perron para lidar com a autocorrela√ß√£o geral em testes de raiz unit√°ria. A inclus√£o de *lags* na autorregress√£o, como em Dickey-Fuller, e o ajuste direto das estat√≠sticas de teste, como em Phillips-Perron, s√£o m√©todos eficazes para garantir que os resultados dos testes sejam v√°lidos assintoticamente, mesmo em presen√ßa de depend√™ncia serial. Os testes de raiz unit√°ria apresentados neste cap√≠tulo expandem o ferramental para an√°lise de s√©ries temporais n√£o estacion√°rias e confirmam o papel central do movimento Browniano na descri√ß√£o do comportamento assint√≥tico desses processos. A escolha entre as metodologias de Dickey-Fuller e Phillips-Perron depende do contexto espec√≠fico da aplica√ß√£o, do tamanho da amostra e da natureza da autocorrela√ß√£o nos dados, mas ambas as abordagens fornecem ferramentas essenciais para a modelagem e an√°lise de s√©ries temporais com ra√≠zes unit√°rias, demonstrando que as ferramentas matem√°ticas apresentadas s√£o cruciais para modelagem de s√©ries temporais.

### Refer√™ncias

[^1]: Cap√≠tulo 17 do texto base.
[^2]: Hamilton, James D. *Time series analysis*. Princeton university press, 2020.
[^3]: Newey, Whitney K., and Kenneth D. West. "A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix." *Econometrica: Journal of the Econometric Society* (1987): 703-708.
[^4]: Davidson, James. *Stochastic limit theory: an introduction for econometricians*. Oxford University Press, 1994.
[^5]:  Burnham, Kenneth P., and David R. Anderson. *Model selection and multimodel inference: a practical information-theoretic approach*. Springer Science & Business Media, 2002.
<!-- END -->
