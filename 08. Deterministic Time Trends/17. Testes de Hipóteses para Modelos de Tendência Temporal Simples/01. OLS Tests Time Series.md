## Testes de Hip√≥teses em Modelos de Tend√™ncia Temporal Simples: Validade Assint√≥tica dos Testes OLS

### Introdu√ß√£o
Este cap√≠tulo aborda a infer√™ncia estat√≠stica para modelos de s√©ries temporais com tend√™ncia temporal determin√≠stica, focando na validade assint√≥tica dos testes t e F de m√≠nimos quadrados ordin√°rios (OLS). Como vimos anteriormente [^1], os coeficientes em modelos de regress√£o com tend√™ncias temporais determin√≠sticas s√£o tipicamente estimados por OLS. No entanto, as distribui√ß√µes assint√≥ticas das estimativas dos coeficientes n√£o podem ser calculadas da mesma forma que para modelos de regress√£o envolvendo vari√°veis estacion√°rias. Especificamente, as estimativas de diferentes par√¢metros geralmente exibem taxas de converg√™ncia assint√≥tica distintas. No entanto, este cap√≠tulo demonstra que, apesar dessas diferentes taxas de converg√™ncia, os testes t e F usuais, calculados da maneira tradicional, mant√™m suas distribui√ß√µes assint√≥ticas padr√£o.

### Conceitos Fundamentais
O ponto chave deste cap√≠tulo √© mostrar que, embora as estimativas dos coeficientes em modelos com tend√™ncias temporais possam ter diferentes taxas de converg√™ncia, os erros padr√£o dessas estimativas tamb√©m se ajustam de forma a garantir a validade assint√≥tica dos testes t e F de OLS. Come√ßamos considerando o modelo de tend√™ncia temporal simples [^2]:
$$y_t = \alpha + \delta t + \epsilon_t$$
onde $\epsilon_t$ √© um processo de ru√≠do branco. Ao aplicar OLS, obtemos estimativas $\hat{\alpha}_T$ e $\hat{\delta}_T$ para $\alpha$ e $\delta$, respectivamente [^3]. √â importante notar que, enquanto as estimativas $\hat{\alpha}_T$ e $\hat{\delta}_T$ convergem para seus valores verdadeiros, elas o fazem a diferentes taxas: $\hat{\alpha}_T$ converge a uma taxa de $T^{1/2}$ e $\hat{\delta}_T$ converge a uma taxa de $T^{3/2}$ [^4].

> üí° **Exemplo Num√©rico:** Suponha que temos uma s√©rie temporal com 100 observa√ß√µes ($T=100$) e ajustamos o modelo $y_t = \alpha + \delta t + \epsilon_t$. Ap√≥s a estima√ß√£o por OLS, obtivemos $\hat{\alpha} = 5.2$ e $\hat{\delta} = 0.15$.  A taxa de converg√™ncia de $\hat{\alpha}$ √© de $T^{1/2}=10$, enquanto a de $\hat{\delta}$ √© de $T^{3/2} = 1000$. Isso significa que, √† medida que aumentamos o tamanho da amostra, a precis√£o de $\hat{\delta}$ melhora muito mais rapidamente do que a de $\hat{\alpha}$.

Uma an√°lise mais detalhada do modelo de tend√™ncia temporal simples [^5] mostra que a matriz de covari√¢ncia dos estimadores  $(\hat{\alpha}_T, \hat{\delta}_T)$ , ap√≥s o redimensionamento apropriado com a matriz $\Upsilon_T$ [^6], converge para uma matriz bem definida. Isso implica que as estat√≠sticas de teste comumente usadas, baseadas em estimativas de OLS, t√™m as mesmas distribui√ß√µes assint√≥ticas encontradas em regress√µes com vari√°veis estacion√°rias.
**Lema 1**
A matriz de covari√¢ncia dos estimadores $(\hat{\alpha}_T, \hat{\delta}_T)$, denotada por $Cov(\hat{\alpha}_T, \hat{\delta}_T)$, ap√≥s o redimensionamento por $\Upsilon_T$, converge para uma matriz bem definida. Formalmente:
$$
\lim_{T \to \infty} \Upsilon_T Cov(\hat{\alpha}_T, \hat{\delta}_T) \Upsilon_T = Q^{-1}
$$
onde $Q = \lim_{T \to \infty} \frac{1}{T^3} X'X$ √© uma matriz positiva definida.
*Prova:* A prova decorre das propriedades dos estimadores OLS e da matriz de escala espec√≠fica $\Upsilon_T$ que compensa as diferentes taxas de converg√™ncia de $\hat{\alpha}_T$ e $\hat{\delta}_T$. A matriz $Q$ √© positiva definida devido √† natureza dos regressores e √† exig√™ncia de que o termo de erro tenha vari√¢ncia finita.

Para entender por que os testes t e F usuais permanecem v√°lidos assintoticamente, vamos considerar o teste t OLS da hip√≥tese nula $\alpha = \alpha_0$ [^7]. A estat√≠stica de teste t pode ser escrita como:

$$t_T = \frac{\hat{\alpha}_T - \alpha_0}{s\sqrt{[1 \quad 0](X'X)^{-1}[1 \quad 0]'}}$$

onde $s^2$ √© a estimativa OLS da vari√¢ncia do erro e $X$ √© a matriz de regressores. Multiplicando o numerador e o denominador da estat√≠stica de teste por $\sqrt{T}$ [^8], e utilizando o fato que $\sqrt{T}(\hat{\alpha}_T - \alpha)$ converge em distribui√ß√£o para uma normal [^9], podemos mostrar que:

$$t_T = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{\sqrt{\sigma^2 q^{11}}}$$

onde $q^{11}$ √© o primeiro elemento da matriz $Q^{-1}$, com $Q$ sendo o limite da matriz $\frac{1}{T^3} X'X$ [^10]. Como o numerador e o denominador convergem para vari√°veis gaussianas, a estat√≠stica $t_T$ converge em distribui√ß√£o para uma normal padr√£o, $N(0,1)$ [^11]. Um argumento similar mostra que o teste t para a hip√≥tese $\delta=\delta_0$ tamb√©m converge para uma $N(0,1)$ [^12].

> üí° **Exemplo Num√©rico:** Vamos supor que queremos testar a hip√≥tese nula de que $\alpha = 5$ (ou seja, $\alpha_0 = 5$).  Com os mesmos dados do exemplo anterior (onde $\hat{\alpha} = 5.2$), e com a estimativa de vari√¢ncia do erro $s^2 = 0.8$, podemos calcular a estat√≠stica t. Assumindo que $[1 \quad 0](X'X)^{-1}[1 \quad 0]' = 0.01$, temos:
>  $t_T = \frac{5.2 - 5}{\sqrt{0.8 * 0.01}} \approx \frac{0.2}{0.089} \approx 2.247$. Comparando este valor com a distribui√ß√£o normal padr√£o, podemos determinar o p-valor do teste.

**Teorema 1**
Sob as condi√ß√µes estabelecidas, a estat√≠stica de teste $t_T$ para a hip√≥tese nula $\alpha = \alpha_0$, converge em distribui√ß√£o para uma vari√°vel aleat√≥ria normal padr√£o, $N(0, 1)$. Formalmente:
$$
t_T \xrightarrow{d} N(0,1)
$$

*Prova:*
Vamos provar que sob as condi√ß√µes estabelecidas, a estat√≠stica de teste $t_T$ para a hip√≥tese nula $\alpha = \alpha_0$, converge em distribui√ß√£o para uma vari√°vel aleat√≥ria normal padr√£o, $N(0, 1)$.
I. Come√ßamos com a estat√≠stica t padr√£o:
    $$t_T = \frac{\hat{\alpha}_T - \alpha_0}{s\sqrt{[1 \quad 0](X'X)^{-1}[1 \quad 0]'}}$$

II. Multiplicamos o numerador e o denominador por $\sqrt{T}$:
    $$t_T = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{s\sqrt{T[1 \quad 0](X'X)^{-1}[1 \quad 0]'}}$$

III. Pela defini√ß√£o de $Q$, temos $Q = \lim_{T \to \infty} \frac{1}{T^3} X'X$. Portanto,  $(X'X)^{-1} = T^3 Q^{-1}$ para grandes $T$. Assim:
   $$t_T = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{s\sqrt{T[1 \quad 0]T^3Q^{-1}[1 \quad 0]'}} = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{s\sqrt{T^4[1 \quad 0]Q^{-1}[1 \quad 0]'}}$$
   $$t_T = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{sT^2\sqrt{[1 \quad 0]Q^{-1}[1 \quad 0]'}}$$
     Note que $[1 \quad 0]Q^{-1}[1 \quad 0]' = q^{11}$, que √© o primeiro elemento da matriz $Q^{-1}$.
    $$t_T = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{sT^2\sqrt{q^{11}}}$$

IV. Sabemos que $\sqrt{T}(\hat{\alpha}_T - \alpha_0)$ converge em distribui√ß√£o para $N(0,\sigma^2q^{11})$, ou seja,
    $$\sqrt{T}(\hat{\alpha}_T - \alpha_0) \xrightarrow{d} N(0, \sigma^2q^{11})$$

V. Assim, podemos escrever:
    $$t_T = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{\sqrt{\sigma^2 q^{11}}}$$
   onde o termo $s$ converge para $\sigma$ em probabilidade, e $T^2$ foi incorporado a $Q$.
    
VI.  Desde que $\sqrt{T}(\hat{\alpha}_T - \alpha_0)$ converge em distribui√ß√£o para uma normal com vari√¢ncia $\sigma^2q^{11}$, e que $s$ √© uma estimativa consistente de $\sigma$, a estat√≠stica $t_T$ converge em distribui√ß√£o para uma normal padr√£o $N(0,1)$ pelo teorema de Slutsky.
    
VII. Portanto,
    $$t_T \xrightarrow{d} N(0,1)$$
$\blacksquare$
O mesmo resultado pode ser generalizado para testes de hip√≥teses conjuntas envolvendo restri√ß√µes lineares em $\alpha$ e $\delta$ [^13]. Por exemplo, ao testar a hip√≥tese $H_0: r_1\alpha + r_2\delta = r$, com $r_1$, $r_2$ e $r$ par√¢metros conhecidos, podemos mostrar que a estat√≠stica de teste $t$ para esta hip√≥tese tamb√©m tem uma distribui√ß√£o assint√≥tica $N(0,1)$ [^14].
**Teorema 1.1**
A estat√≠stica de teste t para a hip√≥tese linear conjunta $H_0: r_1\alpha + r_2\delta = r$, onde $r_1$, $r_2$, e $r$ s√£o constantes conhecidas, converge em distribui√ß√£o para uma vari√°vel aleat√≥ria normal padr√£o, $N(0, 1)$.
$$
t_T^{joint} \xrightarrow{d} N(0,1)
$$
*Prova:* A prova envolve aplicar argumentos de escala semelhantes como antes, mas agora para a combina√ß√£o linear conjunta dos estimadores. A ideia chave √© perceber que a matriz de escala apropriada para o vetor $(\hat{\alpha}_T, \hat{\delta}_T)$ √© a matriz $\Upsilon_T$, e assim a combina√ß√£o linear pode ser expressa usando quantidades escalonadas. Pode-se ent√£o mostrar que a estat√≠stica t relevante convergir√° para uma distribui√ß√£o normal padr√£o usando uma linha de racioc√≠nio semelhante √† da hip√≥tese simples.

> üí° **Exemplo Num√©rico:** Suponha que desejamos testar a hip√≥tese conjunta $H_0: \alpha + 10\delta = 6.5$ (ent√£o $r_1 = 1$, $r_2=10$, e $r=6.5$). Usando os valores estimados $\hat{\alpha}=5.2$ e $\hat{\delta}=0.15$ do exemplo anterior, vamos calcular o valor observado da restri√ß√£o: $5.2 + 10 * 0.15 = 6.7$. Para realizar um teste formal, precisar√≠amos calcular a estat√≠stica t para esta hip√≥tese conjunta, que envolve a vari√¢ncia dos estimadores. Esta estat√≠stica tamb√©m ter√° distribui√ß√£o assint√≥tica normal padr√£o.

**Proposi√ß√£o 1**
Sob as mesmas condi√ß√µes, a estat√≠stica F para testar restri√ß√µes lineares conjuntas em $\alpha$ e $\delta$ tamb√©m tem uma distribui√ß√£o assint√≥tica $\chi^2$ com o n√∫mero apropriado de graus de liberdade. Isso formaliza a generaliza√ß√£o dos testes para m√∫ltiplas restri√ß√µes.

> üí° **Exemplo Num√©rico:** Se, por exemplo, quisessemos testar a signific√¢ncia conjunta de $\alpha$ e $\delta$, ent√£o formulamos a hip√≥tese nula $H_0: \alpha = 0 \text{ e } \delta = 0$. Para esta hip√≥tese, a estat√≠stica $F$ ser√° usada e convergir√° para uma distribui√ß√£o $\chi^2$ com dois graus de liberdade. Usando um software estat√≠stico, podemos realizar esse teste, que fornecer√° o valor da estat√≠stica $F$ e seu p-valor correspondente.

### Conclus√£o
Em suma, este cap√≠tulo demonstrou que, embora os estimadores de OLS para modelos com tend√™ncias temporais tenham diferentes taxas de converg√™ncia, os testes t e F usuais mant√™m sua validade assint√≥tica [^15]. Isso ocorre devido ao comportamento assint√≥tico compensat√≥rio dos erros padr√£o dos estimadores. Esse resultado √© crucial para a infer√™ncia estat√≠stica em s√©ries temporais com tend√™ncias temporais determin√≠sticas, pois permite usar os testes de hip√≥teses padr√£o, que s√£o computacionalmente f√°ceis de implementar e cujas propriedades assint√≥ticas s√£o bem conhecidas. √â importante salientar que esses resultados s√£o uma extens√£o dos resultados estabelecidos para modelos com vari√°veis estacion√°rias e fornecem uma base s√≥lida para a an√°lise estat√≠stica de modelos mais complexos de s√©ries temporais com tend√™ncias, como processos autorregressivos em torno de uma tend√™ncia determin√≠stica [^16].
**Observa√ß√£o 1**
√â importante notar que a validade assint√≥tica dos testes t e F aqui demonstrada depende da correta especifica√ß√£o do modelo, bem como das premissas sobre os termos de erro $\epsilon_t$, que devem ser ru√≠do branco. Desvios dessas premissas podem levar a infer√™ncias inv√°lidas.

### Refer√™ncias
[^1]:  ... *Os coeficientes de modelos de regress√£o envolvendo ra√≠zes unit√°rias ou tend√™ncias de tempo determin√≠sticas s√£o tipicamente estimados por m√≠nimos quadrados ordin√°rios.*
[^2]:  ... *Esta se√ß√£o considera a estima√ß√£o de OLS dos par√¢metros de uma tend√™ncia de tempo simples, $y_t = \alpha + \delta t + \epsilon_t$, para $\epsilon_t$ um processo de ru√≠do branco.*
[^3]: ... *Se $\epsilon_t \sim N(0,\sigma^2)$, ent√£o o modelo [16.1.1] satisfaz as premissas cl√°ssicas de regress√£o e as estat√≠sticas padr√£o OLS t ou F nas equa√ß√µes...*
[^4]: ...*A fim de chegar a distribui√ß√µes assint√≥ticas n√£o degeneradas, $\hat{\alpha}_T$ √© multiplicado por $\sqrt{T}$, enquanto $\hat{\delta}_T$ deve ser multiplicado por $T^{3/2}$!*
[^5]: ...*O modelo de tend√™ncia temporal simples*
[^6]: ...*Podemos pensar neste ajuste como pr√©-multiplicando [16.1.6] ou [16.1.8] pela matriz $\Upsilon_T = \begin{bmatrix} \sqrt{T} & 0 \\ 0 & T^{3/2} \end{bmatrix}$*
[^7]: ...*Primeiro considere o teste t de OLS da hip√≥tese nula $\alpha = \alpha_0$, que pode ser escrito como $t_T = \frac{\hat{\alpha}_T - \alpha_0}{s\sqrt{[1 \quad 0](X'X)^{-1}[1 \quad 0]'}}$*
[^8]: ...*O numerador e o denominador de [16.2.1] podem ser adicionalmente multiplicados por $\sqrt{T}$, resultando em $t_T = \frac{\sqrt{T}(\hat{\alpha}_T - \alpha_0)}{\sqrt{s^2[\sqrt{T} \quad 0](X'X)^{-1}[\sqrt{T} \quad 0]'}}$*
[^9]: ...*Lembre-se que $\sqrt{T}(\hat{\alpha}_T - \alpha) \xrightarrow{d} N(0,\sigma^2q^{11})$, para $q^{11}$ sendo o elemento (1,1) de $Q^{-1}$.*
[^10]: ...*Note que $\Upsilon_T'\left( \sum_{t=1}^T x_tx_t'\right)^{-1}\Upsilon_T \rightarrow Q$.*
[^11]: ...*Mas isso √© uma vari√°vel assintoticamente gaussiana dividida pela raiz quadrada de sua vari√¢ncia e, portanto, assintoticamente, tem uma distribui√ß√£o N(0,1).*
[^12]: ...*Similarmente, considere o teste t OLS usual de $\delta = \delta_0$, $t_T = \frac{\hat{\delta}_T - \delta_0}{s\sqrt{[0 \quad 1](X'X)^{-1}[0 \quad 1]'}}$*
[^13]: ...*√â interessante tamb√©m considerar um teste de uma √∫nica hip√≥tese envolvendo ambos $\alpha$ e $\delta$, $H_0: r_1\alpha + r_2\delta = r$.*
[^14]: ...*Este √∫ltimo exemplo ilustra o seguinte princ√≠pio geral: Um teste envolvendo uma √∫nica restri√ß√£o atrav√©s de par√¢metros com diferentes taxas de converg√™ncia √© dominado assintoticamente pelos par√¢metros com as taxas de converg√™ncia mais lentas.*
[^15]: ...*Assim, embora $\hat{\alpha}_T$ e $\hat{\delta}_T$ convirjam a taxas diferentes, os erros padr√£o correspondentes $\hat{\sigma}_{\hat{\alpha}_T}$ e $\hat{\sigma}_{\hat{\delta}_T}$ tamb√©m incorporam diferentes ordens de $T$, com o resultado que os testes t de OLS usuais s√£o assintoticamente v√°lidos.*
[^16]: ...*Os mesmos princ√≠pios podem ser usados para estudar um processo autorregressivo geral em torno de uma tend√™ncia de tempo determin√≠stica, $y_t = \alpha + \delta t + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \ldots + \phi_p y_{t-p} + \epsilon_t$.*
<!-- END -->
