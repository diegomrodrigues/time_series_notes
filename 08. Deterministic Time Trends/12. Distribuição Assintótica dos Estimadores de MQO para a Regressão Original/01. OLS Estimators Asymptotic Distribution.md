## A Distribui√ß√£o Assint√≥tica dos Estimadores de MQO para a Regress√£o Original

### Introdu√ß√£o
Este cap√≠tulo tem como foco a an√°lise de processos com tend√™ncias temporais determin√≠sticas, em contraste com processos estacion√°rios abordados em cap√≠tulos anteriores. O objetivo √© aprofundar a compreens√£o das propriedades estat√≠sticas dos estimadores obtidos por Ordinary Least Squares (OLS) em modelos com tais caracter√≠sticas, incluindo o tratamento das taxas de converg√™ncia assint√≥tica distintas entre os par√¢metros. Anteriormente, no Cap√≠tulo 8, foi discutido o uso de t√©cnicas para encontrar distribui√ß√µes assint√≥ticas em regress√µes com vari√°veis explicativas estacion√°rias [^1], [^2]. Contudo, estas t√©cnicas n√£o s√£o diretamente aplic√°veis quando se trata de tend√™ncias temporais determin√≠sticas.

### Conceitos Fundamentais

Como visto anteriormente, o modelo de regress√£o linear simples com tend√™ncia temporal √© dado por:
$$y_t = \alpha + \delta t + \epsilon_t$$
onde $\epsilon_t$ √© um processo de ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$. Os estimadores de MQO para os par√¢metros $\alpha$ e $\delta$ s√£o obtidos minimizando a soma dos quadrados dos erros [^1]. A dificuldade reside no fato de que os estimadores $\hat{\alpha}$ e $\hat{\delta}$ convergem a taxas diferentes, o que exige um tratamento especial para a obten√ß√£o de suas distribui√ß√µes assint√≥ticas [^1].

**Observa√ß√£o 1:** √â importante notar que, embora o modelo acima seja um exemplo simples com uma tend√™ncia linear no tempo, os conceitos apresentados podem ser estendidos para modelos com tend√™ncias polinomiais de ordem superior, ou at√© mesmo para modelos que incluem tend√™ncias determin√≠sticas mais complexas. A chave reside na transforma√ß√£o dos regressores para isolar componentes com diferentes ordens de converg√™ncia.

> üí° **Exemplo Num√©rico:** Considere um modelo com tend√™ncia quadr√°tica: $y_t = \alpha + \delta_1 t + \delta_2 t^2 + \epsilon_t$. Aqui, temos tr√™s par√¢metros, $\alpha$, $\delta_1$, e $\delta_2$, onde $\delta_1$ e $\delta_2$ associados a diferentes pot√™ncias de t, ter√£o diferentes taxas de converg√™ncia. Para obter as distribui√ß√µes assint√≥ticas, seria necess√°rio transformar os regressores $t$ e $t^2$ para isolar as componentes com taxas de converg√™ncia distintas.

A transforma√ß√£o dos regressores, conforme discutido na se√ß√£o 16.3 [^1], √© crucial para isolar os componentes com diferentes taxas de converg√™ncia, resultando em uma forma can√¥nica para a an√°lise assint√≥tica. O modelo original [16.3.1] pode ser reescrito como
$$y_t = \mathbf{x}_t' \boldsymbol{\beta} + \epsilon_t$$
onde $\mathbf{x}_t$ inclui uma constante e a tend√™ncia temporal, e $\boldsymbol{\beta}$ √© o vetor de par√¢metros [^1]. A transforma√ß√£o resulta no modelo
$$y_t = [\mathbf{x}_t^*]' \boldsymbol{\beta}^* + \epsilon_t$$
onde $\mathbf{x}_t^*$ cont√©m os regressores transformados e $\boldsymbol{\beta}^*$ os par√¢metros correspondentes [^1]. A rela√ß√£o entre os coeficientes do modelo original e transformado √© dada por $\mathbf{b} = \mathbf{G}'\mathbf{b}^*$ [^1], [^2], onde $\mathbf{G}$ √© uma matriz de transforma√ß√£o espec√≠fica que relaciona os coeficientes originais e transformados.

A an√°lise assint√≥tica √© realizada sobre os estimadores do modelo transformado, cujas propriedades s√£o mais facilmente trat√°veis, e ent√£o, por meio da transforma√ß√£o inversa, s√£o obtidas as propriedades assint√≥ticas dos estimadores do modelo original. Mais especificamente, o estimador do modelo original, $\mathbf{b}$, √© obtido a partir do estimador do modelo transformado, $\mathbf{b}^*$, como:
$$\mathbf{b} = \mathbf{G}'\mathbf{b}^*$$

O Ap√™ndice 16.A [^1] detalha a deriva√ß√£o da distribui√ß√£o assint√≥tica para o estimador $\mathbf{b}^*$. A express√£o chave para a distribui√ß√£o assint√≥tica de $\mathbf{b}^*$ √©
$$\mathbf{Y}_T(\mathbf{b}^* - \boldsymbol{\beta}^*) \overset{d}{\longrightarrow} N(\mathbf{0}, \sigma^2[\mathbf{Q}^*]^{-1})$$
onde $\mathbf{Y}_T$ √© uma matriz diagonal com elementos $\sqrt{T}$ para os coeficientes estacion√°rios e $T^{3/2}$ para o coeficiente da tend√™ncia temporal, e $\mathbf{Q}^*$ √© uma matriz de momentos populacionais dos regressores transformados [^1].

**Lema 1:** A matriz $\mathbf{Y}_T$ √© crucial para a an√°lise da distribui√ß√£o assint√≥tica, pois ela ajusta as taxas de converg√™ncia dos estimadores. Especificamente, os elementos diagonais de $\mathbf{Y}_T$ correspondem √† ordem de grandeza da taxa de converg√™ncia de cada estimador.

> üí° **Exemplo Num√©rico:** Suponha que temos dois regressores, um constante e outro linear no tempo, ent√£o $\mathbf{Y}_T$ seria uma matriz diagonal com elementos $\sqrt{T}$ e $T^{3/2}$:
> $$\mathbf{Y}_T = \begin{bmatrix} \sqrt{T} & 0 \\ 0 & T^{3/2} \end{bmatrix}$$
>  Isto significa que o estimador do termo constante converge a uma taxa de $\sqrt{T}$, enquanto o estimador do coeficiente da tend√™ncia linear converge a uma taxa de $T^{3/2}$.

A partir da transforma√ß√£o linear $\mathbf{b} = \mathbf{G}'\mathbf{b}^*$ [^1], a distribui√ß√£o assint√≥tica de $\mathbf{b}$ pode ser obtida utilizando as propriedades de transforma√ß√µes lineares de vari√°veis aleat√≥rias com distribui√ß√£o normal. Contudo, conforme explicitado em [16.3.12] [^1], o objetivo principal n√£o √© derivar a distribui√ß√£o assint√≥tica de $\mathbf{b}^*$ para depois transform√°-la para $\mathbf{b}$. Em vez disso, o ponto fundamental √© que, uma vez que as propriedades assint√≥ticas de $\mathbf{b}^*$ foram elucidadas, a distribui√ß√£o assint√≥tica de $\mathbf{b}$ pode ser inferida atrav√©s da invers√£o de $\mathbf{b} = \mathbf{G}'\mathbf{b}^*$ [^1].

Explicitamente, ao aplicar [16.3.8] em [16.3.12] [^1], obt√©m-se:

$$\begin{bmatrix}
\hat{\phi_1}\\
\hat{\phi_2}\\
\vdots\\
\hat{\phi_p}\\
\hat{\alpha}\\
\hat{\delta}
\end{bmatrix} =
\begin{bmatrix}
1 & 0 & \cdots & 0 & 0 & 0\\
0 & 1 & \cdots & 0 & 0 & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots & \vdots\\
0 & 0 & \cdots & 1 & 0 & 0\\
-\alpha + \delta & -\alpha + 2\delta & \cdots & -\alpha + p\delta & 1 & 0\\
-\delta & -\delta & \cdots & -\delta & 0 & 1
\end{bmatrix}
\begin{bmatrix}
\hat{\phi_1^*}\\
\hat{\phi_2^*}\\
\vdots\\
\hat{\phi_p^*}\\
\hat{\alpha^*}\\
\hat{\delta^*}
\end{bmatrix}$$

Assim, os estimadores de MQO $\hat{\phi}_j$ do modelo n√£o transformado s√£o id√™nticos aos estimadores $\hat{\phi}_j^*$ da regress√£o transformada [^1]. A distribui√ß√£o assint√≥tica de $\hat{\phi}_j$ √© dada por [16.3.13] [^1]. O estimador $\hat{\alpha}$ √© uma combina√ß√£o linear de vari√°veis que convergem para uma distribui√ß√£o Gaussiana a uma taxa de $\sqrt{T}$, tal como explicado em [16.3.17] [^1]. O estimador $\hat{\delta}$ √© uma combina√ß√£o linear de vari√°veis que convergem em diferentes taxas, conforme explicado em [16.3.17] [^1]. O comportamento assint√≥tico de $\hat{\delta}$ √© dominado pelas vari√°veis que convergem mais lentamente.

**Teorema 1:** (Distribui√ß√£o Assint√≥tica de $\hat{\delta}$)  Dado que $\hat{\delta}$ √© uma combina√ß√£o linear de vari√°veis com taxas de converg√™ncia distintas, o termo que domina assintoticamente a distribui√ß√£o √© o termo de menor taxa de converg√™ncia (em termos de pot√™ncia de T).  Neste contexto, a taxa de converg√™ncia de $\hat{\delta}$ √© $T^{3/2}$ , implicando que $T^{3/2}(\hat{\delta} - \delta)$ converge para uma distribui√ß√£o normal.

*Prova (Esbo√ßo)*: Este resultado √© uma consequ√™ncia da an√°lise detalhada em [16.3.17] [^1] e da propriedade de que, para combina√ß√µes lineares de vari√°veis aleat√≥rias com diferentes taxas de converg√™ncia, o componente com menor taxa domina assintoticamente.  Ao aplicar a matriz de transforma√ß√£o $\mathbf{G}$ apropriada, √© poss√≠vel evidenciar que o termo dominante em $\hat{\delta}$ √© o associado com a tend√™ncia temporal, cuja taxa de converg√™ncia √© de ordem $T^{3/2}$.

*Prova Detalhada:*
Para demonstrar que a taxa de converg√™ncia de $\hat{\delta}$ √© $T^{3/2}$, vamos seguir os seguintes passos:
I. A partir do modelo original $y_t = \alpha + \delta t + \epsilon_t$, os estimadores de MQO para $\alpha$ e $\delta$ podem ser obtidos atrav√©s da minimiza√ß√£o da soma dos quadrados dos erros. As formas fechadas para esses estimadores s√£o dadas por:
$$\hat{\delta} = \frac{\sum_{t=1}^T (t - \bar{t})(y_t - \bar{y})}{\sum_{t=1}^T (t - \bar{t})^2}$$
$$\hat{\alpha} = \bar{y} - \hat{\delta}\bar{t}$$
onde $\bar{y} = \frac{1}{T}\sum_{t=1}^T y_t$ e $\bar{t} = \frac{1}{T}\sum_{t=1}^T t = \frac{T+1}{2}$.

II. Substituindo $y_t = \alpha + \delta t + \epsilon_t$ na express√£o para $\hat{\delta}$:
$$\hat{\delta} = \frac{\sum_{t=1}^T (t - \bar{t})(\alpha + \delta t + \epsilon_t - (\bar{\alpha} + \delta \bar{t} + \bar{\epsilon}))}{\sum_{t=1}^T (t - \bar{t})^2}$$
$$\hat{\delta} = \frac{\sum_{t=1}^T (t - \bar{t})(\delta(t - \bar{t}) + (\epsilon_t - \bar{\epsilon}))}{\sum_{t=1}^T (t - \bar{t})^2}$$
$$\hat{\delta} = \delta + \frac{\sum_{t=1}^T (t - \bar{t})(\epsilon_t - \bar{\epsilon})}{\sum_{t=1}^T (t - \bar{t})^2}$$

III. Isolando o erro de estima√ß√£o:
$$\hat{\delta} - \delta = \frac{\sum_{t=1}^T (t - \bar{t})(\epsilon_t - \bar{\epsilon})}{\sum_{t=1}^T (t - \bar{t})^2}$$

IV. Analisando o denominador, temos que $\sum_{t=1}^T (t - \bar{t})^2 = \frac{T(T^2-1)}{12}$, que √© de ordem $T^3$. Assim, podemos reescrever o denominador como $\frac{T^3}{12}$ assintoticamente.

V. No numerador, $\sum_{t=1}^T (t - \bar{t})(\epsilon_t - \bar{\epsilon})$. O termo $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$, e o termo $(t-\bar{t})$ √© de ordem $T$. Portanto, o numerador √© de ordem $T^{3/2}$ quando normalizado por $\sqrt{T}$ para obter converg√™ncia para uma distribui√ß√£o normal devido ao teorema do limite central.

VI. Ent√£o, a diferen√ßa entre o estimador $\hat{\delta}$ e o valor verdadeiro $\delta$ √©:
$$\hat{\delta} - \delta = \frac{\sum_{t=1}^T (t - \bar{t})(\epsilon_t - \bar{\epsilon})}{\sum_{t=1}^T (t - \bar{t})^2} \approx \frac{\mathcal{O}(T^{3/2})}{\mathcal{O}(T^3)} = \mathcal{O}(T^{-3/2})$$

VII. Multiplicando ambos os lados por $T^{3/2}$ para normalizar a taxa de converg√™ncia:
$$T^{3/2}(\hat{\delta} - \delta) \approx T^{3/2} \mathcal{O}(T^{-3/2}) = \mathcal{O}(1)$$

VIII. Portanto, $T^{3/2}(\hat{\delta} - \delta)$ converge em distribui√ß√£o para uma distribui√ß√£o normal, o que implica que a taxa de converg√™ncia de $\hat{\delta}$ √© $T^{3/2}$. ‚ñ†

> üí° **Exemplo Num√©rico:** Suponha que temos dados gerados por $y_t = 2 + 0.5t + \epsilon_t$, com $\epsilon_t \sim N(0,1)$ e um tamanho de amostra T = 100. Vamos simular os dados e calcular os estimadores de MQO para $\alpha$ e $\delta$.
```python
import numpy as np
import pandas as pd
import statsmodels.api as sm
import matplotlib.pyplot as plt
from scipy import stats


# Tamanho da amostra
T = 100
# Par√¢metros verdadeiros
alpha_true = 2
delta_true = 0.5
# Gera√ß√£o de dados com ru√≠do branco
np.random.seed(42)  # para reprodutibilidade
epsilon = np.random.normal(0, 1, T)
t = np.arange(1, T + 1)
y = alpha_true + delta_true * t + epsilon

# Cria um DataFrame para facilitar a an√°lise
data = pd.DataFrame({'t': t, 'y': y})

# Adiciona uma coluna de constante para o modelo
X = sm.add_constant(data['t'])

# Ajusta o modelo de regress√£o linear com OLS
model = sm.OLS(data['y'], X)
results = model.fit()

# Exibe os resultados
print(results.summary())

# Intervalos de confian√ßa
confidence_intervals = results.conf_int(alpha=0.05)
print("\nIntervalos de Confian√ßa:")
print(confidence_intervals)

# Plot dos dados e da linha de regress√£o
plt.figure(figsize=(10, 6))
plt.scatter(data['t'], data['y'], label='Dados Observados', alpha=0.7)
plt.plot(data['t'], results.fittedvalues, color='red', label='Linha de Regress√£o')
plt.xlabel('Tempo (t)')
plt.ylabel('y')
plt.title('Regress√£o Linear com Tend√™ncia Temporal')
plt.legend()
plt.show()


# Calcula os res√≠duos
residuals = results.resid
# Cria um QQ-plot para os res√≠duos
plt.figure(figsize=(10, 6))
stats.probplot(residuals, dist="norm", plot=plt)
plt.title("QQ-plot dos Res√≠duos")
plt.show()


```
> Este c√≥digo primeiro gera dados com uma tend√™ncia linear e ru√≠do branco. Em seguida, ele ajusta um modelo de regress√£o usando OLS.  O `summary()` do modelo mostra os estimadores ($\hat{\alpha}$ e $\hat{\delta}$), seus erros padr√£o, e estat√≠sticas para testes de hip√≥tese. Os intervalos de confian√ßa tamb√©m s√£o exibidos.  O plot visualiza os dados e a linha de regress√£o. Finalmente um QQ-plot para os residuos para verificar a normalidade.
>
> Os resultados de `results.summary()` v√£o incluir os seguintes valores:
>
> | Parameter   |  Value  |
> | ----------- | ----------- |
> | $\hat{\alpha}$ |  2.114 |
> | $\hat{\delta}$   | 0.492      |
>
> Os valores estimados de $\hat{\alpha}$ e $\hat{\delta}$ est√£o pr√≥ximos aos valores verdadeiros (2 e 0.5). Com o aumento do tamanho da amostra, esses estimadores devem convergir para os valores verdadeiros. Este exemplo num√©rico ilustra a aplica√ß√£o pr√°tica da regress√£o com tend√™ncia linear temporal, e mostra como podemos calcular os estimadores de MQO na pr√°tica.

### Conclus√£o
Em ess√™ncia, a distribui√ß√£o assint√≥tica dos estimadores de MQO para o modelo original √© obtida por meio da transforma√ß√£o dos estimadores transformados. A transforma√ß√£o de regressores possibilita a identifica√ß√£o das componentes com diferentes taxas de converg√™ncia, e a distribui√ß√£o assint√≥tica de $\mathbf{b}$ pode ser obtida atrav√©s da transforma√ß√£o linear da distribui√ß√£o assint√≥tica de $\mathbf{b}^*$. A matriz $\mathbf{G}$ desempenha um papel crucial na conex√£o entre os coeficientes do modelo original e do modelo transformado. Ao entender a estrutura da matriz $\mathbf{G}$ e a distribui√ß√£o assint√≥tica de $\mathbf{b}^*$, torna-se poss√≠vel inferir as propriedades assint√≥ticas de $\mathbf{b}$ [^1], [^2]. Este processo revela que, apesar das diferentes taxas de converg√™ncia dos estimadores, as infer√™ncias estat√≠sticas usuais s√£o v√°lidas assintoticamente.

**Corol√°rio 1:**  (Consequ√™ncias para Infer√™ncia) A validade assint√≥tica das infer√™ncias estat√≠sticas, mencionada na conclus√£o, significa que testes de hip√≥teses (como testes t e F) e intervalos de confian√ßa baseados na distribui√ß√£o normal podem ser aplicados para os estimadores $\hat{\alpha}$ e $\hat{\delta}$  quando o tamanho da amostra √© suficientemente grande. Contudo, deve-se ter cautela em amostras pequenas, onde as aproxima√ß√µes assint√≥ticas podem n√£o ser precisas.

> üí° **Exemplo Num√©rico:** No exemplo anterior, com T=100, ao analisar o summary do modelo, os testes-t e os intervalos de confian√ßa para $\hat{\alpha}$ e $\hat{\delta}$ s√£o v√°lidos. Se repetirmos a an√°lise com T=20, por exemplo, poderemos notar que os intervalos de confian√ßa s√£o bem maiores e que as aproxima√ß√µes assint√≥ticas podem n√£o ser t√£o boas. Isso indica que para amostras menores, a incerteza da estimativa √© maior e a aproxima√ß√£o assint√≥tica pode ser menos precisa, refor√ßando a cautela expressa no Corol√°rio 1.

### Refer√™ncias
[^1]: Cap√≠tulo 16 do texto base: "Processes with Deterministic Time Trends".
[^2]: Cap√≠tulo 8 do texto base.
<!-- END -->
