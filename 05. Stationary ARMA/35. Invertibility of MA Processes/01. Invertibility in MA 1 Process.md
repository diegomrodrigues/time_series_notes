## T√≠tulo Conciso
Invertibilidade e Representa√ß√£o AR em Processos MA

### Introdu√ß√£o
Em continuidade ao estudo de processos *Moving Average (MA)* e suas propriedades [^47], este cap√≠tulo aprofunda a import√¢ncia da **invertibilidade** em processos MA, focando em como essa caracter√≠stica permite reescrever um processo MA como um processo *Autoregressivo (AR)* de ordem infinita. Tal transforma√ß√£o √© de suma import√¢ncia para a previs√£o e o desenvolvimento de algoritmos de estima√ß√£o est√°veis e eficientes. A discuss√£o se concentrar√° principalmente no processo MA(1), ilustrando os conceitos-chave e as implica√ß√µes da invertibilidade.

### Conceitos Fundamentais

**Invertibilidade** √© uma propriedade essencial de um processo MA que garante que ele possa ser expresso como um processo AR de ordem infinita [^64]. Essa representa√ß√£o alternativa √© crucial para diversas aplica√ß√µes, incluindo previs√£o e estima√ß√£o de par√¢metros.

Considere um processo MA(1) dado por:

$$Y_t = \mu + (1 + \theta L)\epsilon_t$$ [^64, 3.7.1]

onde:
*   $Y_t$ √© o valor do processo no tempo $t$,
*   $\mu$ √© a m√©dia do processo,
*   $\theta$ √© o coeficiente do termo MA(1),
*   $L$ √© o operador *lag*,
*   $\epsilon_t$ √© o ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$ [^47, 3.2.1, 3.2.2, 3.2.3].

> üí° **Exemplo Num√©rico:** Seja $\mu = 10$, $\theta = 0.5$, e $\epsilon_t$ uma sequ√™ncia de ru√≠do branco com m√©dia 0 e vari√¢ncia 1.  Ent√£o, $Y_t = 10 + (1 + 0.5L)\epsilon_t = 10 + \epsilon_t + 0.5\epsilon_{t-1}$.  Se $\epsilon_t = 2$ e $\epsilon_{t-1} = -1$, ent√£o $Y_t = 10 + 2 + 0.5(-1) = 11.5$.

Para que este processo MA(1) seja invert√≠vel, √© necess√°rio que $|\theta| < 1$ [^65]. Esta condi√ß√£o garante que possamos reescrever o processo MA(1) como um processo AR(‚àû) [^64]:

$$(1 - \theta L + \theta^2 L^2 - \theta^3 L^3 + \dots)(Y_t - \mu) = \epsilon_t$$ [^65, 3.7.2]

Essa representa√ß√£o AR(‚àû) √© obtida multiplicando ambos os lados da equa√ß√£o do processo MA(1) pelo operador inverso $(1 + \theta L)^{-1}$ [^65]. A condi√ß√£o $|\theta| < 1$ assegura que a sequ√™ncia infinita $\{\theta^j\}_{j=0}^{\infty}$ convirja, tornando a representa√ß√£o AR(‚àû) bem definida [^65].

> üí° **Exemplo Num√©rico:** Se $\theta = 0.5$, ent√£o a sequ√™ncia √© $\{1, 0.5, 0.25, 0.125, ...\}$.  A soma dos primeiros 5 termos √© $1 + 0.5 + 0.25 + 0.125 + 0.0625 = 1.9375$.  Teoricamente, a soma infinita converge para $\frac{1}{1 - 0.5} = 2$.  Se $\theta = 2$, a sequ√™ncia √© $\{1, 2, 4, 8, ...\}$, que diverge.
>
> ```mermaid
> graph LR
>     A[t-0: 1] --> B(t-1: 0.5)
>     B --> C(t-2: 0.25)
>     C --> D(t-3: 0.125)
>     D --> E(t-4: 0.0625)
>     E --> F(...)
>     style A fill:#f9f,stroke:#333,stroke-width:2px
> ```

**Observa√ß√£o:** A converg√™ncia da s√©rie geom√©trica $\sum_{j=0}^{\infty} \theta^j L^j$ para $|\theta| < 1$ √© fundamental para a invertibilidade. Essa converg√™ncia implica que o efeito de choques passados ($\epsilon_{t-j}$) diminui exponencialmente √† medida que $j$ aumenta, permitindo expressar o processo $Y_t$ como uma combina√ß√£o linear ponderada de seus valores passados.

> üí° **Exemplo Num√©rico:** Seja $\theta = 0.8$.  Ent√£o, o efeito de $\epsilon_{t-1}$ em $Y_t$ √© $0.8\epsilon_{t-1}$, o efeito de $\epsilon_{t-2}$ √© $(0.8)^2\epsilon_{t-2} = 0.64\epsilon_{t-2}$, e o efeito de $\epsilon_{t-3}$ √© $(0.8)^3\epsilon_{t-3} = 0.512\epsilon_{t-3}$.  Como pode ser visto, o efeito dos choques passados diminui exponencialmente.

Para consolidar o entendimento da converg√™ncia, podemos apresentar a seguinte proposi√ß√£o:

**Proposi√ß√£o 1:** A converg√™ncia da s√©rie $\sum_{j=0}^{\infty} \theta^j L^j$ √© uniforme para $|\theta| < 1$.

**Demonstra√ß√£o:** Considere a s√©rie geom√©trica $\sum_{j=0}^{\infty} z^j$, onde $z = \theta L$. Se $|z| = |\theta L| < 1$, a s√©rie converge para $\frac{1}{1-z}$.  Dado que $|\theta| < 1$ e $\|L\| = 1$ (a norma do operador *lag* √© 1), ent√£o $|z| = |\theta| < 1$.  A converg√™ncia uniforme segue do fato de que a s√©rie geom√©trica converge uniformemente para $|z| < r$ para qualquer $r < 1$. Portanto, a converg√™ncia √© uniforme para $|\theta| < 1$.

**Demonstra√ß√£o da Invertibilidade**

Para demonstrar formalmente a invertibilidade, considere o operador inverso do processo MA(1) [^65]:

$$(1 + \theta L)^{-1} = 1 - \theta L + \theta^2 L^2 - \theta^3 L^3 + \dots$$

Se $|\theta| < 1$, a sequ√™ncia converge e o operador inverso √© bem definido [^65]. Multiplicando ambos os lados do processo MA(1) por este operador, obtemos:

$$(1 - \theta L + \theta^2 L^2 - \theta^3 L^3 + \dots)(Y_t - \mu) = (1 - \theta L + \theta^2 L^2 - \theta^3 L^3 + \dots)(1 + \theta L)\epsilon_t = \epsilon_t$$

que representa o processo MA(1) como um processo AR(‚àû) [^65].

> üí° **Exemplo Num√©rico:** Seja $Y_t = 5 + (1 + 0.6L)\epsilon_t$, onde $\mu = 5$ e $\theta = 0.6$.  A representa√ß√£o AR(‚àû) √© $\epsilon_t = (1 - 0.6L + 0.36L^2 - 0.216L^3 + ...)(Y_t - 5)$.  Se $Y_t = 7$, $Y_{t-1} = 6$, $Y_{t-2} = 5.5$, e $Y_{t-3} = 5.2$, ent√£o
> $\epsilon_t \approx (7-5) - 0.6(6-5) + 0.36(5.5-5) - 0.216(5.2-5) = 2 - 0.6 + 0.18 - 0.0432 = 1.5768$.
> Note que essa √© uma aproxima√ß√£o, pois a s√©rie AR(‚àû) √© truncada.

**Lema 1:** A representa√ß√£o AR(‚àû) de um processo MA(1) invert√≠vel √© √∫nica.

**Demonstra√ß√£o:** Suponha que existam duas representa√ß√µes AR(‚àû) para o mesmo processo MA(1) invert√≠vel:
$$ (1 + \sum_{i=1}^{\infty} \phi_i L^i) (Y_t - \mu) = \epsilon_t $$
$$ (1 + \sum_{i=1}^{\infty} \psi_i L^i) (Y_t - \mu) = \epsilon_t $$
Subtraindo as duas equa√ß√µes, obtemos:
$$ (\sum_{i=1}^{\infty} (\phi_i - \psi_i) L^i) (Y_t - \mu) = 0 $$
Para que esta igualdade se mantenha para todo $t$, √© necess√°rio que $\phi_i = \psi_i$ para todo $i$, o que demonstra a unicidade da representa√ß√£o.

Para complementar o Lema 1, considere a seguinte proposi√ß√£o sobre a causalidade da representa√ß√£o AR(‚àû):

**Proposi√ß√£o 2:** A representa√ß√£o AR(‚àû) de um processo MA(1) invert√≠vel √© causal.

**Demonstra√ß√£o:** Um processo AR(‚àû) √© causal se os coeficientes da representa√ß√£o AR(‚àû) forem absolutamente som√°veis. No caso do processo MA(1) invert√≠vel, a representa√ß√£o AR(‚àû) √© dada por $\epsilon_t = (1 - \theta L + \theta^2 L^2 - \theta^3 L^3 + \dots)(Y_t - \mu)$. Os coeficientes s√£o $\{\pm \theta^i\}_{i=0}^{\infty}$. A soma absoluta dos coeficientes √© $\sum_{i=0}^{\infty} |\theta^i| = \sum_{i=0}^{\infty} |\theta|^i$. Como $|\theta| < 1$, a s√©rie converge para $\frac{1}{1 - |\theta|}$, que √© um valor finito. Portanto, a representa√ß√£o AR(‚àû) √© causal.

**Consequ√™ncias da N√£o Invertibilidade**

Se $|\theta| \geq 1$, o processo MA(1) n√£o √© invert√≠vel [^65]. Nesse caso, a representa√ß√£o AR(‚àû) n√£o √© bem definida, pois a sequ√™ncia $\{\theta^j\}_{j=0}^{\infty}$ n√£o converge. Isso tem implica√ß√µes importantes:

1.  **Previs√£o:** A previs√£o baseada na representa√ß√£o AR(‚àû) pode se tornar inst√°vel e divergir ao longo do tempo, comprometendo a confiabilidade das previs√µes de longo prazo [^65].

2.  **Estima√ß√£o:** Algoritmos de estima√ß√£o que dependem da invertibilidade podem apresentar problemas de converg√™ncia ou fornecer estimativas inconsistentes para os par√¢metros do processo MA(1) [^65].

3.  **Interpreta√ß√£o:** A n√£o invertibilidade pode levar a ambiguidades na interpreta√ß√£o dos par√¢metros do modelo, j√° que diferentes valores de $\theta$ podem gerar o mesmo processo estoc√°stico [^65].

> üí° **Exemplo Num√©rico:** Considere um processo MA(1) com $\theta = 1.5$ (n√£o invert√≠vel). Se usarmos uma representa√ß√£o AR(‚àû) truncada para prever, os coeficientes crescer√£o em magnitude, amplificando erros passados e levando a previs√µes inst√°veis.

**Rela√ß√£o entre Processos Invert√≠veis e N√£o Invert√≠veis**

√â importante notar que, para cada processo MA(1) invert√≠vel (com $|\theta| < 1$), existe um processo MA(1) n√£o invert√≠vel (com $|\theta| > 1$) que gera a mesma fun√ß√£o de autocovari√¢ncia [^65]. Isso significa que ambos os processos compartilham as mesmas propriedades de primeira e segunda ordem, tornando dif√≠cil distinguir entre eles com base apenas nesses momentos.

Suponha que temos um processo MA(1) n√£o invert√≠vel:

$$\tilde{Y}_t - \mu = (1 + \tilde{\theta} L)\tilde{\epsilon}_t$$

onde $|\tilde{\theta}| > 1$ e $\tilde{\epsilon}_t$ √© ru√≠do branco [^65]. Podemos definir um processo invert√≠vel equivalente com $\theta = \tilde{\theta}^{-1}$ e $\sigma^2 = \tilde{\theta}^2\tilde{\sigma}^2$ [^65]. Ambos os processos, invert√≠vel e n√£o invert√≠vel, ter√£o a mesma fun√ß√£o de autocovari√¢ncia, conforme demonstrado pelas equa√ß√µes [3.7.3] e [3.7.5] [^65].

Para ilustrar a equival√™ncia na fun√ß√£o de autocovari√¢ncia, considere o processo MA(1) invert√≠vel $Y_t = (1 + \theta L) \epsilon_t$, onde $|\theta| < 1$, e o processo MA(1) n√£o invert√≠vel $\tilde{Y}_t = (1 + \tilde{\theta} L) \tilde{\epsilon}_t$, onde $\tilde{\theta} = 1/\theta$ e $\tilde{\epsilon}_t = \theta \epsilon_t$. A autocovari√¢ncia no lag 0 (vari√¢ncia) para o processo invert√≠vel √© $\gamma_0 = (1 + \theta^2) \sigma^2$, e para o processo n√£o invert√≠vel √© $\tilde{\gamma}_0 = (1 + \tilde{\theta}^2) \tilde{\sigma}^2 = (1 + (1/\theta)^2) (\theta^2 \sigma^2) = (\theta^2 + 1) \sigma^2 = \gamma_0$. Similarmente, a autocovari√¢ncia no lag 1 para o processo invert√≠vel √© $\gamma_1 = \theta \sigma^2$, e para o processo n√£o invert√≠vel √© $\tilde{\gamma}_1 = \tilde{\theta} \tilde{\sigma}^2 = (1/\theta) (\theta^2 \sigma^2) = \theta \sigma^2 = \gamma_1$. Para lags maiores que 1, a autocovari√¢ncia √© zero para ambos os processos. Portanto, ambos os processos t√™m a mesma fun√ß√£o de autocovari√¢ncia.

> üí° **Exemplo Num√©rico:** Seja $\theta = 0.5$ e $\sigma^2 = 1$ para o processo invert√≠vel.  Ent√£o $\gamma_0 = (1 + 0.5^2)(1) = 1.25$ e $\gamma_1 = 0.5(1) = 0.5$.  Para o processo n√£o invert√≠vel, $\tilde{\theta} = 1/0.5 = 2$ e $\tilde{\sigma}^2 = 0.5^2(1) = 0.25$.  Ent√£o $\tilde{\gamma}_0 = (1 + 2^2)(0.25) = 5(0.25) = 1.25$ e $\tilde{\gamma}_1 = 2(0.25) = 0.5$.  As autocovari√¢ncias s√£o id√™nticas.

**O Processo Causal Invert√≠vel**
Em geral, existe uma prefer√™ncia para o processo causal invert√≠vel na modelagem de s√©ries temporais. O processo causal invert√≠vel √© definido como o processo onde $|\theta|<1$. O motivo para essa prefer√™ncia √© pragm√°tico. Para encontrar o valor de $\epsilon_t$ para a data $t$ associada com a representa√ß√£o invert√≠vel como em [3.7.8], √© necess√°rio saber os valores presentes e passados de $Y$. Em contrapartida, para encontrar o valor do processo n√£o invert√≠vel $\tilde{\epsilon}_t$, √© necess√°rio o uso de todos os valores futuros de $Y$ [^65].

**Teorema 1:** Dado um processo MA(q) estacion√°rio, existe um processo MA(q) invert√≠vel que gera a mesma fun√ß√£o de autocovari√¢ncia.

**Demonstra√ß√£o (Esbo√ßo):** A demonstra√ß√£o envolve encontrar as ra√≠zes do polin√¥mio associado ao processo MA(q). Se alguma raiz estiver dentro do c√≠rculo unit√°rio, ela pode ser invertida para obter uma raiz fora do c√≠rculo unit√°rio, resultando em um processo invert√≠vel com a mesma fun√ß√£o de autocovari√¢ncia.

Para o Teorema 1, podemos fornecer a seguinte prova detalhada:

**Prova do Teorema 1:** Dado um processo MA(q) estacion√°rio, existe um processo MA(q) invert√≠vel que gera a mesma fun√ß√£o de autocovari√¢ncia.

I. Seja o processo MA(q) dado por $Y_t = \Theta(L) \epsilon_t$, onde $\Theta(L) = 1 + \theta_1 L + \dots + \theta_q L^q$ e $\epsilon_t$ √© ru√≠do branco com vari√¢ncia $\sigma^2$.

II. A fun√ß√£o de autocovari√¢ncia do processo MA(q) √© determinada pelos coeficientes $\theta_1, \dots, \theta_q$.

III. Seja $z_1, \dots, z_q$ as ra√≠zes do polin√¥mio $\Theta(z) = 1 + \theta_1 z + \dots + \theta_q z^q = 0$. Se o processo MA(q) n√£o for invert√≠vel, ent√£o pelo menos uma das ra√≠zes estar√° dentro ou sobre o c√≠rculo unit√°rio, ou seja, $|z_i| \leq 1$ para algum $i$.

IV. Para cada raiz $z_i$ tal que $|z_i| \leq 1$, defina uma nova raiz $z_i^* = 1/z_i$. Note que $|z_i^*| \geq 1$. Se $z_i$ √© complexo, ent√£o $z_i^*$ tamb√©m √© complexo, e o conjugado de $z_i$, denotado por $\overline{z_i}$, √© tamb√©m uma raiz de $\Theta(z)$.

V. Forme um novo polin√¥mio $\Theta^*(z)$ substituindo cada raiz $z_i$ dentro do c√≠rculo unit√°rio por $z_i^*$. Assim, todas as ra√≠zes de $\Theta^*(z)$ est√£o fora do c√≠rculo unit√°rio, garantindo a invertibilidade.

VI. O polin√¥mio $\Theta^*(z)$ pode ser escrito como $\Theta^*(z) = 1 + \theta_1^* z + \dots + \theta_q^* z^q$.

VII. Mostrar que o processo MA(q) definido por $Y_t^* = \Theta^*(L) \epsilon_t$ tem a mesma fun√ß√£o de autocovari√¢ncia que o processo original $Y_t$. Isso segue do fato que a fun√ß√£o de autocovari√¢ncia √© unicamente determinada pelas ra√≠zes do polin√¥mio, e as ra√≠zes que foram alteradas (invertidas) n√£o alteram a fun√ß√£o de autocovari√¢ncia.

VIII. Portanto, dado um processo MA(q) estacion√°rio, existe um processo MA(q) invert√≠vel que gera a mesma fun√ß√£o de autocovari√¢ncia. ‚ñ†

**Teorema 1.1:** Seja $\Theta(L) = 1 + \theta_1 L + ... + \theta_q L^q$ o polin√¥mio do operador *lag* associado a um processo MA(q). O processo MA(q) √© invert√≠vel se e somente se as ra√≠zes de $\Theta(z) = 0$ est√£o fora do c√≠rculo unit√°rio, ou seja, $|z_i| > 1$ para todas as ra√≠zes $z_i$.

**Demonstra√ß√£o (Esbo√ßo):** A invertibilidade do processo MA(q) depende da converg√™ncia da sua representa√ß√£o AR(‚àû). A representa√ß√£o AR(‚àû) existe se e somente se o operador inverso $\Theta(L)^{-1}$ pode ser expresso como uma s√©rie de pot√™ncias convergente em $L$. Isso ocorre se e somente se as ra√≠zes do polin√¥mio $\Theta(z)$ est√£o fora do c√≠rculo unit√°rio.

Para o Teorema 1.1, podemos fornecer a seguinte prova detalhada:

**Prova do Teorema 1.1:** Seja $\Theta(L) = 1 + \theta_1 L + ... + \theta_q L^q$ o polin√¥mio do operador *lag* associado a um processo MA(q). O processo MA(q) √© invert√≠vel se e somente se as ra√≠zes de $\Theta(z) = 0$ est√£o fora do c√≠rculo unit√°rio, ou seja, $|z_i| > 1$ para todas as ra√≠zes $z_i$.

I. Considere o processo MA(q) definido por $Y_t = \Theta(L) \epsilon_t$, onde $\Theta(L) = 1 + \theta_1 L + \dots + \theta_q L^q$ e $\epsilon_t$ √© ru√≠do branco com vari√¢ncia $\sigma^2$.

II. O processo √© invert√≠vel se ele pode ser escrito como um processo AR(‚àû) da forma $\Pi(L) Y_t = \epsilon_t$, onde $\Pi(L) = 1 + \pi_1 L + \pi_2 L^2 + \dots$.

III. Equivalentemente, $\Pi(L) = \Theta(L)^{-1}$. Para que essa representa√ß√£o AR(‚àû) seja v√°lida, $\Pi(L)$ deve ser uma fun√ß√£o convergente para $|L| \leq 1$.

IV. Suponha que as ra√≠zes de $\Theta(z) = 0$ sejam $z_1, z_2, \dots, z_q$. Ent√£o $\Theta(L)$ pode ser fatorado como $\Theta(L) = (1 - z_1^{-1}L)(1 - z_2^{-1}L)\dots(1 - z_q^{-1}L)$.

V. Assim, $\Theta(L)^{-1} = (1 - z_1^{-1}L)^{-1}(1 - z_2^{-1}L)^{-1}\dots(1 - z_q^{-1}L)^{-1}$. Cada termo $(1 - z_i^{-1}L)^{-1}$ pode ser expandido em uma s√©rie geom√©trica como $1 + z_i^{-1}L + (z_i^{-1}L)^2 + \dots$ se e somente se $|z_i^{-1}L| < 1$, ou seja, $|L| < |z_i|$.

VI. Para que $\Theta(L)^{-1}$ seja convergente para $|L| \leq 1$, √© necess√°rio que cada termo $(1 - z_i^{-1}L)^{-1}$ seja convergente para $|L| \leq 1$. Isso implica que $|z_i| > 1$ para todo $i = 1, \dots, q$.

VII. Portanto, o processo MA(q) √© invert√≠vel se e somente se todas as ra√≠zes do polin√¥mio $\Theta(z) = 0$ est√£o fora do c√≠rculo unit√°rio, ou seja, $|z_i| > 1$ para todas as ra√≠zes $z_i$. ‚ñ†

### Conclus√£o

A invertibilidade √© uma propriedade crucial para a an√°lise e modelagem de processos MA. Ela garante a exist√™ncia de uma representa√ß√£o AR(‚àû) bem definida, o que √© essencial para a previs√£o, a estima√ß√£o de par√¢metros e a interpreta√ß√£o do modelo. A condi√ß√£o $|\theta| < 1$ para um processo MA(1) garante a invertibilidade, enquanto a viola√ß√£o dessa condi√ß√£o leva a problemas de instabilidade, ambiguidade e dificuldades na interpreta√ß√£o do modelo. A escolha de um processo invert√≠vel √© prefer√≠vel devido √† sua estabilidade e facilidade de uso em aplica√ß√µes pr√°ticas, al√©m de garantir a unicidade da representa√ß√£o do modelo.

### Refer√™ncias
[^47]: Imagine a battery of I such computers generating sequences. *Stationary ARMA Processes*
[^64]: Consider an MA(1) process. *Invertibility for the MA(1) Process*
[^65]: Provided that |Œ∏| < 1, both sides of [3.7.1] can be multiplied by (1 + Œ∏L)^-1 to obtain. *Invertibility for the MA(1) Process*
<!-- END -->