## Invertibilidade para o Processo MA(q) e o Procedimento de Hansen-Sargent

### Introdu√ß√£o
Como vimos anteriormente, a **invertibilidade** √© uma propriedade crucial dos processos *Moving Average* (MA) que garante uma representa√ß√£o √∫nica e bem definida do modelo [^65]. Se todas as ra√≠zes do polin√¥mio do operador MA estiverem fora do c√≠rculo unit√°rio, o processo √© invert√≠vel e pode ser expresso como um processo Autorregressivo de ordem infinita (AR($\infty$)) [^67]. No entanto, se algumas ra√≠zes estiverem dentro do c√≠rculo unit√°rio, o processo √© n√£o invert√≠vel, embora ainda possa descrever a mesma fun√ß√£o de autocovari√¢ncia [^65]. Para lidar com essa situa√ß√£o, Hansen e Sargent propuseram um procedimento que permite encontrar uma representa√ß√£o invert√≠vel, mesmo quando o processo original n√£o √© [^67, ^68]. Este cap√≠tulo detalha o procedimento de Hansen-Sargent, suas bases te√≥ricas e aplica√ß√µes pr√°ticas.

### O Procedimento de Hansen-Sargent para Invertibilidade
Quando as ra√≠zes do polin√¥mio do operador MA n√£o est√£o todas fora do c√≠rculo unit√°rio, o processo MA(q) n√£o √© invert√≠vel [^67]. O procedimento de Hansen-Sargent oferece uma forma sistem√°tica de encontrar uma representa√ß√£o invert√≠vel equivalente [^68]. O procedimento envolve substituir as ra√≠zes que est√£o dentro do c√≠rculo unit√°rio por seus rec√≠procos.

Formalmente, considere um processo MA(q):
$$Y_t = (1 + \theta_1 L + \theta_2 L^2 + \dots + \theta_q L^q) \epsilon_t = \Theta(L)\epsilon_t$$
Seja $z_1, z_2, \dots, z_q$ as ra√≠zes do polin√¥mio $\Theta(z) = 1 + \theta_1 z + \theta_2 z^2 + \dots + \theta_q z^q$ [^67]. O procedimento de Hansen-Sargent consiste em:

1.  **Identificar as ra√≠zes dentro do c√≠rculo unit√°rio:** Encontre todas as ra√≠zes $z_i$ tais que $|z_i| < 1$.
2.  **Substituir as ra√≠zes pelo rec√≠proco:** Para cada raiz $z_i$ dentro do c√≠rculo unit√°rio, substitua-a por seu rec√≠proco $1/z_i$.
3.  **Construir o novo polin√¥mio:** Forme um novo polin√¥mio $\Theta^*(z)$ usando as ra√≠zes modificadas:
$$\Theta^*(z) = \prod_{i=1}^q (1 - z/z_i^*)$$
onde
$$
z_i^* = \begin{cases}
1/z_i & \text{se } |z_i| < 1 \\
z_i & \text{se } |z_i| \ge 1
\end{cases}
$$
4.  **Representa√ß√£o Invert√≠vel:** O processo MA(q) correspondente √† representa√ß√£o invert√≠vel √© dado por:
$$Y_t = \Theta^*(L)\epsilon_t = (1 + \theta_1^* L + \theta_2^* L^2 + \dots + \theta_q^* L^q) \epsilon_t$$

**Justificativa Te√≥rica:** A justificativa para este procedimento reside no fato de que substituir uma raiz $z_i$ por seu rec√≠proco $1/z_i$ n√£o altera a fun√ß√£o de autocovari√¢ncia do processo, mas garante que todas as ra√≠zes do novo polin√¥mio estejam fora do c√≠rculo unit√°rio [^65].

**Exemplo Num√©rico:**

Considere o processo MA(2) dado por:
$$Y_t = \epsilon_t - 0.5 \epsilon_{t-1} - 0.25 \epsilon_{t-2} = (1 - 0.5L - 0.25L^2)\epsilon_t$$
As ra√≠zes do polin√¥mio $1 - 0.5z - 0.25z^2 = 0$ s√£o $z_1 = -3.414$ e $z_2 = 1.414$. Como $|z_1| > 1$ e $|z_2| > 1$, o processo √© invert√≠vel e o procedimento de Hansen-Sargent n√£o √© necess√°rio.

Considere o processo MA(2) dado por:
$$Y_t = \epsilon_t - 3.414 \epsilon_{t-1} + 4.8284 \epsilon_{t-2} $$
As ra√≠zes s√£o $z_1 =  0.7071$ e $z_2 = 0.7071$. Como $|z_1| < 1$ e $|z_2| < 1$, o processo n√£o √© invert√≠vel. Para aplicar o procedimento de Hansen-Sargent, substitu√≠mos as ra√≠zes pelos rec√≠procos: $1/z_1 = 1.414$ e $1/z_2 = -1.414$ . O novo polin√¥mio √© ent√£o:

$$(1 - 1.414 L)(1+3.414L)= 1 - 0.5L - 0.25L^2 $$

Portanto, a representa√ß√£o invert√≠vel √©:

$$Y_t = (1 - 0.5 L-0.25 L^2)\epsilon_t$$

Para complementar o exemplo num√©rico, podemos estabelecer um resultado geral sobre processos MA(1):

**Teorema 1:** *Para um processo MA(1) dado por $Y_t = \epsilon_t + \theta \epsilon_{t-1}$, o processo √© invert√≠vel se e somente se $|\theta| < 1$. Se $|\theta| > 1$, a representa√ß√£o invert√≠vel obtida pelo procedimento de Hansen-Sargent √© $Y_t = \epsilon_t + \frac{1}{\theta} \epsilon_{t-1}$.*

**Demonstra√ß√£o:**
I. Considere o processo MA(1) $Y_t = \epsilon_t + \theta \epsilon_{t-1}$. O polin√¥mio do operador MA √© $\Theta(z) = 1 + \theta z$.

II. A raiz do polin√¥mio √© $z = -\frac{1}{\theta}$.

III. O processo √© invert√≠vel se e somente se $|z| > 1$, o que implica $|-\frac{1}{\theta}| > 1$, ou equivalentemente, $|\theta| < 1$.

IV. Se $|\theta| > 1$, o processo n√£o √© invert√≠vel. Aplicando o procedimento de Hansen-Sargent, substitu√≠mos a raiz $z = -\frac{1}{\theta}$ por seu rec√≠proco $z^* = -\theta$. O novo polin√¥mio √© ent√£o $\Theta^*(z) = 1 - \frac{1}{\theta}(-z) = 1 + \frac{1}{\theta}z$.

V. Portanto, a representa√ß√£o invert√≠vel √© $Y_t = \epsilon_t + \frac{1}{\theta} \epsilon_{t-1}$.  A raiz deste novo polin√¥mio √© $z = -\theta$ e $|z| = |-\theta| > 1$, garantindo a invertibilidade. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> Vamos considerar um processo MA(1) com $\theta = 2$. Portanto, o processo √© dado por:
> $$Y_t = \epsilon_t + 2 \epsilon_{t-1}$$
>
> 1.  **Verifica√ß√£o da Invertibilidade:** O polin√¥mio √© $\Theta(z) = 1 + 2z$. A raiz √© $z = -\frac{1}{2}$, e $|z| = 0.5 < 1$. Portanto, o processo n√£o √© invert√≠vel.
>
> 2.  **Aplica√ß√£o do Procedimento de Hansen-Sargent:** Substitu√≠mos a raiz $z = -\frac{1}{2}$ por seu rec√≠proco $z^* = -2$.
>
> 3.  **Nova Representa√ß√£o:** O novo polin√¥mio √© $\Theta^*(z) = 1 + \frac{1}{2}z$. Portanto, a representa√ß√£o invert√≠vel √©:
> $$Y_t = \epsilon_t + \frac{1}{2} \epsilon_{t-1}$$
>
> 4.  **Verifica√ß√£o da Invertibilidade:** A raiz do novo polin√¥mio √© $z = -2$, e $|z| = 2 > 1$. Portanto, o processo agora √© invert√≠vel.
>
> Este exemplo demonstra como o procedimento de Hansen-Sargent transforma um processo MA(1) n√£o invert√≠vel em um processo invert√≠vel, substituindo o coeficiente $\theta$ por $\frac{1}{\theta}$.
>
> Para ilustrar o impacto na fun√ß√£o de autocovari√¢ncia, vamos calcular as autocovari√¢ncias dos dois processos.
>
> **Processo Original (N√£o Invert√≠vel):** $Y_t = \epsilon_t + 2 \epsilon_{t-1}$
>
> *   $\gamma_0 = Var(Y_t) = Var(\epsilon_t) + 4 Var(\epsilon_{t-1}) = \sigma^2 + 4\sigma^2 = 5\sigma^2$
> *   $\gamma_1 = Cov(Y_t, Y_{t-1}) = Cov(\epsilon_t + 2 \epsilon_{t-1}, \epsilon_{t-1} + 2\epsilon_{t-2}) = 2 Var(\epsilon_{t-1}) = 2\sigma^2$
> *   $\gamma_k = 0$ para $k > 1$
>
> **Processo Transformado (Invert√≠vel):** $Y_t = \epsilon_t + \frac{1}{2} \epsilon_{t-1}$
>
> *   $\gamma_0 = Var(Y_t) = Var(\epsilon_t) + \frac{1}{4} Var(\epsilon_{t-1}) = \sigma^2 + \frac{1}{4}\sigma^2 = \frac{5}{4}\sigma^2$
> *   $\gamma_1 = Cov(Y_t, Y_{t-1}) = Cov(\epsilon_t + \frac{1}{2} \epsilon_{t-1}, \epsilon_{t-1} + \frac{1}{2}\epsilon_{t-2}) = \frac{1}{2} Var(\epsilon_{t-1}) = \frac{1}{2}\sigma^2$
> *   $\gamma_k = 0$ para $k > 1$
>
>  Normalizando as autocovari√¢ncias de forma que $\gamma_0=1$:
>
> **Processo Original (N√£o Invert√≠vel):**
>
> *   $\gamma_0 = 1$
> *   $\gamma_1 = \frac{2}{5} = 0.4$
>
> **Processo Transformado (Invert√≠vel):**
>
> *   $\gamma_0 = 1$
> *   $\gamma_1 = \frac{1/2}{5/4} = \frac{2}{5} = 0.4$
>
> Assim, os processos tem a mesma estrutura de autocorrela√ß√£o.

### Implementa√ß√£o Pr√°tica e Considera√ß√µes
O procedimento de Hansen-Sargent √© relativamente simples de implementar na pr√°tica. No entanto, algumas considera√ß√µes s√£o importantes:

*   **C√°lculo preciso das ra√≠zes:** A precis√£o no c√°lculo das ra√≠zes do polin√¥mio √© fundamental para determinar corretamente se uma raiz est√° dentro ou fora do c√≠rculo unit√°rio. M√©todos num√©ricos robustos devem ser utilizados para garantir a precis√£o.
*   **Multiplicidade das ra√≠zes:** Se o polin√¥mio tiver ra√≠zes m√∫ltiplas, o procedimento deve ser aplicado a cada raiz individualmente.
*   **Processos com ra√≠zes na borda do c√≠rculo unit√°rio:** Se alguma raiz estiver exatamente na borda do c√≠rculo unit√°rio ($|z_i| = 1$), o processo √© dito *n√£o unicamente invert√≠vel*. Nestes casos, a representa√ß√£o invert√≠vel pode n√£o ser √∫nica, e a escolha da representa√ß√£o pode depender de crit√©rios adicionais [^68].

**Lema 2:** *Seja $Y_t = \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} $ um processo MA(2). Seja $z_1, z_2$ as ra√≠zes de $1 + \theta_1 z + \theta_2 z^2 = 0$. Ent√£o o processo √© invert√≠vel se e somente se $|z_1| > 1$ e $|z_2| > 1$.*

**Demonstra√ß√£o:** Este lema √© uma aplica√ß√£o direta da defini√ß√£o de invertibilidade para o caso MA(2).

**Prova do Lema 2:**
I. Sejam $z_1$ e $z_2$ as ra√≠zes de $1 + \theta_1 z + \theta_2 z^2 = 0$.

II. Pela defini√ß√£o de invertibilidade, o processo MA(2) √© invert√≠vel se e somente se todas as ra√≠zes do polin√¥mio estiverem fora do c√≠rculo unit√°rio, ou seja, $|z_1| > 1$ e $|z_2| > 1$.

III. Portanto, o lema √© uma reafirma√ß√£o direta da condi√ß√£o de invertibilidade. ‚ñ†

**Teorema 3:** *Para o processo MA(q) e a representa√ß√£o invert√≠vel obtida atrav√©s do procedimento de Hansen-Sargent, as fun√ß√µes de autocovari√¢ncia dos dois processos s√£o id√™nticas, mas os coeficientes MA podem ser diferentes.*

**Demonstra√ß√£o:** A fun√ß√£o de autocovari√¢ncia √© determinada pelas ra√≠zes do polin√¥mio do operador MA [^65]. Ao substituir as ra√≠zes dentro do c√≠rculo unit√°rio por seus rec√≠procos, as magnitudes das ra√≠zes s√£o alteradas, mas o produto das ra√≠zes (e, portanto, a fun√ß√£o de autocovari√¢ncia) permanece o mesmo. Como as fun√ß√µes de autocovari√¢ncia permanecem id√™nticas, a estrutura de depend√™ncia temporal do processo √© preservada.

**Prova Detalhada do Teorema 3:**
I. Seja $Y_t = (1 + \theta_1 L + \dots + \theta_q L^q)\epsilon_t = \Theta(L) \epsilon_t$ um processo MA(q).

II. Seja $Y_t^* = (1 + \theta_1^* L + \dots + \theta_q^* L^q)\epsilon_t = \Theta^*(L) \epsilon_t$ a representa√ß√£o invert√≠vel obtida atrav√©s do procedimento de Hansen-Sargent.

III. A fun√ß√£o de autocovari√¢ncia do processo original √© determinada pelos coeficientes $\theta_i$. Em particular, $\gamma_k = Cov(Y_t, Y_{t-k})$ √© uma fun√ß√£o dos coeficientes $\theta_i$.

IV. Seja $z_1, \dots, z_q$ as ra√≠zes do polin√¥mio $\Theta(z)$. Ent√£o, $\Theta(L) = \prod_{i=1}^q (1 - L/z_i)$.

V. Sejam $z_1^*, \dots, z_q^*$ as ra√≠zes do polin√¥mio $\Theta^*(z)$ ap√≥s a aplica√ß√£o do procedimento de Hansen-Sargent.

VI. Pelo procedimento de Hansen-Sargent, as ra√≠zes dentro do c√≠rculo unit√°rio s√£o substitu√≠das por seus rec√≠procos. Assim, $|z_i^*| > 1$ para todo *i*.

VII. Como a substitui√ß√£o de $z_i$ por $1/z_i$ n√£o altera o produto das ra√≠zes, a fun√ß√£o de autocovari√¢ncia permanece inalterada. Portanto, $\gamma_k = Cov(Y_t, Y_{t-k})$ √© a mesma para ambos os processos.

VIII. No entanto, os coeficientes $\theta_i$ e $\theta_i^*$ podem ser diferentes. Isso ocorre porque o polin√¥mio $\Theta(z)$ e $\Theta^*(z)$ t√™m ra√≠zes diferentes, embora as fun√ß√µes de autocovari√¢ncia sejam as mesmas.

IX. Assim, as fun√ß√µes de autocovari√¢ncia dos processos $Y_t$ e $Y_t^*$ s√£o id√™nticas, mas os coeficientes MA podem ser diferentes. ‚ñ†

**Exemplo da Aplica√ß√£o do Procedimento de Hansen-Sargent:**
Considere o processo MA(1) dado por:
$$Y_t = \epsilon_t + 2 \epsilon_{t-1}$$

1. Raiz: O polin√¥mio √© $1 + 2z = 0$, cuja raiz √© $z = -0.5$.
2. Verifica√ß√£o da Invertibilidade: $|z| = 0.5 < 1$, ent√£o o processo n√£o √© invert√≠vel.
3. Aplica√ß√£o de Hansen-Sargent: Substitu√≠mos a raiz por seu rec√≠proco $z^* = 1/z = -2$.
4. Nova Representa√ß√£o: A nova representa√ß√£o √© $Y_t = \epsilon_t + \frac{1}{2} \epsilon_{t-1}$.
5. Verifica√ß√£o da Invertibilidade: A raiz do novo polin√¥mio $1 + \frac{1}{2}z = 0$ √© $z = -2$, e $|z| = 2 > 1$, ent√£o o processo agora √© invert√≠vel.

> üí° **Exemplo Num√©rico:**
> Vamos considerar um processo MA(2) definido por:
> $$Y_t = \epsilon_t + 1.5 \epsilon_{t-1} + 0.5 \epsilon_{t-2}$$
>
> 1. **C√°lculo das ra√≠zes:** O polin√¥mio do operador MA √© $\Theta(z) = 1 + 1.5z + 0.5z^2$. As ra√≠zes deste polin√¥mio s√£o encontradas resolvendo a equa√ß√£o $0.5z^2 + 1.5z + 1 = 0$.
>
> Usando a f√≥rmula quadr√°tica:
>
> $$z = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a} = \frac{-1.5 \pm \sqrt{1.5^2 - 4(0.5)(1)}}{2(0.5)} = \frac{-1.5 \pm \sqrt{2.25 - 2}}{1} = -1.5 \pm \sqrt{0.25} = -1.5 \pm 0.5$$
>
> Portanto, as ra√≠zes s√£o $z_1 = -1$ e $z_2 = -2$.
>
> 2. **Verifica√ß√£o da Invertibilidade:** Verificamos os m√≥dulos das ra√≠zes:
>
> *   $|z_1| = |-1| = 1$
> *   $|z_2| = |-2| = 2$
>
> Como uma das ra√≠zes est√° na borda do c√≠rculo unit√°rio ($|z_1| = 1$), o processo √© *n√£o unicamente invert√≠vel*.
>
> 3. **Aplica√ß√£o do Procedimento de Hansen-Sargent:** Como $|z_1|=1$, este caso requer aten√ß√£o especial. N√£o existe uma forma √∫nica de definir o processo.
>
> ```python
> import numpy as np
>
> # Coeficientes do polin√¥mio MA(2)
> theta1 = 1.5
> theta2 = 0.5
>
> # Calcula as ra√≠zes do polin√¥mio
> roots = np.roots([theta2, theta1, 1])
> print(f"Ra√≠zes do polin√¥mio: {roots}")
>
> # Verifica se as ra√≠zes est√£o dentro do c√≠rculo unit√°rio
> for i, root in enumerate(roots):
>     magnitude = np.abs(root)
>     print(f"M√≥dulo da raiz {i+1}: {magnitude}")
>     if magnitude < 1:
>         print("Raiz dentro do c√≠rculo unit√°rio.")
>     elif magnitude == 1:
>         print("Raiz na borda do c√≠rculo unit√°rio.")
>     else:
>         print("Raiz fora do c√≠rculo unit√°rio.")
> ```

### Implica√ß√µes para a Modelagem de S√©ries Temporais
O procedimento de Hansen-Sargent tem implica√ß√µes significativas para a modelagem de s√©ries temporais usando processos MA(q) [^68]:

*   **Identifica√ß√£o do Modelo:** Ao ajustar um modelo MA(q) aos dados, √© crucial verificar a invertibilidade do processo estimado. Se o processo n√£o for invert√≠vel, o procedimento de Hansen-Sargent pode ser usado para encontrar uma representa√ß√£o equivalente invert√≠vel [^67].
*   **Interpreta√ß√£o dos Coeficientes:** Os coeficientes da representa√ß√£o invert√≠vel podem ter uma interpreta√ß√£o diferente dos coeficientes da representa√ß√£o n√£o invert√≠vel [^67]. No entanto, a estrutura de depend√™ncia temporal do processo (capturada pela fun√ß√£o de autocovari√¢ncia) permanece a mesma [^65].
*   **Previs√£o:** Para fins de previs√£o, a representa√ß√£o invert√≠vel √© prefer√≠vel, pois leva a algoritmos de previs√£o mais est√°veis e eficientes [^67].

Para complementar a discuss√£o sobre modelagem, √© importante considerar o impacto da estima√ß√£o dos par√¢metros $\theta_i$.

**Proposi√ß√£o 4:** *A estima√ß√£o dos par√¢metros $\theta_i$ em um processo MA(q) pode ser realizada por m√©todos de m√°xima verossimilhan√ßa ou por m√©todos dos momentos. A representa√ß√£o invert√≠vel obtida pelo procedimento de Hansen-Sargent preserva a fun√ß√£o de verossimilhan√ßa, garantindo que os estimadores de m√°xima verossimilhan√ßa sejam consistentes.*

**Justificativa:** A fun√ß√£o de verossimilhan√ßa depende da fun√ß√£o de autocovari√¢ncia. Como o procedimento de Hansen-Sargent preserva a fun√ß√£o de autocovari√¢ncia, a fun√ß√£o de verossimilhan√ßa tamb√©m √© preservada.

**Teorema 5:** *Se $\hat{\Theta}(L)$ √© uma estimativa do operador MA $\Theta(L)$ e $\hat{\Theta}^*(L)$ √© a representa√ß√£o invert√≠vel de $\hat{\Theta}(L)$ obtida usando o procedimento de Hansen-Sargent, ent√£o os res√≠duos obtidos usando $\hat{\Theta}^*(L)$ s√£o os mesmos que os res√≠duos obtidos usando uma representa√ß√£o n√£o invert√≠vel de $\hat{\Theta}(L)$*

**Demonstra√ß√£o:**
I. Seja $Y_t = \Theta(L) \epsilon_t$ o verdadeiro processo MA(q).

II. Seja $\hat{\Theta}(L)$ a estimativa do operador MA, que pode ou n√£o ser invert√≠vel.

III. Seja $\hat{\epsilon}_t$ os res√≠duos obtidos ao aplicar o operador estimado aos dados: $\hat{\epsilon}_t = \hat{\Theta}(L)^{-1} Y_t$.

IV. Seja $\hat{\Theta}^*(L)$ a representa√ß√£o invert√≠vel de $\hat{\Theta}(L)$ obtida atrav√©s do procedimento de Hansen-Sargent.

V. Como o procedimento de Hansen-Sargent preserva a fun√ß√£o de autocovari√¢ncia, $\hat{\Theta}(L)$ e $\hat{\Theta}^*(L)$ descrevem a mesma estrutura de depend√™ncia temporal.

VI. Portanto, os res√≠duos obtidos ao aplicar o operador invert√≠vel estimado $\hat{\Theta}^*(L)^{-1}$ aos dados ser√£o os mesmos (em termos da sua distribui√ß√£o e propriedades estat√≠sticas) que os res√≠duos obtidos ao aplicar qualquer outra representa√ß√£o equivalente (invert√≠vel ou n√£o) de $\hat{\Theta}(L)$.

VII. Formalmente, se definirmos $\hat{\epsilon}_t^* = \hat{\Theta}^*(L)^{-1} Y_t$, ent√£o $\hat{\epsilon}_t$ e $\hat{\epsilon}_t^*$ ter√£o as mesmas propriedades estat√≠sticas, especialmente a mesma vari√¢ncia.  Na pr√°tica, a implementa√ß√£o num√©rica pode gerar pequenas diferen√ßas devido a erros de arredondamento.

VIII. Consequentemente, para fins de diagn√≥stico e teste de adequa√ß√£o do modelo, podemos usar tanto a representa√ß√£o invert√≠vel quanto a n√£o invert√≠vel, pois ambas fornecer√£o res√≠duos com caracter√≠sticas semelhantes. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> Suponha que estimamos um processo MA(1) a partir de dados e obtivemos o seguinte modelo:
> $$\hat{Y}_t = \epsilon_t + 1.5\epsilon_{t-1}$$
>
> Este processo n√£o √© invert√≠vel, pois $|\theta| = 1.5 > 1$. Aplicando o procedimento de Hansen-Sargent, obtemos a representa√ß√£o invert√≠vel:
> $$\hat{Y}_t^* = \epsilon_t + \frac{1}{1.5}\epsilon_{t-1} = \epsilon_t + 0.6667\epsilon_{t-1}$$
>
> Agora, vamos gerar uma s√©rie temporal de exemplo e calcular os res√≠duos usando ambas as representa√ß√µes.
>
> ```python
> import numpy as np
> import statsmodels.api as sm
>
> # Gera dados de exemplo
> np.random.seed(0)
> n = 100
> epsilon = np.random.normal(0, 1, n)
>
> # Processo MA(1) n√£o invert√≠vel
> y_non_invertible = [epsilon[i] + 1.5 * epsilon[i-1] if i > 0 else epsilon[i] for i in range(n)]
>
> # Processo MA(1) invert√≠vel
> y_invertible = [epsilon[i] + (1/1.5) * epsilon[i-1] if i > 0 else epsilon[i] for i in range(n)]
>
> # Estima modelo MA(1) usando statsmodels (para fins de compara√ß√£o)
> model_non_invertible = sm.tsa.arima.ARIMA(y_non_invertible, order=(0, 0, 1))
> results_non_invertible = model_non_invertible.fit()
>
> model_invertible = sm.tsa.arima.ARIMA(y_invertible, order=(0, 0, 1))
> results_invertible = model_invertible.fit()
>
> # Calcula os res√≠duos
> residuals_non_invertible = results_non_invertible.resid
> residuals_invertible = results_invertible.resid
>
> # Imprime os resultados
> print("Res√≠duos do modelo n√£o invert√≠vel:", residuals_non_invertible[:5])
> print("Res√≠duos do modelo invert√≠vel:", residuals_invertible[:5])
>
> # Verifica se os res√≠duos s√£o semelhantes
> print("Vari√¢ncia dos res√≠duos (n√£o invert√≠vel):", np.var(residuals_non_invertible))
> print("Vari√¢ncia dos res√≠duos (invert√≠vel):", np.var(residuals_invertible))
> ```
>
> Os res√≠duos obtidos das duas representa√ß√µes (invert√≠vel e n√£o invert√≠vel) ser√£o muito semelhantes, confirmando que o procedimento de Hansen-Sargent preserva as propriedades essenciais para an√°lise e diagn√≥stico do modelo. A pequena diferen√ßa pode ser atribu√≠da a erros num√©ricos ou diferen√ßas na estima√ß√£o dos par√¢metros.

### Conclus√£o
O procedimento de Hansen-Sargent oferece uma ferramenta valiosa para lidar com processos MA(q) n√£o invert√≠veis, garantindo a unicidade da representa√ß√£o e facilitando a an√°lise e previs√£o de s√©ries temporais [^68]. Ao substituir as ra√≠zes dentro do c√≠rculo unit√°rio por seus rec√≠procos, o procedimento permite transformar um processo n√£o invert√≠vel em uma representa√ß√£o equivalente invert√≠vel, preservando a estrutura de autocorrela√ß√£o e garantindo propriedades anal√≠ticas desej√°veis para a modelagem de s√©ries temporais [^65, ^67]. O procedimento de Hansen-Sargent √© uma ferramenta essencial para qualquer analista que trabalhe com modelos MA(q) e busca garantir a robustez e interpretabilidade de seus resultados.

### Refer√™ncias
[^65]: Explica√ß√£o sobre a mesma fun√ß√£o autocovari√¢ncia para representa√ß√µes invert√≠veis e n√£o invert√≠veis, p√°gina 65.
[^67]: A invertibilidade permite escrever o MA(q) como um AR(‚àû) (p√°gina 67).
[^68]: As equa√ß√µes para representa√ß√µes invert√≠veis e n√£o invert√≠veis s√£o mencionadas nas p√°ginas 67 e 68.
<!-- END -->