## T√≠tulo Conciso
Espectro de Pot√™ncia da ACGF para Autocovari√¢ncias Absolutamente Som√°veis

### Introdu√ß√£o
Este cap√≠tulo expande a discuss√£o sobre a fun√ß√£o geradora de autocovari√¢ncia (ACGF) e sua computa√ß√£o eficiente [^61, ^62, ^63, ^64], focando na deriva√ß√£o e significado do **espectro de pot√™ncia** para s√©ries temporais com autocovari√¢ncias absolutamente som√°veis. Como apresentado nos cap√≠tulos anteriores, a ACGF fornece uma representa√ß√£o compacta da estrutura de autocovari√¢ncia de uma s√©rie temporal. O espectro de pot√™ncia, derivado da ACGF, desempenha um papel crucial na an√°lise espectral e em aplica√ß√µes de processamento de sinais, revelando como a pot√™ncia da s√©rie temporal √© distribu√≠da ao longo de diferentes frequ√™ncias.

### Conceitos Fundamentais

Para uma s√©rie temporal $\{Y_t\}$ com autocovari√¢ncias $\{\gamma_j\}$, a ACGF √© definida como [^61]:

$$
g_Y(z) = \sum_{j=-\infty}^{\infty} \gamma_j z^j
$$

Se a sequ√™ncia de autocovari√¢ncias for absolutamente som√°vel, isto √©, $\sum_{j=-\infty}^{\infty} |\gamma_j| < \infty$, ent√£o a ACGF existe e √© anal√≠tica em uma regi√£o que inclui o c√≠rculo unit√°rio no plano complexo [^61].  Quando avaliamos a ACGF no c√≠rculo unit√°rio ($z = e^{-i\omega}$), obtemos o espectro de pot√™ncia (ou densidade espectral de pot√™ncia) $S_Y(\omega)$, que representa a distribui√ß√£o da pot√™ncia da s√©rie temporal ao longo de diferentes frequ√™ncias $\omega$ [^61, ^62, ^64]:

$$
S_Y(\omega) = \frac{1}{2\pi} g_Y(e^{-i\omega}) = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j e^{-i\omega j}
$$

onde $\omega$ √© a frequ√™ncia em radianos por unidade de tempo. O espectro de pot√™ncia $S_Y(\omega)$ √© uma fun√ß√£o real, n√£o negativa e par de $\omega$ [^61].

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal com $\gamma_0 = 1$ e $\gamma_j = 0$ para $j \neq 0$. A ACGF √© $g_Y(z) = 1$. O espectro de pot√™ncia √© $S_Y(\omega) = \frac{1}{2\pi}$. Isso corresponde a um ru√≠do branco, onde todas as frequ√™ncias t√™m a mesma pot√™ncia.
>
> üí° **Exemplo Num√©rico:** Seja $\gamma_0 = 1$, $\gamma_1 = 0.5$, $\gamma_{-1} = 0.5$, e $\gamma_j = 0$ para $|j| > 1$. Ent√£o, $g_Y(z) = 1 + 0.5z + 0.5z^{-1}$. O espectro de pot√™ncia √© $S_Y(\omega) = \frac{1}{2\pi} (1 + 0.5e^{-i\omega} + 0.5e^{i\omega}) = \frac{1}{2\pi} (1 + \cos(\omega))$. Este espectro de pot√™ncia concentra a pot√™ncia em baixas frequ√™ncias.
>
*Proof.* A realidade segue da simetria da ACGF e da rela√ß√£o de Euler. A n√£o-negatividade √© consequ√™ncia do fato que $S_Y(\omega)$ representa a distribui√ß√£o da vari√¢ncia ao longo das frequ√™ncias, e a vari√¢ncia √© sempre n√£o-negativa. A paridade segue de $S_Y(-\omega) = \frac{1}{2\pi} g_Y(e^{i\omega}) = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j e^{i\omega j} = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_{-j} e^{i\omega j} = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_{j} e^{-i\omega j} = S_Y(\omega)$.  A realidade, n√£o-negatividade e paridade s√£o propriedades essenciais do espectro de pot√™ncia.

**Proposi√ß√£o 1** (Conjuga√ß√£o da ACGF). *A ACGF de uma s√©rie temporal real $\{Y_t\}$ satisfaz $g_Y(z) = g_Y(z^{-1})$.*

*Proof.* Para uma s√©rie temporal real, $\gamma_j = \gamma_{-j}$. Assim, $g_Y(z) = \sum_{j=-\infty}^{\infty} \gamma_j z^j = \sum_{j=-\infty}^{\infty} \gamma_{-j} z^j = \sum_{j=-\infty}^{\infty} \gamma_{j} z^{-j} = g_Y(z^{-1})$. $\blacksquare$

**Proposi√ß√£o 1.1** (Simetria do Espectro de Pot√™ncia). *O espectro de pot√™ncia de uma s√©rie temporal real $\{Y_t\}$ √© uma fun√ß√£o par, ou seja, $S_Y(\omega) = S_Y(-\omega)$.*

*Proof.* Esta propriedade j√° foi demonstrada na prova da paridade do espectro de pot√™ncia na se√ß√£o anterior.  Dado que $S_Y(-\omega) = \frac{1}{2\pi} g_Y(e^{i\omega})$ e, pela Proposi√ß√£o 1, $g_Y(z) = g_Y(z^{-1})$, ent√£o $S_Y(-\omega) = \frac{1}{2\pi} g_Y(e^{i\omega}) = \frac{1}{2\pi} g_Y(e^{-i\omega}) = S_Y(\omega)$. $\blacksquare$

**Rela√ß√£o com Autocovari√¢ncia:**

O espectro de pot√™ncia e a sequ√™ncia de autocovari√¢ncias formam um par de Transformada de Fourier Discreta (DFT), tamb√©m conhecido como Transformada de Fourier Discreta Inversa (IDFT) [^63, ^64]:

$$
S_Y(\omega) = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j e^{-i\omega j}
$$

$$
\gamma_j = \int_{-\pi}^{\pi} S_Y(\omega) e^{i\omega j} d\omega
$$

Estas equa√ß√µes estabelecem uma correspond√™ncia biun√≠voca entre o dom√≠nio do tempo (autocovari√¢ncia) e o dom√≠nio da frequ√™ncia (espectro de pot√™ncia).

> üí° **Exemplo Num√©rico:** Considere um processo de ru√≠do branco com espectro de pot√™ncia constante $S_Y(\omega) = \frac{\sigma^2}{2\pi}$ para $-\pi \leq \omega \leq \pi$. As autocovari√¢ncias s√£o $\gamma_j = \int_{-\pi}^{\pi} \frac{\sigma^2}{2\pi} e^{i\omega j} d\omega$. Para $j = 0$, $\gamma_0 = \frac{\sigma^2}{2\pi} \int_{-\pi}^{\pi} d\omega = \sigma^2$. Para $j \neq 0$, $\gamma_j = \frac{\sigma^2}{2\pi} \left[ \frac{e^{i\omega j}}{ij} \right]_{-\pi}^{\pi} = \frac{\sigma^2}{2\pi ij} (e^{i\pi j} - e^{-i\pi j}) = \frac{\sigma^2}{2\pi ij} 2i \sin(\pi j) = 0$. Isso confirma que o ru√≠do branco tem autocovari√¢ncia zero para todos os lags diferentes de zero.
>
*Proof.* Mostraremos que a transformada de Fourier do espectro de pot√™ncia resulta na fun√ß√£o de autocovari√¢ncia original:

I. Partimos da defini√ß√£o do espectro de pot√™ncia:
 $$S_Y(\omega) = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j e^{-i\omega j}$$

II. Substitu√≠mos a express√£o do espectro de pot√™ncia na integral da transformada de Fourier inversa:
  $$\int_{-\pi}^{\pi} S_Y(\omega) e^{i\omega k} d\omega = \int_{-\pi}^{\pi} \left( \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j e^{-i\omega j} \right) e^{i\omega k} d\omega$$

III. Trocamos a ordem da integral e da soma (sob certas condi√ß√µes de converg√™ncia):
   $$\int_{-\pi}^{\pi} S_Y(\omega) e^{i\omega k} d\omega = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j \int_{-\pi}^{\pi} e^{i\omega (k-j)} d\omega$$

IV. Avaliamos a integral:
   $$ \int_{-\pi}^{\pi} e^{i\omega (k-j)} d\omega = \begin{cases} 2\pi, & \text{se } k=j \\ 0, & \text{se } k \neq j \end{cases} $$
Nota: Isso ocorre porque $\int_{-\pi}^{\pi} e^{i\omega (k-j)} d\omega = \left[ \frac{e^{i\omega (k-j)}}{i(k-j)} \right]_{-\pi}^{\pi} = \frac{e^{i\pi (k-j)} - e^{-i\pi (k-j)}}{i(k-j)} = \frac{2\sin(\pi(k-j))}{k-j}$. Se $k=j$, ent√£o a integral √© $\int_{-\pi}^{\pi} 1 d\omega = 2\pi$. Se $k \neq j$, ent√£o $\frac{2\sin(\pi(k-j))}{k-j} = 0$ porque $\sin(\pi(k-j)) = 0$ para inteiros $k$ e $j$.

V. Substitu√≠mos o resultado da integral de volta na express√£o:
   $$\int_{-\pi}^{\pi} S_Y(\omega) e^{i\omega k} d\omega = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j (2\pi \delta_{jk}) = \gamma_k$$
onde $\delta_{jk}$ √© o delta de Kronecker. Portanto, a transformada de Fourier inversa do espectro de pot√™ncia resulta na fun√ß√£o de autocovari√¢ncia original. $\blacksquare$

**Teorema 1** (Teorema de Wiener-Khinchin). *Para uma s√©rie temporal estacion√°ria, o espectro de pot√™ncia √© a transformada de Fourier da fun√ß√£o de autocovari√¢ncia.*

*Proof.* Este teorema √© uma reformula√ß√£o da rela√ß√£o entre o espectro de pot√™ncia e a autocovari√¢ncia j√° estabelecida pelas equa√ß√µes:
$$
S_Y(\omega) = \frac{1}{2\pi} \sum_{j=-\infty}^{\infty} \gamma_j e^{-i\omega j}
$$

$$
\gamma_j = \int_{-\pi}^{\pi} S_Y(\omega) e^{i\omega j} d\omega
$$
O teorema simplesmente afirma esta rela√ß√£o fundamental. $\blacksquare$

#### Espectro de Pot√™ncia para Modelos ARMA
O espectro de pot√™ncia para um modelo ARMA(p, q) pode ser expresso em termos dos polin√¥mios $\phi(z)$ e $\theta(z)$ como [^62]:

$$
S_Y(\omega) = \frac{\sigma^2}{2\pi} \frac{|\theta(e^{-i\omega})|^2}{|\phi(e^{-i\omega})|^2}
$$

onde $\sigma^2$ √© a vari√¢ncia do ru√≠do branco, e [^51]:
$$
\phi(e^{-i\omega}) = 1 - \sum_{k=1}^{p} \phi_k e^{-i\omega k}
$$

$$
\theta(e^{-i\omega}) = 1 + \sum_{k=1}^{q} \theta_k e^{-i\omega k}
$$

Esta express√£o √© fundamental para a an√°lise espectral de modelos ARMA [^47, ^48, ^53].

> üí° **Exemplo Num√©rico:** Para um processo AR(1) com $\phi = 0.8$ e $\sigma^2 = 1$, o espectro de pot√™ncia √© $S_Y(\omega) = \frac{1}{2\pi} \frac{1}{|1 - 0.8e^{-i\omega}|^2}$. O espectro de pot√™ncia atinge seu m√°ximo em $\omega = 0$, indicando que a maior parte da pot√™ncia est√° concentrada em baixas frequ√™ncias.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros do modelo AR(1)
> phi = 0.8
> sigma2 = 1
>
> # Frequ√™ncias
> omega = np.linspace(-np.pi, np.pi, 500)
>
> # Espectro de pot√™ncia
> S_Y = (sigma2 / (2 * np.pi)) * (1 / np.abs(1 - phi * np.exp(-1j * omega))**2)
>
> # Plotando o espectro de pot√™ncia
> plt.figure(figsize=(8, 6))
> plt.plot(omega, S_Y)
> plt.title('Espectro de Pot√™ncia para AR(1) com œÜ = 0.8 e œÉ¬≤ = 1')
> plt.xlabel('Frequ√™ncia (œâ)')
> plt.ylabel('Densidade Espectral de Pot√™ncia')
> plt.grid(True)
> plt.show()
> ```
> Este c√≥digo Python calcula e visualiza o espectro de pot√™ncia de um processo AR(1). O gr√°fico resultante mostra o pico de pot√™ncia em baixas frequ√™ncias, caracter√≠stico de processos AR(1) com coeficientes positivos.

*Proof.* A deriva√ß√£o do espectro de pot√™ncia para um modelo ARMA segue da rela√ß√£o entre a ACGF e o espectro de pot√™ncia.

I. Partimos da ACGF do modelo ARMA(p,q):
    $$g_Y(z) = \sigma^2 \frac{\theta(z)\theta(z^{-1})}{\phi(z)\phi(z^{-1})}$$

II. Substitu√≠mos $z = e^{-i\omega}$ para obter o espectro de pot√™ncia:
    $$S_Y(\omega) = \frac{1}{2\pi} g_Y(e^{-i\omega}) = \frac{\sigma^2}{2\pi} \frac{\theta(e^{-i\omega})\theta(e^{i\omega})}{\phi(e^{-i\omega})\phi(e^{i\omega})}$$

III. Reconhecemos que $\theta(e^{i\omega})$ √© o conjugado complexo de $\theta(e^{-i\omega})$ e, portanto, $\theta(e^{-i\omega})\theta(e^{i\omega}) = |\theta(e^{-i\omega})|^2$. Similarmente, $\phi(e^{i\omega})$ √© o conjugado complexo de $\phi(e^{-i\omega})$ e, portanto, $\phi(e^{-i\omega})\phi(e^{i\omega}) = |\phi(e^{-i\omega})|^2$.

IV. Substitu√≠mos estas rela√ß√µes na express√£o:
      $$S_Y(\omega) = \frac{\sigma^2}{2\pi} \frac{|\theta(e^{-i\omega})|^2}{|\phi(e^{-i\omega})|^2}$$
Portanto, o espectro de pot√™ncia para um modelo ARMA(p, q) √© dado pela express√£o acima. $\blacksquare$

**Espectro de Pot√™ncia e Modelos MA(q):**

Para um processo de M√©dias M√≥veis de ordem *q*, MA(q), o espectro de pot√™ncia √© dado por:

$$
S_Y(\omega) = \frac{\sigma^2}{2\pi} |\theta(e^{-i\omega})|^2 = \frac{\sigma^2}{2\pi} \left| 1 + \sum_{k=1}^{q} \theta_k e^{-i\omega k} \right|^2
$$

Este espectro de pot√™ncia descreve como o modelo MA(q) distribui a pot√™ncia ao longo de diferentes frequ√™ncias em fun√ß√£o dos coeficientes $\theta_k$.

> üí° **Exemplo Num√©rico:** Para um processo MA(1) com $\theta = 0.6$ e $\sigma^2 = 1$, o espectro de pot√™ncia √© $S_Y(\omega) = \frac{1}{2\pi} |1 + 0.6e^{-i\omega}|^2 = \frac{1}{2\pi} (1.36 + 1.2\cos(\omega))$. O espectro de pot√™ncia √© m√°ximo em $\omega = 0$ e m√≠nimo em $\omega = \pi$, indicando que o modelo MA(1) concentra a pot√™ncia em baixas frequ√™ncias.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros do modelo MA(1)
> theta = 0.6
> sigma2 = 1
>
> # Frequ√™ncias
> omega = np.linspace(-np.pi, np.pi, 500)
>
> # Espectro de pot√™ncia
> S_Y = (sigma2 / (2 * np.pi)) * np.abs(1 + theta * np.exp(-1j * omega))**2
>
> # Plotando o espectro de pot√™ncia
> plt.figure(figsize=(8, 6))
> plt.plot(omega, S_Y)
> plt.title('Espectro de Pot√™ncia para MA(1) com Œ∏ = 0.6 e œÉ¬≤ = 1')
> plt.xlabel('Frequ√™ncia (œâ)')
> plt.ylabel('Densidade Espectral de Pot√™ncia')
> plt.grid(True)
> plt.show()
> ```
> Este c√≥digo visualiza o espectro de pot√™ncia para um modelo MA(1). O gr√°fico demonstra como a pot√™ncia √© distribu√≠da nas frequ√™ncias, mostrando o pico em baixas frequ√™ncias para valores positivos de Œ∏.

*Proof.* Para demonstrar o resultado, substitu√≠mos a express√£o da ACGF do modelo MA(q) na defini√ß√£o do espectro de pot√™ncia.

I. A ACGF para um processo MA(q) √© dada por:
   $$ g_Y(z) = \sigma^2 \theta(z) \theta(z^{-1}) = \sigma^2 (1 + \sum_{i=1}^{q} \theta_i z^i) (1 + \sum_{i=1}^{q} \theta_i z^{-i})$$

II. Substitu√≠mos $z = e^{-i\omega}$ na ACGF:
   $$g_Y(e^{-i\omega}) = \sigma^2 (1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i}) (1 + \sum_{i=1}^{q} \theta_i e^{i\omega i})$$

III. Substitu√≠mos a express√£o na defini√ß√£o do espectro de pot√™ncia:
   $$S_Y(\omega) = \frac{1}{2\pi} g_Y(e^{-i\omega}) = \frac{\sigma^2}{2\pi} (1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i}) (1 + \sum_{i=1}^{q} \theta_i e^{i\omega i})$$

IV. Reconhecemos que $(1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i}) (1 + \sum_{i=1}^{q} \theta_i e^{i\omega i}) = \left|1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i}\right|^2$.

V. Substitu√≠mos na express√£o:
    $$S_Y(\omega) = \frac{\sigma^2}{2\pi} \left|1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i}\right|^2$$

Portanto, o espectro de pot√™ncia para um processo MA(q) √© dado pela express√£o acima. $\blacksquare$

**Espectro de Pot√™ncia e Modelos AR(p):**

Para um processo Auto-Regressivo de ordem *p*, AR(p), o espectro de pot√™ncia √© dado por:

$$
S_Y(\omega) = \frac{\sigma^2}{2\pi |\phi(e^{-i\omega})|^2} = \frac{\sigma^2}{2\pi \left| 1 - \sum_{k=1}^{p} \phi_k e^{-i\omega k} \right|^2}
$$

Este espectro de pot√™ncia descreve como o modelo AR(p) distribui a pot√™ncia ao longo de diferentes frequ√™ncias em fun√ß√£o dos coeficientes $\phi_k$.

> üí° **Exemplo Num√©rico:** Para um processo AR(1) com $\phi = 0.8$ e $\sigma^2 = 1$, o espectro de pot√™ncia √© $S_Y(\omega) = \frac{1}{2\pi} \frac{1}{|1 - 0.8e^{-i\omega}|^2} = \frac{1}{2\pi} \frac{1}{1.64 - 1.6\cos(\omega)}$. O espectro de pot√™ncia atinge seu m√°ximo em $\omega = 0$, indicando que a maior parte da pot√™ncia est√° concentrada em baixas frequ√™ncias.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros do modelo AR(1)
> phi = 0.8
> sigma2 = 1
>
> # Frequ√™ncias
> omega = np.linspace(-np.pi, np.pi, 500)
>
> # Espectro de pot√™ncia
> S_Y = (sigma2 / (2 * np.pi)) * (1 / np.abs(1 - phi * np.exp(-1j * omega))**2)
>
> # Plotando o espectro de pot√™ncia
> plt.figure(figsize=(8, 6))
> plt.plot(omega, S_Y)
> plt.title('Espectro de Pot√™ncia para AR(1) com œÜ = 0.8 e œÉ¬≤ = 1')
> plt.xlabel('Frequ√™ncia (œâ)')
> plt.ylabel('Densidade Espectral de Pot√™ncia')
> plt.grid(True)
> plt.show()
> ```
> O gr√°fico gerado pelo c√≥digo mostra a densidade espectral de pot√™ncia de um processo AR(1), com um pico pronunciado em baixas frequ√™ncias, indicativo da forte correla√ß√£o serial presente nesse tipo de processo.

*Proof.* Para demonstrar o resultado, substitu√≠mos a express√£o da ACGF do modelo AR(p) na defini√ß√£o do espectro de pot√™ncia.

I. A ACGF para um processo AR(p) √© dada por:
$$g_Y(z) = \frac{\sigma^2}{\phi(z) \phi(z^{-1})}$$

II. Substitu√≠mos $z = e^{-i\omega}$ na ACGF:
    $$g_Y(e^{-i\omega}) = \frac{\sigma^2}{\phi(e^{-i\omega}) \phi(e^{i\omega})}$$

III. Substitu√≠mos a express√£o na defini√ß√£o do espectro de pot√™ncia:
 $$S_Y(\omega) = \frac{1}{2\pi} g_Y(e^{-i\omega}) = \frac{\sigma^2}{2\pi \phi(e^{-i\omega}) \phi(e^{i\omega})}$$

IV. Reconhecemos que $\phi(e^{-i\omega}) \phi(e^{i\omega}) = |\phi(e^{-i\omega})|^2 = \left| 1 - \sum_{k=1}^{p} \phi_k e^{-i\omega k} \right|^2$.

V. Substitu√≠mos na express√£o:
     $$S_Y(\omega) = \frac{\sigma^2}{2\pi \left| 1 - \sum_{k=1}^{p} \phi_k e^{-i\omega k} \right|^2}$$
 Portanto, o espectro de pot√™ncia para um processo AR(p) √© dado pela express√£o acima. $\blacksquare$

**Teorema 2** (Preserva√ß√£o da √Årea). *A integral do espectro de pot√™ncia sobre o intervalo $[-\pi, \pi]$ √© igual √† vari√¢ncia da s√©rie temporal.*

*Proof.* A vari√¢ncia da s√©rie temporal √© dada por $\gamma_0$. Usando a rela√ß√£o entre a autocovari√¢ncia e o espectro de pot√™ncia:
$$
\gamma_0 = \int_{-\pi}^{\pi} S_Y(\omega) e^{i\omega \cdot 0} d\omega = \int_{-\pi}^{\pi} S_Y(\omega) d\omega
$$
Portanto, a integral do espectro de pot√™ncia √© igual √† vari√¢ncia da s√©rie temporal. $\blacksquare$

**Teorema 2.1** (Rela√ß√£o com a Energia Total). *A √°rea sob o espectro de pot√™ncia, normalizada por $2\pi$, representa a energia total da s√©rie temporal.*

*Proof.* Pelo teorema de Parseval, a energia total da s√©rie temporal no dom√≠nio do tempo √© igual √† energia total no dom√≠nio da frequ√™ncia. A energia total no dom√≠nio do tempo pode ser expressa como a soma dos quadrados dos valores da s√©rie temporal, enquanto no dom√≠nio da frequ√™ncia √© expressa como a integral do espectro de pot√™ncia. Assim, se a s√©rie temporal √© $\{Y_t\}_{t=-\infty}^{\infty}$, sua energia √© $\sum_{t=-\infty}^{\infty} |Y_t|^2$. Pelo teorema de Parseval:
$$
\sum_{t=-\infty}^{\infty} |Y_t|^2 = \frac{1}{2\pi}\int_{-\pi}^{\pi} 2\pi |S_Y(\omega)| d\omega
$$
Onde o fator $2\pi$ √© usado para garantir a consist√™ncia com a defini√ß√£o do espectro de pot√™ncia. Como $S_Y(\omega)$ representa a distribui√ß√£o de pot√™ncia por unidade de frequ√™ncia, a integral sobre todas as frequ√™ncias fornece a energia total da s√©rie. Normalizando por $2\pi$, obtemos a energia total por unidade de tempo. $\blacksquare$

**Transformada de Fourier R√°pida (FFT) para Estima√ß√£o do Espectro de Pot√™ncia:**

A Transformada de Fourier R√°pida (FFT) √© um algoritmo eficiente para calcular a DFT [^63, ^64]. Dada uma s√©rie temporal de tamanho *N*, $Y_0, Y_1, \ldots, Y_{N-1}$, o espectro de pot√™ncia amostral pode ser estimado da seguinte forma:

1.  Calcular a DFT da s√©rie temporal:

    $$
    \tilde{Y}_k = \sum_{n=0}^{N-1} Y_n e^{-i 2\pi k n / N}
    $$

    para $k = 0, 1, \ldots, N-1$.

2.  Estimar o espectro de pot√™ncia:

    $$
    \hat{S}_Y(\omega_k) = \frac{1}{N} |\tilde{Y}_k|^2
    $$

    onde $\omega_k = \frac{2\pi k}{N}$ s√£o as frequ√™ncias amostrais.

O uso da FFT reduz o custo computacional da estimativa do espectro de pot√™ncia de $O(N^2)$ para $O(N \log N)$.

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal de 1024 pontos. Utilizar a FFT para calcular o espectro de pot√™ncia √© significativamente mais r√°pido do que calcular a DFT diretamente. Isso permite analisar dados em tempo real.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Gerar uma s√©rie temporal de exemplo (ru√≠do branco)
> N = 1024
> Y = np.random.randn(N)
>
> # Calcular a FFT
> Y_tilde = np.fft.fft(Y)
>
> # Estimar o espectro de pot√™ncia
> S_Y_hat = (1/N) * np.abs(Y_tilde)**2
>
> # Frequ√™ncias correspondentes
> omega = np.linspace(0, np.pi, N//2) # Usando apenas a metade positiva do espectro
>
> # Plotar o espectro de pot√™ncia estimado
> plt.figure(figsize=(10, 6))
> plt.plot(omega, S_Y_hat[:N//2])  # Plotando apenas a metade positiva
> plt.title('Espectro de Pot√™ncia Estimado via FFT (Ru√≠do Branco)')
> plt.xlabel('Frequ√™ncia (œâ)')
> plt.ylabel('Densidade Espectral de Pot√™ncia')
> plt.grid(True)
> plt.show()
> ```
> Este exemplo mostra como calcular e visualizar o espectro de pot√™ncia de um sinal de ru√≠do branco usando a FFT em Python. A visualiza√ß√£o resultante deve mostrar um espectro aproximadamente plano, indicando que todas as frequ√™ncias t√™m aproximadamente a mesma pot√™ncia, como esperado para ru√≠do branco.
>
> Al√©m disso, podemos comparar o tempo de execu√ß√£o do c√°lculo do espectro de pot√™ncia utilizando a DFT diretamente versus a FFT para demonstrar a efici√™ncia da FFT.

A transformada discreta de Fourier (DFT) de uma sequ√™ncia finita $x_0, x_1, \ldots, x_{N-1}$ √© definida como:

$$X_k = \sum_{n=0}^{N-1} x_n e^{-i 2\pi k n / N}$$

para $k = 0, 1, \ldots, N-1$. Agora vamos derivar a rela√ß√£o entre a DFT e o espectro de pot√™ncia. Seja $x_n$ uma amostra de uma s√©rie temporal estacion√°ria e erg√≥dica.

*Proof.*

I.  A autocovari√¢ncia da s√©rie temporal √© dada por $\gamma_j = E[(x_n - \mu)(x_{n-j} - \mu)]$, onde $\mu$ √© a m√©dia.

II. O estimador amostral da autocovari√¢ncia √© $\hat{\gamma}_j = \frac{1}{N} \sum_{n=j}^{N-1} (x_n - \bar{x}) (x_{n-j} - \bar{x})$, onde $\bar{x}$ √© a m√©dia amostral.

III. O espectro de pot√™ncia √© definido como a transformada de Fourier da fun√ß√£o de autocovari√¢ncia: $S(\omega) = \sum_{j=-\infty}^{\infty} \gamma_j e^{-i\omega j}$.

IV. O estimador amostral do espectro de pot√™ncia √© $\hat{S}(\omega) = \sum_{j=-(N-1)}^{N-1} \hat{\gamma}_j e^{-i\omega j}$.

V. Usando a rela√ß√£o de Parseval, $\sum_{n=0}^{N-1} |x_n|^2 = \frac{1}{N} \sum_{k=0}^{N-1} |X_k|^2$, onde $X_k$ √© a DFT de $x_n$.

VI. Desconsiderando a normaliza√ß√£o, $\hat{S}(\omega) \approx |X_k|^2$, onde $X_k$ √© a DFT da sequ√™ncia $x_n$.

VII. Para expressar a rela√ß√£o explicitamente, a express√£o para o espectro de pot√™ncia estimada usando a DFT (sem a devida normaliza√ß√£o, janelamento, etc.) √© dada por: $\hat{S}(\omega_k) = \frac{1}{N} |X_k|^2 = \frac{1}{N} |\sum_{n=0}^{N-1} x_n e^{-i 2\pi k n / N}|^2$, que se aproxima do verdadeiro espectro de pot√™ncia sob certas condi√ß√µes.

Dessa forma, a transformada discreta de Fourier (DFT) se relaciona com a estimativa amostral do espectro de pot√™ncia da s√©rie temporal, ao aproximar a energia contida nas diversas frequ√™ncias. $\blacksquare$

**Janelamento para Estimativa do Espectro de Pot√™ncia com FFT:**

A aplica√ß√£o de uma janela √† s√©rie temporal antes de calcular a FFT pode reduzir o vazamento espectral e melhorar a precis√£o da estimativa do espectro de pot√™ncia [^63]. Dada uma janela $w_n$, a s√©rie temporal janelada √© $Y_n^* = w_n Y_n$, e o espectro de pot√™ncia estimado √©:

$$
\hat{S}_Y(\omega_k) = \frac{1}{N} |\tilde{Y}^*_k|^2
$$

onde $\tilde{Y}^*_k$ √© a DFT da s√©rie temporal janelada.

**Lema 1** (Efeito do Janelamento no Dom√≠nio da Frequ√™ncia). *O espectro de pot√™ncia da s√©rie temporal janelada √© a convolu√ß√£o do espectro de pot√™ncia original com a transformada de Fourier da janela.*

*Proof.* Seja $W(\omega)$ a transformada de Fourier da janela $w_n$. No dom√≠nio da frequ√™ncia, a multiplica√ß√£o no dom√≠nio do tempo (janelamento) corresponde √† convolu√ß√£o no dom√≠nio da frequ√™ncia:

I. Seja $Y(\omega)$ a Transformada de Fourier da s√©rie temporal original $Y_n$, e $W(\omega)$ a Transformada de Fourier da janela $w_n$.

II. A s√©rie temporal janelada √© dada por $Y_n^* = w_n Y_n$.

III. Pelo teorema da convolu√ß√£o, a Transformada de Fourier do produto de duas fun√ß√µes no dom√≠nio do tempo √© igual √† convolu√ß√£o das Transformadas de Fourier dessas fun√ß√µes no dom√≠nio da frequ√™ncia.

IV. Portanto, a Transformada de Fourier da s√©rie temporal janelada $Y_n^*$ √© dada por:
$$Y^*(\omega) = \frac{1}{2\pi} (Y * W)(\omega) = \frac{1}{2\pi} \int_{-\pi}^{\pi} Y(\lambda) W(\omega - \lambda) d\lambda$$
Isto significa que o espectro estimado √© uma vers√£o suavizada do espectro verdadeiro, com o formato da suaviza√ß√£o determinado pela transformada de Fourier da janela. $\blacksquare$

**Lema 1.1** (Largura da Banda da Janela). *A largura da banda principal da transformada de Fourier da janela determina a resolu√ß√£o espectral do espectro de pot√™ncia estimado.*

*Proof.* A convolu√ß√£o no dom√≠nio da frequ√™ncia implica que a resolu√ß√£o espectral do espectro de pot√™ncia estimado √© limitada pela largura da banda principal da transformada de Fourier da janela. Uma janela com uma largura de banda principal menor proporciona uma resolu√ß√£o espectral mais alta, permitindo distinguir entre componentes de frequ√™ncia mais pr√≥ximos. No entanto, janelas com larguras de banda principal menores geralmente t√™m l√≥bulos laterais maiores, o que pode aumentar o vazamento espectral. A escolha da janela ideal envolve um compromisso entre a resolu√ß√£o espectral e o vazamento espectral. $\blacksquare$

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal senoidal com ru√≠do. Comparar o espectro de pot√™ncia estimado usando uma janela retangular (sem janelamento) com o espectro de pot√™ncia estimado usando uma janela de Hamming ilustra o efeito do janelamento na redu√ß√£o do vazamento espectral.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros do sinal
> Fs = 1000  # Frequ√™ncia de amostragem
> f = 50    # Frequ√™ncia do sinal
> t = np.arange(0, 1, 1/Fs)  # Vetor de tempo
> N = len(t)
>
> # Sinal senoidal com ru√≠do
> signal = np.sin(2 * np.pi * f * t) + 0.1 * np.random.randn(N)
>
> # Janela de Hamming
> window_hamming = np.hamming(N)>
> # Sinal com a janela de Hamming aplicada
> signal_windowed_hamming = signal * window_hamming
>
> # Aplicar a transformada de Fourier
> fft_result = np.fft.fft(signal_windowed_hamming)
>
> # Calcular o espectro de magnitude
> magnitude_spectrum = np.abs(fft_result)
>
> # Frequ√™ncias correspondentes
> frequencies = np.fft.fftfreq(N, 1/Fs)
>
> # Plotar o sinal original com ru√≠do
> plt.figure(figsize=(12, 6))
> plt.subplot(2, 1, 1)
> plt.plot(t, signal, label='Sinal com Ru√≠do')
> plt.title('Sinal Senoidal com Ru√≠do')
> plt.xlabel('Tempo (s)')
> plt.ylabel('Amplitude')
> plt.legend()
>
> # Plotar o espectro de magnitude
> plt.subplot(2, 1, 2)
> plt.plot(frequencies[:N//2], magnitude_spectrum[:N//2], label='Espectro de Magnitude (Hamming)')
> plt.title('Espectro de Magnitude com Janela de Hamming')
> plt.xlabel('Frequ√™ncia (Hz)')
> plt.ylabel('Magnitude')
> plt.legend()
> plt.tight_layout()
> plt.show()
>
> # Janela de Blackman
> window_blackman = np.blackman(N)
>
> # Sinal com a janela de Blackman aplicada
> signal_windowed_blackman = signal * window_blackman
>
> # Aplicar a transformada de Fourier
> fft_result_blackman = np.fft.fft(signal_windowed_blackman)
>
> # Calcular o espectro de magnitude
> magnitude_spectrum_blackman = np.abs(fft_result_blackman)
>
> # Plotar o espectro de magnitude com janela de Blackman
> plt.figure(figsize=(12, 6))
> plt.subplot(2, 1, 1)
> plt.plot(t, signal, label='Sinal com Ru√≠do')
> plt.title('Sinal Senoidal com Ru√≠do')
> plt.xlabel('Tempo (s)')
> plt.ylabel('Amplitude')
> plt.legend()
>
> plt.subplot(2, 1, 2)
> plt.plot(frequencies[:N//2], magnitude_spectrum_blackman[:N//2], label='Espectro de Magnitude (Blackman)')
> plt.title('Espectro de Magnitude com Janela de Blackman')
> plt.xlabel('Frequ√™ncia (Hz)')
> plt.ylabel('Magnitude')
> plt.legend()
> plt.tight_layout()
> plt.show()

<!-- END -->