## TÃ­tulo Conciso
AnÃ¡lise de Filtros via ACGF

### IntroduÃ§Ã£o

Construindo sobre a discussÃ£o anterior da funÃ§Ã£o geradora de autocovariÃ¢ncia (ACGF) para processos MA(q) [^48, ^50, ^61, ^62], este capÃ­tulo se concentra no uso da ACGF para analisar o efeito de filtros aplicados a sÃ©ries temporais. Filtros sÃ£o operaÃ§Ãµes que modificam uma sÃ©rie temporal, frequentemente para remover ruÃ­do ou realÃ§ar caracterÃ­sticas especÃ­ficas [^63]. A ACGF oferece uma maneira eficiente de determinar como um filtro altera a estrutura de autocovariÃ¢ncia da sÃ©rie temporal original. Conforme detalhado nos capÃ­tulos anteriores, a ACGF fornece uma representaÃ§Ã£o concisa da estrutura de autocovariÃ¢ncia de uma sÃ©rie temporal.

### Conceitos Fundamentais

Um filtro linear pode ser representado por um operador $h(L)$, onde $L$ Ã© o operador de retardo [^51]. Quando aplicado a uma sÃ©rie temporal $Y_t$, o filtro produz uma nova sÃ©rie $X_t$ dada por [^64]:

$$
X_t = h(L)Y_t
$$

onde $h(L)$ Ã© uma funÃ§Ã£o dos operadores de retardo. A funÃ§Ã£o $h(L)$ Ã© frequentemente referida como a **funÃ§Ã£o de transferÃªncia** do filtro. A funÃ§Ã£o de transferÃªncia descreve como diferentes frequÃªncias na sÃ©rie temporal original sÃ£o amplificadas ou atenuadas pelo filtro.

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere um filtro de mÃ©dias mÃ³veis simples de ordem 2, onde cada valor na sÃ©rie filtrada Ã© a mÃ©dia dos dois valores anteriores da sÃ©rie original. A equaÃ§Ã£o para este filtro Ã© $X_t = (Y_t + Y_{t-1})/2$. Em termos do operador de retardo, este filtro pode ser escrito como $X_t = (1 + L)/2 * Y_t$. A funÃ§Ã£o de transferÃªncia para este filtro Ã© $h(L) = (1 + L)/2$.

A ACGF da sÃ©rie filtrada $X_t$ estÃ¡ relacionada Ã  ACGF da sÃ©rie original $Y_t$ e Ã  funÃ§Ã£o de transferÃªncia do filtro [^64]:

$$
g_X(z) = h(z) h(z^{-1}) g_Y(z)
$$

onde $h(z)$ Ã© obtido substituindo o operador de retardo $L$ por $z$ na funÃ§Ã£o de transferÃªncia $h(L)$, e $h(z^{-1})$ Ã© obtido substituindo $L$ por $z^{-1}$ [^64].

> ğŸ’¡ **Exemplo NumÃ©rico:** Suponha que temos uma sÃ©rie temporal $Y_t$ com ACGF $g_Y(z) = 1 + 0.5z + 0.5z^{-1}$ e aplicamos um filtro com funÃ§Ã£o de transferÃªncia $h(L) = 1 - L$. EntÃ£o, $h(z) = 1 - z$ e $h(z^{-1}) = 1 - z^{-1}$. A ACGF da sÃ©rie filtrada $X_t$ Ã© $g_X(z) = (1 - z)(1 - z^{-1})(1 + 0.5z + 0.5z^{-1})$.

*Proof.* Vamos derivar a expressÃ£o da ACGF da sÃ©rie filtrada:

I. A sÃ©rie filtrada Ã© dada por $X_t = h(L)Y_t$.

II. Defina a autocovariÃ¢ncia da sÃ©rie filtrada como $\gamma_{X}(j) = E[(X_t - \mu_X)(X_{t-j} - \mu_X)]$, onde $\mu_X$ Ã© a mÃ©dia de $X_t$.

III. SubstituÃ­mos a expressÃ£o de $X_t$:
    $$ \gamma_{X}(j) = E[(h(L)Y_t - \mu_X)(h(L)Y_{t-j} - \mu_X)] $$

IV. Assumindo que o filtro Ã© linear e nÃ£o depende do tempo, podemos trocar a ordem da esperanÃ§a e do operador de retardo:
     $$ \gamma_{X}(j) = h(L) h(L^{-1}) E[(Y_t - \mu_Y)(Y_{t-j} - \mu_Y)] $$

V. Reconhecendo que $E[(Y_t - \mu_Y)(Y_{t-j} - \mu_Y)]$ Ã© a autocovariÃ¢ncia da sÃ©rie original, $\gamma_Y(j)$:
    $$ \gamma_{X}(j) = h(L) h(L^{-1}) \gamma_Y(j) $$

VI. Tomando a transformada da ACGF de ambos os lados:
      $$ g_X(z) = \sum_{j=-\infty}^{\infty} \gamma_X(j) z^j = \sum_{j=-\infty}^{\infty} h(L) h(L^{-1}) \gamma_Y(j) z^j $$

VII. Como $h(L)$ e $h(L^{-1})$ sÃ£o operadores lineares que nÃ£o dependem de *j*, podemos tirÃ¡-los da soma:
       $$ g_X(z) = h(z) h(z^{-1}) \sum_{j=-\infty}^{\infty}  \gamma_Y(j) z^j $$

VIII. Reconhecendo a definiÃ§Ã£o da ACGF da sÃ©rie original:
        $$ g_X(z) = h(z) h(z^{-1}) g_Y(z) $$
Portanto, a ACGF da sÃ©rie filtrada Ã© o produto da funÃ§Ã£o de transferÃªncia do filtro e sua inversa com a ACGF da sÃ©rie original. $\blacksquare$

Esta expressÃ£o Ã© crucial porque permite analisar o efeito do filtro na estrutura de autocovariÃ¢ncia da sÃ©rie original simplesmente multiplicando as ACGFs.

**Lema 1.** Se $h(L)$ Ã© um filtro linear com coeficientes reais, entÃ£o $h(z^{-1}) = \overline{h(\bar{z})}$, onde $\overline{h(\bar{z})}$ denota o conjugado complexo de $h(\bar{z})$.

*Proof.* Seja $h(L) = \sum_{k=-n}^{n} a_k L^k$, onde $a_k$ sÃ£o coeficientes reais. EntÃ£o $h(z) = \sum_{k=-n}^{n} a_k z^k$ e $h(z^{-1}) = \sum_{k=-n}^{n} a_k z^{-k}$. Substituindo $z$ por $\bar{z}$, temos $h(\bar{z}) = \sum_{k=-n}^{n} a_k \bar{z}^k$. Tomando o conjugado complexo, $\overline{h(\bar{z})} = \sum_{k=-n}^{n} a_k \overline{\bar{z}^k} = \sum_{k=-n}^{n} a_k z^{-k} = h(z^{-1})$. $\blacksquare$

**Lema 1.1.** Se $h(L)$ Ã© um filtro simÃ©trico com coeficientes reais, isto Ã© $a_k = a_{-k}$, entÃ£o $h(z) = h(z^{-1})$ para $z \in \mathbb{R}$.

*Proof.* Seja $h(L) = \sum_{k=-n}^{n} a_k L^k$ com $a_k = a_{-k}$.  EntÃ£o $h(z) = \sum_{k=-n}^{n} a_k z^k$ e $h(z^{-1}) = \sum_{k=-n}^{n} a_k z^{-k} = \sum_{k=-n}^{n} a_{-k} z^{-k}$.  Fazendo a substituiÃ§Ã£o $j = -k$, obtemos $h(z^{-1}) = \sum_{j=n}^{-n} a_{j} z^{j} = \sum_{j=-n}^{n} a_{j} z^{j} = h(z)$. $\blacksquare$

**ProposiÃ§Ã£o 2.** Se $h_1(L)$ e $h_2(L)$ sÃ£o dois filtros lineares, a aplicaÃ§Ã£o sequencial dos filtros $h_1(L)$ e $h_2(L)$ a uma sÃ©rie temporal $Y_t$ Ã© equivalente a aplicar um Ãºnico filtro com funÃ§Ã£o de transferÃªncia $h(L) = h_2(L)h_1(L)$.

*Proof.* Seja $X_t = h_1(L)Y_t$ e $W_t = h_2(L)X_t$. EntÃ£o $W_t = h_2(L)(h_1(L)Y_t) = (h_2(L)h_1(L))Y_t = h(L)Y_t$, onde $h(L) = h_2(L)h_1(L)$. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Suponha que temos a sÃ©rie temporal $Y_t$ e aplicamos um filtro de mÃ©dia mÃ³vel de ordem 2 ($h_1(L) = (1+L)/2$) seguido por um filtro de diferenciaÃ§Ã£o ($h_2(L) = 1-L$). O filtro combinado seria $h(L) = h_2(L)h_1(L) = (1-L)(1+L)/2 = (1 - L^2)/2$. Aplicar este filtro combinado Ã© equivalente a calcular a diferenÃ§a entre o valor atual e o valor de dois perÃ­odos atrÃ¡s, e entÃ£o dividir por 2. Por exemplo, se $Y_t = [2, 4, 6, 8, 10]$, entÃ£o $X_t = h_1(L)Y_t = [2, 3, 5, 7, 9]$ e $W_t = h_2(L)X_t = [NÃ£o definido, 1, 2, 2, 2]$. Aplicando diretamente o filtro combinado, $W_t = [(2-6)/2, (4-8)/2, (6-10)/2] = [-2, -2, -2]$. Note que as bordas exigirÃ£o tratamento especial.

**ProposiÃ§Ã£o 3.** Se $Y_t$ Ã© um processo estacionÃ¡rio e $h(L)$ Ã© um filtro linear, entÃ£o $X_t = h(L) Y_t$ Ã© tambÃ©m um processo estacionÃ¡rio.

*Proof.* Para provar que $X_t$ Ã© estacionÃ¡rio, precisamos mostrar que sua mÃ©dia e autocovariÃ¢ncia sÃ£o independentes do tempo.

I. A mÃ©dia de $X_t$ Ã© $E[X_t] = E[h(L)Y_t] = h(L)E[Y_t] = h(L)\mu_Y$. Como $Y_t$ Ã© estacionÃ¡rio, $\mu_Y$ Ã© constante e independente do tempo. Se os coeficientes de $h(L)$ sÃ£o constantes, entÃ£o $h(L)\mu_Y$ tambÃ©m Ã© constante e independente do tempo.

II. A autocovariÃ¢ncia de $X_t$ Ã© $\gamma_{X}(j) = E[(X_t - \mu_X)(X_{t-j} - \mu_X)]$. Usando o resultado anterior, $\gamma_{X}(j) = h(L) h(L^{-1}) \gamma_Y(j)$. Como $Y_t$ Ã© estacionÃ¡rio, $\gamma_Y(j)$ depende apenas do lag *j* e nÃ£o do tempo *t*. Se o filtro $h(L)$ Ã© invariante no tempo, entÃ£o $h(L) h(L^{-1}) \gamma_Y(j)$ tambÃ©m depende apenas do lag *j* e nÃ£o do tempo *t*.

III. Portanto, tanto a mÃ©dia quanto a autocovariÃ¢ncia de $X_t$ sÃ£o independentes do tempo, o que implica que $X_t$ Ã© um processo estacionÃ¡rio. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere uma sÃ©rie temporal estacionÃ¡ria $Y_t$ com mÃ©dia $\mu_Y = 5$ e variÃ¢ncia $\sigma^2_Y = 2$. Aplicamos um filtro de mÃ©dia mÃ³vel simples de ordem 3: $h(L) = (1 + L + L^2)/3$. A mÃ©dia da sÃ©rie filtrada $X_t = h(L)Y_t$ serÃ¡ $E[X_t] = h(L)E[Y_t] = (1 + L + L^2)/3 * 5 = (5 + 5 + 5)/3 = 5$. A mÃ©dia permanece a mesma. Agora, se $Y_t$ fosse nÃ£o estacionÃ¡ria com uma tendÃªncia linear crescente, a mÃ©dia de $Y_t$ mudaria com o tempo, e a mÃ©dia de $X_t$ tambÃ©m seria dependente do tempo, mesmo apÃ³s a aplicaÃ§Ã£o do filtro.

**ProposiÃ§Ã£o 3.1.** O espectro de potÃªncia da sÃ©rie filtrada, $S_X(\omega)$, Ã© dado por $S_X(\omega) = |h(e^{-i\omega})|^2 S_Y(\omega)$.

*Proof.* Sabemos que $g_X(z) = h(z) h(z^{-1}) g_Y(z)$. Para obter o espectro de potÃªncia, substituÃ­mos $z = e^{-i\omega}$:

$$S_X(\omega) = \frac{1}{2\pi} g_X(e^{-i\omega}) = \frac{1}{2\pi} h(e^{-i\omega}) h(e^{i\omega}) g_Y(e^{-i\omega})$$

Como $h(e^{i\omega})$ Ã© o conjugado complexo de $h(e^{-i\omega})$, temos $h(e^{-i\omega}) h(e^{i\omega}) = |h(e^{-i\omega})|^2$. Portanto:

$$S_X(\omega) = |h(e^{-i\omega})|^2 \frac{1}{2\pi} g_Y(e^{-i\omega}) = |h(e^{-i\omega})|^2 S_Y(\omega)$$

Isto demonstra que o espectro de potÃªncia da sÃ©rie filtrada Ã© o produto do espectro de potÃªncia da sÃ©rie original e o mÃ³dulo ao quadrado da funÃ§Ã£o de transferÃªncia do filtro avaliada na frequÃªncia $\omega$. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere uma sÃ©rie temporal com espectro de potÃªncia constante $S_Y(\omega) = 1$ (ruÃ­do branco). Aplicamos um filtro com funÃ§Ã£o de transferÃªncia $h(L) = 0.5 + 0.5L$. EntÃ£o, $h(e^{-i\omega}) = 0.5 + 0.5e^{-i\omega} = 0.5 + 0.5(\cos(\omega) - i\sin(\omega))$. Portanto, $|h(e^{-i\omega})|^2 = (0.5 + 0.5\cos(\omega))^2 + (0.5\sin(\omega))^2 = 0.25 + 0.5\cos(\omega) + 0.25\cos^2(\omega) + 0.25\sin^2(\omega) = 0.5 + 0.5\cos(\omega) = \cos^2(\omega/2)$. O espectro de potÃªncia da sÃ©rie filtrada Ã© $S_X(\omega) = \cos^2(\omega/2)$. Este filtro atenua as altas frequÃªncias e amplifica as baixas frequÃªncias.

**CorolÃ¡rio 3.1.1.** Se $h(L)$ Ã© um filtro com coeficientes reais, entÃ£o $S_X(\omega)$ Ã© uma funÃ§Ã£o par de $\omega$.

*Proof.* Se $h(L)$ tem coeficientes reais, entÃ£o $h(e^{i\omega}) = \overline{h(e^{-i\omega})}$. Portanto, $|h(e^{i\omega})|^2 = |h(e^{-i\omega})|^2$, o que implica que $|h(e^{-i\omega})|^2$ Ã© uma funÃ§Ã£o par de $\omega$. Como $S_Y(\omega)$ tambÃ©m Ã© uma funÃ§Ã£o par para processos estacionÃ¡rios, $S_X(\omega) = |h(e^{-i\omega})|^2 S_Y(\omega)$ Ã© o produto de duas funÃ§Ãµes pares, e, portanto, Ã© uma funÃ§Ã£o par de $\omega$. $\blacksquare$

**Exemplos de Filtros Comuns:**

1.  **Filtro de DiferenciaÃ§Ã£o:** Este filtro calcula a diferenÃ§a entre observaÃ§Ãµes consecutivas e Ã© usado para remover tendÃªncias de longo prazo em uma sÃ©rie temporal. A funÃ§Ã£o de transferÃªncia Ã© $h(L) = 1 - L$ [^63]. Este filtro atua como um filtro passa-altas, atenuando as frequÃªncias baixas (tendÃªncias) e realÃ§ando as frequÃªncias altas (flutuaÃ§Ãµes de curto prazo).

**ProposiÃ§Ã£o 3.2.** A ACGF do filtro de diferenciaÃ§Ã£o $h(L) = 1-L$ Ã© $g_h(z) = 2 - z - z^{-1}$.

*Proof.* A ACGF do filtro Ã© dada por $g_h(z) = h(z)h(z^{-1}) = (1-z)(1-z^{-1}) = 1 - z - z^{-1} + zz^{-1} = 2 - z - z^{-1}$. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Seja $Y_t = [1, 2, 3, 4, 5]$. Aplicando o filtro de diferenciaÃ§Ã£o $h(L) = 1-L$, obtemos $X_t = [2-1, 3-2, 4-3, 5-4] = [1, 1, 1, 1]$. Se $Y_t = [1, 3, 6, 10, 15]$, entÃ£o $X_t = [2, 3, 4, 5]$, mostrando a remoÃ§Ã£o da tendÃªncia linear. A ACGF de $h(L) = 1-L$ Ã© $g_h(z) = (1-z)(1-z^{-1}) = 2-z-z^{-1}$.  A autocovariÃ¢ncia no lag 0 Ã© 2, e a autocovariÃ¢ncia no lag 1 Ã© -1.

2.  **Filtro de MÃ©dia MÃ³vel:** Este filtro calcula a mÃ©dia de um nÃºmero fixo de observaÃ§Ãµes passadas e Ã© usado para suavizar uma sÃ©rie temporal, removendo ruÃ­dos e flutuaÃ§Ãµes de curto prazo. Para um filtro de mÃ©dia mÃ³vel de ordem *m*, a funÃ§Ã£o de transferÃªncia Ã© $h(L) = \frac{1}{m} \sum_{i=0}^{m-1} L^i$. Este filtro atua como um filtro passa-baixas, atenuando as frequÃªncias altas (ruÃ­do) e realÃ§ando as frequÃªncias baixas (tendÃªncias).

**ProposiÃ§Ã£o 4.** A funÃ§Ã£o de transferÃªncia de um filtro de mÃ©dia mÃ³vel de ordem *m* pode ser expressa como $h(z) = \frac{1}{m} \frac{1 - z^m}{1 - z}$.

*Proof.* A funÃ§Ã£o de transferÃªncia do filtro de mÃ©dia mÃ³vel de ordem *m* Ã© $h(L) = \frac{1}{m} \sum_{i=0}^{m-1} L^i$. Substituindo $L$ por $z$, temos $h(z) = \frac{1}{m} \sum_{i=0}^{m-1} z^i$. Esta Ã© uma sÃ©rie geomÃ©trica finita com primeiro termo 1 e razÃ£o *z*. Usando a fÃ³rmula para a soma de uma sÃ©rie geomÃ©trica, $\sum_{i=0}^{m-1} z^i = \frac{1 - z^m}{1 - z}$. Portanto, $h(z) = \frac{1}{m} \frac{1 - z^m}{1 - z}$. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere um filtro de mÃ©dia mÃ³vel de ordem 3, $h(L) = (1 + L + L^2)/3$. Se a sÃ©rie temporal Ã© $Y_t = [1, 2, 3, 4, 5, 6]$, a sÃ©rie filtrada Ã© $X_t = [(1+2+3)/3, (2+3+4)/3, (3+4+5)/3, (4+5+6)/3] = [2, 3, 4, 5]$. A funÃ§Ã£o de transferÃªncia Ã© $h(z) = (1 + z + z^2)/3 = (1/3) * (1 - z^3)/(1 - z)$. Para $z=0.5$, $h(0.5) = (1 + 0.5 + 0.25)/3 = 0.5833$.

**ProposiÃ§Ã£o 4.1.**  O filtro de mÃ©dia mÃ³vel de ordem *m* tem resposta em frequÃªncia dada por $H(\omega) = \frac{1}{m} \frac{\sin(m\omega/2)}{\sin(\omega/2)}e^{-i(m-1)\omega/2}$.

*Proof.* Substituindo $z = e^{-i\omega}$ na expressÃ£o de $h(z)$ da ProposiÃ§Ã£o 4:

$$
H(\omega) = h(e^{-i\omega}) = \frac{1}{m} \frac{1 - e^{-im\omega}}{1 - e^{-i\omega}} = \frac{1}{m} \frac{e^{-im\omega/2}(e^{im\omega/2} - e^{-im\omega/2})}{e^{-i\omega/2}(e^{i\omega/2} - e^{-i\omega/2})}
$$
Usando a identidade de Euler $e^{ix} - e^{-ix} = 2i\sin(x)$:
$$
H(\omega) = \frac{1}{m} \frac{e^{-im\omega/2} 2i\sin(m\omega/2)}{e^{-i\omega/2} 2i\sin(\omega/2)} = \frac{1}{m} \frac{\sin(m\omega/2)}{\sin(\omega/2)} e^{-i(m-1)\omega/2}
$$
Portanto, o mÃ³dulo da resposta em frequÃªncia Ã© dado por $|H(\omega)| = \frac{1}{m} \left| \frac{\sin(m\omega/2)}{\sin(\omega/2)} \right|$ e a fase Ã© dada por $\phi(\omega) = -(m-1)\omega/2$. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Para um filtro de mÃ©dia mÃ³vel de ordem 5 ($m=5$), a resposta em frequÃªncia Ã© $H(\omega) = \frac{1}{5} \frac{\sin(5\omega/2)}{\sin(\omega/2)}e^{-i4\omega/2}$. O mÃ³dulo da resposta em frequÃªncia Ã© $|H(\omega)| = \frac{1}{5} \left| \frac{\sin(5\omega/2)}{\sin(\omega/2)} \right|$. Para $\omega = \pi/4$, $|H(\pi/4)| = \frac{1}{5} \left| \frac{\sin(5\pi/8)}{\sin(\pi/8)} \right| \approx 0.309$.

3.  **Filtro Sazonal:** Este filtro remove componentes sazonais de uma sÃ©rie temporal. Por exemplo, para remover uma sazonalidade anual, podemos usar o filtro $h(L) = 1 - L^{12}$.

> ğŸ’¡ **Exemplo NumÃ©rico:** Aplicando um filtro de diferenciaÃ§Ã£o (h(L) = 1 - L) Ã  sÃ©rie temporal do processo MA(1) $Y_t = \mu + \epsilon_t + \theta \epsilon_{t-1}$, a sÃ©rie resultante seria $X_t = (1-L)Y_t = Y_t - Y_{t-1} = (\epsilon_t + \theta \epsilon_{t-1}) - (\epsilon_{t-1} + \theta \epsilon_{t-2}) = \epsilon_t + (\theta - 1) \epsilon_{t-1} - \theta \epsilon_{t-2}$. A ACGF da sÃ©rie filtrada seria $g_X(z) = (1-z)(1-z^{-1}) g_Y(z) = (1-z)(1-z^{-1}) \sigma^2(1+\theta z)(1+\theta z^{-1})$. Isto ilustra como o filtro transforma as propriedades de autocovariÃ¢ncia da sÃ©rie original.

#### Exemplo Detalhado: Filtro de DiferenciaÃ§Ã£o Aplicado a um AR(1)

Considere um modelo AR(1) dado por $Y_t = \phi Y_{t-1} + \epsilon_t$, onde $|\phi| < 1$ e $\epsilon_t$ Ã© um ruÃ­do branco com variÃ¢ncia $\sigma^2$. Sua ACGF Ã© $g_Y(z) = \frac{\sigma^2}{(1 - \phi z)(1 - \phi z^{-1})}$. Aplicamos o filtro de diferenciaÃ§Ã£o $h(L) = 1 - L$. EntÃ£o, $h(z) = 1 - z$ e $h(z^{-1}) = 1 - z^{-1}$. A ACGF da sÃ©rie filtrada $X_t = (1-L)Y_t$ Ã©:

$$
g_X(z) = (1 - z)(1 - z^{-1}) \frac{\sigma^2}{(1 - \phi z)(1 - \phi z^{-1})}
$$

Simplificando:

$$
g_X(z) = \sigma^2 \frac{(1 - z)(1 - z^{-1})}{(1 - \phi z)(1 - \phi z^{-1})}
$$

Para analisar o efeito do filtro, podemos expandir a ACGF e calcular as autocovariÃ¢ncias resultantes. No entanto, a forma da ACGF jÃ¡ revela que o filtro de diferenciaÃ§Ã£o modifica a estrutura de dependÃªncia temporal do processo AR(1). Em particular, introduz um zero em $z = 1$, correspondendo Ã  remoÃ§Ã£o da tendÃªncia de longo prazo.

*Proof.* Vamos demonstrar como o filtro de diferenciaÃ§Ã£o modifica a estrutura de autocovariÃ¢ncia. Seja $X_t = (1-L)Y_t = Y_t - Y_{t-1}$. Suponha que $Y_t$ segue um modelo AR(1): $Y_t = \phi Y_{t-1} + \epsilon_t$. EntÃ£o, $X_t = Y_t - Y_{t-1} = (\phi Y_{t-1} + \epsilon_t) - (\phi Y_{t-2} + \epsilon_{t-1}) = \phi(Y_{t-1} - Y_{t-2}) + \epsilon_t - \epsilon_{t-1} = \phi X_{t-1} + \epsilon_t - \epsilon_{t-1}$.

I. Calculando a autocovariÃ¢ncia no lag 0:
$ \gamma_X(0) = E[X_t^2] = E[(\phi X_{t-1} + \epsilon_t - \epsilon_{t-1})^2] = \phi^2 E[X_{t-1}^2] + E[\epsilon_t^2] + E[\epsilon_{t-1}^2] + 2\phi E[X_{t-1}\epsilon_t] - 2\phi E[X_{t-1}\epsilon_{t-1}] - 2E[\epsilon_t \epsilon_{t-1}] = \phi^2 \gamma_X(0) + \sigma^2 + \sigma^2 - 2\phi \sigma^2 = \phi^2 \gamma_X(0) + 2\sigma^2(1-\phi)$.

II. Resolvendo para $\gamma_X(0)$:
$\gamma_X(0) = 2\sigma^2 \frac{1-\phi}{1-\phi^2} = 2\sigma^2 \frac{1}{1+\phi}$.

III. Calculando a autocovariÃ¢ncia no lag 1:
$\gamma_X(1) = E[X_t X_{t-1}] = E[(\phi X_{t-1} + \epsilon_t - \epsilon_{t-1})X_{t-1}] = \phi E[X_{t-1}^2] + E[\epsilon_t X_{t-1}] - E[\epsilon_{t-1} X_{t-1}] = \phi \gamma_X(0) - E[\epsilon_{t-1}(\phi Y_{t-2} + \epsilon_{t-1} - \epsilon_{t-2})] = \phi \gamma_X(0) - \sigma^2$.

IV. Substituindo $\gamma_X(0)$:
$\gamma_X(1) = \phi \left( 2\sigma^2 \frac{1}{1+\phi} \right) - \sigma^2 = \sigma^2 \left( \frac{2\phi}{1+\phi} - 1 \right) = \sigma^2 \frac{\phi-1}{1+\phi}$.

V. Para lags maiores que 1, $\gamma_X(j) = \phi \gamma_X(j-1)$ para $j>1$. Portanto, a estrutura de autocovariÃ¢ncia Ã© alterada, e o filtro de diferenciaÃ§Ã£o remove a dependÃªncia de longo prazo. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Seja $\phi = 0.5$ e $\sigma^2 = 1$. EntÃ£o $g_Y(z) = \frac{1}{(1 - 0.5z)(1 - 0.5z^{-1})}$. Aplicando o filtro de diferenciaÃ§Ã£o, $g_X(z) = (1 - z)(1 - z^{-1}) \frac{1}{(1 - 0.5z)(1 - 0.5z^{-1})}$. A autocovariÃ¢ncia no lag 0 para $X_t$ Ã© $\gamma_X(0) = 2\sigma^2 / (1+\phi) = 2 / 1.5 = 1.333$. A autocovariÃ¢ncia no lag 1 para $X_t$ Ã© $\gamma_X(1) = \sigma^2 (\phi - 1)/(1+\phi) = (0.5-1)/1.5 = -0.333$. Isso mostra uma mudanÃ§a na estrutura de autocovariÃ¢ncia em comparaÃ§Ã£o com o processo AR(1) original.

#### InterpretaÃ§Ã£o no DomÃ­nio da FrequÃªncia

Para uma anÃ¡lise mais completa, podemos examinar o efeito do filtro no domÃ­nio da frequÃªncia. A funÃ§Ã£o de transferÃªncia do filtro de diferenciaÃ§Ã£o Ã© $h(L) = 1 - L$, entÃ£o $h(e^{-i\omega}) = 1 - e^{-i\omega} = 1 - (\cos(\omega) - i\sin(\omega)) = (1 - \cos(\omega)) + i\sin(\omega)$. Portanto,

$$
|h(e^{-i\omega})|^2 = (1 - \cos(\omega))^2 + \sin^2(\omega) = 1 - 2\cos(\omega) + \cos^2(\omega) + \sin^2(\omega) = 2 - 2\cos(\omega) = 4\sin^2(\omega/2)
$$

O espectro de potÃªncia da sÃ©rie filtrada Ã©:

$$
S_X(\omega) = |h(e^{-i\omega})|^2 S_Y(\omega) = 4\sin^2(\omega/2) S_Y(\omega)
$$

Isso mostra que o filtro de diferenciaÃ§Ã£o atenua as baixas frequÃªncias (prÃ³ximas de $\omega = 0$) e amplifica as altas frequÃªncias.

> ğŸ’¡ **Exemplo NumÃ©rico:** Se o espectro de potÃªncia da sÃ©rie original for $S_Y(\omega) = 1$, entÃ£o o espectro da sÃ©rie diferenciada serÃ¡ $S_X(\omega) = 4\sin^2(\omega/2)$. Para $\omega = 0$, $S_X(0) = 0$. Para $\omega = \pi/2$, $S_X(\pi/2) = 4\sin^2(\pi/4) = 2$. Para $\omega = \pi$, $S_X(\pi) = 4\sin^2(\pi/2) = 4$. Isso mostra que o filtro de diferenciaÃ§Ã£o suprime a frequÃªncia zero (componente DC) e amplifica as altas frequÃªncias.

### ConclusÃ£o

A utilizaÃ§Ã£o da funÃ§Ã£o geradora de autocovariÃ¢ncia (ACGF) oferece um mÃ©todo elegante e eficiente para analisar o impacto de filtros lineares em sÃ©ries temporais [^61, ^64]. A relaÃ§Ã£o $g_X(z) = h(z) h(z^{-1}) g_Y(z)$ permite determinar facilmente a estrutura de autocovariÃ¢ncia da sÃ©rie filtrada em termos da ACGF da sÃ©rie original e da funÃ§Ã£o de transferÃªncia do filtro [^63]. Este mÃ©todo facilita a compreensÃ£o das propriedades de sinal e ruÃ­do em sÃ©ries temporais e auxilia na escolha e design de filtros apropriados. A anÃ¡lise no domÃ­nio da frequÃªncia complementa a anÃ¡lise da ACGF, fornecendo insights sobre como o filtro modifica o conteÃºdo de frequÃªncia da sÃ©rie temporal.
### ReferÃªncias
[^48]: PÃ¡gina 48, CapÃ­tulo 3, "Stationary ARMA Processes"
[^50]: PÃ¡gina 50, CapÃ­tulo 3, "Stationary ARMA Processes"
[^51]: PÃ¡gina 51, CapÃ­tulo 3, "Stationary ARMA Processes"
[^61]: PÃ¡gina 61, CapÃ­tulo 3, "Stationary ARMA Processes"
[^62]: PÃ¡gina 62, CapÃ­tulo 3, "Stationary ARMA Processes"
[^63]: PÃ¡gina 63, CapÃ­tulo 3, "Stationary ARMA Processes"
[^64]: PÃ¡gina 64, CapÃ­tulo 3, "Stationary ARMA Processes"
<!-- END -->