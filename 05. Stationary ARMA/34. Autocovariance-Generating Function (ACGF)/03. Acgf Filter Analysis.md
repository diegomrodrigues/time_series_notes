## T√≠tulo Conciso
An√°lise de Filtros via ACGF

### Introdu√ß√£o

Construindo sobre a discuss√£o anterior da fun√ß√£o geradora de autocovari√¢ncia (ACGF) para processos MA(q) [^48, ^50, ^61, ^62], este cap√≠tulo se concentra no uso da ACGF para analisar o efeito de filtros aplicados a s√©ries temporais. Filtros s√£o opera√ß√µes que modificam uma s√©rie temporal, frequentemente para remover ru√≠do ou real√ßar caracter√≠sticas espec√≠ficas [^63]. A ACGF oferece uma maneira eficiente de determinar como um filtro altera a estrutura de autocovari√¢ncia da s√©rie temporal original. Conforme detalhado nos cap√≠tulos anteriores, a ACGF fornece uma representa√ß√£o concisa da estrutura de autocovari√¢ncia de uma s√©rie temporal.

### Conceitos Fundamentais

Um filtro linear pode ser representado por um operador $h(L)$, onde $L$ √© o operador de retardo [^51]. Quando aplicado a uma s√©rie temporal $Y_t$, o filtro produz uma nova s√©rie $X_t$ dada por [^64]:

$$
X_t = h(L)Y_t
$$

onde $h(L)$ √© uma fun√ß√£o dos operadores de retardo. A fun√ß√£o $h(L)$ √© frequentemente referida como a **fun√ß√£o de transfer√™ncia** do filtro. A fun√ß√£o de transfer√™ncia descreve como diferentes frequ√™ncias na s√©rie temporal original s√£o amplificadas ou atenuadas pelo filtro.

> üí° **Exemplo Num√©rico:** Considere um filtro de m√©dias m√≥veis simples de ordem 2, onde cada valor na s√©rie filtrada √© a m√©dia dos dois valores anteriores da s√©rie original. A equa√ß√£o para este filtro √© $X_t = (Y_t + Y_{t-1})/2$. Em termos do operador de retardo, este filtro pode ser escrito como $X_t = (1 + L)/2 * Y_t$. A fun√ß√£o de transfer√™ncia para este filtro √© $h(L) = (1 + L)/2$.

A ACGF da s√©rie filtrada $X_t$ est√° relacionada √† ACGF da s√©rie original $Y_t$ e √† fun√ß√£o de transfer√™ncia do filtro [^64]:

$$
g_X(z) = h(z) h(z^{-1}) g_Y(z)
$$

onde $h(z)$ √© obtido substituindo o operador de retardo $L$ por $z$ na fun√ß√£o de transfer√™ncia $h(L)$, e $h(z^{-1})$ √© obtido substituindo $L$ por $z^{-1}$ [^64].

> üí° **Exemplo Num√©rico:** Suponha que temos uma s√©rie temporal $Y_t$ com ACGF $g_Y(z) = 1 + 0.5z + 0.5z^{-1}$ e aplicamos um filtro com fun√ß√£o de transfer√™ncia $h(L) = 1 - L$. Ent√£o, $h(z) = 1 - z$ e $h(z^{-1}) = 1 - z^{-1}$. A ACGF da s√©rie filtrada $X_t$ √© $g_X(z) = (1 - z)(1 - z^{-1})(1 + 0.5z + 0.5z^{-1})$.

*Proof.* Vamos derivar a express√£o da ACGF da s√©rie filtrada:

I. A s√©rie filtrada √© dada por $X_t = h(L)Y_t$.

II. Defina a autocovari√¢ncia da s√©rie filtrada como $\gamma_{X}(j) = E[(X_t - \mu_X)(X_{t-j} - \mu_X)]$, onde $\mu_X$ √© a m√©dia de $X_t$.

III. Substitu√≠mos a express√£o de $X_t$:
    $$ \gamma_{X}(j) = E[(h(L)Y_t - \mu_X)(h(L)Y_{t-j} - \mu_X)] $$

IV. Assumindo que o filtro √© linear e n√£o depende do tempo, podemos trocar a ordem da esperan√ßa e do operador de retardo:
     $$ \gamma_{X}(j) = h(L) h(L^{-1}) E[(Y_t - \mu_Y)(Y_{t-j} - \mu_Y)] $$

V. Reconhecendo que $E[(Y_t - \mu_Y)(Y_{t-j} - \mu_Y)]$ √© a autocovari√¢ncia da s√©rie original, $\gamma_Y(j)$:
    $$ \gamma_{X}(j) = h(L) h(L^{-1}) \gamma_Y(j) $$

VI. Tomando a transformada da ACGF de ambos os lados:
      $$ g_X(z) = \sum_{j=-\infty}^{\infty} \gamma_X(j) z^j = \sum_{j=-\infty}^{\infty} h(L) h(L^{-1}) \gamma_Y(j) z^j $$

VII. Como $h(L)$ e $h(L^{-1})$ s√£o operadores lineares que n√£o dependem de *j*, podemos tir√°-los da soma:
       $$ g_X(z) = h(z) h(z^{-1}) \sum_{j=-\infty}^{\infty}  \gamma_Y(j) z^j $$

VIII. Reconhecendo a defini√ß√£o da ACGF da s√©rie original:
        $$ g_X(z) = h(z) h(z^{-1}) g_Y(z) $$
Portanto, a ACGF da s√©rie filtrada √© o produto da fun√ß√£o de transfer√™ncia do filtro e sua inversa com a ACGF da s√©rie original. $\blacksquare$

Esta express√£o √© crucial porque permite analisar o efeito do filtro na estrutura de autocovari√¢ncia da s√©rie original simplesmente multiplicando as ACGFs.

**Lema 1.** Se $h(L)$ √© um filtro linear com coeficientes reais, ent√£o $h(z^{-1}) = \overline{h(\bar{z})}$, onde $\overline{h(\bar{z})}$ denota o conjugado complexo de $h(\bar{z})$.

*Proof.* Seja $h(L) = \sum_{k=-n}^{n} a_k L^k$, onde $a_k$ s√£o coeficientes reais. Ent√£o $h(z) = \sum_{k=-n}^{n} a_k z^k$ e $h(z^{-1}) = \sum_{k=-n}^{n} a_k z^{-k}$. Substituindo $z$ por $\bar{z}$, temos $h(\bar{z}) = \sum_{k=-n}^{n} a_k \bar{z}^k$. Tomando o conjugado complexo, $\overline{h(\bar{z})} = \sum_{k=-n}^{n} a_k \overline{\bar{z}^k} = \sum_{k=-n}^{n} a_k z^{-k} = h(z^{-1})$. $\blacksquare$

**Lema 1.1.** Se $h(L)$ √© um filtro sim√©trico com coeficientes reais, isto √© $a_k = a_{-k}$, ent√£o $h(z) = h(z^{-1})$ para $z \in \mathbb{R}$.

*Proof.* Seja $h(L) = \sum_{k=-n}^{n} a_k L^k$ com $a_k = a_{-k}$.  Ent√£o $h(z) = \sum_{k=-n}^{n} a_k z^k$ e $h(z^{-1}) = \sum_{k=-n}^{n} a_k z^{-k} = \sum_{k=-n}^{n} a_{-k} z^{-k}$.  Fazendo a substitui√ß√£o $j = -k$, obtemos $h(z^{-1}) = \sum_{j=n}^{-n} a_{j} z^{j} = \sum_{j=-n}^{n} a_{j} z^{j} = h(z)$. $\blacksquare$

**Proposi√ß√£o 2.** Se $h_1(L)$ e $h_2(L)$ s√£o dois filtros lineares, a aplica√ß√£o sequencial dos filtros $h_1(L)$ e $h_2(L)$ a uma s√©rie temporal $Y_t$ √© equivalente a aplicar um √∫nico filtro com fun√ß√£o de transfer√™ncia $h(L) = h_2(L)h_1(L)$.

*Proof.* Seja $X_t = h_1(L)Y_t$ e $W_t = h_2(L)X_t$. Ent√£o $W_t = h_2(L)(h_1(L)Y_t) = (h_2(L)h_1(L))Y_t = h(L)Y_t$, onde $h(L) = h_2(L)h_1(L)$. $\blacksquare$

> üí° **Exemplo Num√©rico:** Suponha que temos a s√©rie temporal $Y_t$ e aplicamos um filtro de m√©dia m√≥vel de ordem 2 ($h_1(L) = (1+L)/2$) seguido por um filtro de diferencia√ß√£o ($h_2(L) = 1-L$). O filtro combinado seria $h(L) = h_2(L)h_1(L) = (1-L)(1+L)/2 = (1 - L^2)/2$. Aplicar este filtro combinado √© equivalente a calcular a diferen√ßa entre o valor atual e o valor de dois per√≠odos atr√°s, e ent√£o dividir por 2. Por exemplo, se $Y_t = [2, 4, 6, 8, 10]$, ent√£o $X_t = h_1(L)Y_t = [2, 3, 5, 7, 9]$ e $W_t = h_2(L)X_t = [N√£o definido, 1, 2, 2, 2]$. Aplicando diretamente o filtro combinado, $W_t = [(2-6)/2, (4-8)/2, (6-10)/2] = [-2, -2, -2]$. Note que as bordas exigir√£o tratamento especial.

**Proposi√ß√£o 3.** Se $Y_t$ √© um processo estacion√°rio e $h(L)$ √© um filtro linear, ent√£o $X_t = h(L) Y_t$ √© tamb√©m um processo estacion√°rio.

*Proof.* Para provar que $X_t$ √© estacion√°rio, precisamos mostrar que sua m√©dia e autocovari√¢ncia s√£o independentes do tempo.

I. A m√©dia de $X_t$ √© $E[X_t] = E[h(L)Y_t] = h(L)E[Y_t] = h(L)\mu_Y$. Como $Y_t$ √© estacion√°rio, $\mu_Y$ √© constante e independente do tempo. Se os coeficientes de $h(L)$ s√£o constantes, ent√£o $h(L)\mu_Y$ tamb√©m √© constante e independente do tempo.

II. A autocovari√¢ncia de $X_t$ √© $\gamma_{X}(j) = E[(X_t - \mu_X)(X_{t-j} - \mu_X)]$. Usando o resultado anterior, $\gamma_{X}(j) = h(L) h(L^{-1}) \gamma_Y(j)$. Como $Y_t$ √© estacion√°rio, $\gamma_Y(j)$ depende apenas do lag *j* e n√£o do tempo *t*. Se o filtro $h(L)$ √© invariante no tempo, ent√£o $h(L) h(L^{-1}) \gamma_Y(j)$ tamb√©m depende apenas do lag *j* e n√£o do tempo *t*.

III. Portanto, tanto a m√©dia quanto a autocovari√¢ncia de $X_t$ s√£o independentes do tempo, o que implica que $X_t$ √© um processo estacion√°rio. $\blacksquare$

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal estacion√°ria $Y_t$ com m√©dia $\mu_Y = 5$ e vari√¢ncia $\sigma^2_Y = 2$. Aplicamos um filtro de m√©dia m√≥vel simples de ordem 3: $h(L) = (1 + L + L^2)/3$. A m√©dia da s√©rie filtrada $X_t = h(L)Y_t$ ser√° $E[X_t] = h(L)E[Y_t] = (1 + L + L^2)/3 * 5 = (5 + 5 + 5)/3 = 5$. A m√©dia permanece a mesma. Agora, se $Y_t$ fosse n√£o estacion√°ria com uma tend√™ncia linear crescente, a m√©dia de $Y_t$ mudaria com o tempo, e a m√©dia de $X_t$ tamb√©m seria dependente do tempo, mesmo ap√≥s a aplica√ß√£o do filtro.

**Proposi√ß√£o 3.1.** O espectro de pot√™ncia da s√©rie filtrada, $S_X(\omega)$, √© dado por $S_X(\omega) = |h(e^{-i\omega})|^2 S_Y(\omega)$.

*Proof.* Sabemos que $g_X(z) = h(z) h(z^{-1}) g_Y(z)$. Para obter o espectro de pot√™ncia, substitu√≠mos $z = e^{-i\omega}$:

$$S_X(\omega) = \frac{1}{2\pi} g_X(e^{-i\omega}) = \frac{1}{2\pi} h(e^{-i\omega}) h(e^{i\omega}) g_Y(e^{-i\omega})$$

Como $h(e^{i\omega})$ √© o conjugado complexo de $h(e^{-i\omega})$, temos $h(e^{-i\omega}) h(e^{i\omega}) = |h(e^{-i\omega})|^2$. Portanto:

$$S_X(\omega) = |h(e^{-i\omega})|^2 \frac{1}{2\pi} g_Y(e^{-i\omega}) = |h(e^{-i\omega})|^2 S_Y(\omega)$$

Isto demonstra que o espectro de pot√™ncia da s√©rie filtrada √© o produto do espectro de pot√™ncia da s√©rie original e o m√≥dulo ao quadrado da fun√ß√£o de transfer√™ncia do filtro avaliada na frequ√™ncia $\omega$. $\blacksquare$

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal com espectro de pot√™ncia constante $S_Y(\omega) = 1$ (ru√≠do branco). Aplicamos um filtro com fun√ß√£o de transfer√™ncia $h(L) = 0.5 + 0.5L$. Ent√£o, $h(e^{-i\omega}) = 0.5 + 0.5e^{-i\omega} = 0.5 + 0.5(\cos(\omega) - i\sin(\omega))$. Portanto, $|h(e^{-i\omega})|^2 = (0.5 + 0.5\cos(\omega))^2 + (0.5\sin(\omega))^2 = 0.25 + 0.5\cos(\omega) + 0.25\cos^2(\omega) + 0.25\sin^2(\omega) = 0.5 + 0.5\cos(\omega) = \cos^2(\omega/2)$. O espectro de pot√™ncia da s√©rie filtrada √© $S_X(\omega) = \cos^2(\omega/2)$. Este filtro atenua as altas frequ√™ncias e amplifica as baixas frequ√™ncias.

**Corol√°rio 3.1.1.** Se $h(L)$ √© um filtro com coeficientes reais, ent√£o $S_X(\omega)$ √© uma fun√ß√£o par de $\omega$.

*Proof.* Se $h(L)$ tem coeficientes reais, ent√£o $h(e^{i\omega}) = \overline{h(e^{-i\omega})}$. Portanto, $|h(e^{i\omega})|^2 = |h(e^{-i\omega})|^2$, o que implica que $|h(e^{-i\omega})|^2$ √© uma fun√ß√£o par de $\omega$. Como $S_Y(\omega)$ tamb√©m √© uma fun√ß√£o par para processos estacion√°rios, $S_X(\omega) = |h(e^{-i\omega})|^2 S_Y(\omega)$ √© o produto de duas fun√ß√µes pares, e, portanto, √© uma fun√ß√£o par de $\omega$. $\blacksquare$

**Exemplos de Filtros Comuns:**

1.  **Filtro de Diferencia√ß√£o:** Este filtro calcula a diferen√ßa entre observa√ß√µes consecutivas e √© usado para remover tend√™ncias de longo prazo em uma s√©rie temporal. A fun√ß√£o de transfer√™ncia √© $h(L) = 1 - L$ [^63]. Este filtro atua como um filtro passa-altas, atenuando as frequ√™ncias baixas (tend√™ncias) e real√ßando as frequ√™ncias altas (flutua√ß√µes de curto prazo).

**Proposi√ß√£o 3.2.** A ACGF do filtro de diferencia√ß√£o $h(L) = 1-L$ √© $g_h(z) = 2 - z - z^{-1}$.

*Proof.* A ACGF do filtro √© dada por $g_h(z) = h(z)h(z^{-1}) = (1-z)(1-z^{-1}) = 1 - z - z^{-1} + zz^{-1} = 2 - z - z^{-1}$. $\blacksquare$

> üí° **Exemplo Num√©rico:** Seja $Y_t = [1, 2, 3, 4, 5]$. Aplicando o filtro de diferencia√ß√£o $h(L) = 1-L$, obtemos $X_t = [2-1, 3-2, 4-3, 5-4] = [1, 1, 1, 1]$. Se $Y_t = [1, 3, 6, 10, 15]$, ent√£o $X_t = [2, 3, 4, 5]$, mostrando a remo√ß√£o da tend√™ncia linear. A ACGF de $h(L) = 1-L$ √© $g_h(z) = (1-z)(1-z^{-1}) = 2-z-z^{-1}$.  A autocovari√¢ncia no lag 0 √© 2, e a autocovari√¢ncia no lag 1 √© -1.

2.  **Filtro de M√©dia M√≥vel:** Este filtro calcula a m√©dia de um n√∫mero fixo de observa√ß√µes passadas e √© usado para suavizar uma s√©rie temporal, removendo ru√≠dos e flutua√ß√µes de curto prazo. Para um filtro de m√©dia m√≥vel de ordem *m*, a fun√ß√£o de transfer√™ncia √© $h(L) = \frac{1}{m} \sum_{i=0}^{m-1} L^i$. Este filtro atua como um filtro passa-baixas, atenuando as frequ√™ncias altas (ru√≠do) e real√ßando as frequ√™ncias baixas (tend√™ncias).

**Proposi√ß√£o 4.** A fun√ß√£o de transfer√™ncia de um filtro de m√©dia m√≥vel de ordem *m* pode ser expressa como $h(z) = \frac{1}{m} \frac{1 - z^m}{1 - z}$.

*Proof.* A fun√ß√£o de transfer√™ncia do filtro de m√©dia m√≥vel de ordem *m* √© $h(L) = \frac{1}{m} \sum_{i=0}^{m-1} L^i$. Substituindo $L$ por $z$, temos $h(z) = \frac{1}{m} \sum_{i=0}^{m-1} z^i$. Esta √© uma s√©rie geom√©trica finita com primeiro termo 1 e raz√£o *z*. Usando a f√≥rmula para a soma de uma s√©rie geom√©trica, $\sum_{i=0}^{m-1} z^i = \frac{1 - z^m}{1 - z}$. Portanto, $h(z) = \frac{1}{m} \frac{1 - z^m}{1 - z}$. $\blacksquare$

> üí° **Exemplo Num√©rico:** Considere um filtro de m√©dia m√≥vel de ordem 3, $h(L) = (1 + L + L^2)/3$. Se a s√©rie temporal √© $Y_t = [1, 2, 3, 4, 5, 6]$, a s√©rie filtrada √© $X_t = [(1+2+3)/3, (2+3+4)/3, (3+4+5)/3, (4+5+6)/3] = [2, 3, 4, 5]$. A fun√ß√£o de transfer√™ncia √© $h(z) = (1 + z + z^2)/3 = (1/3) * (1 - z^3)/(1 - z)$. Para $z=0.5$, $h(0.5) = (1 + 0.5 + 0.25)/3 = 0.5833$.

**Proposi√ß√£o 4.1.**  O filtro de m√©dia m√≥vel de ordem *m* tem resposta em frequ√™ncia dada por $H(\omega) = \frac{1}{m} \frac{\sin(m\omega/2)}{\sin(\omega/2)}e^{-i(m-1)\omega/2}$.

*Proof.* Substituindo $z = e^{-i\omega}$ na express√£o de $h(z)$ da Proposi√ß√£o 4:

$$
H(\omega) = h(e^{-i\omega}) = \frac{1}{m} \frac{1 - e^{-im\omega}}{1 - e^{-i\omega}} = \frac{1}{m} \frac{e^{-im\omega/2}(e^{im\omega/2} - e^{-im\omega/2})}{e^{-i\omega/2}(e^{i\omega/2} - e^{-i\omega/2})}
$$
Usando a identidade de Euler $e^{ix} - e^{-ix} = 2i\sin(x)$:
$$
H(\omega) = \frac{1}{m} \frac{e^{-im\omega/2} 2i\sin(m\omega/2)}{e^{-i\omega/2} 2i\sin(\omega/2)} = \frac{1}{m} \frac{\sin(m\omega/2)}{\sin(\omega/2)} e^{-i(m-1)\omega/2}
$$
Portanto, o m√≥dulo da resposta em frequ√™ncia √© dado por $|H(\omega)| = \frac{1}{m} \left| \frac{\sin(m\omega/2)}{\sin(\omega/2)} \right|$ e a fase √© dada por $\phi(\omega) = -(m-1)\omega/2$. $\blacksquare$

> üí° **Exemplo Num√©rico:** Para um filtro de m√©dia m√≥vel de ordem 5 ($m=5$), a resposta em frequ√™ncia √© $H(\omega) = \frac{1}{5} \frac{\sin(5\omega/2)}{\sin(\omega/2)}e^{-i4\omega/2}$. O m√≥dulo da resposta em frequ√™ncia √© $|H(\omega)| = \frac{1}{5} \left| \frac{\sin(5\omega/2)}{\sin(\omega/2)} \right|$. Para $\omega = \pi/4$, $|H(\pi/4)| = \frac{1}{5} \left| \frac{\sin(5\pi/8)}{\sin(\pi/8)} \right| \approx 0.309$.

3.  **Filtro Sazonal:** Este filtro remove componentes sazonais de uma s√©rie temporal. Por exemplo, para remover uma sazonalidade anual, podemos usar o filtro $h(L) = 1 - L^{12}$.

> üí° **Exemplo Num√©rico:** Aplicando um filtro de diferencia√ß√£o (h(L) = 1 - L) √† s√©rie temporal do processo MA(1) $Y_t = \mu + \epsilon_t + \theta \epsilon_{t-1}$, a s√©rie resultante seria $X_t = (1-L)Y_t = Y_t - Y_{t-1} = (\epsilon_t + \theta \epsilon_{t-1}) - (\epsilon_{t-1} + \theta \epsilon_{t-2}) = \epsilon_t + (\theta - 1) \epsilon_{t-1} - \theta \epsilon_{t-2}$. A ACGF da s√©rie filtrada seria $g_X(z) = (1-z)(1-z^{-1}) g_Y(z) = (1-z)(1-z^{-1}) \sigma^2(1+\theta z)(1+\theta z^{-1})$. Isto ilustra como o filtro transforma as propriedades de autocovari√¢ncia da s√©rie original.

#### Exemplo Detalhado: Filtro de Diferencia√ß√£o Aplicado a um AR(1)

Considere um modelo AR(1) dado por $Y_t = \phi Y_{t-1} + \epsilon_t$, onde $|\phi| < 1$ e $\epsilon_t$ √© um ru√≠do branco com vari√¢ncia $\sigma^2$. Sua ACGF √© $g_Y(z) = \frac{\sigma^2}{(1 - \phi z)(1 - \phi z^{-1})}$. Aplicamos o filtro de diferencia√ß√£o $h(L) = 1 - L$. Ent√£o, $h(z) = 1 - z$ e $h(z^{-1}) = 1 - z^{-1}$. A ACGF da s√©rie filtrada $X_t = (1-L)Y_t$ √©:

$$
g_X(z) = (1 - z)(1 - z^{-1}) \frac{\sigma^2}{(1 - \phi z)(1 - \phi z^{-1})}
$$

Simplificando:

$$
g_X(z) = \sigma^2 \frac{(1 - z)(1 - z^{-1})}{(1 - \phi z)(1 - \phi z^{-1})}
$$

Para analisar o efeito do filtro, podemos expandir a ACGF e calcular as autocovari√¢ncias resultantes. No entanto, a forma da ACGF j√° revela que o filtro de diferencia√ß√£o modifica a estrutura de depend√™ncia temporal do processo AR(1). Em particular, introduz um zero em $z = 1$, correspondendo √† remo√ß√£o da tend√™ncia de longo prazo.

*Proof.* Vamos demonstrar como o filtro de diferencia√ß√£o modifica a estrutura de autocovari√¢ncia. Seja $X_t = (1-L)Y_t = Y_t - Y_{t-1}$. Suponha que $Y_t$ segue um modelo AR(1): $Y_t = \phi Y_{t-1} + \epsilon_t$. Ent√£o, $X_t = Y_t - Y_{t-1} = (\phi Y_{t-1} + \epsilon_t) - (\phi Y_{t-2} + \epsilon_{t-1}) = \phi(Y_{t-1} - Y_{t-2}) + \epsilon_t - \epsilon_{t-1} = \phi X_{t-1} + \epsilon_t - \epsilon_{t-1}$.

I. Calculando a autocovari√¢ncia no lag 0:
$ \gamma_X(0) = E[X_t^2] = E[(\phi X_{t-1} + \epsilon_t - \epsilon_{t-1})^2] = \phi^2 E[X_{t-1}^2] + E[\epsilon_t^2] + E[\epsilon_{t-1}^2] + 2\phi E[X_{t-1}\epsilon_t] - 2\phi E[X_{t-1}\epsilon_{t-1}] - 2E[\epsilon_t \epsilon_{t-1}] = \phi^2 \gamma_X(0) + \sigma^2 + \sigma^2 - 2\phi \sigma^2 = \phi^2 \gamma_X(0) + 2\sigma^2(1-\phi)$.

II. Resolvendo para $\gamma_X(0)$:
$\gamma_X(0) = 2\sigma^2 \frac{1-\phi}{1-\phi^2} = 2\sigma^2 \frac{1}{1+\phi}$.

III. Calculando a autocovari√¢ncia no lag 1:
$\gamma_X(1) = E[X_t X_{t-1}] = E[(\phi X_{t-1} + \epsilon_t - \epsilon_{t-1})X_{t-1}] = \phi E[X_{t-1}^2] + E[\epsilon_t X_{t-1}] - E[\epsilon_{t-1} X_{t-1}] = \phi \gamma_X(0) - E[\epsilon_{t-1}(\phi Y_{t-2} + \epsilon_{t-1} - \epsilon_{t-2})] = \phi \gamma_X(0) - \sigma^2$.

IV. Substituindo $\gamma_X(0)$:
$\gamma_X(1) = \phi \left( 2\sigma^2 \frac{1}{1+\phi} \right) - \sigma^2 = \sigma^2 \left( \frac{2\phi}{1+\phi} - 1 \right) = \sigma^2 \frac{\phi-1}{1+\phi}$.

V. Para lags maiores que 1, $\gamma_X(j) = \phi \gamma_X(j-1)$ para $j>1$. Portanto, a estrutura de autocovari√¢ncia √© alterada, e o filtro de diferencia√ß√£o remove a depend√™ncia de longo prazo. $\blacksquare$

> üí° **Exemplo Num√©rico:** Seja $\phi = 0.5$ e $\sigma^2 = 1$. Ent√£o $g_Y(z) = \frac{1}{(1 - 0.5z)(1 - 0.5z^{-1})}$. Aplicando o filtro de diferencia√ß√£o, $g_X(z) = (1 - z)(1 - z^{-1}) \frac{1}{(1 - 0.5z)(1 - 0.5z^{-1})}$. A autocovari√¢ncia no lag 0 para $X_t$ √© $\gamma_X(0) = 2\sigma^2 / (1+\phi) = 2 / 1.5 = 1.333$. A autocovari√¢ncia no lag 1 para $X_t$ √© $\gamma_X(1) = \sigma^2 (\phi - 1)/(1+\phi) = (0.5-1)/1.5 = -0.333$. Isso mostra uma mudan√ßa na estrutura de autocovari√¢ncia em compara√ß√£o com o processo AR(1) original.

#### Interpreta√ß√£o no Dom√≠nio da Frequ√™ncia

Para uma an√°lise mais completa, podemos examinar o efeito do filtro no dom√≠nio da frequ√™ncia. A fun√ß√£o de transfer√™ncia do filtro de diferencia√ß√£o √© $h(L) = 1 - L$, ent√£o $h(e^{-i\omega}) = 1 - e^{-i\omega} = 1 - (\cos(\omega) - i\sin(\omega)) = (1 - \cos(\omega)) + i\sin(\omega)$. Portanto,

$$
|h(e^{-i\omega})|^2 = (1 - \cos(\omega))^2 + \sin^2(\omega) = 1 - 2\cos(\omega) + \cos^2(\omega) + \sin^2(\omega) = 2 - 2\cos(\omega) = 4\sin^2(\omega/2)
$$

O espectro de pot√™ncia da s√©rie filtrada √©:

$$
S_X(\omega) = |h(e^{-i\omega})|^2 S_Y(\omega) = 4\sin^2(\omega/2) S_Y(\omega)
$$

Isso mostra que o filtro de diferencia√ß√£o atenua as baixas frequ√™ncias (pr√≥ximas de $\omega = 0$) e amplifica as altas frequ√™ncias.

> üí° **Exemplo Num√©rico:** Se o espectro de pot√™ncia da s√©rie original for $S_Y(\omega) = 1$, ent√£o o espectro da s√©rie diferenciada ser√° $S_X(\omega) = 4\sin^2(\omega/2)$. Para $\omega = 0$, $S_X(0) = 0$. Para $\omega = \pi/2$, $S_X(\pi/2) = 4\sin^2(\pi/4) = 2$. Para $\omega = \pi$, $S_X(\pi) = 4\sin^2(\pi/2) = 4$. Isso mostra que o filtro de diferencia√ß√£o suprime a frequ√™ncia zero (componente DC) e amplifica as altas frequ√™ncias.

### Conclus√£o

A utiliza√ß√£o da fun√ß√£o geradora de autocovari√¢ncia (ACGF) oferece um m√©todo elegante e eficiente para analisar o impacto de filtros lineares em s√©ries temporais [^61, ^64]. A rela√ß√£o $g_X(z) = h(z) h(z^{-1}) g_Y(z)$ permite determinar facilmente a estrutura de autocovari√¢ncia da s√©rie filtrada em termos da ACGF da s√©rie original e da fun√ß√£o de transfer√™ncia do filtro [^63]. Este m√©todo facilita a compreens√£o das propriedades de sinal e ru√≠do em s√©ries temporais e auxilia na escolha e design de filtros apropriados. A an√°lise no dom√≠nio da frequ√™ncia complementa a an√°lise da ACGF, fornecendo insights sobre como o filtro modifica o conte√∫do de frequ√™ncia da s√©rie temporal.
### Refer√™ncias
[^48]: P√°gina 48, Cap√≠tulo 3, "Stationary ARMA Processes"
[^50]: P√°gina 50, Cap√≠tulo 3, "Stationary ARMA Processes"
[^51]: P√°gina 51, Cap√≠tulo 3, "Stationary ARMA Processes"
[^61]: P√°gina 61, Cap√≠tulo 3, "Stationary ARMA Processes"
[^62]: P√°gina 62, Cap√≠tulo 3, "Stationary ARMA Processes"
[^63]: P√°gina 63, Cap√≠tulo 3, "Stationary ARMA Processes"
[^64]: P√°gina 64, Cap√≠tulo 3, "Stationary ARMA Processes"
<!-- END -->