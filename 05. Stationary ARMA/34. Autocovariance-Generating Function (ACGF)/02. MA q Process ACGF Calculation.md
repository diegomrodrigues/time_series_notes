## T√≠tulo Conciso
ACGF para Processos MA(q)

### Introdu√ß√£o

Em continuidade √† discuss√£o sobre a fun√ß√£o geradora de autocovari√¢ncia (ACGF) [^61, ^62] e suas propriedades fundamentais, este cap√≠tulo foca na aplica√ß√£o espec√≠fica da ACGF a processos de M√©dias M√≥veis de ordem *q*, denotados como MA(q) [^48]. Exploraremos como a ACGF simplifica a an√°lise da estrutura de autocovari√¢ncia nesses modelos e facilita a compara√ß√£o entre diferentes especifica√ß√µes de MA(q). Como vimos anteriormente, a ACGF √© uma ferramenta poderosa para resumir a estrutura de depend√™ncia temporal de uma s√©rie temporal.

### Conceitos Fundamentais

Um processo MA(q) √© definido como [^50]:

$$
Y_t = \mu + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \ldots + \theta_q \epsilon_{t-q}
$$

onde $\mu$ √© a m√©dia do processo, $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$ [^47], e $\theta_1, \theta_2, \ldots, \theta_q$ s√£o os par√¢metros do modelo. A ACGF para um processo MA(q) √© dada por [^62]:

$$
g_Y(z) = \sigma^2 (1 + \sum_{i=1}^{q} \theta_i z^i) (1 + \sum_{i=1}^{q} \theta_i z^{-i})
$$

Esta express√£o √© um resultado direto da defini√ß√£o da ACGF e da estrutura do modelo MA(q) [^61, ^62].

> üí° **Exemplo Num√©rico:**  Considere um processo MA(1) com $\theta_1 = 0.7$ e $\sigma^2 = 2$. A ACGF √© dada por $g_Y(z) = 2(1 + 0.7z)(1 + 0.7z^{-1})$. Expandindo, obtemos $g_Y(z) = 2(1 + 0.7z + 0.7z^{-1} + 0.49)$. Isto nos permite identificar as autocovari√¢ncias: $\gamma_0 = 2(1 + 0.49) = 2.98$ e $\gamma_1 = 2(0.7) = 1.4$.

Para entender melhor o significado da ACGF para o processo MA(q), podemos expandir a express√£o acima. Seja $\Theta(z) = 1 + \sum_{i=1}^{q} \theta_i z^i$ e $\Theta(z^{-1}) = 1 + \sum_{i=1}^{q} \theta_i z^{-i}$, ent√£o $g_Y(z) = \sigma^2 \Theta(z) \Theta(z^{-1})$. Expandindo o produto, obtemos:

$$
g_Y(z) = \sigma^2 \left[ 1 + \sum_{j=1}^{q} \theta_j (z^j + z^{-j}) + \sum_{j=1}^{q} \sum_{k=1}^{q} \theta_j \theta_k z^{j-k} \right]
$$

Esta forma expandida revela a rela√ß√£o entre os par√¢metros $\theta_i$ e as autocovari√¢ncias do processo.  Comparando com a defini√ß√£o geral da ACGF, $g_Y(z) = \sum_{j=-\infty}^{\infty} \gamma_j z^j$, podemos identificar as autocovari√¢ncias $\gamma_j$ como os coeficientes de $z^j$ na expans√£o.

*Proof.* Vamos demonstrar como derivar as autocovari√¢ncias a partir da ACGF para o modelo MA(q):

I. Come√ßamos com a defini√ß√£o da ACGF:
$$ g_Y(z) = \sigma^2 \left(1 + \sum_{i=1}^{q} \theta_i z^i\right) \left(1 + \sum_{i=1}^{q} \theta_i z^{-i}\right) $$

II. Expandimos a express√£o:
$$ g_Y(z) = \sigma^2 \left( 1 + \sum_{i=1}^{q} \theta_i z^i + \sum_{i=1}^{q} \theta_i z^{-i} + \left( \sum_{i=1}^{q} \theta_i z^i \right) \left( \sum_{i=1}^{q} \theta_i z^{-i} \right) \right) $$

III. Expandimos o produto dos somat√≥rios:
$$ g_Y(z) = \sigma^2 \left( 1 + \sum_{i=1}^{q} \theta_i z^i + \sum_{i=1}^{q} \theta_i z^{-i} + \sum_{j=1}^{q} \sum_{k=1}^{q} \theta_j \theta_k z^{j-k} \right) $$

IV. Reorganizamos para agrupar os termos com $z^j$:
$$ g_Y(z) = \sigma^2 \left( 1 + \sum_{j=1}^{q} \theta_j (z^j + z^{-j}) + \sum_{j=1}^{q} \sum_{k=1}^{q} \theta_j \theta_k z^{j-k} \right) $$

V. Observamos que o termo $\sum_{j=1}^{q} \sum_{k=1}^{q} \theta_j \theta_k z^{j-k}$ contribui para as autocovari√¢ncias em diferentes lags. Em particular:

*   Para o lag 0: $\gamma_0 = \sigma^2 \left( 1 + \sum_{i=1}^{q} \theta_i^2 \right)$
*   Para o lag j (com $1 \leq j \leq q$): $\gamma_j = \sigma^2 \left( \theta_j + \sum_{i=j}^{q} \theta_i \theta_{i-j} \right)$
*   Para o lag j (com $j > q$): $\gamma_j = 0$

VI. Esta deriva√ß√£o demonstra como a ACGF encapsula as informa√ß√µes sobre as autocovari√¢ncias do processo MA(q) em termos dos par√¢metros $\theta_i$ e $\sigma^2$. $\blacksquare$

**C√°lculo das Autocovari√¢ncias:**

A partir da ACGF, podemos calcular as autocovari√¢ncias $\gamma_j$ do processo MA(q).  Para $j=0$, temos:

$$
\gamma_0 = \sigma^2 \left( 1 + \sum_{i=1}^{q} \theta_i^2 \right)
$$

Para $1 \leq j \leq q$, temos:

$$
\gamma_j = \sigma^2 \left( \theta_j + \sum_{i=j+1}^{q} \theta_i \theta_{i-j} \right)
$$

Para $j > q$, temos:

$$
\gamma_j = 0
$$

Este resultado reflete a propriedade fundamental dos processos MA(q): a autocovari√¢ncia √© zero para lags maiores que *q* [^48].

> üí° **Exemplo Num√©rico:**  Considere um processo MA(2) com $\theta_1 = 0.6$, $\theta_2 = 0.4$ e $\sigma^2 = 1$.  As autocovari√¢ncias s√£o calculadas como:
>
> *   $\gamma_0 = \sigma^2(1 + \theta_1^2 + \theta_2^2) = 1(1 + 0.6^2 + 0.4^2) = 1.52$
> *   $\gamma_1 = \sigma^2(\theta_1 + \theta_2 \theta_0) = 1(0.6 + 0.4 \cdot 0) = 0.6$  (Note that $\theta_0$ does not exist, so this term is 0). Actually it should be $\theta_1 + \theta_2 * 0$, since for MA(2), the term should stop with $\theta_2$.
> *   $\gamma_2 = \sigma^2(\theta_2) = 1(0.4) = 0.4$
> *   $\gamma_j = 0$ para $|j| > 2$
>
> Podemos usar estas autocovari√¢ncias para avaliar a depend√™ncia temporal da s√©rie. No lag 0, a vari√¢ncia √© 1.52, enquanto nos lags 1 e 2, temos autocovari√¢ncias de 0.6 e 0.4, respectivamente. A aus√™ncia de autocovari√¢ncia para lags maiores que 2 confirma a natureza MA(2) do processo.

**Proposi√ß√£o 2.** O espectro de pot√™ncia de um processo MA(q) √© limitado e cont√≠nuo.

*Proof.* O espectro de pot√™ncia √© dado por $S_Y(\omega) = \frac{1}{2\pi} g_Y(e^{-i\omega})$. Substituindo a express√£o da ACGF para um processo MA(q), obtemos:

$$S_Y(\omega) = \frac{\sigma^2}{2\pi} \left| 1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i} \right|^2$$

I. Cada termo $e^{-i\omega i}$ tem magnitude 1, pois $|e^{-i\omega i}| = \sqrt{\cos^2(\omega i) + \sin^2(\omega i)} = 1$.

II. A soma $\sum_{i=1}^{q} \theta_i e^{-i\omega i}$ √© finita, pois a soma √© de 1 a *q*.

III. Portanto, $\left| 1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i} \right|$ √© limitado.

IV. J√° que $\sigma^2$ √© uma constante e a express√£o dentro do m√≥dulo √© limitada, $S_Y(\omega)$ √© limitado.

V. A continuidade de $S_Y(\omega)$ segue da continuidade da fun√ß√£o exponencial complexa $e^{-i\omega i}$ e da finitude da soma. $\blacksquare$

**Proposi√ß√£o 2.1.** O espectro de pot√™ncia de um processo MA(q) √© sempre n√£o-negativo.

*Proof.* O espectro de pot√™ncia √© dado por $S_Y(\omega) = \frac{\sigma^2}{2\pi} \left| 1 + \sum_{i=1}^{q} \theta_i e^{-i\omega i} \right|^2$. Como o m√≥dulo ao quadrado de qualquer n√∫mero complexo √© sempre n√£o-negativo, e $\sigma^2$ tamb√©m √© n√£o-negativo (sendo uma vari√¢ncia), o espectro de pot√™ncia $S_Y(\omega)$ √© sempre maior ou igual a zero.

**Invertibilidade:**

Um processo MA(q) √© *invert√≠vel* se puder ser expresso como um processo autorregressivo de ordem infinita, AR($\infty$) [^65]. A invertibilidade √© importante para a estimativa e previs√£o de par√¢metros [^65, ^67]. Para um processo MA(q) ser invert√≠vel, as ra√≠zes do polin√¥mio $\Theta(z) = 1 + \sum_{i=1}^{q} \theta_i z^i$ devem estar fora do c√≠rculo unit√°rio [^65].  Isto significa que se $z_k$ for uma raiz de $\Theta(z)$, ent√£o $|z_k| > 1$ para todo *k*.

A ACGF pode ser utilizada para verificar a invertibilidade de um processo MA(q). Se a ACGF puder ser reescrita na forma $g_Y(z) = \sigma^2 \frac{\theta(z) \theta(z^{-1})}{\phi(z) \phi(z^{-1})}$ com $\phi(z)=1$, e as ra√≠zes de $\theta(z)$ est√£o fora do c√≠rculo unit√°rio, ent√£o o processo √© invert√≠vel [^62, ^65].

> üí° **Exemplo Num√©rico:** Para o processo MA(1) $Y_t = \mu + \epsilon_t + \theta \epsilon_{t-1}$, com $\theta = 0.8$, o polin√¥mio √© $\Theta(z) = 1 + 0.8 z$. A raiz √© $z = -1/0.8 = -1.25$. Como $|-1.25| > 1$, o processo √© invert√≠vel. Agora, se $\theta = 1.2$, a raiz √© $z = -1/1.2 = -0.833$. Como $|-0.833| < 1$, o processo n√£o √© invert√≠vel. Isso significa que, para $\theta = 0.8$, podemos encontrar uma representa√ß√£o AR($\infty$) convergente para o processo MA(1), enquanto para $\theta = 1.2$, tal representa√ß√£o n√£o existe.

Para complementar a an√°lise da invertibilidade, podemos derivar uma condi√ß√£o necess√°ria e suficiente expressa em termos das autocovari√¢ncias.

**Teorema 3.** Um processo MA(q) √© invert√≠vel se e somente se a sequ√™ncia de autocovari√¢ncias $\gamma_j$ satisfaz a seguinte condi√ß√£o: existe uma fun√ß√£o $A(z) = \sum_{j=0}^{\infty} a_j z^j$ tal que $\sum_{j=0}^{\infty} |a_j| < \infty$ e $\sigma^2 A(z) A(z^{-1}) = g_Y(z)^{-1}$.

*Proof.* (Estrat√©gia) A prova envolve mostrar que a condi√ß√£o sobre as ra√≠zes do polin√¥mio $\Theta(z)$ ser fora do c√≠rculo unit√°rio √© equivalente √† exist√™ncia de uma representa√ß√£o AR($\infty$) convergente, cuja ACGF inversa coincide com a especificada.

*Proof.* Mostraremos que se as ra√≠zes de $\Theta(z)$ est√£o fora do c√≠rculo unit√°rio, ent√£o o processo MA(q) √© invert√≠vel:

I. Seja $\Theta(z) = 1 + \sum_{i=1}^{q} \theta_i z^i$ o polin√¥mio do processo MA(q) e $z_1, z_2, \ldots, z_q$ suas ra√≠zes.

II. Se as ra√≠zes est√£o fora do c√≠rculo unit√°rio, ent√£o $|z_i| > 1$ para todo *i*.

III. Isso significa que podemos escrever o processo MA(q) como:
$ Y_t = \mu + (1 - z_1^{-1}L)(1 - z_2^{-1}L)\ldots(1 - z_q^{-1}L) \epsilon_t$ onde *L* √© o operador de defasagem.

IV. Como as ra√≠zes est√£o fora do c√≠rculo unit√°rio, temos $|z_i^{-1}| < 1$ para todo *i*. Isso significa que podemos expandir cada fator $(1 - z_i^{-1}L)^{-1}$ em uma s√©rie geom√©trica convergente.

V. Formalmente, $(1-z_i^{-1}L)^{-1} = \sum_{k=0}^{\infty} (z_i^{-1}L)^k$, que converge absolutamente pois $|z_i^{-1}| < 1$.

VI. Portanto, podemos escrever o processo MA(q) como uma soma infinita de termos passados de $\epsilon_t$, o que significa que o processo √© invert√≠vel. $\blacksquare$

**Lema 3.** Se um processo MA(q) √© invert√≠vel, ent√£o existe um processo AR($\infty$) que o representa.

*Proof.* A invertibilidade de um processo MA(q) implica que podemos express√°-lo como uma combina√ß√£o linear infinita de valores passados da s√©rie temporal. Seja $Y_t$ um processo MA(q) invert√≠vel. Ent√£o, existe uma representa√ß√£o AR($\infty$) da forma:

$$Y_t = \mu + \sum_{i=1}^{\infty} \phi_i Y_{t-i} + \epsilon_t$$

onde os $\phi_i$ s√£o os coeficientes do processo AR($\infty$). A demonstra√ß√£o formal envolve mostrar que os coeficientes $\phi_i$ podem ser obtidos a partir dos par√¢metros $\theta_i$ do processo MA(q) e que a s√©rie $\sum_{i=1}^{\infty} |\phi_i|$ converge, garantindo que a representa√ß√£o AR($\infty$) √© bem definida. Isso segue diretamente da condi√ß√£o de que as ra√≠zes do polin√¥mio $\Theta(z)$ est√£o fora do c√≠rculo unit√°rio.

**Lema 3.1.** Os coeficientes $\phi_i$ do processo AR($\infty$) podem ser obtidos pela expans√£o em s√©rie de pot√™ncias de $(1 + \sum_{i=1}^{q} \theta_i z^i)^{-1}$.

*Proof.* Dado que $Y_t = \mu + \epsilon_t + \sum_{i=1}^{q} \theta_i \epsilon_{t-i}$, podemos reescrever como $\epsilon_t = Y_t - \mu - \sum_{i=1}^{q} \theta_i \epsilon_{t-i}$. Se o processo √© invert√≠vel, ent√£o $\epsilon_t$ pode ser expresso como uma fun√ß√£o linear dos valores passados de $Y_t$, ou seja, $\epsilon_t = \sum_{i=0}^{\infty} a_i (Y_{t-i} - \mu)$, com $a_0 = 1$. Substituindo esta express√£o na equa√ß√£o original e reorganizando, obtemos uma express√£o para $Y_t$ em termos dos seus valores passados, que corresponde √† representa√ß√£o AR($\infty$). Os coeficientes $\phi_i$ s√£o ent√£o dados pelos coeficientes da expans√£o em s√©rie de pot√™ncias de $(1 + \sum_{i=1}^{q} \theta_i z^i)^{-1}$.

I. Seja $\Theta(z) = 1 + \sum_{i=1}^{q} \theta_i z^i$. Pela invertibilidade, as ra√≠zes de $\Theta(z)$ est√£o fora do c√≠rculo unit√°rio.

II. Queremos encontrar uma s√©rie $A(z) = \sum_{i=0}^{\infty} a_i z^i$ tal que $\Theta(z) A(z) = 1$. Isso significa que $A(z) = \Theta(z)^{-1}$.

III. A expans√£o em s√©rie de pot√™ncias de $\Theta(z)^{-1}$ fornece os coeficientes $a_i$, que correspondem aos coeficientes $\phi_i$ na representa√ß√£o AR($\infty$).

IV. Portanto, os coeficientes $\phi_i$ do processo AR($\infty$) s√£o obtidos pela expans√£o em s√©rie de pot√™ncias de $(1 + \sum_{i=1}^{q} \theta_i z^i)^{-1}$. $\blacksquare$

> üí° **Exemplo Num√©rico:** Consideremos novamente o processo MA(1) $Y_t = \mu + \epsilon_t + \theta \epsilon_{t-1}$ com $\theta = 0.5$. O polin√¥mio √© $\Theta(z) = 1 + 0.5z$. Para encontrar a representa√ß√£o AR($\infty$), precisamos expandir $(1 + 0.5z)^{-1}$ em uma s√©rie de pot√™ncias. Usando a s√©rie geom√©trica, temos $(1 + 0.5z)^{-1} = 1 - 0.5z + (0.5z)^2 - (0.5z)^3 + \ldots = \sum_{i=0}^{\infty} (-0.5)^i z^i$. Portanto, os coeficientes $\phi_i$ s√£o dados por $\phi_i = -(-0.5)^i$ para $i \geq 1$. A representa√ß√£o AR($\infty$) √© $Y_t = \mu - 0.5 Y_{t-1} + 0.25 Y_{t-2} - 0.125 Y_{t-3} + \ldots + \epsilon_t$. Note que os coeficientes $\phi_i$ decrescem em magnitude √† medida que *i* aumenta, o que garante a converg√™ncia da s√©rie.

### Conclus√£o

A fun√ß√£o geradora de autocovari√¢ncia (ACGF) fornece uma representa√ß√£o compacta e √∫til para analisar a estrutura de autocovari√¢ncia de processos MA(q) [^61]. Atrav√©s da ACGF, podemos calcular facilmente as autocovari√¢ncias, analisar o espectro de pot√™ncia e verificar a invertibilidade do modelo. Esta ferramenta √© essencial para a an√°lise e modelagem de s√©ries temporais utilizando processos de m√©dias m√≥veis [^48, ^50]. A facilidade de an√°lise proporcionada pela ACGF a torna indispens√°vel para a compreens√£o e aplica√ß√£o de modelos MA(q) em diversas √°reas.

### Refer√™ncias
[^47]: P√°gina 47, Cap√≠tulo 3, "Stationary ARMA Processes"
[^48]: P√°gina 48, Cap√≠tulo 3, "Stationary ARMA Processes"
[^50]: P√°gina 50, Cap√≠tulo 3, "Stationary ARMA Processes"
[^61]: P√°gina 61, Cap√≠tulo 3, "Stationary ARMA Processes"
[^62]: P√°gina 62, Cap√≠tulo 3, "Stationary ARMA Processes"
[^65]: P√°gina 65, Cap√≠tulo 3, "Stationary ARMA Processes"
[^67]: P√°gina 67, Cap√≠tulo 3, "Stationary ARMA Processes"
<!-- END -->