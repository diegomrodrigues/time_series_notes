## Desvio Padr√£o do Erro de Previs√£o e Intervalos de Confian√ßa em Processos N√£o Estacion√°rios

### Introdu√ß√£o
Nos cap√≠tulos anteriores, exploramos a proje√ß√£o linear e o Erro Quadr√°tico M√©dio (MSE) para processos estacion√°rios por tend√™ncia e processos de raiz unit√°ria, incluindo o modelo ARIMA(0,1,1) e o passeio aleat√≥rio com deriva [^1, ^2, ^3, ^4]. Agora, vamos analisar o comportamento do desvio padr√£o do erro de previs√£o e como ele impacta a constru√ß√£o de intervalos de confian√ßa, especialmente em processos de raiz unit√°ria. Esta an√°lise √© crucial para entender como a incerteza das previs√µes se propaga com o tempo e como podemos quantificar essa incerteza atrav√©s de intervalos de confian√ßa. Especificamente, examinaremos como o desvio padr√£o do erro de previs√£o cresce com o horizonte de previs√£o $s$ e como isso se compara com o crescimento linear da pr√≥pria previs√£o em processos com deriva positiva ($\delta > 0$).

### Desvio Padr√£o do Erro de Previs√£o
O desvio padr√£o do erro de previs√£o (RMSE, *Root Mean Squared Error*) √© definido como a raiz quadrada do MSE:
$$ RMSE = \sqrt{MSE} $$
Enquanto o MSE quantifica a incerteza de previs√£o em termos de vari√¢ncia, o RMSE fornece uma medida de incerteza na mesma unidade da s√©rie original. Em processos n√£o estacion√°rios, o RMSE geralmente aumenta com o horizonte de previs√£o ($s$), embora a taxa de aumento possa variar dependendo do modelo. Vamos analisar como o RMSE se comporta em processos de raiz unit√°ria e comparar com o comportamento em modelos estacion√°rios por tend√™ncia.

#### Processos Estacion√°rios por Tend√™ncia
Como visto no Lema 0.1 do cap√≠tulo anterior [^4], para um processo estacion√°rio por tend√™ncia, o MSE converge para um valor fixo quando $s \to \infty$. Consequentemente, o RMSE tamb√©m converge para um valor fixo:
$$ \lim_{s\to\infty} RMSE = \sqrt{\lim_{s\to\infty} MSE} $$
Este limite representa a raiz quadrada da vari√¢ncia incondicional do componente estoc√°stico. Ou seja, em processos estacion√°rios por tend√™ncia, a incerteza da previs√£o se estabiliza com o aumento do horizonte, e a precis√£o das previs√µes se mant√©m dentro de certos limites.

> üí° **Exemplo Num√©rico:**
> No exemplo num√©rico do cap√≠tulo anterior, t√≠nhamos um processo estacion√°rio por tend√™ncia com um componente estoc√°stico MA(1) com $\psi_1 = 0.7$ e $\sigma^2 = 1$, cujo MSE se aproximava de 1.49 quando $s$ tende ao infinito. Portanto, o RMSE, quando $s \to \infty$, ser√°:
>
> $$ \lim_{s\to\infty} RMSE = \sqrt{1.49} \approx 1.22 $$
>
> Isso significa que o desvio padr√£o do erro de previs√£o se aproxima de 1.22 para horizontes de previs√£o muito grandes.
>
> ```mermaid
> graph LR
>     A[s=0] --> B(s=1, RMSE=...)
>     B --> C(s=5, RMSE=...)
>     C --> D(s=10, RMSE=...)
>     D --> E(s=inf, RMSE=1.22)
>     style A fill:#f9f,stroke:#333,stroke-width:2px
> ```
> O gr√°fico ilustra que, √† medida que $s$ aumenta, o RMSE se aproxima de 1.22.

#### Processos de Raiz Unit√°ria
Em contraste, para um processo de raiz unit√°ria, como o MSE n√£o converge para um valor fixo, o RMSE tamb√©m n√£o converge e aumenta com o horizonte de previs√£o $s$. A taxa de aumento do RMSE √©, em geral, menor do que a taxa de aumento da previs√£o em si. Vamos analisar os casos de um modelo geral de raiz unit√°ria, do modelo ARIMA(0,1,1), e do passeio aleat√≥rio com deriva.

**Modelo Geral de Raiz Unit√°ria**
Para um modelo geral de raiz unit√°ria, sabemos que o MSE se aproxima assintoticamente de uma fun√ß√£o linear de $s$ [^4]. Portanto, o RMSE se aproxima assintoticamente de uma fun√ß√£o da raiz quadrada de $s$:
$$ \lim_{s \to \infty} RMSE \propto \sqrt{s} $$
Este resultado indica que, para processos de raiz unit√°ria, a incerteza da previs√£o aumenta com o horizonte de previs√£o, mas a uma taxa menor do que a pr√≥pria previs√£o, que cresce linearmente com $s$ devido ao componente determin√≠stico $\delta s$.
Como demonstrado no cap√≠tulo 15, o desvio padr√£o do erro de previs√£o cresce com a raiz quadrada de $s$, enquanto a previs√£o cresce linearmente com $s$ quando $\delta>0$.

**Proposi√ß√£o 1:** Para um processo de raiz unit√°ria com drift ($\delta > 0$), o desvio padr√£o do erro de previs√£o cresce com a raiz quadrada de $s$, enquanto a previs√£o cresce linearmente com $s$.
*Proof:*
I.  Do cap√≠tulo 15 [^1], sabemos que o MSE para um processo de raiz unit√°ria aumenta com o horizonte de previs√£o $s$, aproximando-se assintoticamente de uma fun√ß√£o linear de $s$. Portanto,  $MSE \approx as$, onde $a$ √© uma constante.
II.  O RMSE √© a raiz quadrada do MSE, ou seja, $RMSE = \sqrt{MSE}$. Portanto, $RMSE \approx \sqrt{as} = \sqrt{a}\sqrt{s}$.
III.  Isso implica que o RMSE cresce com a raiz quadrada de $s$.
IV.  Por outro lado, a proje√ß√£o linear para um processo de raiz unit√°ria com drift √© dada por $\hat{y}_{t+s|t} = s\delta + y_t + \ldots$, onde $y_t$ e os termos de erro tem influ√™ncia decrescente em rela√ß√£o a $s$.
V.  O termo dominante na proje√ß√£o linear √© $s\delta$, o que implica que a previs√£o cresce linearmente com $s$ quando $\delta>0$.
VI. Concluindo, o RMSE cresce com $\sqrt{s}$, enquanto a proje√ß√£o cresce com $s$.
‚ñ†
Este resultado formaliza a rela√ß√£o entre o crescimento do erro de previs√£o e o crescimento da pr√≥pria previs√£o em processos de raiz unit√°ria. O crescimento da incerteza, medido pelo RMSE, √© mais lento do que o crescimento da previs√£o, o que tem implica√ß√µes importantes para a constru√ß√£o de intervalos de confian√ßa, como veremos a seguir.

> üí° **Exemplo Num√©rico:**
> Suponha que temos um processo de raiz unit√°ria cujo MSE, para horizontes de previs√£o grandes, se aproxima de $MSE \approx 0.5s$. Nesse caso, o RMSE ser√° dado por:
>
> $$ RMSE = \sqrt{0.5s} \approx 0.71 \sqrt{s} $$
>
> Isso significa que, √† medida que $s$ aumenta, o RMSE cresce com a raiz quadrada de $s$. Se compararmos com um processo com $\delta = 1$, cuja proje√ß√£o linear √© dada por $\hat{y}_{t+s|t} = s + y_t + \ldots$, vemos que a previs√£o cresce linearmente com $s$, enquanto o RMSE cresce mais lentamente com $\sqrt{s}$.
>
> ```mermaid
> graph LR
>     A[s=0] --> B(s=1, RMSE=0.71)
>     B --> C(s=5, RMSE=1.58)
>     C --> D(s=10, RMSE=2.25)
>     D --> E(s=100, RMSE=7.1)
>     style A fill:#f9f,stroke:#333,stroke-width:2px
> ```
> O gr√°fico mostra o crescimento mais lento do RMSE em rela√ß√£o a $s$, comparado com o crescimento linear da proje√ß√£o.
>
> Vamos analisar alguns pontos espec√≠ficos:
> *   **Para s = 1:** $RMSE \approx 0.71 * \sqrt{1} = 0.71$. O desvio padr√£o do erro de previs√£o para um per√≠odo √† frente √© de aproximadamente 0.71.
> *   **Para s = 10:** $RMSE \approx 0.71 * \sqrt{10} \approx 2.25$. O desvio padr√£o do erro de previs√£o para dez per√≠odos √† frente √© de aproximadamente 2.25, mostrando o aumento da incerteza.
> *   **Para s = 100:** $RMSE \approx 0.71 * \sqrt{100} = 7.1$. Para cem per√≠odos √† frente, o desvio padr√£o do erro de previs√£o aumenta para 7.1, o que demonstra o comportamento da raiz quadrada.

**Modelo ARIMA(0,1,1)**
Para um modelo ARIMA(0,1,1), sabemos que o MSE √© dado por [^4]:
$$ MSE = (s + 2\theta^2)\sigma^2 $$
Portanto, o RMSE para o modelo ARIMA(0,1,1) √© dado por:
$$ RMSE = \sqrt{(s + 2\theta^2)\sigma^2} = \sigma \sqrt{s + 2\theta^2} $$
Este resultado mostra que, para um modelo ARIMA(0,1,1), o RMSE tamb√©m aumenta com o horizonte de previs√£o $s$, e, para valores grandes de $s$, se aproxima de um crescimento com a raiz quadrada de $s$:
$$ \lim_{s\to\infty} RMSE \propto \sqrt{s} $$
A presen√ßa do termo $2\theta^2$ adiciona uma constante ao crescimento linear, mas, para $s$ grande, o termo linear $s$ domina.

> üí° **Exemplo Num√©rico:**
> No exemplo num√©rico do cap√≠tulo anterior, t√≠nhamos um modelo ARIMA(0,1,1) com $\theta=0.7$ e $\sigma^2=0.5$, onde o MSE era dado por $MSE = (s + 0.98) \times 0.5$. Portanto, o RMSE √©:
>
> $$ RMSE = \sqrt{(s + 0.98) \times 0.5} $$
>
> Para diferentes valores de $s$, temos:
> *   **Para $s=1$:**
>    $RMSE = \sqrt{1.98 \times 0.5} = \sqrt{0.99} \approx 0.995$
> *   **Para $s=5$:**
>    $RMSE = \sqrt{5.98 \times 0.5} = \sqrt{2.99} \approx 1.73$
> *   **Para $s=10$:**
>    $RMSE = \sqrt{10.98 \times 0.5} = \sqrt{5.49} \approx 2.34$
> Observe como o RMSE cresce com a raiz quadrada de $s$.
>
> ```mermaid
>  graph LR
>      A[s=0] --> B(s=1, RMSE=0.995)
>      A --> C(s=5, RMSE=1.73)
>      A --> D(s=10, RMSE=2.34)
>      style A fill:#f9f,stroke:#333,stroke-width:2px
> ```
>
> Vamos detalhar:
> *   **Para s=1**: $RMSE \approx 0.995$.  O desvio padr√£o do erro de previs√£o para um passo √† frente √© de aproximadamente 0.995.
> *   **Para s=5**: $RMSE \approx 1.73$. O erro padr√£o da previs√£o aumenta para 1.73 ap√≥s 5 per√≠odos.
> *   **Para s=10**: $RMSE \approx 2.34$. A incerteza aumenta ainda mais para 2.34 ap√≥s 10 per√≠odos, evidenciando a rela√ß√£o da raiz quadrada com o aumento de s.

**Passeio Aleat√≥rio com Deriva**
Para um passeio aleat√≥rio com deriva, sabemos que o MSE √© dado por [^4]:
$$ MSE = s\sigma^2 $$
Portanto, o RMSE para o passeio aleat√≥rio com deriva √©:
$$ RMSE = \sqrt{s\sigma^2} = \sigma\sqrt{s} $$
Este resultado confirma que o RMSE cresce com a raiz quadrada de $s$ para o passeio aleat√≥rio com deriva, e essa taxa de crescimento √© mais lenta do que o crescimento linear da proje√ß√£o, que √© dada por $\hat{y}_{t+s|t} = s\delta + y_t$.

> üí° **Exemplo Num√©rico:**
> No exemplo num√©rico do cap√≠tulo anterior, t√≠nhamos um passeio aleat√≥rio com deriva com $\sigma^2 = 0.8$. O RMSE √© dado por:
> $$ RMSE = \sqrt{s \times 0.8} \approx 0.89 \sqrt{s} $$
> Para diferentes valores de $s$, temos:
> *  **Para $s=1$:**
>     $RMSE = \sqrt{1 \times 0.8} = \sqrt{0.8} \approx 0.89$
> *  **Para $s=5$:**
>     $RMSE = \sqrt{5 \times 0.8} = \sqrt{4} = 2$
> *   **Para $s=10$:**
>     $RMSE = \sqrt{10 \times 0.8} = \sqrt{8} \approx 2.83$
>Observe como o RMSE cresce com a raiz quadrada de $s$.
>
> ```mermaid
> graph LR
>     A[s=0] --> B(s=1, RMSE=0.89)
>     A --> C(s=5, RMSE=2)
>     A --> D(s=10, RMSE=2.83)
>     style A fill:#f9f,stroke:#333,stroke-width:2px
> ```
> Analisando em mais detalhe:
> *   **Para s=1:** $RMSE \approx 0.89$. A incerteza para um per√≠odo √† frente √© aproximadamente 0.89.
> *   **Para s=5:** $RMSE = 2$. Ap√≥s 5 per√≠odos, o desvio padr√£o do erro de previs√£o aumenta para 2.
> *  **Para s=10:** $RMSE \approx 2.83$. Para 10 per√≠odos, a incerteza da previs√£o √© de aproximadamente 2.83, comprovando o crescimento da raiz quadrada.

### Intervalos de Confian√ßa
Os intervalos de confian√ßa s√£o constru√≠dos para quantificar a incerteza em torno das previs√µes. Um intervalo de confian√ßa de $100(1-\alpha)\%$ para a previs√£o $\hat{y}_{t+s|t}$ √© dado por:
$$ \hat{y}_{t+s|t} \pm z_{\alpha/2} \times RMSE $$
onde $z_{\alpha/2}$ √© o valor cr√≠tico da distribui√ß√£o normal padr√£o correspondente ao n√≠vel de confian√ßa desejado. Por exemplo, para um intervalo de confian√ßa de 95%,  $z_{\alpha/2} \approx 1.96$.
Para processos de raiz unit√°ria, como o RMSE cresce com a raiz quadrada de $s$, os intervalos de confian√ßa tamb√©m se expandem com o horizonte de previs√£o, mas a uma taxa menor do que a pr√≥pria proje√ß√£o linear.

**Proposi√ß√£o 2:** Em processos de raiz unit√°ria com deriva positiva, os intervalos de confian√ßa se expandem mais lentamente do que a s√©rie em si.
*Proof:*
I.  A proje√ß√£o linear para um processo de raiz unit√°ria com deriva positiva √© $\hat{y}_{t+s|t} = s\delta + y_t + \ldots$, que cresce linearmente com o horizonte de previs√£o $s$.
II. O RMSE para um processo de raiz unit√°ria cresce com a raiz quadrada de $s$, como demonstrado na Proposi√ß√£o 1,  ou seja $RMSE \propto \sqrt{s}$.
III. Os intervalos de confian√ßa s√£o constru√≠dos adicionando e subtraindo do valor previsto um m√∫ltiplo do RMSE. Portanto, o tamanho do intervalo de confian√ßa cresce com $\sqrt{s}$.
IV.  Como $\sqrt{s}$ cresce mais lentamente do que $s$, os intervalos de confian√ßa se expandem mais lentamente do que a s√©rie em si, que cresce linearmente com $s$.
‚ñ†
Esta proposi√ß√£o formaliza a intui√ß√£o de que, embora a incerteza das previs√µes em processos de raiz unit√°ria aumente com o horizonte de previs√£o, ela n√£o aumenta t√£o rapidamente quanto o pr√≥prio n√≠vel da s√©rie. Isso significa que, para horizontes de previs√£o grandes, a trajet√≥ria da s√©rie √© determinada pela tend√™ncia determin√≠stica, enquanto a incerteza em torno dessa trajet√≥ria cresce a uma taxa mais lenta.

> üí° **Exemplo Num√©rico:**
> Vamos considerar o passeio aleat√≥rio com deriva com $\delta=0.1$ e $\sigma^2=0.8$. Vamos construir um intervalo de confian√ßa de 95% para $s=1, 5 e 10$ utilizando o RMSE.
>
> *   **Para $s=1$:**
>     *   Proje√ß√£o Linear: $\hat{y}_{t+1|t} = 1(0.1) + y_t = 0.1 + y_t$
>     *   RMSE: $RMSE = \sqrt{1 \times 0.8} = \sqrt{0.8} \approx 0.89$
>     *   Intervalo de confian√ßa 95%: $0.1 + y_t \pm 1.96 \times 0.89 = 0.1 + y_t \pm 1.75$. Ou seja, o intervalo de confian√ßa de 95% √© [y_t - 1.65, y_t + 1.85].
>
> *  **Para $s=5$:**
>     *   Proje√ß√£o Linear: $\hat{y}_{t+5|t} = 5(0.1) + y_t = 0.5 + y_t$
>     *   RMSE: $RMSE = \sqrt{5 \times 0.8} = \sqrt{4} = 2$
>     *   Intervalo de confian√ßa 95%: $0.5 + y_t \pm 1.96 \times 2 = 0.5 + y_t \pm 3.92$. Ou seja, o intervalo de confian√ßa de 95% √© [y_t - 3.42, y_t + 4.42].
>
> *  **Para $s=10$:**
>     *   Proje√ß√£o Linear: $\hat{y}_{t+10|t} = 10(0.1) + y_t = 1 + y_t$
>     *    RMSE: $RMSE = \sqrt{10 \times 0.8} = \sqrt{8} \approx 2.83$
>     *   Intervalo de confian√ßa 95%: $1 + y_t \pm 1.96 \times 2.83 = 1 + y_t \pm 5.55$. Ou seja, o intervalo de confian√ßa de 95% √© [y_t - 4.55, y_t + 6.55]
>
> Considere que $y_t = 100$. Observe que, enquanto a previs√£o cresce linearmente (100.1, 100.5 e 101), os intervalos de confian√ßa tamb√©m crescem, mas mais lentamente do que a previs√£o: [98.35, 101.85], [96.58, 104.42], [95.45, 106.55].
>
> ```mermaid
> graph LR
>     A[t] --> B(s=1, [98.35, 101.85])
>     A --> C(s=5, [96.58, 104.42])
>     A --> D(s=10, [95.45, 106.55])
>     style A fill:#f9f,stroke:#333,stroke-width:2px
> ```
>
> Esse exemplo demonstra que, embora a incerteza da previs√£o (medida pelo tamanho do intervalo de confian√ßa) aumente com o horizonte de previs√£o, ela aumenta a uma taxa menor do que a pr√≥pria previs√£o. Vamos analisar alguns pontos:
> *   **Para s=1:** A previs√£o √© 100.1 e o intervalo de confian√ßa √© [98.35, 101.85]. A amplitude do intervalo √© de 3.5.
> *   **Para s=5:** A previs√£o √© 100.5 e o intervalo de confian√ßa √© [96.58, 104.42]. A amplitude do intervalo cresce para 7.84.
> *   **Para s=10:** A previs√£o √© 101 e o intervalo de confian√ßa √© [95.45, 106.55]. A amplitude do intervalo aumenta ainda mais, mas n√£o na mesma propor√ß√£o que a proje√ß√£o.
>
>
> Isso ilustra que a incerteza aumenta com o horizonte, mas a taxa de crescimento √© mais lenta comparada √† progress√£o da previs√£o, que √© linearmente dependente de `s`.

**Observa√ß√£o 1:**  A expans√£o dos intervalos de confian√ßa com o horizonte de previs√£o reflete a crescente incerteza nas proje√ß√µes futuras em processos de raiz unit√°ria. √â importante destacar que, embora o RMSE cres√ßa com a raiz quadrada de $s$, a largura dos intervalos de confian√ßa √© determinada tamb√©m pelo n√≠vel de confian√ßa desejado, expresso pelo valor $z_{\alpha/2}$. Assim, a escolha do n√≠vel de confian√ßa afeta a amplitude do intervalo e, por consequ√™ncia, a interpreta√ß√£o da incerteza da previs√£o.

**Lema 1.1:** Em um processo de raiz unit√°ria, o incremento no tamanho do intervalo de confian√ßa entre dois horizontes de previs√£o $s_1$ e $s_2$ (com $s_2 > s_1$) diminui √† medida que $s_1$ aumenta.
*Proof:*
I. O tamanho do intervalo de confian√ßa para um horizonte $s$ √© dado por $2 * z_{\alpha/2} * RMSE(s)$.
II. Como  $RMSE(s) \propto \sqrt{s}$,  o tamanho do intervalo de confian√ßa √© proporcional a $\sqrt{s}$.
III. O incremento do tamanho do intervalo de confian√ßa entre $s_1$ e $s_2$ √© dado por  $2 * z_{\alpha/2} * (RMSE(s_2) - RMSE(s_1)) \propto  \sqrt{s_2} - \sqrt{s_1}$.
IV. Para analisar como o incremento varia com $s_1$, podemos calcular a derivada em rela√ß√£o a $s_1$: $\frac{d}{ds_1}(\sqrt{s_2} - \sqrt{s_1}) = -\frac{1}{2\sqrt{s_1}}$.
V. Como essa derivada √© negativa e decrescente em valor absoluto (pois $\sqrt{s_1}$ aumenta com $s_1$), o incremento no tamanho do intervalo diminui √† medida que $s_1$ aumenta.
‚ñ†
Este lema complementa a discuss√£o sobre a expans√£o dos intervalos de confian√ßa, mostrando que o aumento na incerteza, embora cont√≠nuo, torna-se cada vez menor conforme o horizonte de previs√£o aumenta, refletindo a domin√¢ncia da tend√™ncia determin√≠stica para grandes valores de $s$.

### Conclus√£o
Neste cap√≠tulo, exploramos o comportamento do desvio padr√£o do erro de previs√£o (RMSE) e sua rela√ß√£o com os intervalos de confian√ßa em processos n√£o estacion√°rios. Vimos que, enquanto o RMSE converge para um valor fixo em processos estacion√°rios por tend√™ncia, ele aumenta com a raiz quadrada do horizonte de previs√£o $s$ em processos de raiz unit√°ria, o que tem implica√ß√µes importantes para a constru√ß√£o de intervalos de confian√ßa. Especificamente, demonstramos que a incerteza das previs√µes em processos de raiz unit√°ria aumenta com o horizonte, mas a uma taxa mais lenta do que a pr√≥pria proje√ß√£o linear. Essa diferen√ßa entre as taxas de crescimento do RMSE e da proje√ß√£o √© crucial para entender a precis√£o das previs√µes em processos n√£o estacion√°rios e para a constru√ß√£o de intervalos de confian√ßa significativos. Os resultados aqui apresentados s√£o essenciais para a modelagem e previs√£o de s√©ries temporais n√£o estacion√°rias, e ajudam a interpretar a confian√ßa que podemos depositar nas proje√ß√µes futuras, dada a incerteza inerente a estes processos.

### Refer√™ncias
[^1]: Modelos de S√©ries Temporais N√£o Estacion√°rias: T√≥picos introdut√≥rios.
[^2]: Compara√ß√£o da Proje√ß√£o Linear em Processos Estacion√°rios por Tend√™ncia e Raiz Unit√°ria.
[^3]: Compara√ß√£o da Proje√ß√£o Linear em Processos Estacion√°rios por Tend√™ncia e Raiz Unit√°ria: An√°lise do Modelo ARIMA(0,1,1).
[^4]: An√°lise do Erro Quadr√°tico M√©dio (MSE) em Processos N√£o Estacion√°rios.
<!-- END -->
