## Compara√ß√£o da Proje√ß√£o Linear em Processos Estacion√°rios por Tend√™ncia e Raiz Unit√°ria: An√°lise do Modelo ARIMA(0,1,1)

### Introdu√ß√£o
Nos cap√≠tulos anteriores, exploramos as proje√ß√µes lineares para processos estacion√°rios por tend√™ncia e processos de raiz unit√°ria, enfatizando as diferen√ßas fundamentais entre eles e como cada um modela o comportamento de s√©ries temporais n√£o estacion√°rias [^1, ^2]. Agora, vamos aprofundar a an√°lise ao considerar um caso espec√≠fico de um processo de raiz unit√°ria: o modelo **Autoregressivo Integrado de M√©dia M√≥vel (ARIMA)** de ordem (0, 1, 1), ou seja, um processo ARIMA(0,1,1). Este modelo oferece uma vis√£o mais detalhada de como as inova√ß√µes afetam as previs√µes em processos com raiz unit√°ria, especialmente quando comparado a processos estacion√°rios por tend√™ncia.

### Proje√ß√£o Linear para um Modelo ARIMA(0,1,1)
Um modelo ARIMA(0,1,1) √© um caso particular de um processo de raiz unit√°ria, onde a primeira diferen√ßa da s√©rie temporal segue um processo de m√©dia m√≥vel de ordem 1 (MA(1)).  O modelo pode ser expresso como [15.1.3]:
$$(1 - L)y_t = \delta + (1+\theta L)\epsilon_t$$
onde $L$ √© o operador de defasagem, $\delta$ √© a deriva (ou seja, a m√©dia da primeira diferen√ßa), $\epsilon_t$ √© um ru√≠do branco e $\theta$ √© o par√¢metro da m√©dia m√≥vel. Este modelo implica que a primeira diferen√ßa da s√©rie √© um processo estacion√°rio MA(1). Ao expandir, obtemos:
$$ y_t - y_{t-1} = \delta + \epsilon_t + \theta \epsilon_{t-1} $$

A proje√ß√£o linear para o modelo ARIMA(0,1,1) √© dada por [15.3.5]:
$$ \hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t $$
Essa equa√ß√£o [15.3.5] mostra que a melhor previs√£o para $y_{t+s}$ √© composta por tr√™s componentes principais:
1. **Tend√™ncia Linear:** O termo $s\delta$ representa a tend√™ncia linear, que cresce a uma taxa constante $\delta$ a cada per√≠odo de previs√£o $s$. Isso √© semelhante a um passeio aleat√≥rio com deriva, mas aqui a tend√™ncia est√° impl√≠cita na modelagem da diferen√ßa.
2. **N√≠vel Atual:** O termo $y_t$ representa o n√≠vel atual da s√©rie, o ponto de partida para a previs√£o.
3. **Efeito do Choque Atual:** O termo $\theta \epsilon_t$ representa o efeito da inova√ß√£o (choque) atual $\epsilon_t$, ponderado pelo par√¢metro $\theta$ da m√©dia m√≥vel.

Comparando com a proje√ß√£o linear para um processo de raiz unit√°ria mais geral,  $$ \hat{y}_{t+s|t} = s\delta + y_t + (\psi_1 + \psi_2 + \ldots + \psi_s)\epsilon_t + (\psi_2 + \ldots + \psi_{s+1})\epsilon_{t-1} + \ldots$$, vemos que no modelo ARIMA(0,1,1) apenas a inova√ß√£o atual ($\epsilon_t$) tem um impacto direto na previs√£o e esse efeito √© ponderado por $\theta$. As inova√ß√µes passadas n√£o influenciam diretamente a previs√£o (al√©m do n√≠vel atual $y_t$). Ou seja, no ARIMA(0,1,1) temos $\psi_1 = \theta$ e $\psi_i = 0$ para $i > 1$.

**Proposi√ß√£o 1** A proje√ß√£o linear para o modelo ARIMA(0,1,1) pode ser reescrita utilizando o operador de defasagem $L$ como:
$$ \hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t $$
*Proof:*
I.  O modelo ARIMA(0,1,1) √© definido como $(1-L)y_t = \delta + (1 + \theta L)\epsilon_t$.
II. A proje√ß√£o linear, conforme [15.3.5], √© dada por $\hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t$.
III. Comparando com a proje√ß√£o linear geral de um processo com raiz unit√°ria, $\hat{y}_{t+s|t} = s\delta + y_t + (\psi_1 + \psi_2 + \ldots + \psi_s)\epsilon_t + (\psi_2 + \ldots + \psi_{s+1})\epsilon_{t-1} + \ldots$, vemos que, para o ARIMA(0,1,1), $\psi_1 = \theta$ e $\psi_i=0$ para $i>1$.
IV. Substituindo esses valores na equa√ß√£o geral, temos $\hat{y}_{t+s|t} = s\delta + y_t + \theta\epsilon_t$, que √© a proje√ß√£o linear do modelo ARIMA(0,1,1).
‚ñ†
Essa proposi√ß√£o confirma que, para o modelo ARIMA(0,1,1), apenas o choque atual √© relevante para a previs√£o, al√©m da tend√™ncia determin√≠stica e do n√≠vel atual da s√©rie, tornando a forma [15.3.5] equivalente √† forma com operador de defasagem quando aplicado a esse modelo espec√≠fico.

**Lema 1.1** A vari√¢ncia do erro de previs√£o para o modelo ARIMA(0,1,1) n√£o depende do horizonte de previs√£o $s$.
*Proof:*
I. O erro de previs√£o para o modelo ARIMA(0,1,1) √© dado por $e_{t+s|t} = y_{t+s} - \hat{y}_{t+s|t}$.
II. Substituindo as express√µes para $y_{t+s}$ e $\hat{y}_{t+s|t}$, temos que $e_{t+s|t} = (y_{t+s}-y_t-s\delta -\theta \epsilon_t)$.
III. Do modelo ARIMA(0,1,1) temos que $\Delta y_t = \delta + \epsilon_t + \theta\epsilon_{t-1}$, ou seja, $y_{t+s} = y_t + s\delta + \sum_{i=1}^{s}\epsilon_{t+i} + \theta\epsilon_{t+i-1} $.
IV. Substituindo esse resultado no erro de previs√£o temos $e_{t+s|t} = \sum_{i=1}^{s}\epsilon_{t+i} + \theta\epsilon_{t+s-1}-\theta \epsilon_t$.
V. Calculando a vari√¢ncia do erro,  $\mathbb{V}[e_{t+s|t}] = \mathbb{V}[\sum_{i=1}^{s}\epsilon_{t+i} + \theta\epsilon_{t+s-1}-\theta \epsilon_t]$. Como $\epsilon_t$ √© um ru√≠do branco com vari√¢ncia $\sigma^2$, e s√£o independentes entre si, temos $\mathbb{V}[e_{t+s|t}] = \sum_{i=1}^{s}\sigma^2 + \theta^2\sigma^2 + \theta^2\sigma^2 = s\sigma^2 + 2\theta^2\sigma^2$.
VI.  A vari√¢ncia do erro de previs√£o depende apenas de $s$ e dos par√¢metros do modelo, e n√£o do horizonte de previs√£o, sendo expressa como $(s+2\theta^2)\sigma^2$, que aumenta linearmente com $s$. Note que a vari√¢ncia √© sempre maior que $s\sigma^2$ devido ao termo $2\theta^2\sigma^2$, indicando que a vari√¢ncia do erro de previs√£o √© maior do que para um passeio aleat√≥rio com deriva.
‚ñ†

> üí° **Exemplo Num√©rico:**
> Vamos considerar um modelo ARIMA(0,1,1) com $\delta = 0.1$, $\theta = 0.6$ e $\sigma^2 = 1$. Suponha que o valor atual da s√©rie seja $y_t = 100$ e a inova√ß√£o atual seja $\epsilon_t = 3$.
>
> *   **Para $s=1$ (um per√≠odo √† frente):**
>     $\hat{y}_{t+1|t} = 1(0.1) + 100 + 0.6(3) = 0.1 + 100 + 1.8 = 101.9$
>
> *   **Para $s=5$ (cinco per√≠odos √† frente):**
>      $\hat{y}_{t+5|t} = 5(0.1) + 100 + 0.6(3) = 0.5 + 100 + 1.8 = 102.3$
>
> *   **Para $s=10$ (dez per√≠odos √† frente):**
>     $\hat{y}_{t+10|t} = 10(0.1) + 100 + 0.6(3) = 1 + 100 + 1.8 = 102.8$
>
> Observe que a previs√£o cresce linearmente a uma taxa constante de 0.1 por per√≠odo, partindo do valor inicial $y_t=100$. O impacto da inova√ß√£o $\epsilon_t = 3$ (ponderado por $\theta = 0.6$) √© constante para todos os horizontes de previs√£o, adicionando 1.8 ao valor base ($100+s\delta$). Vamos calcular a vari√¢ncia do erro de previs√£o para $s=1$ e $s=5$:
>
> *   Para $s=1$: $\mathbb{V}[e_{t+1|t}] = (1 + 2(0.6)^2)\times 1 = 1 + 2(0.36) = 1.72$
> *   Para $s=5$: $\mathbb{V}[e_{t+5|t}] = (5 + 2(0.6)^2)\times 1 = 5 + 2(0.36) = 5.72$
>
> Como previsto pelo Lema 1.1, a vari√¢ncia do erro de previs√£o cresce linearmente com $s$.
>
> ```mermaid
>  graph LR
>      A[y_t = 100] --> B(s=1, 101.1)
>      A --> C(s=5, 100.5)
>      A --> D(s=10, 101)
>       style A fill:#f9f,stroke:#333,stroke-width:2px
>
>      B --> E(Prev. s=1, 101.9)
>      C --> F(Prev. s=5, 102.3)
>      D --> G(Prev. s=10, 102.8)
>
>       style E fill:#ccf,stroke:#333,stroke-width:2px
>       style F fill:#ccf,stroke:#333,stroke-width:2px
>       style G fill:#ccf,stroke:#333,stroke-width:2px
> ```
>
> Este exemplo mostra como o modelo ARIMA(0,1,1) combina a deriva linear e o efeito do choque atual para gerar as previs√µes futuras.  O efeito do choque atual, embora persistente, n√£o se acumula nos per√≠odos seguintes como em um passeio aleat√≥rio.

### Compara√ß√£o com o Passeio Aleat√≥rio com Deriva
O modelo ARIMA(0,1,1) pode ser visto como uma extens√£o do modelo de passeio aleat√≥rio com deriva. No passeio aleat√≥rio com deriva puro, temos:
$$ y_t = y_{t-1} + \delta + \epsilon_t $$
E a sua proje√ß√£o linear √© dada por:
$$ \hat{y}_{t+s|t} = s\delta + y_t $$
A principal diferen√ßa entre o passeio aleat√≥rio com deriva e o ARIMA(0,1,1) est√° na presen√ßa do termo $\theta\epsilon_t$. No passeio aleat√≥rio com deriva, as inova√ß√µes n√£o afetam a previs√£o para al√©m do n√≠vel atual da s√©rie, enquanto no ARIMA(0,1,1) um choque atual afeta a previs√£o linear para todos os per√≠odos futuros atrav√©s do termo $\theta\epsilon_t$.  Isso significa que a previs√£o do modelo ARIMA(0,1,1) incorpora explicitamente um efeito persistente, mas n√£o cumulativo da inova√ß√£o atual, diferentemente do modelo de passeio aleat√≥rio com deriva, que n√£o considera esse efeito persistente.

**Lema 1** O passeio aleat√≥rio com deriva √© um caso especial do modelo ARIMA(0,1,1) com $\theta = 0$.
*Proof:*
I. O modelo ARIMA(0,1,1) √© definido como $\Delta y_t = \delta + \epsilon_t + \theta\epsilon_{t-1}$.
II. Quando $\theta = 0$, o modelo se torna $\Delta y_t = \delta + \epsilon_t$, ou seja $y_t = y_{t-1} + \delta + \epsilon_t$ que √© a defini√ß√£o de um passeio aleat√≥rio com deriva.
III. A proje√ß√£o linear do ARIMA(0,1,1) √© $\hat{y}_{t+s|t} = s\delta + y_t + \theta\epsilon_t$.
IV. Quando $\theta = 0$, a proje√ß√£o linear se torna $\hat{y}_{t+s|t} = s\delta + y_t$, que √© a proje√ß√£o linear do passeio aleat√≥rio com deriva.
‚ñ†
Este lema formaliza a intui√ß√£o de que o passeio aleat√≥rio com deriva pode ser considerado uma simplifica√ß√£o do modelo ARIMA(0,1,1), onde o impacto de choques passados na proje√ß√£o linear √© nulo al√©m da mudan√ßa no valor inicial da s√©rie.

> üí° **Exemplo Num√©rico:**
> Usando os mesmos valores de $\delta=0.1$ e $y_t=100$, vamos comparar as proje√ß√µes do passeio aleat√≥rio com deriva e do ARIMA(0,1,1), considerando que $\theta=0.6$ e $\epsilon_t=3$.
>
> *   **Passeio Aleat√≥rio com Deriva:**
>     *   $\hat{y}_{t+1|t} = 1(0.1) + 100 = 100.1$
>     *   $\hat{y}_{t+5|t} = 5(0.1) + 100 = 100.5$
>     *   $\hat{y}_{t+10|t} = 10(0.1) + 100 = 101$
>
> *   **ARIMA(0,1,1):**
>     *   $\hat{y}_{t+1|t} = 1(0.1) + 100 + 0.6(3) = 101.9$
>     *   $\hat{y}_{t+5|t} = 5(0.1) + 100 + 0.6(3) = 102.3$
>     *   $\hat{y}_{t+10|t} = 10(0.1) + 100 + 0.6(3) = 102.8$
>
> Observe que, embora ambos os modelos prevejam um crescimento linear com taxa $\delta$, o modelo ARIMA(0,1,1) incorpora o impacto do choque atual $(\theta \epsilon_t = 1.8)$, o que n√£o ocorre no passeio aleat√≥rio. A tabela abaixo resume as diferen√ßas:
>
> | Modelo           | $\hat{y}_{t+1|t}$ | $\hat{y}_{t+5|t}$ | $\hat{y}_{t+10|t}$ |
> |-------------------|-------------------|-------------------|--------------------|
> | Passeio Aleat√≥rio | 100.1             | 100.5             | 101                |
> | ARIMA(0,1,1)      | 101.9             | 102.3             | 102.8             |
>
> ```mermaid
>  graph LR
>      A[y_t = 100] --> B(Passeio Aleat√≥rio: s=1, 100.1)
>      A --> C(Passeio Aleat√≥rio: s=5, 100.5)
>      A --> D(Passeio Aleat√≥rio: s=10, 101)
>
>       A --> E(ARIMA(0,1,1): s=1, 101.9)
>       A --> F(ARIMA(0,1,1): s=5, 102.3)
>       A --> G(ARIMA(0,1,1): s=10, 102.8)
>
>      style A fill:#f9f,stroke:#333,stroke-width:2px
>      style E fill:#ccf,stroke:#333,stroke-width:2px
>       style F fill:#ccf,stroke:#333,stroke-width:2px
>       style G fill:#ccf,stroke:#333,stroke-width:2px
> ```
> Este exemplo demonstra que o modelo ARIMA(0,1,1) captura um efeito persistente do choque atual nas previs√µes, enquanto o passeio aleat√≥rio com deriva n√£o.

### Compara√ß√£o com Processos Estacion√°rios por Tend√™ncia
A diferen√ßa entre a proje√ß√£o linear do modelo ARIMA(0,1,1) e a de um processo estacion√°rio por tend√™ncia reside, principalmente, no tratamento dos choques. Em um processo estacion√°rio por tend√™ncia, a influ√™ncia dos choques se dissipa com o aumento do horizonte de previs√£o, e a proje√ß√£o converge para a tend√™ncia determin√≠stica.  Em contraste, no modelo ARIMA(0,1,1), embora os choques passados n√£o se acumulem no n√≠vel da s√©rie, o choque atual afeta a previs√£o para todos os horizontes futuros atrav√©s do termo  $\theta \epsilon_t$, ou seja, mant√©m um efeito persistente. Isso faz com que os choques tenham um efeito permanente na previs√£o, mas o efeito n√£o se acumula com o tempo.

**Observa√ß√£o 1** A proje√ß√£o linear do modelo ARIMA(0,1,1) converge para um caminho linear com inclina√ß√£o $\delta$ quando o choque atual $\epsilon_t$ √© nulo.

A tabela a seguir resume as principais diferen√ßas:

| Caracter√≠stica | Processo Estacion√°rio por Tend√™ncia  | Modelo ARIMA(0,1,1)  | Passeio Aleat√≥rio com Deriva |
| :---------------------- | :---------------------------------------- | :---------------------------------- | :---------------------------------- |
| **Modelo**  | $y_t = \alpha + \delta t + \psi(L)\epsilon_t$  |  $\Delta y_t = \delta + (1+\theta L)\epsilon_t$  | $y_t = y_{t-1} + \delta + \epsilon_t$  |
| **Proje√ß√£o Linear** | $\hat{y}_{t+s|t} = \alpha + \delta(t+s) + \psi_s\epsilon_t + \psi_{s+1}\epsilon_{t-1} + \ldots$ |  $\hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t$  | $\hat{y}_{t+s|t} = s\delta + y_t$   |
| **Tend√™ncia**  | Tend√™ncia determin√≠stica linear e componente estoc√°stico com efeito transitorio | Tend√™ncia linear na proje√ß√£o e componente com efeito persistente do choque atual | Tend√™ncia linear na proje√ß√£o |
| **Efeito dos Choques** | Transit√≥rio. Dissipa-se com o tempo. | Permanente, mas n√£o cumulativo.  | N√£o h√° efeito direto dos choques nas previs√µes, al√©m do valor atual da s√©rie. |
| **Persist√™ncia**| Inova√ß√µes n√£o t√™m efeito persistente | Inova√ß√µes t√™m efeito persistente na proje√ß√£o linear, atrav√©s de $\theta \epsilon_t$ | Inova√ß√µes n√£o tem efeito persistente na proje√ß√£o linear |

### Implica√ß√µes Pr√°ticas
A escolha entre um modelo estacion√°rio por tend√™ncia, um ARIMA(0,1,1) ou um passeio aleat√≥rio com deriva depende das caracter√≠sticas da s√©rie temporal que se est√° modelando. Se os choques passados t√™m efeitos transit√≥rios e a s√©rie tende a retornar a uma tend√™ncia fixa, um processo estacion√°rio por tend√™ncia pode ser adequado. Por outro lado, se os choques t√™m efeitos permanentes no n√≠vel da s√©rie e o comportamento da s√©rie √© melhor descrito como a acumula√ß√£o de choques ao longo do tempo, um modelo ARIMA(0,1,1) ou um passeio aleat√≥rio com deriva pode ser mais apropriado. Especificamente, o modelo ARIMA(0,1,1) captura a ideia de que um choque atual tem um impacto persistente, o que √© mais apropriado para s√©ries temporais onde essa caracter√≠stica √© observada.

### Conclus√£o
Neste cap√≠tulo, exploramos a proje√ß√£o linear para o modelo ARIMA(0,1,1), um caso espec√≠fico de processo de raiz unit√°ria, e comparamos com as proje√ß√µes de processos estacion√°rios por tend√™ncia e do passeio aleat√≥rio com deriva. O modelo ARIMA(0,1,1) fornece um exemplo concreto de como as inova√ß√µes afetam as previs√µes em processos com raiz unit√°ria, adicionando o termo  $\theta \epsilon_t$ que modela o efeito persistente de um choque atual. Enquanto a proje√ß√£o linear para processos estacion√°rios por tend√™ncia tende a convergir para uma tend√™ncia linear determin√≠stica, as proje√ß√µes lineares para processos de raiz unit√°ria, incluindo o modelo ARIMA(0,1,1), incorporam efeitos cumulativos ou persistentes de choques, destacando a natureza da n√£o estacionariedade. A escolha entre esses modelos depende das propriedades espec√≠ficas da s√©rie temporal e do comportamento dos seus choques. Compreender essas nuances √© essencial para uma an√°lise e previs√£o eficaz de s√©ries temporais n√£o estacion√°rias.

### Refer√™ncias
[^1]: Modelos de S√©ries Temporais N√£o Estacion√°rias: Proje√ß√£o Linear e Passeio Aleat√≥rio com Deriva.
[^2]: Compara√ß√£o da Proje√ß√£o Linear em Processos Estacion√°rios por Tend√™ncia e Raiz Unit√°ria.
[^3]:  Modelos de S√©ries Temporais N√£o Estacion√°rias: T√≥picos introdut√≥rios.
<!-- END -->
