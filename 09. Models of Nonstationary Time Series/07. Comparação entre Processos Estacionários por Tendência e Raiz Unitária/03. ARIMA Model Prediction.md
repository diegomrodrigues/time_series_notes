## ComparaÃ§Ã£o da ProjeÃ§Ã£o Linear em Processos EstacionÃ¡rios por TendÃªncia e Raiz UnitÃ¡ria: AnÃ¡lise do Modelo ARIMA(0,1,1)

### IntroduÃ§Ã£o
Nos capÃ­tulos anteriores, exploramos as projeÃ§Ãµes lineares para processos estacionÃ¡rios por tendÃªncia e processos de raiz unitÃ¡ria, enfatizando as diferenÃ§as fundamentais entre eles e como cada um modela o comportamento de sÃ©ries temporais nÃ£o estacionÃ¡rias [^1, ^2]. Agora, vamos aprofundar a anÃ¡lise ao considerar um caso especÃ­fico de um processo de raiz unitÃ¡ria: o modelo **Autoregressivo Integrado de MÃ©dia MÃ³vel (ARIMA)** de ordem (0, 1, 1), ou seja, um processo ARIMA(0,1,1). Este modelo oferece uma visÃ£o mais detalhada de como as inovaÃ§Ãµes afetam as previsÃµes em processos com raiz unitÃ¡ria, especialmente quando comparado a processos estacionÃ¡rios por tendÃªncia.

### ProjeÃ§Ã£o Linear para um Modelo ARIMA(0,1,1)
Um modelo ARIMA(0,1,1) Ã© um caso particular de um processo de raiz unitÃ¡ria, onde a primeira diferenÃ§a da sÃ©rie temporal segue um processo de mÃ©dia mÃ³vel de ordem 1 (MA(1)).  O modelo pode ser expresso como [15.1.3]:
$$(1 - L)y_t = \delta + (1+\theta L)\epsilon_t$$
onde $L$ Ã© o operador de defasagem, $\delta$ Ã© a deriva (ou seja, a mÃ©dia da primeira diferenÃ§a), $\epsilon_t$ Ã© um ruÃ­do branco e $\theta$ Ã© o parÃ¢metro da mÃ©dia mÃ³vel. Este modelo implica que a primeira diferenÃ§a da sÃ©rie Ã© um processo estacionÃ¡rio MA(1). Ao expandir, obtemos:
$$ y_t - y_{t-1} = \delta + \epsilon_t + \theta \epsilon_{t-1} $$

A projeÃ§Ã£o linear para o modelo ARIMA(0,1,1) Ã© dada por [15.3.5]:
$$ \hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t $$
Essa equaÃ§Ã£o [15.3.5] mostra que a melhor previsÃ£o para $y_{t+s}$ Ã© composta por trÃªs componentes principais:
1. **TendÃªncia Linear:** O termo $s\delta$ representa a tendÃªncia linear, que cresce a uma taxa constante $\delta$ a cada perÃ­odo de previsÃ£o $s$. Isso Ã© semelhante a um passeio aleatÃ³rio com deriva, mas aqui a tendÃªncia estÃ¡ implÃ­cita na modelagem da diferenÃ§a.
2. **NÃ­vel Atual:** O termo $y_t$ representa o nÃ­vel atual da sÃ©rie, o ponto de partida para a previsÃ£o.
3. **Efeito do Choque Atual:** O termo $\theta \epsilon_t$ representa o efeito da inovaÃ§Ã£o (choque) atual $\epsilon_t$, ponderado pelo parÃ¢metro $\theta$ da mÃ©dia mÃ³vel.

Comparando com a projeÃ§Ã£o linear para um processo de raiz unitÃ¡ria mais geral,  $$ \hat{y}_{t+s|t} = s\delta + y_t + (\psi_1 + \psi_2 + \ldots + \psi_s)\epsilon_t + (\psi_2 + \ldots + \psi_{s+1})\epsilon_{t-1} + \ldots$$, vemos que no modelo ARIMA(0,1,1) apenas a inovaÃ§Ã£o atual ($\epsilon_t$) tem um impacto direto na previsÃ£o e esse efeito Ã© ponderado por $\theta$. As inovaÃ§Ãµes passadas nÃ£o influenciam diretamente a previsÃ£o (alÃ©m do nÃ­vel atual $y_t$). Ou seja, no ARIMA(0,1,1) temos $\psi_1 = \theta$ e $\psi_i = 0$ para $i > 1$.

**ProposiÃ§Ã£o 1** A projeÃ§Ã£o linear para o modelo ARIMA(0,1,1) pode ser reescrita utilizando o operador de defasagem $L$ como:
$$ \hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t $$
*Proof:*
I.  O modelo ARIMA(0,1,1) Ã© definido como $(1-L)y_t = \delta + (1 + \theta L)\epsilon_t$.
II. A projeÃ§Ã£o linear, conforme [15.3.5], Ã© dada por $\hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t$.
III. Comparando com a projeÃ§Ã£o linear geral de um processo com raiz unitÃ¡ria, $\hat{y}_{t+s|t} = s\delta + y_t + (\psi_1 + \psi_2 + \ldots + \psi_s)\epsilon_t + (\psi_2 + \ldots + \psi_{s+1})\epsilon_{t-1} + \ldots$, vemos que, para o ARIMA(0,1,1), $\psi_1 = \theta$ e $\psi_i=0$ para $i>1$.
IV. Substituindo esses valores na equaÃ§Ã£o geral, temos $\hat{y}_{t+s|t} = s\delta + y_t + \theta\epsilon_t$, que Ã© a projeÃ§Ã£o linear do modelo ARIMA(0,1,1).
â– 
Essa proposiÃ§Ã£o confirma que, para o modelo ARIMA(0,1,1), apenas o choque atual Ã© relevante para a previsÃ£o, alÃ©m da tendÃªncia determinÃ­stica e do nÃ­vel atual da sÃ©rie, tornando a forma [15.3.5] equivalente Ã  forma com operador de defasagem quando aplicado a esse modelo especÃ­fico.

**Lema 1.1** A variÃ¢ncia do erro de previsÃ£o para o modelo ARIMA(0,1,1) nÃ£o depende do horizonte de previsÃ£o $s$.
*Proof:*
I. O erro de previsÃ£o para o modelo ARIMA(0,1,1) Ã© dado por $e_{t+s|t} = y_{t+s} - \hat{y}_{t+s|t}$.
II. Substituindo as expressÃµes para $y_{t+s}$ e $\hat{y}_{t+s|t}$, temos que $e_{t+s|t} = (y_{t+s}-y_t-s\delta -\theta \epsilon_t)$.
III. Do modelo ARIMA(0,1,1) temos que $\Delta y_t = \delta + \epsilon_t + \theta\epsilon_{t-1}$, ou seja, $y_{t+s} = y_t + s\delta + \sum_{i=1}^{s}\epsilon_{t+i} + \theta\epsilon_{t+i-1} $.
IV. Substituindo esse resultado no erro de previsÃ£o temos $e_{t+s|t} = \sum_{i=1}^{s}\epsilon_{t+i} + \theta\epsilon_{t+s-1}-\theta \epsilon_t$.
V. Calculando a variÃ¢ncia do erro,  $\mathbb{V}[e_{t+s|t}] = \mathbb{V}[\sum_{i=1}^{s}\epsilon_{t+i} + \theta\epsilon_{t+s-1}-\theta \epsilon_t]$. Como $\epsilon_t$ Ã© um ruÃ­do branco com variÃ¢ncia $\sigma^2$, e sÃ£o independentes entre si, temos $\mathbb{V}[e_{t+s|t}] = \sum_{i=1}^{s}\sigma^2 + \theta^2\sigma^2 + \theta^2\sigma^2 = s\sigma^2 + 2\theta^2\sigma^2$.
VI.  A variÃ¢ncia do erro de previsÃ£o depende apenas de $s$ e dos parÃ¢metros do modelo, e nÃ£o do horizonte de previsÃ£o, sendo expressa como $(s+2\theta^2)\sigma^2$, que aumenta linearmente com $s$. Note que a variÃ¢ncia Ã© sempre maior que $s\sigma^2$ devido ao termo $2\theta^2\sigma^2$, indicando que a variÃ¢ncia do erro de previsÃ£o Ã© maior do que para um passeio aleatÃ³rio com deriva.
â– 

> ðŸ’¡ **Exemplo NumÃ©rico:**
> Vamos considerar um modelo ARIMA(0,1,1) com $\delta = 0.1$, $\theta = 0.6$ e $\sigma^2 = 1$. Suponha que o valor atual da sÃ©rie seja $y_t = 100$ e a inovaÃ§Ã£o atual seja $\epsilon_t = 3$.
>
> *   **Para $s=1$ (um perÃ­odo Ã  frente):**
>     $\hat{y}_{t+1|t} = 1(0.1) + 100 + 0.6(3) = 0.1 + 100 + 1.8 = 101.9$
>
> *   **Para $s=5$ (cinco perÃ­odos Ã  frente):**
>      $\hat{y}_{t+5|t} = 5(0.1) + 100 + 0.6(3) = 0.5 + 100 + 1.8 = 102.3$
>
> *   **Para $s=10$ (dez perÃ­odos Ã  frente):**
>     $\hat{y}_{t+10|t} = 10(0.1) + 100 + 0.6(3) = 1 + 100 + 1.8 = 102.8$
>
> Observe que a previsÃ£o cresce linearmente a uma taxa constante de 0.1 por perÃ­odo, partindo do valor inicial $y_t=100$. O impacto da inovaÃ§Ã£o $\epsilon_t = 3$ (ponderado por $\theta = 0.6$) Ã© constante para todos os horizontes de previsÃ£o, adicionando 1.8 ao valor base ($100+s\delta$). Vamos calcular a variÃ¢ncia do erro de previsÃ£o para $s=1$ e $s=5$:
>
> *   Para $s=1$: $\mathbb{V}[e_{t+1|t}] = (1 + 2(0.6)^2)\times 1 = 1 + 2(0.36) = 1.72$
> *   Para $s=5$: $\mathbb{V}[e_{t+5|t}] = (5 + 2(0.6)^2)\times 1 = 5 + 2(0.36) = 5.72$
>
> Como previsto pelo Lema 1.1, a variÃ¢ncia do erro de previsÃ£o cresce linearmente com $s$.
>
> ```mermaid
>  graph LR
>      A[y_t = 100] --> B(s=1, 101.1)
>      A --> C(s=5, 100.5)
>      A --> D(s=10, 101)
>       style A fill:#f9f,stroke:#333,stroke-width:2px
>
>      B --> E(Prev. s=1, 101.9)
>      C --> F(Prev. s=5, 102.3)
>      D --> G(Prev. s=10, 102.8)
>
>       style E fill:#ccf,stroke:#333,stroke-width:2px
>       style F fill:#ccf,stroke:#333,stroke-width:2px
>       style G fill:#ccf,stroke:#333,stroke-width:2px
> ```
>
> Este exemplo mostra como o modelo ARIMA(0,1,1) combina a deriva linear e o efeito do choque atual para gerar as previsÃµes futuras.  O efeito do choque atual, embora persistente, nÃ£o se acumula nos perÃ­odos seguintes como em um passeio aleatÃ³rio.

### ComparaÃ§Ã£o com o Passeio AleatÃ³rio com Deriva
O modelo ARIMA(0,1,1) pode ser visto como uma extensÃ£o do modelo de passeio aleatÃ³rio com deriva. No passeio aleatÃ³rio com deriva puro, temos:
$$ y_t = y_{t-1} + \delta + \epsilon_t $$
E a sua projeÃ§Ã£o linear Ã© dada por:
$$ \hat{y}_{t+s|t} = s\delta + y_t $$
A principal diferenÃ§a entre o passeio aleatÃ³rio com deriva e o ARIMA(0,1,1) estÃ¡ na presenÃ§a do termo $\theta\epsilon_t$. No passeio aleatÃ³rio com deriva, as inovaÃ§Ãµes nÃ£o afetam a previsÃ£o para alÃ©m do nÃ­vel atual da sÃ©rie, enquanto no ARIMA(0,1,1) um choque atual afeta a previsÃ£o linear para todos os perÃ­odos futuros atravÃ©s do termo $\theta\epsilon_t$.  Isso significa que a previsÃ£o do modelo ARIMA(0,1,1) incorpora explicitamente um efeito persistente, mas nÃ£o cumulativo da inovaÃ§Ã£o atual, diferentemente do modelo de passeio aleatÃ³rio com deriva, que nÃ£o considera esse efeito persistente.

**Lema 1** O passeio aleatÃ³rio com deriva Ã© um caso especial do modelo ARIMA(0,1,1) com $\theta = 0$.
*Proof:*
I. O modelo ARIMA(0,1,1) Ã© definido como $\Delta y_t = \delta + \epsilon_t + \theta\epsilon_{t-1}$.
II. Quando $\theta = 0$, o modelo se torna $\Delta y_t = \delta + \epsilon_t$, ou seja $y_t = y_{t-1} + \delta + \epsilon_t$ que Ã© a definiÃ§Ã£o de um passeio aleatÃ³rio com deriva.
III. A projeÃ§Ã£o linear do ARIMA(0,1,1) Ã© $\hat{y}_{t+s|t} = s\delta + y_t + \theta\epsilon_t$.
IV. Quando $\theta = 0$, a projeÃ§Ã£o linear se torna $\hat{y}_{t+s|t} = s\delta + y_t$, que Ã© a projeÃ§Ã£o linear do passeio aleatÃ³rio com deriva.
â– 
Este lema formaliza a intuiÃ§Ã£o de que o passeio aleatÃ³rio com deriva pode ser considerado uma simplificaÃ§Ã£o do modelo ARIMA(0,1,1), onde o impacto de choques passados na projeÃ§Ã£o linear Ã© nulo alÃ©m da mudanÃ§a no valor inicial da sÃ©rie.

> ðŸ’¡ **Exemplo NumÃ©rico:**
> Usando os mesmos valores de $\delta=0.1$ e $y_t=100$, vamos comparar as projeÃ§Ãµes do passeio aleatÃ³rio com deriva e do ARIMA(0,1,1), considerando que $\theta=0.6$ e $\epsilon_t=3$.
>
> *   **Passeio AleatÃ³rio com Deriva:**
>     *   $\hat{y}_{t+1|t} = 1(0.1) + 100 = 100.1$
>     *   $\hat{y}_{t+5|t} = 5(0.1) + 100 = 100.5$
>     *   $\hat{y}_{t+10|t} = 10(0.1) + 100 = 101$
>
> *   **ARIMA(0,1,1):**
>     *   $\hat{y}_{t+1|t} = 1(0.1) + 100 + 0.6(3) = 101.9$
>     *   $\hat{y}_{t+5|t} = 5(0.1) + 100 + 0.6(3) = 102.3$
>     *   $\hat{y}_{t+10|t} = 10(0.1) + 100 + 0.6(3) = 102.8$
>
> Observe que, embora ambos os modelos prevejam um crescimento linear com taxa $\delta$, o modelo ARIMA(0,1,1) incorpora o impacto do choque atual $(\theta \epsilon_t = 1.8)$, o que nÃ£o ocorre no passeio aleatÃ³rio. A tabela abaixo resume as diferenÃ§as:
>
> | Modelo           | $\hat{y}_{t+1|t}$ | $\hat{y}_{t+5|t}$ | $\hat{y}_{t+10|t}$ |
> |-------------------|-------------------|-------------------|--------------------|
> | Passeio AleatÃ³rio | 100.1             | 100.5             | 101                |
> | ARIMA(0,1,1)      | 101.9             | 102.3             | 102.8             |
>
> ```mermaid
>  graph LR
>      A[y_t = 100] --> B(Passeio AleatÃ³rio: s=1, 100.1)
>      A --> C(Passeio AleatÃ³rio: s=5, 100.5)
>      A --> D(Passeio AleatÃ³rio: s=10, 101)
>
>       A --> E(ARIMA(0,1,1): s=1, 101.9)
>       A --> F(ARIMA(0,1,1): s=5, 102.3)
>       A --> G(ARIMA(0,1,1): s=10, 102.8)
>
>      style A fill:#f9f,stroke:#333,stroke-width:2px
>      style E fill:#ccf,stroke:#333,stroke-width:2px
>       style F fill:#ccf,stroke:#333,stroke-width:2px
>       style G fill:#ccf,stroke:#333,stroke-width:2px
> ```
> Este exemplo demonstra que o modelo ARIMA(0,1,1) captura um efeito persistente do choque atual nas previsÃµes, enquanto o passeio aleatÃ³rio com deriva nÃ£o.

### ComparaÃ§Ã£o com Processos EstacionÃ¡rios por TendÃªncia
A diferenÃ§a entre a projeÃ§Ã£o linear do modelo ARIMA(0,1,1) e a de um processo estacionÃ¡rio por tendÃªncia reside, principalmente, no tratamento dos choques. Em um processo estacionÃ¡rio por tendÃªncia, a influÃªncia dos choques se dissipa com o aumento do horizonte de previsÃ£o, e a projeÃ§Ã£o converge para a tendÃªncia determinÃ­stica.  Em contraste, no modelo ARIMA(0,1,1), embora os choques passados nÃ£o se acumulem no nÃ­vel da sÃ©rie, o choque atual afeta a previsÃ£o para todos os horizontes futuros atravÃ©s do termo  $\theta \epsilon_t$, ou seja, mantÃ©m um efeito persistente. Isso faz com que os choques tenham um efeito permanente na previsÃ£o, mas o efeito nÃ£o se acumula com o tempo.

**ObservaÃ§Ã£o 1** A projeÃ§Ã£o linear do modelo ARIMA(0,1,1) converge para um caminho linear com inclinaÃ§Ã£o $\delta$ quando o choque atual $\epsilon_t$ Ã© nulo.

A tabela a seguir resume as principais diferenÃ§as:

| CaracterÃ­stica | Processo EstacionÃ¡rio por TendÃªncia  | Modelo ARIMA(0,1,1)  | Passeio AleatÃ³rio com Deriva |
| :---------------------- | :---------------------------------------- | :---------------------------------- | :---------------------------------- |
| **Modelo**  | $y_t = \alpha + \delta t + \psi(L)\epsilon_t$  |  $\Delta y_t = \delta + (1+\theta L)\epsilon_t$  | $y_t = y_{t-1} + \delta + \epsilon_t$  |
| **ProjeÃ§Ã£o Linear** | $\hat{y}_{t+s|t} = \alpha + \delta(t+s) + \psi_s\epsilon_t + \psi_{s+1}\epsilon_{t-1} + \ldots$ |  $\hat{y}_{t+s|t} = s\delta + y_t + \theta \epsilon_t$  | $\hat{y}_{t+s|t} = s\delta + y_t$   |
| **TendÃªncia**  | TendÃªncia determinÃ­stica linear e componente estocÃ¡stico com efeito transitorio | TendÃªncia linear na projeÃ§Ã£o e componente com efeito persistente do choque atual | TendÃªncia linear na projeÃ§Ã£o |
| **Efeito dos Choques** | TransitÃ³rio. Dissipa-se com o tempo. | Permanente, mas nÃ£o cumulativo.  | NÃ£o hÃ¡ efeito direto dos choques nas previsÃµes, alÃ©m do valor atual da sÃ©rie. |
| **PersistÃªncia**| InovaÃ§Ãµes nÃ£o tÃªm efeito persistente | InovaÃ§Ãµes tÃªm efeito persistente na projeÃ§Ã£o linear, atravÃ©s de $\theta \epsilon_t$ | InovaÃ§Ãµes nÃ£o tem efeito persistente na projeÃ§Ã£o linear |

### ImplicaÃ§Ãµes PrÃ¡ticas
A escolha entre um modelo estacionÃ¡rio por tendÃªncia, um ARIMA(0,1,1) ou um passeio aleatÃ³rio com deriva depende das caracterÃ­sticas da sÃ©rie temporal que se estÃ¡ modelando. Se os choques passados tÃªm efeitos transitÃ³rios e a sÃ©rie tende a retornar a uma tendÃªncia fixa, um processo estacionÃ¡rio por tendÃªncia pode ser adequado. Por outro lado, se os choques tÃªm efeitos permanentes no nÃ­vel da sÃ©rie e o comportamento da sÃ©rie Ã© melhor descrito como a acumulaÃ§Ã£o de choques ao longo do tempo, um modelo ARIMA(0,1,1) ou um passeio aleatÃ³rio com deriva pode ser mais apropriado. Especificamente, o modelo ARIMA(0,1,1) captura a ideia de que um choque atual tem um impacto persistente, o que Ã© mais apropriado para sÃ©ries temporais onde essa caracterÃ­stica Ã© observada.

### ConclusÃ£o
Neste capÃ­tulo, exploramos a projeÃ§Ã£o linear para o modelo ARIMA(0,1,1), um caso especÃ­fico de processo de raiz unitÃ¡ria, e comparamos com as projeÃ§Ãµes de processos estacionÃ¡rios por tendÃªncia e do passeio aleatÃ³rio com deriva. O modelo ARIMA(0,1,1) fornece um exemplo concreto de como as inovaÃ§Ãµes afetam as previsÃµes em processos com raiz unitÃ¡ria, adicionando o termo  $\theta \epsilon_t$ que modela o efeito persistente de um choque atual. Enquanto a projeÃ§Ã£o linear para processos estacionÃ¡rios por tendÃªncia tende a convergir para uma tendÃªncia linear determinÃ­stica, as projeÃ§Ãµes lineares para processos de raiz unitÃ¡ria, incluindo o modelo ARIMA(0,1,1), incorporam efeitos cumulativos ou persistentes de choques, destacando a natureza da nÃ£o estacionariedade. A escolha entre esses modelos depende das propriedades especÃ­ficas da sÃ©rie temporal e do comportamento dos seus choques. Compreender essas nuances Ã© essencial para uma anÃ¡lise e previsÃ£o eficaz de sÃ©ries temporais nÃ£o estacionÃ¡rias.

### ReferÃªncias
[^1]: Modelos de SÃ©ries Temporais NÃ£o EstacionÃ¡rias: ProjeÃ§Ã£o Linear e Passeio AleatÃ³rio com Deriva.
[^2]: ComparaÃ§Ã£o da ProjeÃ§Ã£o Linear em Processos EstacionÃ¡rios por TendÃªncia e Raiz UnitÃ¡ria.
[^3]:  Modelos de SÃ©ries Temporais NÃ£o EstacionÃ¡rias: TÃ³picos introdutÃ³rios.
<!-- END -->
