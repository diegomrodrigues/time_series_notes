## Modelos de Raiz Unit√°ria: Especifica√ß√£o, Implica√ß√µes e o Papel do Operador de Primeira Diferen√ßa

### Introdu√ß√£o
Este cap√≠tulo aprofunda a an√°lise dos modelos de **raiz unit√°ria**, um conceito fundamental no estudo de s√©ries temporais n√£o estacion√°rias [^1], [^2], [^3], [^4]. Exploraremos em detalhe como esses modelos especificam que a primeira diferen√ßa da s√©rie temporal, $(1 - L)y_t$, √© estacion√°ria, modelando as *mudan√ßas* na s√©rie em vez de seu n√≠vel. A representa√ß√£o matem√°tica desse tipo de modelo, dada por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, ser√° cuidadosamente analisada. Investigaremos o papel crucial do operador de primeira diferen√ßa $(1-L)$, frequentemente denotado por $\Delta$, e como ele transforma uma s√©rie n√£o estacion√°ria em uma estacion√°ria. Al√©m disso, analisaremos o caso particular do passeio aleat√≥rio com deriva, onde $\psi(L) = 1$, e as suas implica√ß√µes pr√°ticas. Este cap√≠tulo √© essencial para entender a din√¢mica de s√©ries temporais com comportamentos n√£o estacion√°rios e como model√°-las adequadamente.

### Especifica√ß√£o Matem√°tica dos Modelos de Raiz Unit√°ria
Em contraste com os modelos *trend-stationary*, que assumem que a n√£o estacionaridade √© causada por uma tend√™ncia determin√≠stica, os modelos de raiz unit√°ria especificam que a n√£o estacionaridade surge de um componente estoc√°stico com persist√™ncia. Nesses modelos, a s√©rie original $y_t$ n√£o √© estacion√°ria, mas a sua primeira diferen√ßa, dada por $(1 - L)y_t = y_t - y_{t-1} = \Delta y_t$, √© estacion√°ria. A forma geral de um modelo com raiz unit√°ria √© dada por:
$$(1-L)y_t = \delta + \psi(L)\epsilon_t$$ [^1]
onde:
*  $y_t$ √© a s√©rie temporal observada no instante $t$.
*   $(1 - L)$ √© o operador de primeira diferen√ßa, que transforma a s√©rie $y_t$ em sua primeira diferen√ßa, $\Delta y_t = y_t - y_{t-1}$.
*   $\delta$ √© a deriva, um termo constante que representa a varia√ß√£o m√©dia da s√©rie diferenciada.
*  $\psi(L)\epsilon_t$ √© um processo estoc√°stico estacion√°rio de m√©dia zero, onde $\psi(L)$ √© um operador de m√©dias m√≥veis e $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$.

A equa√ß√£o acima estabelece que a *mudan√ßa* na s√©rie temporal, $\Delta y_t$, √© estacion√°ria. Em outras palavras, o modelo de raiz unit√°ria foca na modelagem da din√¢mica das mudan√ßas na s√©rie, e n√£o nos n√≠veis da s√©rie. A deriva $\delta$ captura a tend√™ncia m√©dia das mudan√ßas, e o componente $\psi(L)\epsilon_t$ captura a din√¢mica de curto prazo das mudan√ßas, modelada como um processo estacion√°rio.

#### O Papel do Operador de Primeira Diferen√ßa (1-L)
O operador de primeira diferen√ßa, $(1 - L)$, desempenha um papel central na modelagem de processos com raiz unit√°ria. Aplicar este operador a uma s√©rie temporal consiste em subtrair o valor da s√©rie no per√≠odo anterior, $y_{t-1}$, do valor da s√©rie no per√≠odo atual, $y_t$:
$$(1 - L)y_t = y_t - Ly_t = y_t - y_{t-1} = \Delta y_t$$
O operador $(1-L)$ tamb√©m √© frequentemente denotado por $\Delta$, e √© comumente utilizado na modelagem de processos com raiz unit√°ria. O operador de primeira diferen√ßa √© fundamental porque remove a n√£o estacionaridade causada pela raiz unit√°ria da s√©rie original, e transforma a s√©rie em uma s√©rie estacion√°ria. O operador $(1-L)$ captura a din√¢mica das *mudan√ßas* na s√©rie, e n√£o os n√≠veis da s√©rie original.
A opera√ß√£o de primeira diferen√ßa n√£o √© invert√≠vel, ou seja, n√£o existe um operador que quando aplicado a $\Delta y_t$ retorne a s√©rie original $y_t$. A perda de informa√ß√£o causada pela aplica√ß√£o do operador $(1-L)$ √© uma das caracter√≠sticas da modelagem de processos com raiz unit√°ria.

> üí° **Exemplo Num√©rico:**
>
> Considere uma s√©rie temporal de pre√ßos de ativos financeiros com os seguintes valores:
> $$y = [10, 12, 13, 15, 16, 18, 20]$$
>
> A aplica√ß√£o do operador de primeira diferen√ßa $(1-L)$ resulta na seguinte s√©rie de diferen√ßas:
> $$\Delta y = (1-L)y = [12-10, 13-12, 15-13, 16-15, 18-16, 20-18] = [2, 1, 2, 1, 2, 2]$$
>
> Observe que a s√©rie original $y$ n√£o tem uma m√©dia constante, mas a s√©rie $\Delta y$ (as mudan√ßas) pode ser modelada como um processo estacion√°rio. O operador de primeira diferen√ßa $(1-L)$ captura a din√¢mica das *mudan√ßas* na s√©rie, e n√£o os n√≠veis da s√©rie original. Os valores da s√©rie $\Delta y$ representam as mudan√ßas nos pre√ßos do ativo, e a m√©dia da s√©rie $\Delta y$ (1.67) representa a mudan√ßa m√©dia no pre√ßo do ativo.
>
>   ```python
>   import numpy as np
>
>   # Example time series
>   y = np.array([10, 12, 13, 15, 16, 18, 20])
>
>   # Calculate the first difference
>   delta_y = np.diff(y)
>
>   # Print the results
>   print("Original time series y:", y)
>   print("First difference of time series Œîy:", delta_y)
>   print("Mean of delta y: ", np.mean(delta_y))
>  ```

#### O Componente Estoc√°stico: $\psi(L)\epsilon_t$
O componente estoc√°stico $\psi(L)\epsilon_t$ em um modelo com raiz unit√°ria descreve a din√¢mica de curto prazo das mudan√ßas na s√©rie, $\Delta y_t$, em torno da deriva $\delta$. Assim como nos modelos *trend-stationary*, $\psi(L)$ representa um operador de m√©dias m√≥veis que pode ser de ordem finita ou infinita. Este operador, em geral, √© modelado por um modelo ARMA, e $\epsilon_t$ √© um ru√≠do branco.
A forma do operador $\psi(L)$ e seus par√¢metros determinam a autocorrela√ß√£o da s√©rie diferenciada, o que implica na persist√™ncia ou n√£o dos choques no componente estoc√°stico da s√©rie original.
O componente estoc√°stico adiciona flexibilidade ao modelo, permitindo que ele capture a din√¢mica de curto prazo da s√©rie diferenciada, e a persist√™ncia de choques nos n√≠veis da s√©rie original.

> üí° **Exemplo Num√©rico:**
>
> Suponha que um modelo com raiz unit√°ria seja dado por:
> $$(1-L)y_t = 0.1 + \psi(L)\epsilon_t$$
>
> *   **Caso 1: Ru√≠do Branco:** Se $\psi(L) = 1$, ent√£o temos $(1-L)y_t = 0.1 + \epsilon_t$. Neste caso, a mudan√ßa na s√©rie √© um ru√≠do branco com m√©dia 0.1.
>
> *   **Caso 2: Processo MA(1):** Se $\psi(L) = (1 + 0.5L)$, ent√£o temos $(1-L)y_t = 0.1 + \epsilon_t + 0.5\epsilon_{t-1}$. Neste caso, a mudan√ßa na s√©rie segue um processo MA(1) com m√©dia 0.1.
>
> *   **Caso 3: Processo AR(1):** Se $\psi(L) = (1 - 0.8L)^{-1}$, ent√£o temos $(1-L)y_t = 0.1 + (1 - 0.8L)^{-1}\epsilon_t$, que implica que a mudan√ßa na s√©rie segue um processo AR(1) com m√©dia 0.1.
>
> *   **Caso 4: Processo ARMA(1,1):** Se $\psi(L) = (1 - 0.8L)^{-1}(1+0.3L)$, ent√£o temos que a din√¢mica de curto prazo das mudan√ßas segue um modelo ARMA(1,1), onde $(1-L)y_t$ segue um processo ARMA(1,1) com m√©dia 0.1
>
> Nesses exemplos, o operador $\psi(L)$ introduz complexidade na din√¢mica da mudan√ßa na s√©rie original $y_t$.
>
> ```python
> import numpy as np
>
> T = 100
> sigma_epsilon = 1
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, T)
>
> # Define function to simulate time series
> def simulate_ts_unit_root(delta, phi, theta, T, sigma_epsilon):
>     np.random.seed(42)
>     epsilon = np.random.normal(0, sigma_epsilon, T)
>     y = np.zeros(T)
>     for t in range(1, T):
>        y[t] = y[t-1] + delta + epsilon[t]
>     return y
>
> # Example 1: Random Walk with Drift
> y_random_walk = simulate_ts_unit_root(0.1, 0, 0, T, sigma_epsilon)
> print("Random Walk with drift - First 5 values:", y_random_walk[1:5])
>
> # Example 2: AR(1)
> y_ar = np.zeros(T)
> phi_ar = 0.8
> for t in range (1, T):
>      y_ar[t] = y_ar[t-1] + 0.1 + (phi_ar*epsilon[t-1] + epsilon[t])
> print("Unit root with AR(1) - First 5 values:", y_ar[1:5])
>
> # Example 3: MA(1)
> y_ma = np.zeros(T)
> theta_ma = 0.5
> for t in range (1, T):
>      y_ma[t] = y_ma[t-1] + 0.1 + (epsilon[t] + theta_ma*epsilon[t-1])
> print("Unit root with MA(1) - First 5 values:", y_ma[1:5])
>
>
> # Example 4: ARMA(1,1)
> y_arma = np.zeros(T)
> phi_arma = 0.8
> theta_arma = 0.3
> for t in range (1, T):
>      y_arma[t] = y_arma[t-1] + 0.1 + (phi_arma*epsilon[t-1] + theta_arma * epsilon[t-1] + epsilon[t])
> print("Unit root with ARMA(1,1) - First 5 values:", y_arma[1:5])
> ```
**Lema 1:** *Se uma s√©rie temporal $y_t$ tem uma raiz unit√°ria, ent√£o a s√©rie $(1-L)^d y_t$ √© estacion√°ria para algum inteiro positivo $d$. O menor valor de $d$ para o qual $(1-L)^d y_t$ √© estacion√°ria √© chamado de ordem de integra√ß√£o da s√©rie $y_t$. Uma s√©rie com raiz unit√°ria tem ordem de integra√ß√£o 1, e √© denotada por I(1).*
*Prova:*
I.  Uma s√©rie temporal $y_t$ tem uma raiz unit√°ria se o polin√¥mio caracter√≠stico do operador de retardo tiver uma raiz igual a 1.
II. Aplicar o operador $(1-L)$ remove a raiz unit√°ria.
III.Se a s√©rie $(1-L)y_t$ √© estacion√°ria, ent√£o a s√©rie $y_t$ √© integrada de ordem 1, ou I(1).
IV. Se a s√©rie $(1-L)y_t$ ainda tiver uma raiz unit√°ria, ent√£o podemos aplicar o operador $(1-L)$ novamente para obter $(1-L)^2y_t$.
V.  Repetindo esse processo at√© que $(1-L)^d y_t$ seja estacion√°ria, obtemos a ordem de integra√ß√£o $d$ da s√©rie $y_t$.
VI. Em particular, para um modelo com raiz unit√°ria simples $(1-L)y_t = \delta + \psi(L)\epsilon_t$, temos que a primeira diferen√ßa √© estacion√°ria, e portanto, a s√©rie √© integrada de ordem 1. $\blacksquare$

### O Caso Particular do Passeio Aleat√≥rio com Deriva

Um caso particular importante dos modelos com raiz unit√°ria √© o passeio aleat√≥rio com deriva, onde $\psi(L) = 1$. Neste caso, o modelo se reduz a:
$$(1-L)y_t = \delta + \epsilon_t$$
ou, equivalentemente:
$$y_t = y_{t-1} + \delta + \epsilon_t$$ [^1]
Este modelo representa um processo onde o valor da s√©rie no per√≠odo atual, $y_t$, √© igual ao valor do per√≠odo anterior, $y_{t-1}$, somado a uma deriva constante $\delta$ e um ru√≠do branco $\epsilon_t$. O passeio aleat√≥rio com deriva √© um modelo base para diversas aplica√ß√µes em economia e finan√ßas, onde as mudan√ßas em uma s√©rie s√£o aleat√≥rias, e a s√©rie n√£o retorna √† sua m√©dia ap√≥s um choque.
A presen√ßa da deriva $\delta$ introduz uma tend√™ncia na s√©rie ao longo do tempo, e os choques $\epsilon_t$ s√£o permanentes, e afetam o n√≠vel da s√©rie de forma aditiva.

> üí° **Exemplo Num√©rico:**
>
> Suponha que o pre√ßo de uma a√ß√£o siga um passeio aleat√≥rio com deriva, dado por:
> $$y_t = y_{t-1} + 0.05 + \epsilon_t$$
> onde $y_t$ √© o pre√ßo no tempo $t$, $\delta = 0.05$ √© a deriva (ou seja, o pre√ßo m√©dio aumenta em 0.05 unidades por per√≠odo) e $\epsilon_t$ √© um ru√≠do branco com m√©dia zero. Se o pre√ßo inicial for $y_0=100$, os valores seguintes da s√©rie ser√£o:
> $$y_1 = 100 + 0.05 + \epsilon_1$$
> $$y_2 = y_1 + 0.05 + \epsilon_2 = 100 + 2(0.05) + \epsilon_1 + \epsilon_2$$
> $$y_3 = y_2 + 0.05 + \epsilon_3 = 100 + 3(0.05) + \epsilon_1 + \epsilon_2 + \epsilon_3$$
>
> Observe que o pre√ßo da a√ß√£o aumenta em m√©dia 0.05 por per√≠odo, mas os choques $\epsilon_t$ t√™m um efeito permanente no n√≠vel do pre√ßo, demonstrando que a s√©rie n√£o √© estacion√°ria. A s√©rie √© caracterizada por uma raiz unit√°ria.
>
>  ```python
>  import numpy as np
>
>  # Parameters for random walk
>  delta = 0.05
>  T = 100
>  sigma_epsilon = 1
>  np.random.seed(42)
>  epsilon = np.random.normal(0, sigma_epsilon, T)
>
>  # Generate Random walk with drift
>  y = np.zeros(T)
>  y[0] = 100 # Initial price
>  for t in range(1, T):
>      y[t] = y[t-1] + delta + epsilon[t]
>  print("First 5 values of Random Walk with drift:", y[1:5])
>
>  ```

**Lema 2:** *A primeira diferen√ßa de um modelo com raiz unit√°ria, dada por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, √© uma s√©rie estacion√°ria, que pode ser modelada com as ferramentas da teoria de s√©ries temporais estacion√°rias.*
*Prova:*
I. Um modelo com raiz unit√°ria √© definido por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, onde $y_t$ √© n√£o estacion√°ria.
II. A aplica√ß√£o do operador de primeira diferen√ßa $(1-L)$ em $y_t$ gera a s√©rie $\Delta y_t = (1-L)y_t$.
III. A s√©rie resultante, $\Delta y_t$, √© dada por $\Delta y_t = \delta + \psi(L)\epsilon_t$, onde $\delta$ √© uma constante e $\psi(L)\epsilon_t$ √© um processo estacion√°rio.
IV. A estacionaridade de $\psi(L)\epsilon_t$ implica que a m√©dia e a vari√¢ncia de $\Delta y_t$ s√£o constantes ao longo do tempo.
V. Portanto, a primeira diferen√ßa de um modelo com raiz unit√°ria, $\Delta y_t$, √© uma s√©rie estacion√°ria, que pode ser modelada com modelos ARMA ou similares.  $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
> *  Considere o passeio aleat√≥rio com deriva: $y_t = y_{t-1} + 0.2 + \epsilon_t$. A primeira diferen√ßa √© dada por $\Delta y_t = (1-L)y_t = 0.2 + \epsilon_t$, que √© um ru√≠do branco com m√©dia 0.2, e √©, portanto, estacion√°ria.
> * Considere o modelo $(1-L)y_t = 0.1 + \epsilon_t + 0.5\epsilon_{t-1}$. A primeira diferen√ßa √© dada por $\Delta y_t = 0.1 + \epsilon_t + 0.5\epsilon_{t-1}$, que √© um processo de m√©dias m√≥veis MA(1) com m√©dia 0.1, e √©, portanto, estacion√°ria.
> * Considere o modelo $(1-L)y_t = 0.05 + 0.8(1-L)y_{t-1} + \epsilon_t$. A s√©rie $\Delta y_t$ segue um processo autoregressivo AR(1), o que indica que a diferen√ßa da s√©rie √© estacion√°ria.
> * Considere o modelo $(1-L)y_t = 0.1 + 0.5\epsilon_{t-1} + \epsilon_t - 0.3\epsilon_{t-2}$. A primeira diferen√ßa da s√©rie, $\Delta y_t$, segue um modelo ARMA(0,2), que √© estacion√°rio.

**Proposi√ß√£o 1:** *Em um modelo com raiz unit√°ria, a s√©rie original $y_t$ n√£o √© estacion√°ria, mas a sua primeira diferen√ßa, $\Delta y_t = (1-L)y_t$, √© uma s√©rie estacion√°ria e tem uma representa√ß√£o equivalente por um modelo ARMA, e a forma espec√≠fica do operador $\psi(L)$ determina as propriedades do componente estoc√°stico da s√©rie transformada.*
*Prova:*
I. O modelo com raiz unit√°ria √© definido por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, onde $y_t$ √© n√£o estacion√°ria.
II. A primeira diferen√ßa, $\Delta y_t = (1-L)y_t$, √© dada por $\Delta y_t = \delta + \psi(L)\epsilon_t$.
III. O termo $\delta$ √© uma constante (a deriva), e $\psi(L)\epsilon_t$ √© um processo estoc√°stico estacion√°rio de m√©dia zero.
IV. Se $\psi(L)\epsilon_t$ seguir um modelo ARMA, ent√£o a primeira diferen√ßa $\Delta y_t$ √© uma s√©rie estacion√°ria, e a forma espec√≠fica de $\psi(L)$ ir√° determinar as propriedades de autocorrela√ß√£o da s√©rie diferenciada.
V. Portanto, a primeira diferen√ßa de um modelo com raiz unit√°ria √© uma s√©rie estacion√°ria que tem uma representa√ß√£o equivalente por um modelo ARMA, e as propriedades do componente estoc√°stico da s√©rie diferenciada s√£o determinadas pela forma do operador $\psi(L)$. $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
> * Suponha que  $(1-L)y_t = 0.2 + \epsilon_t$. Ent√£o, $\Delta y_t = 0.2 + \epsilon_t$ √© estacion√°rio, e $\psi(L) = 1$. A s√©rie diferenciada √© um ru√≠do branco com m√©dia 0.2, e vari√¢ncia $\sigma^2$, onde $\sigma^2$ √© a vari√¢ncia de $\epsilon_t$.
> * Suponha que $(1-L)y_t = 0.1 + \epsilon_t + 0.5\epsilon_{t-1}$. Ent√£o,  $\Delta y_t = 0.1 + \epsilon_t + 0.5\epsilon_{t-1}$ √© um processo MA(1) com m√©dia 0.1, e $\psi(L) = (1 + 0.5L)$. A s√©rie diferenciada √© estacion√°ria.
> * Suponha que $(1-L)y_t = 0.05 + 0.8(1-L)y_{t-1} + \epsilon_t$. A s√©rie diferenciada √© dada por $\Delta y_t = 0.05 + 0.8\Delta y_{t-1} + \epsilon_t$. A primeira diferen√ßa $\Delta y_t$ segue um processo autoregressivo AR(1), e $\psi(L) = (1-0.8L)^{-1}$. O componente estacion√°rio da s√©rie diferenciada segue um processo AR(1).
> * Se $(1-L)y_t = 0.2 + 0.6 \epsilon_{t-1} + \epsilon_t - 0.4 \epsilon_{t-2}$, ent√£o a primeira diferen√ßa da s√©rie √© dada por  $\Delta y_t = 0.2 + 0.6 \epsilon_{t-1} + \epsilon_t - 0.4 \epsilon_{t-2}$.  A s√©rie diferenciada segue um processo de m√©dias m√≥veis MA(2), e $\psi(L) = (1 + 0.6L - 0.4L^2)$.

**Teorema 1:** *Um processo com raiz unit√°ria, modelado como $(1 - L)y_t = \delta + \psi(L)\epsilon_t$, tem a propriedade de que choques (representados por $\epsilon_t$) t√™m efeitos permanentes sobre a s√©rie original $y_t$, enquanto os efeitos dos choques sobre a s√©rie diferenciada $\Delta y_t$ s√£o tempor√°rios.*
*Prova:*
I. Em um modelo com raiz unit√°ria, a s√©rie original $y_t$ √© obtida pela soma acumulada das mudan√ßas $\Delta y_t$.
II. Cada choque $\epsilon_t$ afeta $\Delta y_t$ no per√≠odo atual, e a influ√™ncia do choque depende da forma de $\psi(L)$.
III. No entanto, como $\Delta y_t = y_t - y_{t-1}$, o efeito do choque sobre o n√≠vel da s√©rie $y_t$ se propaga para os per√≠odos seguintes, devido ao componente autoregressivo. O efeito do choque √© acumulativo, e n√£o desaparece com o tempo.
IV. A s√©rie original $y_t$ acumula todos os choques $\epsilon_t$ ao longo do tempo, e a deriva $\delta$.
V. Portanto, os choques t√™m efeitos permanentes sobre o n√≠vel da s√©rie original $y_t$, enquanto os seus efeitos sobre a s√©rie diferenciada $\Delta y_t$ s√£o tempor√°rios, ou seja, os choques afetam os n√≠veis da s√©rie original de forma permanente, e o componente diferenciado da s√©rie de forma tempor√°ria.  $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
> *   **Passeio Aleat√≥rio com Deriva:** Em um passeio aleat√≥rio com deriva, $y_t = y_{t-1} + \delta + \epsilon_t$, um choque $\epsilon_t$ tem um efeito permanente sobre o n√≠vel da s√©rie, pois $y_{t+1} = y_t + \delta + \epsilon_{t+1} = y_{t-1} + 2\delta + \epsilon_t + \epsilon_{t+1}$, e assim por diante. O choque $\epsilon_t$ permanece na s√©rie para sempre. A primeira diferen√ßa, $\Delta y_t = \delta + \epsilon_t$  √© um ru√≠do branco com m√©dia $\delta$, o que indica que os choques s√£o tempor√°rios sobre a diferen√ßa da s√©rie.
> *   **Modelo com Raiz Unit√°ria e AR(1):** Suponha que $(1-L)y_t = 0.1 + 0.8(1-L)y_{t-1} + \epsilon_t$. Aqui,  $\Delta y_t = 0.1 + 0.8\Delta y_{t-1} + \epsilon_t$, o que implica que os choques t√™m efeitos persistentes sobre a primeira diferen√ßa, que √© estacion√°ria, mas o efeito dos choques sobre a s√©rie original $y_t$ √© permanente.
>   * **C√°lculo:** Se $\epsilon_t$ √© um choque em $t=1$, ent√£o $\Delta y_1 =  0.1 + \epsilon_1$. Em $t=2$, $\Delta y_2 = 0.1 + 0.8\Delta y_1 + \epsilon_2 =  0.1 + 0.8(0.1+\epsilon_1) + \epsilon_2$. O efeito do choque $\epsilon_1$ persiste sobre $\Delta y_t$ para per√≠odos futuros. A s√©rie original $y_t$ √© obtida pela soma acumulada de $\Delta y_t$, e o efeito do choque √© permanente.
>  * **Interpreta√ß√£o:** Choques no componente estacion√°rio $\Delta y_t$ s√£o persistentes, mas os efeitos dos choques na s√©rie original $y_t$ s√£o permanentes, devido √† raiz unit√°ria.

**Teorema 2:** *Se $y_t$ √© uma s√©rie I(1) e $\Delta y_t = (1-L)y_t$, ent√£o a s√©rie $y_t$ pode ser representada como a soma de um passeio aleat√≥rio com deriva e um componente estacion√°rio.  Ou seja, existe uma representa√ß√£o da s√©rie $y_t$ dada por $y_t = \mu + \sum_{i=1}^t (\delta + \psi(L)\epsilon_i)$, onde $\mu$ √© um termo constante que representa a condi√ß√£o inicial da s√©rie, e a somat√≥ria representa os efeitos cumulativos da deriva e dos choques ao longo do tempo. Essa representa√ß√£o explicita o efeito cumulativo dos choques sobre o n√≠vel da s√©rie original.*
*Prova:*
I.  Sabemos que $(1-L)y_t = \delta + \psi(L)\epsilon_t$.
II.  Reescrevendo, temos que $y_t = y_{t-1} + \delta + \psi(L)\epsilon_t$.
III. Usando o processo de substitui√ß√£o iterativa, podemos escrever:
    $y_t = y_{t-1} + \delta + \psi(L)\epsilon_t $
    $y_{t-1} = y_{t-2} + \delta + \psi(L)\epsilon_{t-1} $
    $y_{t-2} = y_{t-3} + \delta + \psi(L)\epsilon_{t-2} $
    ...
    $y_1 = y_0 + \delta + \psi(L)\epsilon_1$
IV. Substituindo recursivamente, obtemos:
    $y_t = y_0 + t\delta + \sum_{i=1}^t \psi(L)\epsilon_i$
V.  Definindo $\mu = y_0$, temos:
    $y_t = \mu + t\delta + \sum_{i=1}^t \psi(L)\epsilon_i$
VI. A representa√ß√£o $y_t = \mu + \sum_{i=1}^t (\delta + \psi(L)\epsilon_i)$ √© equivalente, onde $\mu$ representa a condi√ß√£o inicial,  $\sum_{i=1}^t \delta = t\delta$, e $\sum_{i=1}^t \psi(L)\epsilon_i$ representa o componente cumulativo estoc√°stico.
VII. Portanto, a s√©rie $y_t$ √© a soma de um termo inicial, um termo de tend√™ncia determin√≠stico, e um termo cumulativo estoc√°stico. $\blacksquare$

### Implica√ß√µes Pr√°ticas dos Modelos de Raiz Unit√°ria

Os modelos de raiz unit√°ria t√™m diversas implica√ß√µes pr√°ticas:

1.  **Modelagem de Vari√°veis Econ√¥micas:** S√£o amplamente usados para modelar vari√°veis macroecon√¥micas como o PIB, a infla√ß√£o, e o c√¢mbio, que geralmente exibem caracter√≠sticas de n√£o estacionaridade com persist√™ncia de choques. O uso de modelos com raiz unit√°ria permite modelar a trajet√≥ria dessas vari√°veis de forma mais precisa.
2. **Previs√£o:** A previs√£o de s√©ries temporais com raiz unit√°ria envolve projetar as mudan√ßas na s√©rie, e n√£o os n√≠veis da s√©rie original. A incerteza das previs√µes aumenta com o horizonte de tempo, refletindo a natureza n√£o estacion√°ria da s√©rie original.
3. **An√°lise de Pol√≠ticas P√∫blicas:** Os efeitos de pol√≠ticas econ√¥micas sobre vari√°veis com raiz unit√°ria s√£o persistentes. Uma mudan√ßa na taxa de juros, por exemplo, pode ter efeitos duradouros sobre o n√≠vel de investimento, que podem ser modelados por modelos com raiz unit√°ria.
4. **Testes de Raiz Unit√°ria:** Os testes de raiz unit√°ria s√£o usados para verificar a presen√ßa de raiz unit√°ria em uma s√©rie temporal. O resultado do teste √© uma informa√ß√£o fundamental para a escolha de modelos adequados.
5.  **An√°lise de Cointegra√ß√£o:** Modelos de raiz unit√°ria s√£o importantes para a an√°lise de cointegra√ß√£o, onde duas ou mais s√©ries n√£o estacion√°rias est√£o relacionadas no longo prazo. A cointegra√ß√£o implica que uma combina√ß√£o linear das s√©ries √© estacion√°ria.
6. **Interpreta√ß√£o da Din√¢mica**: A an√°lise do componente estacion√°rio da s√©rie diferenciada, atrav√©s da an√°lise do operador $\psi(L)$, permite identificar a din√¢mica de curto prazo da s√©rie, e a persist√™ncia dos choques sobre a s√©rie original.
> üí° **Exemplo Num√©rico:**
>
> *   **Modelagem do PIB:** Se o teste de raiz unit√°ria indicar que o PIB tem raiz unit√°ria, podemos modelar a primeira diferen√ßa do PIB (o crescimento do PIB) como um processo ARMA, e modelar a persist√™ncia dos choques sobre o n√≠vel do PIB atrav√©s do modelo com raiz unit√°ria.
>
> *   **Previs√£o de Pre√ßos de Ativos:** Se um ativo financeiro seguir um passeio aleat√≥rio com deriva, o modelo com raiz unit√°ria pode ser usado para projetar o pre√ßo do ativo no futuro. A incerteza da previs√£o aumenta com o tempo, devido √† natureza n√£o estacion√°ria do modelo.
>
> *   **An√°lise de Pol√≠ticas:** Se uma pol√≠tica econ√¥mica tiver como objetivo aumentar o emprego, a modelagem da vari√°vel "taxa de desemprego" com um modelo com raiz unit√°ria permite avaliar os efeitos de longo prazo da pol√≠tica, incluindo a persist√™ncia dos efeitos.
>
> *   **Testes de Raiz Unit√°ria:** A aplica√ß√£o do teste de raiz unit√°ria sobre a s√©rie de pre√ßos de um ativo financeiro permite verificar se a s√©rie tem raiz unit√°ria, e se um modelo com raiz unit√°ria √© adequado para a modelagem.
>
> *   **An√°lise de Cointegra√ß√£o:** Se a taxa de juros de longo e curto prazo tiver raiz unit√°ria, um teste de cointegra√ß√£o pode verificar se existe uma rela√ß√£o de longo prazo entre essas taxas, e um modelo de corre√ß√£o de erros pode ser utilizado para modelar essa rela√ß√£o.
>
> * **Interpreta√ß√£o da Din√¢mica:** Se o modelo da diferen√ßa de uma s√©rie temporal, $\Delta y_t$, indicar que essa s√©rie segue um processo autoregressivo de primeira ordem com par√¢metro pr√≥ximo de 1, o modelo sugere que os choques t√™m efeitos persistentes. Se o par√¢metro autoregressivo for pr√≥ximo de 0, os efeitos dos choques s√£o de curto prazo.
>
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> delta_sim = 0.1  # Drift
> phi_sim = 0.8 # autoregressive coefficient
> T_sim = 100 # length
> sigma_sim = 1
> np.random.seed(42)
> epsilon_sim = np.random.normal(0, sigma_sim, T_sim)
>
> # Simulate a time series with unit root and AR(1)
> y_sim = np.zeros(T_sim)
> for t in range(1, T_sim):
>   y_sim[t] = y_sim[t-1] + delta_sim + (phi_sim*epsilon_sim[t-1] + epsilon_sim[t])
>
>
> # Plot the simulated series
> plt.figure(figsize=(10, 6))
> plt.plot(y_sim)
> plt.xlabel('Time (t)')
> plt.ylabel('Value of y_t')
> plt.title('Simulated Time Series with Unit Root and AR(1) Component')
> plt.grid(True)
> plt.show()
>
> # Compute and Plot the first difference of y
> delta_y_sim = np.diff(y_sim)
>
> plt.figure(figsize=(10, 6))
> plt.plot(delta_y_sim)
> plt.xlabel('Time (t)')
> plt.ylabel('Value of Œîy_t')
> plt.title('First difference of simulated Time Series')
> plt.grid(True)
> plt.show()
> ```
**Observa√ß√£o 1:** *A opera√ß√£o de diferencia√ß√£o $(1-L)$ tem o efeito de remover tend√™ncias estoc√°sticas e determin√≠sticas de uma s√©rie temporal, e o processo de diferencia√ß√£o √© uma t√©cnica de modelagem que pode gerar s√©ries temporais estacion√°rias a partir de s√©ries n√£o estacion√°rias.*
*Prova:*
I. Em um modelo com raiz unit√°ria, a s√©rie original $y_t$ n√£o √© estacion√°ria devido a um componente estoc√°stico com efeitos permanentes (a raiz unit√°ria).
II.  A opera√ß√£o de primeira diferen√ßa $(1-L)$ aplicada √† s√©rie $y_t$ remove a raiz unit√°ria, transformando a s√©rie em $\Delta y_t$, que √© estacion√°ria.
III. A deriva $\delta$ em $(1-L)y_t = \delta + \psi(L)\epsilon_t$ introduz uma tend√™ncia determin√≠stica, que √© capturada na m√©dia da s√©rie $\Delta y_t$.
IV. A opera√ß√£o $(1-L)$ remove tanto a tend√™ncia estoc√°stica, causada pela raiz unit√°ria, como tamb√©m a tend√™ncia determin√≠stica causada pela deriva $\delta$ da s√©rie $y_t$.
V. Portanto, a diferencia√ß√£o √© uma t√©cnica de modelagem que remove a n√£o estacionaridade, e gera uma s√©rie estacion√°ria que pode ser analisada com as ferramentas da teoria de s√©ries temporais.

### Conclus√£o

Neste cap√≠tulo, exploramos em detalhe os modelos de raiz unit√°ria, com √™nfase na especifica√ß√£o de que a primeira diferen√ßa da s√©rie temporal √© estacion√°ria. Analisamos o papel fundamental do operador de primeira diferen√ßa $(1-L)$, e como ele transforma uma s√©rie n√£o estacion√°ria em uma estacion√°ria. Vimos que a representa√ß√£o de um modelo com raiz unit√°ria √© dada por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, e analisamos o caso particular do passeioaleat√≥rio com deriva, onde $\psi(L)=0$. Agora, vamos considerar o modelo AR(1) com raiz unit√°ria, que √© dado por $y_t = y_{t-1} + \phi_1 y_{t-1} + \epsilon_t$. Reescrevendo, temos $(1 - (1-\phi_1)L)y_t = \epsilon_t$.

Neste caso, para ter uma raiz unit√°ria, precisamos que $1-\phi_1 = 1$, ou seja, $\phi_1 = 0$. Portanto, o modelo se reduz a $y_t = y_{t-1} + \epsilon_t$, que √© um passeio aleat√≥rio.

Agora, vamos considerar o caso geral de um modelo AR(p) com raiz unit√°ria. Podemos escrever o modelo AR(p) como $y_t = \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t$. Usando o operador de defasagem, temos $(1-\phi_1 L - \phi_2 L^2 - \dots - \phi_p L^p)y_t = \epsilon_t$, que podemos escrever como $\phi(L)y_t = \epsilon_t$, onde $\phi(L) = 1-\phi_1 L - \phi_2 L^2 - \dots - \phi_p L^p$.

Para que o modelo tenha uma raiz unit√°ria, o polin√¥mio $\phi(L)$ deve ter uma raiz igual a 1. Isso significa que $\phi(1) = 1 - \phi_1 - \phi_2 - \dots - \phi_p = 0$, ou seja, a soma dos coeficientes do polin√¥mio autoregressivo deve ser igual a 1.

Podemos reescrever o modelo com uma raiz unit√°ria como $(1-L)y_t = \delta + \psi(L)\epsilon_t$, onde $\delta$ representa a deriva e $\psi(L)$ √© um polin√¥mio em $L$ que representa a parte estacion√°ria do modelo. Para um modelo AR(p), $\psi(L)$ √© obtido a partir do polin√¥mio autoregressivo $\phi(L)$.

A presen√ßa de uma raiz unit√°ria tem implica√ß√µes importantes para a an√°lise de s√©ries temporais. S√©ries com raiz unit√°ria n√£o s√£o estacion√°rias, o que significa que sua m√©dia e vari√¢ncia mudam ao longo do tempo. Isso exige tratamento especial antes de se aplicar t√©cnicas de modelagem estat√≠stica padr√£o. As transforma√ß√µes comumente usadas para lidar com ra√≠zes unit√°rias s√£o a diferencia√ß√£o, ou seja, tomar diferen√ßas sucessivas da s√©rie.

### Teste de Raiz Unit√°ria

Para verificar a presen√ßa de ra√≠zes unit√°rias em uma s√©rie temporal, realizamos testes de raiz unit√°ria. O teste mais comum √© o Teste de Dickey-Fuller (DF) e suas varia√ß√µes, como o Teste de Dickey-Fuller Aumentado (ADF).

O Teste DF testa a hip√≥tese nula de que a s√©rie tem uma raiz unit√°ria contra a hip√≥tese alternativa de que a s√©rie √© estacion√°ria. A estat√≠stica do teste DF √© baseada em um modelo autoregressivo da forma:

$$\Delta y_t = \rho y_{t-1} + \epsilon_t$$

Onde $\Delta y_t = y_t - y_{t-1}$. A hip√≥tese nula de raiz unit√°ria √© dada por $H_0: \rho = 0$. Se rejeitarmos a hip√≥tese nula, conclu√≠mos que a s√©rie √© estacion√°ria.

O Teste ADF estende o teste DF adicionando defasagens da diferen√ßa de $y_t$ para remover qualquer autocorrela√ß√£o restante nos res√≠duos:

$$\Delta y_t = \rho y_{t-1} + \sum_{i=1}^p \beta_i \Delta y_{t-i} + \epsilon_t$$

A hip√≥tese nula para o Teste ADF √© a mesma do Teste DF, $H_0: \rho = 0$.

Os testes de raiz unit√°ria s√£o cruciais para determinar o tratamento apropriado para s√©ries temporais. Se a s√©rie tem raiz unit√°ria, precisamos diferenci√°-la antes de model√°-la. Se a s√©rie n√£o tem raiz unit√°ria, podemos usar os m√©todos de modelagem de s√©ries temporais estacion√°rias.

<!-- END -->
