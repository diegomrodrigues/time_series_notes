## Modelos de S√©ries Temporais N√£o Estacion√°rias: Limita√ß√µes da Expectativa Condicional e a Necessidade de Modelagem de Tend√™ncias

### Introdu√ß√£o

Este cap√≠tulo avan√ßa na discuss√£o sobre modelos de s√©ries temporais n√£o estacion√°rias, explorando as limita√ß√µes da premissa de que a expectativa incondicional da vari√°vel √© constante, $E(y_t) = \mu$, e que a proje√ß√£o linear de $y_{t+s}$ sobre o passado converge para essa m√©dia, $\lim_{s\to\infty} \hat{y}_{t+s|t} = \mu$. Como mencionado anteriormente, esta propriedade, embora v√°lida para s√©ries temporais estacion√°rias, √© inadequada para muitas s√©ries econ√¥micas e financeiras que exibem tend√™ncias claras [^1]. A necessidade de modelar essas tend√™ncias, atrav√©s de abordagens como a inclus√£o de tend√™ncias determin√≠sticas e a modelagem de processos de raiz unit√°ria, torna-se imperativa para obter previs√µes precisas e an√°lises robustas. Expandiremos nosso entendimento sobre a transi√ß√£o de processos estacion√°rios para n√£o estacion√°rios e suas implica√ß√µes pr√°ticas.

### Conceitos Fundamentais

Em processos estacion√°rios, como abordado nos cap√≠tulos iniciais, a expectativa incondicional de uma vari√°vel √© constante e independente do tempo, expressa como $E(y_t) = \mu$ [^1]. Al√©m disso, √† medida que o horizonte de previs√£o aumenta, a previs√£o condicional de $y_{t+s}$ tende a convergir para esta m√©dia incondicional: $\lim_{s\to\infty} \hat{y}_{t+s|t} = \mu$ [^1]. Essa propriedade decorre da estacionaridade da s√©rie, que implica que seus momentos (m√©dia, vari√¢ncia, autocovari√¢ncia) s√£o invariantes no tempo. No entanto, esta premissa √© frequentemente violada em s√©ries temporais econ√¥micas e financeiras, que frequentemente apresentam tend√™ncias ascendentes ou descendentes ao longo do tempo, como o Produto Interno Bruto (PIB), taxas de juros e pre√ßos de ativos [^1].

> üí° **Exemplo Num√©rico:** Considere um processo estacion√°rio $y_t = 5 + 0.7\epsilon_{t-1} + \epsilon_t$, onde $\epsilon_t$ √© ru√≠do branco com m√©dia zero e vari√¢ncia 1. A esperan√ßa incondicional √© $E(y_t) = 5$. A medida que o horizonte de previs√£o aumenta, a previs√£o condicional $\hat{y}_{t+s|t}$ converge para 5. Isto significa que, mesmo que a s√©rie possa apresentar flutua√ß√µes tempor√°rias, ela sempre retorna ao n√≠vel de 5. Isto √© apropriado para vari√°veis que n√£o t√™m tend√™ncias.

```python
import numpy as np
import matplotlib.pyplot as plt

# Simula√ß√£o de um processo estacion√°rio
np.random.seed(42)
T = 100
mu = 5
psi_1 = 0.7
epsilon = np.random.normal(0, 1, T+100)
y = np.zeros(T+100)
for t in range(1,T+100):
    y[t] = mu + psi_1*epsilon[t-1] + epsilon[t]

# Previs√£o do processo
forecasts = np.zeros(T+100)
for s in range(1, 101):
  forecasts[T+s-1] = mu + 0 if (s > 0) else y[T-1]

plt.plot(range(1,T+101), y[1:], label='S√©rie Estacion√°ria')
plt.axhline(y=mu, color='r', linestyle='--', label="Expectativa Incondicional")
plt.plot(range(T,T+100), forecasts[T:T+100], label='Previs√£o Convergindo para a M√©dia')
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.legend()
plt.title('Previs√£o em S√©rie Temporal Estacion√°ria')
plt.show()
```
Este exemplo demonstra como a previs√£o converge para a m√©dia em um processo estacion√°rio.

Para modelar s√©ries temporais com tend√™ncias, s√£o utilizadas duas abordagens principais:

1.  **Tend√™ncia Determin√≠stica:** A m√©dia $\mu$ √© substitu√≠da por uma fun√ß√£o linear do tempo, $y_t = \alpha + \delta t + \psi(L)\epsilon_t$ [^1]. Este modelo captura a tend√™ncia da s√©rie atrav√©s da fun√ß√£o $\alpha + \delta t$, onde $\alpha$ √© o intercepto e $\delta$ √© a inclina√ß√£o da tend√™ncia. A remo√ß√£o da tend√™ncia resulta em um processo estacion√°rio. No entanto, a previs√£o em processos trend-stationary n√£o converge para uma m√©dia constante, mas sim para uma linha reta com inclina√ß√£o $\delta$.

> üí° **Exemplo Num√©rico:** Considere a s√©rie $y_t = 10 + 2t + \epsilon_t$, onde $\epsilon_t$ √© um ru√≠do branco com m√©dia 0 e vari√¢ncia 4. Aqui, $\alpha = 10$ e $\delta = 2$. Para um tempo $t=5$, a tend√™ncia determin√≠stica √© $10 + 2(5) = 20$. As previs√µes para o futuro convergir√£o para esta tend√™ncia, em vez de uma m√©dia constante. Especificamente, $\hat{y}_{t+s|t} = 10 + 2(t+s)$, indicando que as previs√µes acompanhar√£o a tend√™ncia crescente. Para ilustrar, a previs√£o para $t+1$ dado $t=5$ √© $\hat{y}_{6|5} = 10 + 2(6) = 22$.

2.  **Processo de Raiz Unit√°ria:** A primeira diferen√ßa da s√©rie √© modelada como um processo estacion√°rio, $(1-L)y_t = \delta + \psi(L)\epsilon_t$ [^1]. Este modelo n√£o assume uma tend√™ncia determin√≠stica, mas sim um componente estoc√°stico que pode levar a um crescimento ou decl√≠nio persistente. Similarmente ao modelo trend-stationary, a previs√£o de um processo com raiz unit√°ria tamb√©m n√£o converge para uma m√©dia constante, mas sim para uma linha com inclina√ß√£o $\delta$.

> üí° **Exemplo Num√©rico:** Considere o processo de raiz unit√°ria $\Delta y_t = 0.3 + \epsilon_t$, com $\epsilon_t$ sendo ru√≠do branco com m√©dia 0 e vari√¢ncia 1. Aqui, $\delta = 0.3$. A previs√£o da varia√ß√£o √© sempre 0.3. O n√≠vel da s√©rie, $y_t$, ir√° seguir um *random walk* com um drift de 0.3. As previs√µes futuras n√£o convergem para uma m√©dia, mas seguem uma trajet√≥ria com uma inclina√ß√£o de aproximadamente 0.3 vezes o horizonte da previs√£o,  $\hat{y}_{t+s|t} = y_t + 0.3s$, onde $y_t$ √© o √∫ltimo valor observado. Se $y_{10}=15$, a previs√£o para $y_{15}$ √© aproximadamente $\hat{y}_{15|10}= 15 + 0.3 \times 5 = 16.5$.

A principal limita√ß√£o da premissa de m√©dia constante e converg√™ncia das previs√µes para essa m√©dia est√° em sua incapacidade de capturar o comportamento de s√©ries temporais com tend√™ncias. Em s√©ries econ√¥micas e financeiras, √© comum observar que os n√≠veis das vari√°veis n√£o permanecem constantes ao longo do tempo, e que a previs√£o deve levar em conta a tend√™ncia. Os modelos de tend√™ncia determin√≠stica e raiz unit√°ria s√£o projetados especificamente para superar essa limita√ß√£o, ao permitir que a m√©dia e a previs√£o evoluam ao longo do tempo, seja atrav√©s da fun√ß√£o linear $\alpha + \delta t$ ou pela modelagem de um processo n√£o estacion√°rio com impacto persistente de choques.

**Lema 4:** *Em um processo trend-stationary, $y_t = \alpha + \delta t + \psi(L)\epsilon_t$, a esperan√ßa condicional da s√©rie n√£o converge para uma constante, mas sim para a linha de tend√™ncia $\alpha + \delta t$ quando o horizonte de previs√£o se estende.*

*Prova:*
I. Para um processo trend-stationary $y_t = \alpha + \delta t + \psi(L)\epsilon_t$, a previs√£o de $y_{t+s}$ √© dada por $\hat{y}_{t+s|t} = \alpha + \delta(t+s) + \psi_s(L)\epsilon_t$ [^4].
II. √Ä medida que $s \to \infty$, o componente estacion√°rio $\psi_s(L)\epsilon_t$ tende a zero.
III. Portanto, $\lim_{s\to\infty} \hat{y}_{t+s|t} = \alpha + \delta(t+s)$, que √© uma fun√ß√£o linear do tempo com inclina√ß√£o $\delta$.
IV. Consequentemente, a previs√£o n√£o converge para uma m√©dia constante, mas sim para uma tend√™ncia linear.  ‚ñ†

> üí° **Exemplo Num√©rico:** Considere o processo trend-stationary $y_t = 2 + 0.5t + \epsilon_t$, onde $\epsilon_t$ √© ru√≠do branco com m√©dia 0 e desvio padr√£o 1. A esperan√ßa condicional de $y_{t+s}$ quando $s \to \infty$ √© $\hat{y}_{t+s|t} = 2 + 0.5(t+s)$. Vemos que a previs√£o n√£o converge para uma m√©dia constante, mas sim para uma linha crescente, ilustrando que o modelo trend-stationary captura a tend√™ncia presente na s√©rie.

```python
import numpy as np
import matplotlib.pyplot as plt

# Simula√ß√£o do processo trend-stationary
np.random.seed(42)
T = 100
alpha = 2
delta = 0.5
epsilon = np.random.normal(0, 1, T+100)
t = np.arange(1, T+101)
y = alpha + delta * t + epsilon
# Previs√£o do processo
forecasts = np.zeros(T+100)
for s in range(1, 101):
  forecasts[T+s-1] = alpha + delta * (T+s)

plt.plot(t, y, label='S√©rie Trend-Stationary')
plt.plot(range(T,T+100), forecasts[T:T+100], label="Previs√£o da Tend√™ncia")
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.legend()
plt.title('Previs√£o em S√©rie Temporal Trend-Stationary')
plt.show()
```
Este exemplo demonstra como a previs√£o converge para a tend√™ncia linear em um processo trend-stationary.

**Teorema 4:** *Em um processo de raiz unit√°ria, $(1-L)y_t = \delta + \psi(L)\epsilon_t$, a esperan√ßa condicional n√£o converge para uma constante, mas sim para uma linha com inclina√ß√£o $\delta$, cujo intercepto √© atualizado a cada nova observa√ß√£o $y_t$ quando o horizonte de previs√£o se estende.*

*Prova:*
I. Para um processo de raiz unit√°ria $(1-L)y_t = \delta + \psi(L)\epsilon_t$, a previs√£o de $y_{t+s}$ √© dada por $\hat{y}_{t+s|t} = y_t + s\delta + \psi_s(L)\epsilon_t$ [^4].
II. √Ä medida que $s \to \infty$, o componente estacion√°rio $\psi_s(L)\epsilon_t$ tende a zero.
III. Portanto, $\lim_{s\to\infty} \hat{y}_{t+s|t} = y_t + s\delta$, que √© uma fun√ß√£o linear do tempo com inclina√ß√£o $\delta$. O intercepto $y_t$ depende do √∫ltimo valor observado da s√©rie.
IV. Assim, a previs√£o n√£o converge para uma m√©dia constante, mas para uma linha cuja posi√ß√£o depende do valor atual da s√©rie. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere o processo de raiz unit√°ria (random walk com drift) $\Delta y_t = 0.1 + \epsilon_t$, com $\epsilon_t$ ru√≠do branco.  A previs√£o de $y_{t+s}$ para um horizonte grande ($s \to \infty$) √© $\hat{y}_{t+s|t} = y_t + 0.1s$. O intercepto depende do √∫ltimo valor observado $y_t$ e a inclina√ß√£o da previs√£o √© 0.1. Isso demonstra que a previs√£o converge para uma linha cuja posi√ß√£o depende do √∫ltimo valor da s√©rie.

```python
import numpy as np
import matplotlib.pyplot as plt

# Simula√ß√£o do processo de raiz unit√°ria
np.random.seed(42)
T = 100
delta = 0.1
epsilon = np.random.normal(0, 1, T+100)
y = np.zeros(T+100)

for t in range(1,T+100):
  y[t] = y[t-1] + delta + epsilon[t]
# Previs√£o do processo
forecasts = np.zeros(T+100)
for s in range(1, 101):
  forecasts[T+s-1] = y[T-1] + delta * s

plt.plot(range(1,T+101), y[1:], label='S√©rie Unit Root')
plt.plot(range(T,T+100), forecasts[T:T+100], label="Previs√£o para a Tend√™ncia")
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.legend()
plt.title('Previs√£o em S√©rie Temporal com Raiz Unit√°ria')
plt.show()
```
Este exemplo demonstra como a previs√£o converge para uma linha com inclina√ß√£o $\delta$, onde o intercepto √© atualizado de acordo com a √∫ltima observa√ß√£o, em um processo de raiz unit√°ria.

**Lema 4.1:** *A persist√™ncia de choques √© diferente em modelos trend-stationary e modelos unit root. Em modelos trend-stationary, choques t√™m efeito tempor√°rio, enquanto em modelos unit root, choques t√™m um efeito persistente ou permanente.*

*Prova:*
I. Em modelos *trend-stationary*, a s√©rie retorna √† tend√™ncia linear ap√≥s um choque. Isso significa que o efeito de um choque $\epsilon_t$ sobre o n√≠vel da s√©rie $y_t$ diminui ao longo do tempo devido √† estacionariedade do componente $\psi(L)\epsilon_t$.
II. Em modelos de *unit root*, um choque $\epsilon_t$ afeta o n√≠vel da s√©rie de forma permanente, pois a s√©rie n√£o possui tend√™ncia linear ao redor da qual ir√° retornar.
III. A equa√ß√£o $(1-L)y_t = \delta + \psi(L)\epsilon_t$ mostra que um choque $\epsilon_t$ √© integrado √† s√©rie a partir do momento em que ocorre, influenciando os valores futuros.
IV.  Portanto, em modelos *trend-stationary* os choques s√£o tempor√°rios, e em modelos *unit root*, os choques t√™m um impacto permanente. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere novamente os modelos $y_t = 2 + 0.5t + \epsilon_t$ (trend-stationary) e $\Delta y_t = 0.1 + \epsilon_t$ (raiz unit√°ria). Um choque positivo em $\epsilon_t$ causar√° um desvio tempor√°rio em torno da tend√™ncia linear para o primeiro caso, e uma mudan√ßa permanente no n√≠vel da s√©rie, para o segundo. Para o modelo *trend-stationary*, se $\epsilon_1$ for 2, $y_1$ ser√° 4.5 (2 + 0.5*1 + 2), mas ao longo do tempo o efeito de $\epsilon_1$ desaparece. Para o modelo *unit root*, se $\epsilon_1$ for 2, ent√£o $y_1 = y_0 + 0.1 + 2$, e o efeito de 2 √© mantido ao longo do tempo. Se $y_0$ era zero, $y_1$ ser√° 2.1, $y_2$ ser√° aproximadamente $2.1 + 0.1 + \epsilon_2$, e assim por diante.

**Proposi√ß√£o 1:** *Um processo com raiz unit√°ria, $\Delta y_t = \delta + \psi(L)\epsilon_t$, pode ser transformado em um processo trend-stationary adicionando um componente de tend√™ncia determin√≠stica.*

*Prova:*
I. Come√ßamos com o processo de raiz unit√°ria $\Delta y_t = \delta + \psi(L)\epsilon_t$.
II. Somando e subtraindo $\delta t$ a esta equa√ß√£o, temos $\Delta y_t - \delta = \psi(L)\epsilon_t$.
III. Integrando ambos os lados, obtemos $y_t - \delta t = \int \psi(L)\epsilon_t \, dt$.
IV. Se definirmos $z_t = y_t - \delta t$ e  considerando que a integral de um processo estacion√°rio resulta em um processo tamb√©m estacion√°rio quando este √∫ltimo possui m√©dia 0, ent√£o $z_t$ √© estacion√°rio.
V. Portanto, podemos expressar $y_t$ como $y_t = \delta t + z_t$, onde $z_t$ √© um processo estacion√°rio.
VI. Isso mostra que o processo original de raiz unit√°ria pode ser visto como um processo trend-stationary ap√≥s a adi√ß√£o do componente de tend√™ncia determin√≠stica $\delta t$.  ‚ñ†
> üí° **Observa√ß√£o:** Esta proposi√ß√£o destaca a dualidade entre os modelos de raiz unit√°ria e trend-stationary. A adi√ß√£o de uma tend√™ncia determin√≠stica a um processo de raiz unit√°ria pode resultar em um processo com um comportamento semelhante ao de um processo trend-stationary, e vice-versa.  A escolha entre modelar uma tend√™ncia determin√≠stica ou um processo com raiz unit√°ria depende da interpreta√ß√£o econ√¥mica e das caracter√≠sticas espec√≠ficas da s√©rie temporal. Por exemplo, se um choque tem um efeito persistente, a melhor op√ß√£o seria o modelo de raiz unit√°ria. Se acreditamos que a s√©rie tem uma tend√™ncia fundamental, o modelo trend-stationary seria mais adequado.

### Implica√ß√µes Pr√°ticas

A inadequa√ß√£o da premissa de esperan√ßa incondicional constante e converg√™ncia para a m√©dia em s√©ries temporais com tend√™ncias √© um problema central na modelagem de dados econ√¥micos e financeiros. A modelagem de tend√™ncias, seja atrav√©s de tend√™ncias determin√≠sticas ou processos de raiz unit√°ria, √© essencial para obter previs√µes precisas e analisar a din√¢mica dessas s√©ries.

*   **Modelos Trend-Stationary:** Adequados quando se assume que a s√©rie flutua em torno de uma tend√™ncia determin√≠stica. A an√°lise envolve a estima√ß√£o de par√¢metros da tend√™ncia linear e o estudo das flutua√ß√µes estacion√°rias ao redor dessa tend√™ncia.
*   **Modelos Unit Root:** Adequados quando se assume que a s√©rie n√£o tem uma tend√™ncia determin√≠stica, mas sim um comportamento estoc√°stico que pode levar a mudan√ßas de n√≠vel persistentes. A an√°lise envolve a diferencia√ß√£o da s√©rie, a modelagem do componente estacion√°rio resultante e a an√°lise do impacto persistente de choques.

A escolha entre esses modelos √© crucial para a interpreta√ß√£o dos resultados e para a previs√£o da s√©rie. Em s√©ries com tend√™ncias claras, o uso de modelos estacion√°rios pode levar a conclus√µes err√¥neas e previs√µes imprecisas. Os modelos de tend√™ncia determin√≠stica e raiz unit√°ria oferecem uma abordagem mais adequada para lidar com essa complexidade, ao permitir uma an√°lise mais completa e realista do comportamento de s√©ries temporais n√£o estacion√°rias. √â tamb√©m importante notar que a an√°lise da vari√¢ncia do erro de previs√£o tamb√©m se torna diferente quando s√£o considerados modelos com tend√™ncias, como visto no cap√≠tulo anterior.

> üí° **Exemplo Comparativo:** Imagine modelar o PIB de um pa√≠s. Se usarmos um modelo estacion√°rio, a previs√£o sempre retornaria a uma m√©dia constante, o que √© claramente inadequado j√° que o PIB tipicamente cresce ao longo do tempo. O modelo trend-stationary capturaria uma tend√™ncia de crescimento, e o modelo unit root, com um drift, capturaria o crescimento persistente da s√©rie. A escolha dependeria se acreditamos que o crescimento do PIB segue uma tend√™ncia linear determinada ou √© mais um processo estoc√°stico com choques permanentes. Em geral, para dados de PIB, um modelo de raiz unit√°ria seria mais apropriado.

### Conclus√£o

A premissa de que a esperan√ßa incondicional da vari√°vel √© constante e que as previs√µes convergem para essa m√©dia √© uma simplifica√ß√£o que pode ser inadequada para muitas s√©ries temporais econ√¥micas e financeiras, que exibem tend√™ncias claras. Os modelos de tend√™ncia determin√≠stica e raiz unit√°ria s√£o ferramentas essenciais para superar essa limita√ß√£o, permitindo modelar a din√¢mica complexa de s√©ries temporais n√£o estacion√°rias. A modelagem de tend√™ncias n√£o estacion√°rias implica que a previs√£o n√£o converge para uma m√©dia fixa, mas sim para uma tend√™ncia linear, cuja inclina√ß√£o √© dada pelo par√¢metro $\delta$ do modelo, e cujo intercepto pode variar com o tempo. A an√°lise da persist√™ncia de choques tamb√©m se torna diferente, com modelos *trend-stationary* apresentando choques tempor√°rios e modelos com raiz unit√°ria, choques permanentes, como demonstrado neste cap√≠tulo. As implica√ß√µes computacionais dessa escolha foram abordadas no cap√≠tulo anterior. A escolha entre os modelos *trend-stationary* e *unit root*, portanto, deve ser feita levando em considera√ß√£o a natureza das tend√™ncias presentes na s√©rie temporal.

### Refer√™ncias
[^1]: [15.1.1]
[^4]: [15.3.1], [15.3.4]
<!-- END -->
