## Modelos de SÃ©ries Temporais NÃ£o EstacionÃ¡rias: LimitaÃ§Ãµes da Expectativa Condicional e a Necessidade de Modelagem de TendÃªncias

### IntroduÃ§Ã£o

Este capÃ­tulo avanÃ§a na discussÃ£o sobre modelos de sÃ©ries temporais nÃ£o estacionÃ¡rias, explorando as limitaÃ§Ãµes da premissa de que a expectativa incondicional da variÃ¡vel Ã© constante, $E(y_t) = \mu$, e que a projeÃ§Ã£o linear de $y_{t+s}$ sobre o passado converge para essa mÃ©dia, $\lim_{s\to\infty} \hat{y}_{t+s|t} = \mu$. Como mencionado anteriormente, esta propriedade, embora vÃ¡lida para sÃ©ries temporais estacionÃ¡rias, Ã© inadequada para muitas sÃ©ries econÃ´micas e financeiras que exibem tendÃªncias claras [^1]. A necessidade de modelar essas tendÃªncias, atravÃ©s de abordagens como a inclusÃ£o de tendÃªncias determinÃ­sticas e a modelagem de processos de raiz unitÃ¡ria, torna-se imperativa para obter previsÃµes precisas e anÃ¡lises robustas. Expandiremos nosso entendimento sobre a transiÃ§Ã£o de processos estacionÃ¡rios para nÃ£o estacionÃ¡rios e suas implicaÃ§Ãµes prÃ¡ticas.

### Conceitos Fundamentais

Em processos estacionÃ¡rios, como abordado nos capÃ­tulos iniciais, a expectativa incondicional de uma variÃ¡vel Ã© constante e independente do tempo, expressa como $E(y_t) = \mu$ [^1]. AlÃ©m disso, Ã  medida que o horizonte de previsÃ£o aumenta, a previsÃ£o condicional de $y_{t+s}$ tende a convergir para esta mÃ©dia incondicional: $\lim_{s\to\infty} \hat{y}_{t+s|t} = \mu$ [^1]. Essa propriedade decorre da estacionaridade da sÃ©rie, que implica que seus momentos (mÃ©dia, variÃ¢ncia, autocovariÃ¢ncia) sÃ£o invariantes no tempo. No entanto, esta premissa Ã© frequentemente violada em sÃ©ries temporais econÃ´micas e financeiras, que frequentemente apresentam tendÃªncias ascendentes ou descendentes ao longo do tempo, como o Produto Interno Bruto (PIB), taxas de juros e preÃ§os de ativos [^1].

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere um processo estacionÃ¡rio $y_t = 5 + 0.7\epsilon_{t-1} + \epsilon_t$, onde $\epsilon_t$ Ã© ruÃ­do branco com mÃ©dia zero e variÃ¢ncia 1. A esperanÃ§a incondicional Ã© $E(y_t) = 5$. A medida que o horizonte de previsÃ£o aumenta, a previsÃ£o condicional $\hat{y}_{t+s|t}$ converge para 5. Isto significa que, mesmo que a sÃ©rie possa apresentar flutuaÃ§Ãµes temporÃ¡rias, ela sempre retorna ao nÃ­vel de 5. Isto Ã© apropriado para variÃ¡veis que nÃ£o tÃªm tendÃªncias.

```python
import numpy as np
import matplotlib.pyplot as plt

# SimulaÃ§Ã£o de um processo estacionÃ¡rio
np.random.seed(42)
T = 100
mu = 5
psi_1 = 0.7
epsilon = np.random.normal(0, 1, T+100)
y = np.zeros(T+100)
for t in range(1,T+100):
    y[t] = mu + psi_1*epsilon[t-1] + epsilon[t]

# PrevisÃ£o do processo
forecasts = np.zeros(T+100)
for s in range(1, 101):
  forecasts[T+s-1] = mu + 0 if (s > 0) else y[T-1]

plt.plot(range(1,T+101), y[1:], label='SÃ©rie EstacionÃ¡ria')
plt.axhline(y=mu, color='r', linestyle='--', label="Expectativa Incondicional")
plt.plot(range(T,T+100), forecasts[T:T+100], label='PrevisÃ£o Convergindo para a MÃ©dia')
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.legend()
plt.title('PrevisÃ£o em SÃ©rie Temporal EstacionÃ¡ria')
plt.show()
```
Este exemplo demonstra como a previsÃ£o converge para a mÃ©dia em um processo estacionÃ¡rio.

Para modelar sÃ©ries temporais com tendÃªncias, sÃ£o utilizadas duas abordagens principais:

1.  **TendÃªncia DeterminÃ­stica:** A mÃ©dia $\mu$ Ã© substituÃ­da por uma funÃ§Ã£o linear do tempo, $y_t = \alpha + \delta t + \psi(L)\epsilon_t$ [^1]. Este modelo captura a tendÃªncia da sÃ©rie atravÃ©s da funÃ§Ã£o $\alpha + \delta t$, onde $\alpha$ Ã© o intercepto e $\delta$ Ã© a inclinaÃ§Ã£o da tendÃªncia. A remoÃ§Ã£o da tendÃªncia resulta em um processo estacionÃ¡rio. No entanto, a previsÃ£o em processos trend-stationary nÃ£o converge para uma mÃ©dia constante, mas sim para uma linha reta com inclinaÃ§Ã£o $\delta$.

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere a sÃ©rie $y_t = 10 + 2t + \epsilon_t$, onde $\epsilon_t$ Ã© um ruÃ­do branco com mÃ©dia 0 e variÃ¢ncia 4. Aqui, $\alpha = 10$ e $\delta = 2$. Para um tempo $t=5$, a tendÃªncia determinÃ­stica Ã© $10 + 2(5) = 20$. As previsÃµes para o futuro convergirÃ£o para esta tendÃªncia, em vez de uma mÃ©dia constante. Especificamente, $\hat{y}_{t+s|t} = 10 + 2(t+s)$, indicando que as previsÃµes acompanharÃ£o a tendÃªncia crescente. Para ilustrar, a previsÃ£o para $t+1$ dado $t=5$ Ã© $\hat{y}_{6|5} = 10 + 2(6) = 22$.

2.  **Processo de Raiz UnitÃ¡ria:** A primeira diferenÃ§a da sÃ©rie Ã© modelada como um processo estacionÃ¡rio, $(1-L)y_t = \delta + \psi(L)\epsilon_t$ [^1]. Este modelo nÃ£o assume uma tendÃªncia determinÃ­stica, mas sim um componente estocÃ¡stico que pode levar a um crescimento ou declÃ­nio persistente. Similarmente ao modelo trend-stationary, a previsÃ£o de um processo com raiz unitÃ¡ria tambÃ©m nÃ£o converge para uma mÃ©dia constante, mas sim para uma linha com inclinaÃ§Ã£o $\delta$.

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere o processo de raiz unitÃ¡ria $\Delta y_t = 0.3 + \epsilon_t$, com $\epsilon_t$ sendo ruÃ­do branco com mÃ©dia 0 e variÃ¢ncia 1. Aqui, $\delta = 0.3$. A previsÃ£o da variaÃ§Ã£o Ã© sempre 0.3. O nÃ­vel da sÃ©rie, $y_t$, irÃ¡ seguir um *random walk* com um drift de 0.3. As previsÃµes futuras nÃ£o convergem para uma mÃ©dia, mas seguem uma trajetÃ³ria com uma inclinaÃ§Ã£o de aproximadamente 0.3 vezes o horizonte da previsÃ£o,  $\hat{y}_{t+s|t} = y_t + 0.3s$, onde $y_t$ Ã© o Ãºltimo valor observado. Se $y_{10}=15$, a previsÃ£o para $y_{15}$ Ã© aproximadamente $\hat{y}_{15|10}= 15 + 0.3 \times 5 = 16.5$.

A principal limitaÃ§Ã£o da premissa de mÃ©dia constante e convergÃªncia das previsÃµes para essa mÃ©dia estÃ¡ em sua incapacidade de capturar o comportamento de sÃ©ries temporais com tendÃªncias. Em sÃ©ries econÃ´micas e financeiras, Ã© comum observar que os nÃ­veis das variÃ¡veis nÃ£o permanecem constantes ao longo do tempo, e que a previsÃ£o deve levar em conta a tendÃªncia. Os modelos de tendÃªncia determinÃ­stica e raiz unitÃ¡ria sÃ£o projetados especificamente para superar essa limitaÃ§Ã£o, ao permitir que a mÃ©dia e a previsÃ£o evoluam ao longo do tempo, seja atravÃ©s da funÃ§Ã£o linear $\alpha + \delta t$ ou pela modelagem de um processo nÃ£o estacionÃ¡rio com impacto persistente de choques.

**Lema 4:** *Em um processo trend-stationary, $y_t = \alpha + \delta t + \psi(L)\epsilon_t$, a esperanÃ§a condicional da sÃ©rie nÃ£o converge para uma constante, mas sim para a linha de tendÃªncia $\alpha + \delta t$ quando o horizonte de previsÃ£o se estende.*

*Prova:*
I. Para um processo trend-stationary $y_t = \alpha + \delta t + \psi(L)\epsilon_t$, a previsÃ£o de $y_{t+s}$ Ã© dada por $\hat{y}_{t+s|t} = \alpha + \delta(t+s) + \psi_s(L)\epsilon_t$ [^4].
II. Ã€ medida que $s \to \infty$, o componente estacionÃ¡rio $\psi_s(L)\epsilon_t$ tende a zero.
III. Portanto, $\lim_{s\to\infty} \hat{y}_{t+s|t} = \alpha + \delta(t+s)$, que Ã© uma funÃ§Ã£o linear do tempo com inclinaÃ§Ã£o $\delta$.
IV. Consequentemente, a previsÃ£o nÃ£o converge para uma mÃ©dia constante, mas sim para uma tendÃªncia linear.  â– 

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere o processo trend-stationary $y_t = 2 + 0.5t + \epsilon_t$, onde $\epsilon_t$ Ã© ruÃ­do branco com mÃ©dia 0 e desvio padrÃ£o 1. A esperanÃ§a condicional de $y_{t+s}$ quando $s \to \infty$ Ã© $\hat{y}_{t+s|t} = 2 + 0.5(t+s)$. Vemos que a previsÃ£o nÃ£o converge para uma mÃ©dia constante, mas sim para uma linha crescente, ilustrando que o modelo trend-stationary captura a tendÃªncia presente na sÃ©rie.

```python
import numpy as np
import matplotlib.pyplot as plt

# SimulaÃ§Ã£o do processo trend-stationary
np.random.seed(42)
T = 100
alpha = 2
delta = 0.5
epsilon = np.random.normal(0, 1, T+100)
t = np.arange(1, T+101)
y = alpha + delta * t + epsilon
# PrevisÃ£o do processo
forecasts = np.zeros(T+100)
for s in range(1, 101):
  forecasts[T+s-1] = alpha + delta * (T+s)

plt.plot(t, y, label='SÃ©rie Trend-Stationary')
plt.plot(range(T,T+100), forecasts[T:T+100], label="PrevisÃ£o da TendÃªncia")
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.legend()
plt.title('PrevisÃ£o em SÃ©rie Temporal Trend-Stationary')
plt.show()
```
Este exemplo demonstra como a previsÃ£o converge para a tendÃªncia linear em um processo trend-stationary.

**Teorema 4:** *Em um processo de raiz unitÃ¡ria, $(1-L)y_t = \delta + \psi(L)\epsilon_t$, a esperanÃ§a condicional nÃ£o converge para uma constante, mas sim para uma linha com inclinaÃ§Ã£o $\delta$, cujo intercepto Ã© atualizado a cada nova observaÃ§Ã£o $y_t$ quando o horizonte de previsÃ£o se estende.*

*Prova:*
I. Para um processo de raiz unitÃ¡ria $(1-L)y_t = \delta + \psi(L)\epsilon_t$, a previsÃ£o de $y_{t+s}$ Ã© dada por $\hat{y}_{t+s|t} = y_t + s\delta + \psi_s(L)\epsilon_t$ [^4].
II. Ã€ medida que $s \to \infty$, o componente estacionÃ¡rio $\psi_s(L)\epsilon_t$ tende a zero.
III. Portanto, $\lim_{s\to\infty} \hat{y}_{t+s|t} = y_t + s\delta$, que Ã© uma funÃ§Ã£o linear do tempo com inclinaÃ§Ã£o $\delta$. O intercepto $y_t$ depende do Ãºltimo valor observado da sÃ©rie.
IV. Assim, a previsÃ£o nÃ£o converge para uma mÃ©dia constante, mas para uma linha cuja posiÃ§Ã£o depende do valor atual da sÃ©rie. â– 

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere o processo de raiz unitÃ¡ria (random walk com drift) $\Delta y_t = 0.1 + \epsilon_t$, com $\epsilon_t$ ruÃ­do branco.  A previsÃ£o de $y_{t+s}$ para um horizonte grande ($s \to \infty$) Ã© $\hat{y}_{t+s|t} = y_t + 0.1s$. O intercepto depende do Ãºltimo valor observado $y_t$ e a inclinaÃ§Ã£o da previsÃ£o Ã© 0.1. Isso demonstra que a previsÃ£o converge para uma linha cuja posiÃ§Ã£o depende do Ãºltimo valor da sÃ©rie.

```python
import numpy as np
import matplotlib.pyplot as plt

# SimulaÃ§Ã£o do processo de raiz unitÃ¡ria
np.random.seed(42)
T = 100
delta = 0.1
epsilon = np.random.normal(0, 1, T+100)
y = np.zeros(T+100)

for t in range(1,T+100):
  y[t] = y[t-1] + delta + epsilon[t]
# PrevisÃ£o do processo
forecasts = np.zeros(T+100)
for s in range(1, 101):
  forecasts[T+s-1] = y[T-1] + delta * s

plt.plot(range(1,T+101), y[1:], label='SÃ©rie Unit Root')
plt.plot(range(T,T+100), forecasts[T:T+100], label="PrevisÃ£o para a TendÃªncia")
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.legend()
plt.title('PrevisÃ£o em SÃ©rie Temporal com Raiz UnitÃ¡ria')
plt.show()
```
Este exemplo demonstra como a previsÃ£o converge para uma linha com inclinaÃ§Ã£o $\delta$, onde o intercepto Ã© atualizado de acordo com a Ãºltima observaÃ§Ã£o, em um processo de raiz unitÃ¡ria.

**Lema 4.1:** *A persistÃªncia de choques Ã© diferente em modelos trend-stationary e modelos unit root. Em modelos trend-stationary, choques tÃªm efeito temporÃ¡rio, enquanto em modelos unit root, choques tÃªm um efeito persistente ou permanente.*

*Prova:*
I. Em modelos *trend-stationary*, a sÃ©rie retorna Ã  tendÃªncia linear apÃ³s um choque. Isso significa que o efeito de um choque $\epsilon_t$ sobre o nÃ­vel da sÃ©rie $y_t$ diminui ao longo do tempo devido Ã  estacionariedade do componente $\psi(L)\epsilon_t$.
II. Em modelos de *unit root*, um choque $\epsilon_t$ afeta o nÃ­vel da sÃ©rie de forma permanente, pois a sÃ©rie nÃ£o possui tendÃªncia linear ao redor da qual irÃ¡ retornar.
III. A equaÃ§Ã£o $(1-L)y_t = \delta + \psi(L)\epsilon_t$ mostra que um choque $\epsilon_t$ Ã© integrado Ã  sÃ©rie a partir do momento em que ocorre, influenciando os valores futuros.
IV.  Portanto, em modelos *trend-stationary* os choques sÃ£o temporÃ¡rios, e em modelos *unit root*, os choques tÃªm um impacto permanente. â– 

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere novamente os modelos $y_t = 2 + 0.5t + \epsilon_t$ (trend-stationary) e $\Delta y_t = 0.1 + \epsilon_t$ (raiz unitÃ¡ria). Um choque positivo em $\epsilon_t$ causarÃ¡ um desvio temporÃ¡rio em torno da tendÃªncia linear para o primeiro caso, e uma mudanÃ§a permanente no nÃ­vel da sÃ©rie, para o segundo. Para o modelo *trend-stationary*, se $\epsilon_1$ for 2, $y_1$ serÃ¡ 4.5 (2 + 0.5*1 + 2), mas ao longo do tempo o efeito de $\epsilon_1$ desaparece. Para o modelo *unit root*, se $\epsilon_1$ for 2, entÃ£o $y_1 = y_0 + 0.1 + 2$, e o efeito de 2 Ã© mantido ao longo do tempo. Se $y_0$ era zero, $y_1$ serÃ¡ 2.1, $y_2$ serÃ¡ aproximadamente $2.1 + 0.1 + \epsilon_2$, e assim por diante.

**ProposiÃ§Ã£o 1:** *Um processo com raiz unitÃ¡ria, $\Delta y_t = \delta + \psi(L)\epsilon_t$, pode ser transformado em um processo trend-stationary adicionando um componente de tendÃªncia determinÃ­stica.*

*Prova:*
I. ComeÃ§amos com o processo de raiz unitÃ¡ria $\Delta y_t = \delta + \psi(L)\epsilon_t$.
II. Somando e subtraindo $\delta t$ a esta equaÃ§Ã£o, temos $\Delta y_t - \delta = \psi(L)\epsilon_t$.
III. Integrando ambos os lados, obtemos $y_t - \delta t = \int \psi(L)\epsilon_t \, dt$.
IV. Se definirmos $z_t = y_t - \delta t$ e  considerando que a integral de um processo estacionÃ¡rio resulta em um processo tambÃ©m estacionÃ¡rio quando este Ãºltimo possui mÃ©dia 0, entÃ£o $z_t$ Ã© estacionÃ¡rio.
V. Portanto, podemos expressar $y_t$ como $y_t = \delta t + z_t$, onde $z_t$ Ã© um processo estacionÃ¡rio.
VI. Isso mostra que o processo original de raiz unitÃ¡ria pode ser visto como um processo trend-stationary apÃ³s a adiÃ§Ã£o do componente de tendÃªncia determinÃ­stica $\delta t$.  â– 
> ğŸ’¡ **ObservaÃ§Ã£o:** Esta proposiÃ§Ã£o destaca a dualidade entre os modelos de raiz unitÃ¡ria e trend-stationary. A adiÃ§Ã£o de uma tendÃªncia determinÃ­stica a um processo de raiz unitÃ¡ria pode resultar em um processo com um comportamento semelhante ao de um processo trend-stationary, e vice-versa.  A escolha entre modelar uma tendÃªncia determinÃ­stica ou um processo com raiz unitÃ¡ria depende da interpretaÃ§Ã£o econÃ´mica e das caracterÃ­sticas especÃ­ficas da sÃ©rie temporal. Por exemplo, se um choque tem um efeito persistente, a melhor opÃ§Ã£o seria o modelo de raiz unitÃ¡ria. Se acreditamos que a sÃ©rie tem uma tendÃªncia fundamental, o modelo trend-stationary seria mais adequado.

### ImplicaÃ§Ãµes PrÃ¡ticas

A inadequaÃ§Ã£o da premissa de esperanÃ§a incondicional constante e convergÃªncia para a mÃ©dia em sÃ©ries temporais com tendÃªncias Ã© um problema central na modelagem de dados econÃ´micos e financeiros. A modelagem de tendÃªncias, seja atravÃ©s de tendÃªncias determinÃ­sticas ou processos de raiz unitÃ¡ria, Ã© essencial para obter previsÃµes precisas e analisar a dinÃ¢mica dessas sÃ©ries.

*   **Modelos Trend-Stationary:** Adequados quando se assume que a sÃ©rie flutua em torno de uma tendÃªncia determinÃ­stica. A anÃ¡lise envolve a estimaÃ§Ã£o de parÃ¢metros da tendÃªncia linear e o estudo das flutuaÃ§Ãµes estacionÃ¡rias ao redor dessa tendÃªncia.
*   **Modelos Unit Root:** Adequados quando se assume que a sÃ©rie nÃ£o tem uma tendÃªncia determinÃ­stica, mas sim um comportamento estocÃ¡stico que pode levar a mudanÃ§as de nÃ­vel persistentes. A anÃ¡lise envolve a diferenciaÃ§Ã£o da sÃ©rie, a modelagem do componente estacionÃ¡rio resultante e a anÃ¡lise do impacto persistente de choques.

A escolha entre esses modelos Ã© crucial para a interpretaÃ§Ã£o dos resultados e para a previsÃ£o da sÃ©rie. Em sÃ©ries com tendÃªncias claras, o uso de modelos estacionÃ¡rios pode levar a conclusÃµes errÃ´neas e previsÃµes imprecisas. Os modelos de tendÃªncia determinÃ­stica e raiz unitÃ¡ria oferecem uma abordagem mais adequada para lidar com essa complexidade, ao permitir uma anÃ¡lise mais completa e realista do comportamento de sÃ©ries temporais nÃ£o estacionÃ¡rias. Ã‰ tambÃ©m importante notar que a anÃ¡lise da variÃ¢ncia do erro de previsÃ£o tambÃ©m se torna diferente quando sÃ£o considerados modelos com tendÃªncias, como visto no capÃ­tulo anterior.

> ğŸ’¡ **Exemplo Comparativo:** Imagine modelar o PIB de um paÃ­s. Se usarmos um modelo estacionÃ¡rio, a previsÃ£o sempre retornaria a uma mÃ©dia constante, o que Ã© claramente inadequado jÃ¡ que o PIB tipicamente cresce ao longo do tempo. O modelo trend-stationary capturaria uma tendÃªncia de crescimento, e o modelo unit root, com um drift, capturaria o crescimento persistente da sÃ©rie. A escolha dependeria se acreditamos que o crescimento do PIB segue uma tendÃªncia linear determinada ou Ã© mais um processo estocÃ¡stico com choques permanentes. Em geral, para dados de PIB, um modelo de raiz unitÃ¡ria seria mais apropriado.

### ConclusÃ£o

A premissa de que a esperanÃ§a incondicional da variÃ¡vel Ã© constante e que as previsÃµes convergem para essa mÃ©dia Ã© uma simplificaÃ§Ã£o que pode ser inadequada para muitas sÃ©ries temporais econÃ´micas e financeiras, que exibem tendÃªncias claras. Os modelos de tendÃªncia determinÃ­stica e raiz unitÃ¡ria sÃ£o ferramentas essenciais para superar essa limitaÃ§Ã£o, permitindo modelar a dinÃ¢mica complexa de sÃ©ries temporais nÃ£o estacionÃ¡rias. A modelagem de tendÃªncias nÃ£o estacionÃ¡rias implica que a previsÃ£o nÃ£o converge para uma mÃ©dia fixa, mas sim para uma tendÃªncia linear, cuja inclinaÃ§Ã£o Ã© dada pelo parÃ¢metro $\delta$ do modelo, e cujo intercepto pode variar com o tempo. A anÃ¡lise da persistÃªncia de choques tambÃ©m se torna diferente, com modelos *trend-stationary* apresentando choques temporÃ¡rios e modelos com raiz unitÃ¡ria, choques permanentes, como demonstrado neste capÃ­tulo. As implicaÃ§Ãµes computacionais dessa escolha foram abordadas no capÃ­tulo anterior. A escolha entre os modelos *trend-stationary* e *unit root*, portanto, deve ser feita levando em consideraÃ§Ã£o a natureza das tendÃªncias presentes na sÃ©rie temporal.

### ReferÃªncias
[^1]: [15.1.1]
[^4]: [15.3.1], [15.3.4]
<!-- END -->
