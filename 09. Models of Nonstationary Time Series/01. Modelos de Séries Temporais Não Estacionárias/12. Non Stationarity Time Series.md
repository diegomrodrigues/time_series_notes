## Modelos de S√©ries Temporais N√£o Estacion√°rias: Implica√ß√µes da N√£o Estacionariedade nas Propriedades Estat√≠sticas

### Introdu√ß√£o

Em continuidade aos cap√≠tulos anteriores, que abordaram modelos *trend-stationary* e *unit root* [^1], [^2], [^3], e a implementa√ß√£o computacional desses modelos [^4], este cap√≠tulo se aprofunda nas implica√ß√µes da **n√£o estacionariedade** nas propriedades estat√≠sticas de s√©ries temporais. Como j√° mencionado, a n√£o estacionariedade, intr√≠nseca a muitos dados econ√¥micos e financeiros, invalida a aplica√ß√£o direta de t√©cnicas de an√°lise concebidas para s√©ries estacion√°rias, exigindo a utiliza√ß√£o de modelos e abordagens que considerem explicitamente a varia√ß√£o temporal das propriedades estat√≠sticas das s√©ries. Este cap√≠tulo detalha como a n√£o estacionariedade afeta a m√©dia, a vari√¢ncia, e a autocovari√¢ncia, e como estas mudan√ßas exigem uma modelagem diferenciada. Exploramos as implica√ß√µes te√≥ricas e pr√°ticas dessas mudan√ßas nas propriedades estat√≠sticas, com especial aten√ß√£o √† necessidade de abordar explicitamente tais caracter√≠sticas em modelos n√£o estacion√°rios.

### Conceitos Fundamentais

A n√£o estacionariedade, como j√° introduzido, significa que as propriedades estat√≠sticas de uma s√©rie temporal n√£o s√£o constantes ao longo do tempo [^1]. Em s√©ries estacion√°rias, a m√©dia, vari√¢ncia e autocovari√¢ncia s√£o constantes [^1]. Quando essa premissa n√£o se sustenta, a modelagem de s√©ries temporais demanda abordagens que acomodem essas varia√ß√µes, resultando em uma an√°lise mais precisa e em previs√µes mais confi√°veis.  As implica√ß√µes da n√£o estacionariedade nas propriedades estat√≠sticas s√£o:

1.  **M√©dia Vari√°vel no Tempo:**
    *   Em s√©ries estacion√°rias, a m√©dia √© constante ao longo do tempo. No entanto, em s√©ries n√£o estacion√°rias, a m√©dia pode variar, apresentando tend√™ncias de crescimento ou decrescimento ao longo do tempo, ou mudan√ßas abruptas e n√£o lineares.
    *  Em modelos *trend-stationary*, a m√©dia √© modelada como uma fun√ß√£o determin√≠stica do tempo, como $\mu_t = \alpha + \delta t$ [^1], e √© expressa como a tend√™ncia linear que varia com o tempo.
    *   Em modelos *unit root*, a m√©dia da s√©rie original n√£o √© constante, e em geral, a s√©rie n√£o tem m√©dia (a m√©dia cresce com o tempo, tendendo para infinito), mas a m√©dia da primeira diferen√ßa √© constante [^1].
     *  Modelos mais complexos podem considerar mudan√ßas de regime na m√©dia.

2.  **Vari√¢ncia Vari√°vel no Tempo:**
    *   Em s√©ries estacion√°rias, a vari√¢ncia √© constante ao longo do tempo, e n√£o depende do tempo. Em s√©ries n√£o estacion√°rias, a vari√¢ncia pode aumentar ou diminuir, apresentar per√≠odos de alta e baixa volatilidade, ou ser afetada por mudan√ßas estruturais.
    *   Em modelos *trend-stationary*, a vari√¢ncia √© considerada constante no componente estoc√°stico $\psi(L)\epsilon_t$ [^1], mas a vari√¢ncia da s√©rie em si aumenta com o tempo devido √† presen√ßa da tend√™ncia.
    *   Em modelos *unit root*, a vari√¢ncia da s√©rie original n√£o √© constante, e em geral, aumenta com o tempo, mas a vari√¢ncia da primeira diferen√ßa √© constante.
    *   Modelos de volatilidade condicional, como modelos ARCH e GARCH, s√£o usados para modelar a n√£o estacionariedade da vari√¢ncia, especialmente em dados financeiros.

3.  **Autocovari√¢ncia Vari√°vel no Tempo:**
    *   Em s√©ries estacion√°rias, a autocovari√¢ncia depende apenas da defasagem (o intervalo de tempo entre as observa√ß√µes) e n√£o do instante de tempo.  Em s√©ries n√£o estacion√°rias, a autocovari√¢ncia pode depender do instante de tempo, e o decaimento das autocorrela√ß√µes com as defasagens pode ser mais lento do que em s√©ries estacion√°rias.
    *  Em modelos *trend-stationary*, a autocovari√¢ncia depende da estrutura do componente estacion√°rio $\psi(L)\epsilon_t$, e esta autocovari√¢ncia √© constante.
    *  Em modelos *unit root*, a autocovari√¢ncia da s√©rie original n√£o depende somente da defasagem, e o decaimento das autocorrela√ß√µes √© lento. As autocorrela√ß√µes da primeira diferen√ßa, no entanto, decaem mais rapidamente com a defasagem.
    * Modelos de mem√≥ria longa, ou fracamente estacion√°rios, s√£o adequados para modelar s√©ries onde o decaimento das autocorrela√ß√µes √© mais lento.

> üí° **Exemplo Num√©rico:**
>
> *   **M√©dia Vari√°vel:** O PIB de um pa√≠s geralmente apresenta uma tend√™ncia de crescimento ao longo do tempo, tornando sua m√©dia n√£o constante. Um modelo *trend-stationary* poderia capturar a m√©dia vari√°vel, como $PIB_t = 100 + 5t + \epsilon_t$, onde a m√©dia varia com o tempo como $100 + 5t$.  Se o PIB fosse modelado com um passeio aleat√≥rio com deriva, $PIB_t = PIB_{t-1} + 0.5 + \epsilon_t$, a m√©dia n√£o seria constante ao longo do tempo. Para ilustrar, se tomarmos alguns valores para $t$ e $\epsilon_t$, como $t=1, 2, 3$ e $\epsilon_t = 2, -1, 0.5$, temos que
>>  Para o modelo *trend-stationary*:
>>  $PIB_1 = 100 + 5(1) + 2 = 107$
>>  $PIB_2 = 100 + 5(2) - 1 = 109$
>>  $PIB_3 = 100 + 5(3) + 0.5 = 115.5$
>> J√° para o passeio aleat√≥rio, assumindo $PIB_0=100$, temos:
>>  $PIB_1 = 100 + 0.5 + 2 = 102.5$
>>  $PIB_2 = 102.5 + 0.5 - 1 = 102$
>>  $PIB_3 = 102 + 0.5 + 0.5 = 103$
>  Percebe-se que no primeiro modelo, a m√©dia varia deterministicamente, enquanto no segundo, a m√©dia varia de forma n√£o determin√≠stica (aleat√≥ria).
> *   **Vari√¢ncia Vari√°vel:** O pre√ßo de um ativo financeiro pode apresentar per√≠odos de alta e baixa volatilidade.  Um modelo GARCH pode ser usado para modelar a vari√¢ncia condicional, onde a volatilidade varia no tempo, ao contr√°rio da premissa de vari√¢ncia constante em s√©ries estacion√°rias. A vari√¢ncia condicional pode ser dada por $\sigma^2_t = 0.01 + 0.2\epsilon^2_{t-1} + 0.7\sigma^2_{t-1}$, modelando a n√£o estacionaridade na vari√¢ncia. Por exemplo, se tivermos $\epsilon_0 = 0$ e $\sigma^2_0 = 0.01$, os primeiros valores da vari√¢ncia condicional seriam:
>> $\sigma^2_1 = 0.01 + 0.2(0)^2 + 0.7(0.01) = 0.017$
>> $\text{Se } \epsilon_1 = 0.1$:
>> $\sigma^2_2 = 0.01 + 0.2(0.1)^2 + 0.7(0.017) = 0.022$
>>  Note como a vari√¢ncia se ajusta com base nos valores anteriores do res√≠duo e da pr√≥pria vari√¢ncia, o que demonstra que a volatilidade n√£o √© constante no tempo.
> *   **Autocovari√¢ncia Vari√°vel:** Em dados clim√°ticos, como a temperatura, a autocovari√¢ncia entre temperaturas em diferentes esta√ß√µes do ano podem variar, o que √© um exemplo de n√£o estacionariedade.  Modelos com componentes de sazonalidade, que s√£o um tipo espec√≠fico de n√£o estacionariedade, podem ser utilizados. A autocovari√¢ncia pode ser expressa como $\gamma(t, k) = Cov(T_t, T_{t+k})$, onde $T_t$ √© a temperatura no tempo $t$.  Se a s√©rie fosse estacion√°ria, $\gamma(t,k)$ seria igual a $\gamma(k)$, uma fun√ß√£o que depende apenas da defasagem $k$. Por exemplo, a autocovari√¢ncia entre a temperatura de janeiro e fevereiro pode ser diferente da autocovari√¢ncia entre a temperatura de julho e agosto, mostrando uma depend√™ncia temporal na autocovari√¢ncia.

**Lema 12:** *A aplica√ß√£o de m√©todos de an√°lise de s√©ries estacion√°rias a s√©ries temporais n√£o estacion√°rias pode levar a conclus√µes esp√∫rias devido ao desrespeito √†s premissas de estacionaridade.*

*Prova:*
I. M√©todos de an√°lise de s√©ries estacion√°rias, como modelos ARMA, assumem que as propriedades estat√≠sticas das s√©ries s√£o constantes ao longo do tempo.
II. Quando aplicados a s√©ries n√£o estacion√°rias, esses modelos podem gerar resultados enviesados e conclus√µes err√¥neas.
III. O uso de fun√ß√µes de autocorrela√ß√£o (ACF) e autocorrela√ß√£o parcial (PACF) em s√©ries n√£o estacion√°rias pode levar a interpreta√ß√µes erradas, porque o decaimento da ACF n√£o ser√° o mesmo que em s√©ries estacion√°rias, e a PACF pode apresentar um padr√£o que n√£o est√° relacionado √† depend√™ncia serial da s√©rie.
IV. A estima√ß√£o de modelos estacion√°rios com dados n√£o estacion√°rios pode levar a estimativas inconsistentes dos par√¢metros e √† n√£o validade dos testes estat√≠sticos associados.
V. Portanto, a aplica√ß√£o de m√©todos de an√°lise de s√©ries estacion√°rias a s√©ries temporais n√£o estacion√°rias pode levar a conclus√µes err√¥neas e deve ser evitada.  ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *  Se aplicarmos um modelo AR(1) estacion√°rio a uma s√©rie com tend√™ncia, como o PIB, o modelo ir√° ajustar uma m√©dia constante, e os res√≠duos apresentar√£o padr√µes n√£o aleat√≥rios, indicando que o modelo n√£o est√° capturando a tend√™ncia da s√©rie.  A previs√£o tamb√©m ser√° enviesada, uma vez que n√£o considerar√° o crescimento de longo prazo.
>   Por exemplo, em um modelo AR(1), $y_t = \phi y_{t-1} + \epsilon_t$, um valor ajustado de $\phi$ n√£o ser√° capaz de capturar um comportamento com tend√™ncia, e a previs√£o tender√° para um valor constante (e n√£o para uma trajet√≥ria de crescimento). Suponha que a s√©rie seja $y_t = 2t + \epsilon_t$. Ao estimar o modelo AR(1) em uma s√©rie simulada com essa tend√™ncia, o modelo ir√° tentar capturar um valor m√©dio constante e um par√¢metro $\phi$ que n√£o representam a verdadeira din√¢mica dos dados.
> *  Se aplicarmos um modelo ARMA estacion√°rio a uma s√©rie de pre√ßos de a√ß√µes, que tem vari√¢ncia vari√°vel, o modelo poder√° n√£o capturar a volatilidade vari√°vel ao longo do tempo. A previs√£o ser√° imprecisa, especialmente em per√≠odos de alta volatilidade, e as an√°lises de risco podem ser inadequadas.
>    Por exemplo, em modelos estacion√°rios como ARMA, a vari√¢ncia √© constante. Os res√≠duos mostrar√£o comportamento heteroced√°stico, n√£o capturando as mudan√ßas de volatilidade do ativo. Se os retornos do ativo forem dados por $r_t = \sigma_t \epsilon_t$, onde $\sigma_t$ varia no tempo, um modelo ARMA assumir√° que $\sigma_t$ √© constante, o que levar√° a erros na modelagem.
> * Se usarmos fun√ß√µes de autocorrela√ß√£o (ACF) e autocorrela√ß√£o parcial (PACF) em uma s√©rie com raiz unit√°ria, os padr√µes apresentados n√£o ter√£o a mesma interpreta√ß√£o do que em s√©ries estacion√°rias. O decaimento lento na ACF, por exemplo, poder√° ser confundido com uma correla√ß√£o serial de longo prazo.
>   Em uma s√©rie com raiz unit√°ria, o correlograma decai lentamente, o que pode ser interpretado como uma alta correla√ß√£o serial, mas √©, na verdade, um reflexo da n√£o estacionariedade da s√©rie. Uma s√©rie gerada por um passeio aleat√≥rio $y_t = y_{t-1} + \epsilon_t$ exibir√° uma ACF que decai lentamente, ao inv√©s de um decaimento r√°pido como observado em s√©ries estacion√°rias.

**Proposi√ß√£o 12.1:** *A diferencia√ß√£o √© uma t√©cnica √∫til para remover a n√£o estacionariedade em s√©ries com raiz unit√°ria, mas pode introduzir problemas de n√£o invertibilidade em s√©ries *trend-stationary*.*

*Prova:*
I. A diferencia√ß√£o consiste em subtrair o valor anterior da s√©rie do valor atual, o que corresponde √† aplica√ß√£o do operador $(1-L)$.
II. Em s√©ries com raiz unit√°ria, como um passeio aleat√≥rio, a diferencia√ß√£o remove a n√£o estacionariedade na m√©dia, transformando a s√©rie em um processo estacion√°rio com m√©dia constante.
III. Para um modelo com raiz unit√°ria como $(1-L)y_t = \delta + \psi(L)\epsilon_t$, a diferencia√ß√£o transforma a s√©rie n√£o estacion√°ria em uma s√©rie estacion√°ria $\Delta y_t = \delta + \psi(L)\epsilon_t$.
IV. Em s√©ries *trend-stationary*, a diferencia√ß√£o tamb√©m remove a tend√™ncia, tornando a s√©rie estacion√°ria, mas o componente de m√©dias m√≥veis resultante, $(1-L)\psi(L)$, √© n√£o invert√≠vel, e a s√©rie n√£o ser√° um processo ARMA cl√°ssico.
V. Portanto, a diferencia√ß√£o √© √∫til para remover a n√£o estacionariedade em s√©ries com raiz unit√°ria, mas pode levar a problemas de n√£o invertibilidade e dificuldades na modelagem em s√©ries *trend-stationary*. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   Se aplicarmos a diferencia√ß√£o a uma s√©rie que segue um passeio aleat√≥rio, como $y_t = y_{t-1} + \epsilon_t$, o resultado ser√° $\Delta y_t = y_t - y_{t-1} = \epsilon_t$, que √© ru√≠do branco (estacion√°rio). Se gerarmos uma s√©rie com passeio aleat√≥rio, como $y_t = y_{t-1} + 0.1 + \epsilon_t$, com $\epsilon_t \sim N(0,1)$, temos que a s√©rie $y_t$ ser√° n√£o estacion√°ria, mas a s√©rie diferenciada $\Delta y_t = y_t - y_{t-1} = 0.1 + \epsilon_t$ ser√° estacion√°ria, pois √© um ru√≠do branco com uma constante.
> *  Se aplicarmos a diferencia√ß√£o a uma s√©rie *trend-stationary*, como $y_t = 10 + 0.5t + \epsilon_t$, o resultado ser√° $\Delta y_t = y_t - y_{t-1} = 0.5 + (\epsilon_t - \epsilon_{t-1})$.  O res√≠duo √© um processo de m√©dias m√≥veis, que n√£o √© invert√≠vel, e que n√£o pode ser modelado como um processo AR. Se $\epsilon_t$ for um ru√≠do branco, $\epsilon_t - \epsilon_{t-1}$ ser√° um processo de m√©dias m√≥veis de ordem 1 (MA(1)). A fun√ß√£o de autocorrela√ß√£o de um MA(1) tem apenas uma autocorrela√ß√£o n√£o nula (na primeira defasagem), o que pode criar dificuldades na modelagem.
>   A n√£o invertibilidade causa problemas na estima√ß√£o dos par√¢metros dos modelos resultantes, uma vez que a fun√ß√£o de autocorrela√ß√£o n√£o poder√° ser invertida para se obter o processo estoc√°stico gerador da s√©rie.

**Lema 12.1:** *A modelagem da n√£o estacionariedade muitas vezes requer transforma√ß√µes n√£o lineares nos dados para estabilizar a vari√¢ncia ou linearizar a rela√ß√£o entre as vari√°veis.*

*Prova:*
I. Transforma√ß√µes n√£o lineares, como a transforma√ß√£o logar√≠tmica, podem ser utilizadas para estabilizar a vari√¢ncia em s√©ries temporais com heterocedasticidade.
II. Transforma√ß√µes como Box-Cox podem ser usadas para determinar uma transforma√ß√£o √≥tima que minimize a heterocedasticidade e maximize a normalidade dos res√≠duos.
III. Transforma√ß√µes n√£o lineares podem ser usadas para linearizar as rela√ß√µes entre vari√°veis, permitindo o uso de modelos de regress√£o linear ou outros modelos lineares em dados que n√£o s√£o lineares em seu formato original.
IV. Transforma√ß√µes podem reduzir ou eliminar a n√£o estacionariedade da vari√¢ncia, melhorando a adequa√ß√£o do modelo.
V. Portanto, a aplica√ß√£o de transforma√ß√µes n√£o lineares pode melhorar a adequa√ß√£o e efici√™ncia dos modelos, quando aplicados em dados com n√£o linearidades ou heterocedasticidade.  ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   Em s√©ries temporais com crescimento exponencial, a transforma√ß√£o logar√≠tmica pode estabilizar a vari√¢ncia, tornando o processo mais estacion√°rio. Se modelarmos o logaritmo do PIB, ao inv√©s do PIB, o resultado da modelagem pode ser melhor.
>   Por exemplo, se $PIB_t$ crescer exponencialmente, a vari√¢ncia de $PIB_t$ aumentar√° ao longo do tempo. A aplica√ß√£o da transforma√ß√£o $\log(PIB_t)$ pode estabilizar a vari√¢ncia, tornando os dados mais adequados para modelos de s√©ries temporais. Se o PIB for dado por $PIB_t = e^{0.05t + \epsilon_t}$, o logaritmo do PIB ser√° $\log(PIB_t) = 0.05t + \epsilon_t$, que tem vari√¢ncia constante se $\epsilon_t$ tiver vari√¢ncia constante.
> *   Em dados financeiros, os retornos de ativos podem exibir volatilidade vari√°vel no tempo, com per√≠odos de alta e baixa volatilidade. Transforma√ß√µes como o logaritmo podem reduzir ou eliminar a heterocedasticidade.
>  Por exemplo, se $y_t$ for o pre√ßo de um ativo, o retorno $\Delta \log y_t$ √© uma medida de varia√ß√£o percentual, que apresenta menor heterocedasticidade.  O uso de modelos GARCH tamb√©m pode ser utilizado para modelar a heterocedasticidade diretamente. Se a vari√¢ncia do pre√ßo de uma a√ß√£o for proporcional ao seu pre√ßo, ent√£o o retorno $\Delta \log y_t = \log y_t - \log y_{t-1}$ ter√° vari√¢ncia mais est√°vel.
> *   Se a rela√ß√£o entre vari√°veis for n√£o linear, como uma rela√ß√£o quadr√°tica ou exponencial, transforma√ß√µes podem linearizar a rela√ß√£o, tornando poss√≠vel modelar a rela√ß√£o com modelos lineares.
>   Por exemplo, se $y_t$ e $x_t$ tiverem uma rela√ß√£o exponencial, aplicar a transforma√ß√£o $\log(y_t)$ pode linearizar a rela√ß√£o. Se a rela√ß√£o for $y_t = e^{\alpha x_t}$, ent√£o $\log(y_t) = \alpha x_t$ que √© uma rela√ß√£o linear.

**Teorema 12:** *A modelagem de s√©ries temporais n√£o estacion√°rias exige uma combina√ß√£o de conhecimento te√≥rico sobre o comportamento das s√©ries, e habilidades computacionais para implementar e diagnosticar os modelos.*
*Prova:*
I. A escolha do modelo adequado (trend-stationary, unit root, ARIMA, ou modelos mais avan√ßados) exige o conhecimento te√≥rico sobre a natureza da n√£o estacionariedade.  A s√©rie temporal pode apresentar tend√™ncias, mudan√ßas de regime, volatilidade vari√°vel no tempo ou mem√≥ria longa, e a escolha deve considerar essas caracter√≠sticas.
II.  A modelagem exige habilidades computacionais em linguagens como Python, R ou Julia, e conhecimento de bibliotecas estat√≠sticas, como `statsmodels`, `arch` e `forecast`.
III. A implementa√ß√£o dos modelos exige a estima√ß√£o de par√¢metros por m√©todos num√©ricos, como m√≠nimos quadrados ou m√°xima verossimilhan√ßa. Os m√©todos de otimiza√ß√£o s√£o importantes para garantir a converg√™ncia e a precis√£o dos resultados.
IV. A an√°lise de res√≠duos e testes de hip√≥teses exigem conhecimento estat√≠stico e habilidades computacionais para verificar a adequa√ß√£o do modelo.  Testes de raiz unit√°ria, an√°lise do correlograma, teste de Ljung-Box, an√°lise de volatilidade, entre outros, s√£o importantes para validar o modelo.
V. A interpreta√ß√£o dos resultados exige conhecimento da √°rea espec√≠fica onde o modelo est√° sendo aplicado, para que conclus√µes econ√¥micas, financeiras ou de outras √°reas possam ser obtidas a partir da an√°lise da s√©rie temporal.
VI. Portanto, a modelagem de s√©ries temporais n√£o estacion√°rias exige um processo iterativo que combina conhecimento te√≥rico, habilidades computacionais e capacidade de interpreta√ß√£o dos resultados, de forma a garantir a adequa√ß√£o do modelo aos dados e a relev√¢ncia das conclus√µes.  ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   Um economista, ao modelar o PIB de um pa√≠s, precisa escolher entre modelos *trend-stationary* e modelos *unit root* e precisa conhecer a teoria por tr√°s destes modelos, e das implica√ß√µes de cada modelo na interpreta√ß√£o dos resultados. O economista precisa ser capaz de implementar o modelo computacionalmente, fazer os testes estat√≠sticos necess√°rios para validar o modelo e realizar a interpreta√ß√£o econ√¥mica dos resultados.
>  Por exemplo, se o teste de raiz unit√°ria indicar que o PIB tem raiz unit√°ria, o modelo a ser utilizado ser√° diferente daquele a ser usado se o teste indicar que o PIB √© *trend-stationary*. Se o teste ADF (Augmented Dickey-Fuller) para a s√©rie de logaritmos do PIB, com uma constante e tend√™ncia, resultar em um p-valor maior que 0.05, n√£o rejeitamos a hip√≥tese nula de raiz unit√°ria, indicando que a s√©rie √© mais bem modelada como um processo integrado e n√£o como uma tend√™ncia.
> *  Um gestor de investimentos, ao modelar a volatilidade de um ativo financeiro, precisa conhecer os modelos GARCH e ter a habilidade computacional para estimar esses modelos, utilizando bibliotecas estat√≠sticas. O gestor tamb√©m precisa conhecer os testes estat√≠sticos para validar a adequa√ß√£o do modelo e realizar a an√°lise do risco a partir dos resultados.
>  Por exemplo, a estima√ß√£o de modelos GARCH exige a utiliza√ß√£o de m√©todos de otimiza√ß√£o num√©rica, assim como a an√°lise de res√≠duos, o c√°lculo de medidas de risco, como VaR (Value at Risk), e a an√°lise das previs√µes. A implementa√ß√£o de um modelo GARCH(1,1) em Python com a biblioteca `arch` pode envolver a otimiza√ß√£o da fun√ß√£o de verossimilhan√ßa, e a an√°lise dos res√≠duos padronizados para verificar a adequa√ß√£o do modelo.
> *  Um engenheiro precisa conhecer modelos de s√©ries temporais e an√°lise de res√≠duos para monitorar um processo industrial, e usar previs√µes para otimizar o funcionamento da planta.
>   Por exemplo, se o processo apresentar tend√™ncia, pode ser apropriado modelar o processo com um modelo *trend-stationary*. Se o processo apresentar mudan√ßas abruptas de n√≠vel, modelos com mudan√ßa de regime podem ser necess√°rios. Se a produ√ß√£o de uma f√°brica for modelada como $Producao_t = 100 + 0.2t + \epsilon_t$, e o teste de raiz unit√°ria n√£o rejeitar a hip√≥tese nula, a modelagem da produ√ß√£o como um passeio aleat√≥rio pode ser mais apropriada.

**Lema 12.2:** *A previs√£o de s√©ries temporais n√£o estacion√°rias √© um desafio, especialmente no longo prazo, devido √† incerteza introduzida pela n√£o estacionariedade.*
*Prova:*
I. Modelos *trend-stationary* geram previs√µes que convergem para a trajet√≥ria da tend√™ncia, e a vari√¢ncia do erro de previs√£o tende a se estabilizar com o tempo.
II. Modelos *unit root*, no entanto, geram previs√µes que acompanham a trajet√≥ria com deriva, e a vari√¢ncia do erro de previs√£o aumenta com o tempo, ou seja, quanto maior o horizonte da previs√£o, maior a incerteza.
III. Modelos com mem√≥ria longa podem ter comportamento intermedi√°rio entre modelos *trend-stationary* e modelos *unit root*, e sua previs√£o pode apresentar uma incerteza que decai lentamente com o tempo.
IV. Modelos com mudan√ßas de regime podem gerar cen√°rios com diferentes trajet√≥rias de longo prazo, adicionando incerteza √† previs√£o.
V. Portanto, a previs√£o de s√©ries temporais n√£o estacion√°rias √© um desafio devido √† incerteza inerente √† n√£o estacionariedade. A previs√£o de longo prazo √© mais incerta do que a previs√£o de curto prazo, especialmente em s√©ries com raiz unit√°ria ou mem√≥ria longa. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *  Um modelo *trend-stationary* para a produ√ß√£o industrial pode gerar previs√µes que tendem para uma trajet√≥ria de crescimento no longo prazo. A incerteza se concentra nas flutua√ß√µes ao redor da tend√™ncia. O erro de previs√£o se estabiliza em um certo valor, de acordo com as caracter√≠sticas do componente estacion√°rio do modelo.
>  Por exemplo, em $Producao_t = 100 + 2t + \epsilon_t$, a previs√£o tenderia para a linha $100 + 2t$, com um certo desvio padr√£o. Se $\epsilon_t$ for um ru√≠do branco com vari√¢ncia $\sigma^2$, ent√£o a vari√¢ncia do erro de previs√£o da produ√ß√£o no tempo $t+h$ seria $\sigma^2$, e n√£o cresceria com o tempo.
> *  Um modelo *unit root* para o pre√ßo de uma a√ß√£o gera previs√µes cuja vari√¢ncia do erro cresce com o tempo. O desvio padr√£o do erro de previs√£o se torna cada vez maior conforme o horizonte da previs√£o aumenta.
>   Por exemplo, em $Preco_t = Preco_{t-1} + 0.1 + \epsilon_t$, a vari√¢ncia do erro de previs√£o cresce linearmente com o horizonte da previs√£o.  Se $\epsilon_t$ for um ru√≠do branco com vari√¢ncia $\sigma^2$, ent√£o a vari√¢ncia do erro de previs√£o $h$ per√≠odos a frente ser√° $h\sigma^2$.
> *  Em modelos ARIMA, a vari√¢ncia do erro de previs√£o tamb√©m tende a crescer com o horizonte de previs√£o.  Quanto maior a ordem de integra√ß√£o da s√©rie (o n√∫mero de diferen√ßas necess√°rias para se obter a estacionaridade), maior a incerteza da previs√£o de longo prazo. Por exemplo, em um modelo ARIMA(1,1,1) a vari√¢ncia do erro de previs√£o crescer√° com o tempo, mas em uma taxa menor do que no passeio aleat√≥rio.

**Teorema 12.1:** *Modelos com componentes de sazonalidade s√£o uma extens√£o natural dos modelos n√£o estacion√°rios, e s√£o adequados para modelar s√©ries que apresentam padr√µes peri√≥dicos ao longo do tempo.*

*Prova:*
I. S√©ries temporais podem apresentar padr√µes peri√≥dicos, como varia√ß√µes di√°rias, semanais, mensais ou anuais, que s√£o chamados de sazonalidade.
II. Modelos com componentes de sazonalidade podem ser constru√≠dos como uma extens√£o dos modelos ARMA, incorporando termos que modelam a periodicidade da s√©rie.
III. A sazonalidade pode ser aditiva ou multiplicativa, dependendo de como a varia√ß√£o peri√≥dica interage com a tend√™ncia da s√©rie.
IV. Modelos SARIMA (Seasonal ARIMA) s√£o uma classe de modelos que capturam a sazonalidade. Um modelo SARIMA pode ser definido como $(p, d, q)(P, D, Q)_s$, onde $(p, d, q)$ s√£o as ordens do componente ARMA n√£o sazonal, $(P, D, Q)_s$ s√£o as ordens do componente ARMA sazonal, e $s$ √© o per√≠odo da sazonalidade.
V. O uso de transforma√ß√µes, como a diferencia√ß√£o sazonal, pode ajudar a estabilizar a s√©rie e a tornar o modelo mais adequado.
VI. Portanto, modelos com componentes de sazonalidade s√£o uma extens√£o natural dos modelos n√£o estacion√°rios, e a modelagem da sazonalidade √© fundamental em s√©ries que apresentam padr√µes peri√≥dicos. ‚ñ†

> üí° **Exemplo Num√©rico:**
> *  A venda de sorvetes apresenta um padr√£o sazonal, com picos no ver√£o e vales no inverno.  Modelos com componente sazonal podem capturar essa varia√ß√£o peri√≥dica.  Se um modelo ARIMA simples for ajustado a essa s√©rie, os res√≠duos apresentar√£o padr√µes peri√≥dicos, indicando que o modelo n√£o est√° capturando a sazonalidade.  O modelo SARIMA seria mais adequado.
>    Por exemplo, um modelo SARIMA com um per√≠odo de 12 meses pode ser utilizado para modelar a sazonalidade anual, com os par√¢metros do modelo ajustados para capturar as varia√ß√µes entre os meses.  Um modelo como $(0, 1, 1)(0, 1, 1)_{12}$ pode capturar a din√¢mica sazonal com a primeira diferen√ßa e com uma m√©dia m√≥vel sazonal e n√£o sazonal.  A primeira diferen√ßa remove a tend√™ncia, e a diferen√ßa sazonal (diferen√ßa entre o valor atual e o valor 12 meses atr√°s) remove a sazonalidade. Os componentes de m√©dia m√≥vel modelam o componente estoc√°stico.
> * O consumo de energia el√©trica apresenta varia√ß√µes di√°rias e semanais, com picos durante o dia e durante a semana.  Modelos com componente sazonal podem capturar esse padr√£o.
>   Por exemplo, um modelo SARIMA com componentes di√°rios e semanais pode ser utilizado para modelar a sazonalidade.  Um modelo com termos que capturem a varia√ß√£o hor√°ria e a varia√ß√£o semanal seria o mais apropriado. Um modelo como $(p,d,q)(P,D,Q)_{24}(P,D,Q)_{168}$ poderia ser utilizado para capturar a sazonalidade di√°ria e semanal, respectivamente.
> * O n√∫mero de passageiros em voos a√©reos apresenta padr√µes sazonais, com picos durante as f√©rias escolares e feriados.  Modelos com componente sazonal podem ser usados para prever o n√∫mero de passageiros e otimizar a aloca√ß√£o de voos.
>   Por exemplo, um modelo SARIMA pode capturar as varia√ß√µes anuais, semestrais, trimestrais, mensais ou semanais, e pode ser usado para prever a demanda de voos em diferentes per√≠odos do ano. O modelo SARIMA √© estimado com base nos dados hist√≥ricos de passageiros.

**Proposi√ß√£o 12.2:** *A modelagem de s√©ries temporais n√£o estacion√°rias muitas vezes envolve a utiliza√ß√£o de testes de hip√≥teses para determinar a presen√ßa de raiz unit√°ria, tend√™ncia, ou quebras estruturais, e para validar a adequa√ß√£o do modelo aos dados.*
*Prova:*
I. Testes de raiz unit√°ria, como o teste de Dickey-Fuller aumentado (ADF) ou o teste de Phillips-Perron (PP), s√£o utilizados para verificar a presen√ßa de raiz unit√°ria na s√©rie. A hip√≥tese nula desses testes √© que a s√©rie tem raiz unit√°ria.
II. Testes para detectar tend√™ncias determin√≠sticas podem ser usados para identificar se a s√©rie tem um padr√£o de crescimento ou decrescimento ao longo do tempo.
III. Testes para identificar quebras estruturais, como o teste de Chow ou o teste de CUSUM, podem ser usados para verificar se a s√©rie apresenta mudan√ßas abruptas em seus par√¢metros.
IV. Testes de adequa√ß√£o do modelo, como o teste de Ljung-Box para verificar se os res√≠duos s√£o ru√≠do branco, s√£o utilizados para validar a adequa√ß√£o do modelo aos dados.
V.  A utiliza√ß√£o de testes de hip√≥teses √© um passo fundamental para garantir a validade estat√≠stica das an√°lises, e para selecionar o modelo mais adequado aos dados.
VI. Portanto, a modelagem de s√©ries temporais n√£o estacion√°rias muitas vezes exige a utiliza√ß√£o de testes de hip√≥teses para detectar caracter√≠sticas da n√£o estacionariedade e para validar a adequa√ß√£o do modelo. ‚ñ†

> üí° **Exemplo Num√©rico:**
> *   Antes de modelar o PIB, √© importante realizar testes de raiz unit√°ria para verificar se a s√©rie tem raiz unit√°ria ou se √© *trend-stationary*. Se o teste ADF n√£o rejeitar a hip√≥tese nula de raiz unit√°ria, um modelo *unit root* pode ser o mais adequado. Por exemplo, se aplicarmos o teste ADF com constante e tend√™ncia no logaritmo do PIB, e obtermos um p-valor de 0.70, n√£o rejeitamos a hip√≥tese nula, e o modelo *unit root* passa a ser o mais adequado.
> *   Em dados financeiros, testes de raiz unit√°ria podem ser utilizados para verificar a estacionaridade dos pre√ßos dos ativos, ou de seus retornos. Se os retornos forem estacion√°rios, modelos ARMA podem ser utilizados para modelar sua din√¢mica.  Se os pre√ßos n√£o forem estacion√°rios, a modelagem pode ser feita com o uso de modelos cointegrados. Se o teste ADF nos retornos de um ativo tiver um p-valor menor do que 0.05, rejeitamos a hip√≥tese nula, e podemos modelar os retornos como um processo estacion√°rio.
> *  Antes de aplicar um modelo ARMA, √© fundamental verificar se os res√≠duos s√£o ru√≠do branco, usando o teste de Ljung-Box. Se os res√≠duos apresentarem autocorrela√ß√£o, o modelo deve ser revisto.  Outros testes, como o teste de Jarque-Bera, podem ser utilizados para verificar a normalidade dos res√≠duos. Se o teste de Ljung-Box apresentar um p-valor menor que 0.05, isso indicaria que os res√≠duos n√£o s√£o ru√≠do branco, e que h√° alguma depend√™ncia serial n√£o capturada pelo modelo.
> * Testes de quebra estrutural podem ser utilizados para verificar se a s√©rie apresenta mudan√ßas abruptas no comportamento, que podem ser causadas por eventos como mudan√ßas de governo ou crises econ√¥micas.
>   Por exemplo, se uma s√©rie apresentar uma mudan√ßa abrupta de n√≠vel devido a uma quebra estrutural, um modelo com mudan√ßa de regime pode ser mais adequado. Se o teste de Chow indicar uma quebra estrutural na s√©rie de desemprego, um modelo de mudan√ßa de regime pode ser utilizado para modelar os dados.

**Lema 12.3:** *A escolha entre diferentes modelos n√£o estacion√°rios (trend-stationary, unit root, modelos com mudan√ßa de regime, modelos de volatilidade condicional, etc.) deve ser guiada por crit√©rios de informa√ß√£o, como o crit√©rio de informa√ß√£o de Akaike (AIC) ou o crit√©rio de informa√ß√£o Bayesiano (BIC).*
*Prova:*
I. Os crit√©rios de informa√ß√£o AIC e BIC penalizam modelos com muitos par√¢metros, e favorecem modelos que apresentem um bom ajuste aos dados com poucos par√¢metros.
II. O AIC e o BIC podem ser utilizados para comparar modelos n√£o aninhados (modelos em que nenhum dos modelos pode ser obtido como um caso particular do outro).
III. O AIC √© dado por $AIC = -2 \log(L) + 2k$, onde $L$ √© a verossimilhan√ßa do modelo e $k$ √© o n√∫mero de par√¢metros.
IV. O BIC √© dado por $BIC = -2 \log(L) + k \log(n)$, onde $n$ √© o n√∫mero de observa√ß√µes.
V. Em geral, o BIC penaliza modelos complexos com mais intensidade do que o AIC, levando √† escolha de modelos mais parcimoniosos.
VI. Portanto, a escolha do modelo mais adequado para s√©ries temporais n√£o estacion√°rias pode ser guiada por crit√©rios de informa√ß√£o, que comparam a adequa√ß√£o do modelo aos dados e sua complexidade.  ‚ñ†

> üí° **Exemplo Num√©rico:**
> * Ao comparar um modelo AR(1) e um modelo AR(2), podemos usar o AIC ou BIC para verificar qual dos dois modelos apresenta um melhor compromisso entre o ajuste aos dados e a complexidade do modelo.  O modelo com o menor valor de AIC ou BIC √© o mais adequado. Se o AIC do modelo AR(1) for 100 e o AIC do modelo AR(2) for 95, o modelo AR(2) seria prefer√≠vel, pois o AIC √© menor. Se o BIC do AR(1) for 105 e o BIC do AR(2) for 110, o modelo AR(1) seria prefer√≠vel, pois o BIC √© menor.
> * Ao comparar um modelo *trend-stationary* com um modelo *unit root* para o PIB, podemos usar o AIC ou BIC para verificar qual dos modelos √© mais adequado aos dados.  O modelo com o menor valor de AIC ou BIC √© o mais adequado, considerando as diferen√ßas no n√∫mero de par√¢metros e o ajuste aos dados. Se o AIC do modelo *trend-stationary* for 150 e o AIC do modelo *unit root* for 145, o modelo *unit root* seria prefer√≠vel.
> * Ao comparar um modelo GARCH(1,1) e um modelo GARCH(2,2) para a volatilidade de um ativo, podemos usar o AIC ou BIC para verificar qual modelo apresenta um melhor compromisso entre o ajuste aos dados e a complexidade do modelo.  O modelo com o menor valor de AIC ou BIC √© o mais adequado. Se o AIC do GARCH(1,1) for 200 e o AIC do GARCH(2,2) for 198, o modelo GARCH(2,2) seria prefer√≠vel.
> * Os crit√©rios de informa√ß√£o podem ser utilizados para escolher entre modelos com diferentes componentes de sazonalidade. O modelo com menor valor de AIC ou BIC √© o mais adequado. Ao compar> * A an√°lise dos res√≠duos do modelo √© crucial para avaliar a sua adequa√ß√£o. Idealmente, os res√≠duos devem ser aleat√≥rios, com m√©dia zero e sem padr√µes discern√≠veis.
> * Se os res√≠duos mostrarem autocorrela√ß√£o, isso indica que o modelo n√£o capturou toda a depend√™ncia temporal nos dados, e pode ser necess√°rio considerar termos AR ou MA.
> * A presen√ßa de heterocedasticidade nos res√≠duos sugere que a vari√¢ncia dos erros n√£o √© constante, e isso pode violar as suposi√ß√µes do modelo.
> * Modelos com componentes de sazonalidade podem ser utilizados para prever valores futuros. A qualidade das previs√µes depende da adequa√ß√£o do modelo e da estabilidade dos padr√µes de sazonalidade ao longo do tempo.
> * Uma vez que um modelo de s√©ries temporais com componentes de sazonalidade tenha sido ajustado, √© fundamental realizar uma valida√ß√£o robusta utilizando dados de teste separados daqueles utilizados no ajuste.
> * A valida√ß√£o cruzada temporal √© uma abordagem que simula cen√°rios de previs√£o e avalia o desempenho do modelo em dados n√£o vistos durante o ajuste.
> * Ao escolher um modelo para s√©ries temporais com sazonalidade, √© importante considerar o conhecimento do dom√≠nio e a interpretabilidade do modelo, al√©m das m√©tricas estat√≠sticas.
> * Em alguns casos, √© poss√≠vel melhorar a previs√£o combinando diferentes modelos de s√©ries temporais que capturam diferentes aspectos dos dados.
> * A modelagem de s√©ries temporais com sazonalidade √© uma √°rea rica e ativa de pesquisa e aplica√ß√µes, e novas abordagens e m√©todos s√£o continuamente desenvolvidos.
> * A escolha do modelo e a interpreta√ß√£o dos resultados requerem cautela, pois modelos mais complexos nem sempre levam a resultados superiores e podem ser suscet√≠veis ao overfitting.

<!-- END -->
