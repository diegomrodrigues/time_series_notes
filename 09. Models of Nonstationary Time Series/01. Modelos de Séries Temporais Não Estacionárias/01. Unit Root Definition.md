## Modelos de S√©ries Temporais N√£o Estacion√°rias: A Import√¢ncia da Condi√ß√£o $\psi(1) \neq 0$ em Processos de Raiz Unit√°ria

### Introdu√ß√£o

Este cap√≠tulo explora modelos para s√©ries temporais n√£o estacion√°rias, contrastando com a an√°lise anterior focada em processos estacion√°rios [^1]. A n√£o estacionariedade, comum em dados econ√¥micos e financeiros, exige abordagens espec√≠ficas para modelagem e previs√£o. Discutiremos duas abordagens principais para modelar tend√™ncias: a inclus√£o de uma tend√™ncia determin√≠stica e a modelagem de processos de raiz unit√°ria [^1]. Este √∫ltimo conceito introduz a condi√ß√£o crucial de que $\psi(1) \neq 0$, que ser√° o foco principal desta discuss√£o, e √© fundamental para distinguir processos de raiz unit√°ria de processos estacion√°rios diferenciados.

### Conceitos Fundamentais

Modelos de s√©ries temporais estacion√°rias, como os discutidos nos cap√≠tulos 3 e 4, podem ser expressos como $y_t = \mu + \epsilon_t + \psi_1\epsilon_{t-1} + \psi_2\epsilon_{t-2} + \ldots = \mu + \psi(L)\epsilon_t$ [^1], onde $\sum_{i=0}^{\infty} |\psi_i| < \infty$, as ra√≠zes de $\psi(z)=0$ est√£o fora do c√≠rculo unit√°rio, e $\{\epsilon_t\}$ √© uma sequ√™ncia de ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$ [^1]. Uma caracter√≠stica chave desses processos √© que a expectativa incondicional da vari√°vel √© constante: $E(y_t) = \mu$. Adicionalmente, previs√µes para o futuro convergem para essa m√©dia incondicional: $\lim_{s \to \infty} \hat{y}_{t+s|t} = \mu$ [^1].
> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal estacion√°ria gerada pelo modelo $y_t = 5 + 0.8\epsilon_{t-1} + \epsilon_t$, onde $\epsilon_t$ s√£o ru√≠dos brancos com m√©dia 0 e vari√¢ncia 1. Aqui, $\mu = 5$, $\psi_1 = 0.8$, e $\psi_i = 0$ para $i > 1$. A expectativa incondicional de $y_t$ √© $E(y_t) = 5$. Se fizermos previs√µes de $y_{t+s}$ com base em $y_t$, √† medida que $s$ aumenta, essas previs√µes convergir√£o para 5.
```python
import numpy as np
import matplotlib.pyplot as plt

# Simula√ß√£o de uma s√©rie temporal estacion√°ria
np.random.seed(42)
T = 100
mu = 5
psi_1 = 0.8
epsilon = np.random.normal(0, 1, T+1)
y = np.zeros(T+1)
for t in range(1,T+1):
  y[t] = mu + psi_1*epsilon[t-1] + epsilon[t]

plt.plot(y[1:])
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.title('S√©rie Temporal Estacion√°ria')
plt.show()
```
Em contrapartida, s√©ries temporais n√£o estacion√°rias podem apresentar tend√™ncias. Duas abordagens comuns para modelar tais tend√™ncias s√£o:

1. **Tend√™ncia Determin√≠stica:** Substituir a m√©dia constante $\mu$ por uma fun√ß√£o linear do tempo, $y_t = \alpha + \delta t + \psi(L)\epsilon_t$ [^1]. Processos deste tipo s√£o chamados *trend-stationary* [^1], pois a remo√ß√£o da tend√™ncia ($\alpha + \delta t$) resulta em um processo estacion√°rio.

2. **Processo de Raiz Unit√°ria:** Especificado como $(1-L)y_t = \delta + \psi(L)\epsilon_t$ [^1], onde $L$ √© o operador de defasagem. Aqui, a primeira diferen√ßa da s√©rie, $\Delta y_t = y_t - y_{t-1}$, √© modelada como um processo estacion√°rio em vez da s√©rie original [^1].

A condi√ß√£o **$\psi(1) \neq 0$** √© fundamental na defini√ß√£o do processo de raiz unit√°ria [^1]. Para entender a import√¢ncia dessa condi√ß√£o, consideremos um processo de raiz unit√°ria na forma:
$$(1 - L)y_t = \delta + \psi(L)\epsilon_t$$ [^1]
onde $\psi(L) = 1 + \psi_1L + \psi_2L^2 + \ldots$ [^1].

Expandindo $\psi(z)$ em $z=1$, temos $\psi(1) = 1 + \psi_1 + \psi_2 + \ldots$ [^1]. A condi√ß√£o $\psi(1) \neq 0$ garante que a s√©rie original $y_t$ n√£o seja estacion√°ria. Se a s√©rie original $y_t$ fosse estacion√°ria com representa√ß√£o $y_t = \mu + \chi(L)\epsilon_t$, ent√£o sua diferencia√ß√£o resultaria em:
$$(1 - L)y_t = (1-L)\chi(L)\epsilon_t = \psi(L)\epsilon_t$$
onde $\psi(L) = (1-L)\chi(L)$. Avaliando em $z=1$, temos $\psi(1) = (1-1)\chi(1) = 0$ [^1]. Portanto, a condi√ß√£o $\psi(1) \neq 0$ exclui explicitamente a possibilidade de que $y_t$ seja estacion√°ria, e que a primeira diferen√ßa resulta em um processo de m√©dia m√≥vel (MA) onde a soma dos coeficientes √© zero [^1].
> üí° **Exemplo Num√©rico:** Suponha que $y_t = \mu + \chi(L)\epsilon_t$ seja um processo estacion√°rio, onde $\chi(L) = 1 + 0.5L$. Assim, $\chi(z) = 1 + 0.5z$. Se diferenciarmos $y_t$, obtemos $(1-L)y_t = (1-L)(1+0.5L)\epsilon_t = (1-0.5L-0.5L^2)\epsilon_t$. Aqui, $\psi(L) = (1-0.5L-0.5L^2)$, e $\psi(1) = 1-0.5-0.5=0$. Observe que a soma dos coeficientes √© zero.
```python
# Simula√ß√£o de um processo estacion√°rio diferenciado
T = 100
mu = 0
chi_1 = 0.5
epsilon = np.random.normal(0, 1, T+2)
y = np.zeros(T+2)
for t in range(2,T+2):
  y[t] = mu + epsilon[t] + chi_1*epsilon[t-1]
diff_y = np.diff(y)
psi_1 = -chi_1
psi_2 = -0.5
print(f"œà(1) = 1 + {psi_1} + {psi_2} = {1+psi_1+psi_2}")
plt.plot(diff_y[1:])
plt.xlabel('Tempo')
plt.ylabel('Œîy_t')
plt.title('Processo Estacion√°rio Diferenciado')
plt.show()

```

**Lema 1:** *Se um processo estacion√°rio $y_t$ tem representa√ß√£o $y_t = \mu + \chi(L)\epsilon_t$, ent√£o o processo diferenciado $(1-L)y_t$ tem representa√ß√£o $(1-L)y_t = \psi(L)\epsilon_t$, onde $\psi(1)=0$.*

*Prova:*
I.  Assumimos que $y_t$ √© um processo estacion√°rio com representa√ß√£o $y_t = \mu + \chi(L)\epsilon_t$.
II. Aplicando o operador de diferen√ßa $(1-L)$ a $y_t$, obtemos: $(1-L)y_t = (1-L)(\mu + \chi(L)\epsilon_t)$.
III. Como $\mu$ √© uma constante, $(1-L)\mu = \mu - \mu = 0$.
IV. Assim, $(1-L)y_t = (1-L)\chi(L)\epsilon_t$.
V. Definindo $\psi(L) = (1-L)\chi(L)$, temos $(1-L)y_t = \psi(L)\epsilon_t$.
VI. Avaliando $\psi(z)$ em $z=1$, obtemos $\psi(1) = (1-1)\chi(1) = 0$.
VII. Portanto, mostramos que $(1-L)y_t = \psi(L)\epsilon_t$ com $\psi(1)=0$. ‚ñ†

O exemplo protot√≠pico de um processo de raiz unit√°ria √© o *random walk with drift*:
$$y_t = y_{t-1} + \delta + \epsilon_t$$ [^1]. Nesse caso, $\psi(L)=1$, ent√£o $\psi(1)=1 \neq 0$ [^1].
> üí° **Exemplo Num√©rico:** Consideremos um *random walk with drift* com $\delta = 0.2$ e ru√≠do branco $\epsilon_t$ com vari√¢ncia 1. A equa√ß√£o √© $y_t = y_{t-1} + 0.2 + \epsilon_t$. Aqui, $\psi(L) = 1$, ent√£o $\psi(1) = 1 \neq 0$. Observe que a s√©rie $y_t$ n√£o √© estacion√°ria, pois a cada passo o valor tem uma tend√™ncia de aumentar em m√©dia 0.2.
```python
# Simula√ß√£o de um random walk with drift
T = 100
delta = 0.2
epsilon = np.random.normal(0, 1, T+1)
y = np.zeros(T+1)
y[0]=0
for t in range(1,T+1):
  y[t] = y[t-1] + delta + epsilon[t]

plt.plot(y)
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.title('Random Walk com Drift')
plt.show()

```
De forma mais geral, a equa√ß√£o [15.1.7] nos mostra uma representa√ß√£o alternativa de um processo de raiz unit√°ria:
$$(1 - L)u_t = (1 + \theta_1L + \theta_2L^2 + \ldots + \theta_qL^q)\epsilon_t = \psi^*(L)\epsilon_t$$, onde $\psi^*(z) = \frac{1 + \theta_1z + \theta_2z^2 + \ldots + \theta_qz^q}{(1-\lambda_2z)\ldots(1-\lambda_pz)}$ com $|\lambda_i|<1$ para $i=2,\ldots,p$ [^1]. Se o polin√¥mio autorregressivo na equa√ß√£o [15.1.6] tivesse uma raiz unit√°ria e as outras ra√≠zes dentro do c√≠rculo unit√°rio, a equa√ß√£o [15.1.7] seria verdadeira [^1].
Nesse contexto, a primeira diferen√ßa de $y_t$ torna-se: $(1-L)y_t = \delta + \psi^*(L)\epsilon_t$, o que est√° na forma de um processo de raiz unit√°ria conforme definido em [15.1.3] [^1]. A condi√ß√£o $\psi(1) \neq 0$ √© crucial porque, se $\psi(1) = 0$, implicaria que a s√©rie $y_t$ original era estacion√°ria, o que contradiz a defini√ß√£o de um processo de raiz unit√°ria [^1].

**Teorema 1:** *Um processo de raiz unit√°ria, definido por $(1-L)y_t = \delta + \psi(L)\epsilon_t$ com $\psi(1) \neq 0$, n√£o pode ser transformado em um processo estacion√°rio por diferencia√ß√£o.*

*Prova:*
I.  Assumimos que $(1-L)y_t = \delta + \psi(L)\epsilon_t$ representa um processo de raiz unit√°ria, onde $\psi(1) \neq 0$.
II.  Por contradi√ß√£o, vamos assumir que aplicar o operador $(1-L)$ a $y_t$ resulta em um processo estacion√°rio. Chamemos esse processo de $z_t$, ou seja, $z_t = (1-L)y_t$.
III. Se $z_t$ √© estacion√°rio, ent√£o pelo Lema 1, $z_t$ deve ter representa√ß√£o da forma $z_t = \psi(L)\epsilon_t$ com $\psi(1) = 0$.
IV. No entanto, sabemos da defini√ß√£o de processo de raiz unit√°ria que $(1-L)y_t = \delta + \psi(L)\epsilon_t$, com $\psi(1) \neq 0$.
V. Essa contradi√ß√£o indica que nossa suposi√ß√£o inicial de que $(1-L)y_t$ resulta em um processo estacion√°rio √© falsa.
VI. Portanto, um processo de raiz unit√°ria, definido com $\psi(1) \neq 0$, n√£o pode ser transformado em um processo estacion√°rio por diferencia√ß√£o. ‚ñ†

**Proposi√ß√£o 1.1:** *A condi√ß√£o $\psi(1) \neq 0$ implica que o processo $(1-L)y_t$ n√£o √© um processo MA estacion√°rio com coeficientes que somam zero.*

*Prova:*
I.  Se $(1-L)y_t$ fosse um processo MA estacion√°rio com coeficientes que somam zero, ent√£o teria uma representa√ß√£o da forma $(1-L)y_t = \psi(L)\epsilon_t$, onde $\psi(1) = 0$.
II.  Entretanto, um processo de raiz unit√°ria √© definido por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, onde $\psi(1) \neq 0$.
III.  Portanto, a condi√ß√£o $\psi(1) \neq 0$ exclui a possibilidade de que $(1-L)y_t$ seja um processo MA estacion√°rio com coeficientes que somam zero. ‚ñ†

### Conclus√£o

A condi√ß√£o $\psi(1) \neq 0$ √© uma caracter√≠stica definidora dos processos de raiz unit√°ria, distinguindo-os de processos estacion√°rios. Esta condi√ß√£o garante que a diferencia√ß√£o da s√©rie n√£o a transforme em um processo estacion√°rio com uma m√©dia m√≥vel (MA) cujo somat√≥rio dos coeficientes seja igual a zero. A compreens√£o desta condi√ß√£o √© crucial para a modelagem e an√°lise de s√©ries temporais n√£o estacion√°rias, especialmente na escolha entre abordagens de tend√™ncia determin√≠stica e de raiz unit√°ria. A implica√ß√£o da condi√ß√£o $\psi(1) \neq 0$ √© que o efeito de um choque aleat√≥rio em um processo de raiz unit√°ria tem um impacto persistente na s√©rie [^1], ao contr√°rio de um processo estacion√°rio, onde o efeito eventualmente se dissipa. Este aspecto tem implica√ß√µes significativas para previs√£o e infer√™ncia estat√≠stica.
> üí° **Exemplo Num√©rico:** Em um processo estacion√°rio, como $y_t = 0.8y_{t-1} + \epsilon_t$, um choque $\epsilon_t$ impacta $y_t$ e seus efeitos diminuem exponencialmente ao longo do tempo. Em um processo de raiz unit√°ria, como $y_t = y_{t-1} + \epsilon_t$, o choque $\epsilon_t$ tem um efeito permanente em $y_t$, pois o valor de $y_t$ √© alterado pelo valor de $\epsilon_t$ e transmitido para os valores futuros da s√©rie.
```python
# Compara√ß√£o entre processo AR(1) e random walk
T = 100
ar_coeff = 0.8
epsilon = np.random.normal(0, 1, T+1)

y_ar = np.zeros(T+1)
y_rw = np.zeros(T+1)
for t in range(1,T+1):
  y_ar[t] = ar_coeff*y_ar[t-1] + epsilon[t]
  y_rw[t] = y_rw[t-1] + epsilon[t]


plt.plot(y_ar, label="AR(1)")
plt.plot(y_rw, label="Random Walk")
plt.legend()
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.title('Compara√ß√£o AR(1) vs Random Walk')
plt.show()
```

### Refer√™ncias
[^1]:  [15.1.1], [15.1.2], [15.1.3], [15.1.4], [15.1.6], [15.1.7]
<!-- END -->
