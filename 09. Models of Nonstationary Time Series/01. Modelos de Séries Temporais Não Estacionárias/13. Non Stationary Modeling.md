## Modelos de S√©ries Temporais N√£o Estacion√°rias: Abordagens com Tend√™ncias Determin√≠sticas e Raiz Unit√°ria

### Introdu√ß√£o

Em continuidade √† discuss√£o sobre modelos de s√©ries temporais n√£o estacion√°rias, este cap√≠tulo aborda especificamente duas das abordagens mais comuns para modelar essa caracter√≠stica: a inclus√£o de **tend√™ncias determin√≠sticas** e a modelagem com **processos de raiz unit√°ria**. Como vimos nos cap√≠tulos anteriores, a n√£o estacionariedade, onde as propriedades estat√≠sticas de uma s√©rie temporal variam ao longo do tempo, √© uma caracter√≠stica inerente a muitos dados econ√¥micos e financeiros [^1], [^2], [^3], [^4]. Modelos estacion√°rios, que assumem propriedades estat√≠sticas constantes, n√£o s√£o adequados para analisar tais s√©ries. Portanto, torna-se crucial o desenvolvimento de abordagens que incorporem e tratem a n√£o estacionariedade de forma expl√≠cita. Neste cap√≠tulo, vamos detalhar as nuances de cada abordagem, seus pressupostos, suas implica√ß√µes e como elas s√£o implementadas na pr√°tica.

### Conceitos Fundamentais

As abordagens para modelar a n√£o estacionariedade podem ser divididas em duas categorias principais:

1.  **Modelagem com Tend√™ncias Determin√≠sticas (Trend-Stationary):**
    *   Nesta abordagem, a n√£o estacionariedade √© atribu√≠da a uma tend√™ncia que pode ser modelada como uma fun√ß√£o determin√≠stica do tempo, tipicamente uma fun√ß√£o linear [^1]. A ideia central √© que, ap√≥s a remo√ß√£o dessa tend√™ncia, o componente estoc√°stico da s√©rie temporal se torna estacion√°rio.
    *  O modelo geral √© dado por:
        $$y_t = \alpha + \delta t + \psi(L)\epsilon_t$$ [^1], onde:
          * $y_t$ √© a s√©rie temporal no instante $t$;
          * $\alpha$ √© o intercepto, representando o valor da s√©rie em $t=0$;
          * $\delta$ √© a inclina√ß√£o da tend√™ncia linear, representando a taxa de crescimento (ou decrescimento) da s√©rie;
          * $t$ √© o √≠ndice de tempo;
          * $\psi(L)\epsilon_t$ √© um componente estoc√°stico estacion√°rio, que pode ser modelado por um processo ARMA.
    *  A presen√ßa do termo $\delta t$ implica que a m√©dia da s√©rie temporal ($E(y_t)$) n√£o √© constante ao longo do tempo, mas sim uma fun√ß√£o linear de $t$.
    *  Ap√≥s a remo√ß√£o da tend√™ncia, obt√©m-se uma s√©rie estacion√°ria, que pode ser modelada usando t√©cnicas de an√°lise de s√©ries temporais estacion√°rias.
    *   A previs√£o em modelos *trend-stationary* converge, no longo prazo, para uma linha reta com inclina√ß√£o $\delta$, e intercepto dependente do tempo.

> üí° **Exemplo Num√©rico:**
>
>   Suponha que modelamos o n√∫mero de assinantes de um servi√ßo de streaming ao longo de 10 per√≠odos (trimestres). Assumindo um modelo com tend√™ncia determin√≠stica, onde $\alpha = 100$ (assinantes iniciais), $\delta = 5$ (crescimento trimestral) e o componente estoc√°stico $\psi(L)\epsilon_t$ √© um ru√≠do branco com m√©dia zero, a s√©rie seria:
>   $y_t = 100 + 5t + \epsilon_t$.
>
>   Para fins de exemplo, vamos gerar alguns dados simulados com ru√≠do branco:
>
>    ```python
>   import numpy as np
>   import matplotlib.pyplot as plt
>
>   np.random.seed(42)
>   t = np.arange(1, 11)
>   alpha = 100
>   delta = 5
>   epsilon = np.random.normal(0, 2, 10) # ru√≠do branco com desvio padr√£o 2
>   y = alpha + delta*t + epsilon
>
>   plt.plot(t, y, marker='o')
>   plt.xlabel('Tempo (Trimestres)')
>   plt.ylabel('N√∫mero de Assinantes')
>   plt.title('S√©rie Temporal com Tend√™ncia Determin√≠stica')
>   plt.grid(True)
>   plt.show()
>   ```
>
>   A m√©dia da s√©rie, $E(y_t) = 100+5t$, aumenta linearmente ao longo do tempo, mas o desvio da m√©dia, dado por $\epsilon_t$, √© estacion√°rio. A remo√ß√£o da tend√™ncia $100+5t$ da s√©rie $y_t$ deixa um res√≠duo estacion√°rio (ru√≠do branco).

2.  **Modelagem com Processos de Raiz Unit√°ria (Unit Root):**
    *   Nesta abordagem, a n√£o estacionariedade √© atribu√≠da √† presen√ßa de uma raiz unit√°ria no processo estoc√°stico da s√©rie, o que implica que choques t√™m um efeito permanente no n√≠vel da s√©rie [^1]. Isso se traduz na persist√™ncia dos efeitos de choques aleat√≥rios ao longo do tempo, e na aus√™ncia de converg√™ncia da s√©rie para um valor m√©dio fixo.
    *  O modelo geral √© dado por:
        $$(1-L)y_t = \delta + \psi(L)\epsilon_t$$ [^1], onde:
          * $y_t$ √© a s√©rie temporal no instante $t$;
          * $L$ √© o operador de defasagem (lag);
          * $\delta$ √© a deriva, representando o crescimento m√©dio da s√©rie;
          * $\psi(L)\epsilon_t$ √© um componente estoc√°stico estacion√°rio, que pode ser modelado por um processo ARMA.
    *   O operador $(1-L)$ representa a primeira diferen√ßa, ou seja, $(1-L)y_t = y_t - y_{t-1} = \Delta y_t$. A equa√ß√£o acima expressa que a primeira diferen√ßa da s√©rie temporal, $\Delta y_t$, tem uma m√©dia constante (dada pela deriva $\delta$), e √© expressa por um componente estoc√°stico estacion√°rio.
    *  A presen√ßa da raiz unit√°ria implica que a s√©rie original ($y_t$) n√£o tem m√©dia constante, mas que a diferen√ßa da s√©rie, $\Delta y_t$, √© estacion√°ria, ap√≥s a remo√ß√£o da deriva.
    * Um caso particular de modelos *unit root* √© o passeio aleat√≥rio com deriva (*random walk with drift*), obtido quando $\psi(L)=1$, que tem a forma $y_t = y_{t-1} + \delta + \epsilon_t$ [^3].
    * A previs√£o em modelos *unit root* converge, no longo prazo, para uma linha reta com inclina√ß√£o $\delta$ e intercepto dependente do √∫ltimo valor observado, $y_t$.

> üí° **Exemplo Num√©rico:**
>
>   Suponha que modelamos o pre√ßo de um ativo financeiro como um passeio aleat√≥rio com deriva, onde a deriva ($\delta$) √© igual a 0.2 e o choque aleat√≥rio ($\epsilon_t$) √© um ru√≠do branco com desvio padr√£o 1. O modelo √© dado por $y_t = y_{t-1} + 0.2 + \epsilon_t$.  Se o valor inicial da s√©rie for $y_0=10$, ent√£o os primeiros valores da s√©rie, com alguns valores simulados para $\epsilon_t$, seriam:
>
>   $y_1 = 10 + 0.2 + \epsilon_1$
>   $y_2 = y_1 + 0.2 + \epsilon_2$
>   $y_3 = y_2 + 0.2 + \epsilon_3$
>
>   Simulando 10 valores para $\epsilon_t$:
>
>   ```python
>   import numpy as np
>   import matplotlib.pyplot as plt
>
>   np.random.seed(42)
>   n = 10
>   delta = 0.2
>   epsilon = np.random.normal(0, 1, n)
>   y = np.zeros(n)
>   y[0] = 10
>
>   for t in range(1, n):
>      y[t] = y[t-1] + delta + epsilon[t]
>
>   plt.plot(range(n), y, marker='o')
>   plt.xlabel('Tempo')
>   plt.ylabel('Pre√ßo do Ativo')
>   plt.title('Passeio Aleat√≥rio com Deriva')
>   plt.grid(True)
>   plt.show()
>   ```
>
>   Observe que a s√©rie n√£o tem uma m√©dia constante, e cada choque tem um impacto permanente no n√≠vel da s√©rie. A primeira diferen√ßa,  $\Delta y_t = y_t - y_{t-1} = 0.2 + \epsilon_t$, tem m√©dia constante 0.2 e componente estoc√°stico estacion√°rio.

**Lema 13:** *A escolha entre modelar a n√£o estacionariedade com tend√™ncia determin√≠stica ou raiz unit√°ria depende da natureza da s√©rie temporal e dos resultados de testes de raiz unit√°ria. A interpreta√ß√£o dos resultados depende da escolha do modelo.*
*Prova:*
I. Modelos com tend√™ncia determin√≠stica s√£o apropriados para s√©ries que apresentam uma tend√™ncia linear, e onde os desvios em torno dessa tend√™ncia s√£o estacion√°rios. A m√©dia do processo original √© uma fun√ß√£o linear do tempo, e o desvio dessa m√©dia √© modelado por um componente estacion√°rio. A previs√£o de longo prazo converge para uma trajet√≥ria linear.
II. Modelos com raiz unit√°ria s√£o apropriados para s√©ries temporais que n√£o possuem uma trajet√≥ria de equil√≠brio no longo prazo e onde choques aleat√≥rios tem um impacto permanente no n√≠vel da s√©rie.  A m√©dia do processo original n√£o √© constante, mas a m√©dia da primeira diferen√ßa √© constante. A previs√£o de longo prazo acompanha uma trajet√≥ria linear com inclina√ß√£o igual √† deriva, com intercepto vari√°vel de acordo com o √∫ltimo valor observado.
III. Testes de raiz unit√°ria, como o teste de Dickey-Fuller aumentado (ADF) e o teste de Phillips-Perron (PP), podem ser utilizados para testar a presen√ßa de uma raiz unit√°ria na s√©rie. Se a hip√≥tese nula de presen√ßa de raiz unit√°ria for rejeitada (por exemplo, o p-valor do teste for menor que 0.05), a modelagem com tend√™ncia determin√≠stica pode ser mais apropriada, pois isso indicaria que a s√©rie √© trend-stationary. Caso contr√°rio, o modelo com raiz unit√°ria pode ser o mais indicado.
IV. A interpreta√ß√£o econ√¥mica da modelagem tamb√©m deve ser levada em considera√ß√£o. Em alguns casos, a exist√™ncia de uma tend√™ncia linear pode ser mais plaus√≠vel do que a exist√™ncia de uma raiz unit√°ria, e vice-versa.
V.  Portanto, a escolha entre essas abordagens depende de uma combina√ß√£o dos resultados estat√≠sticos, dos testes de raiz unit√°ria e de uma interpreta√ß√£o econ√¥mica plaus√≠vel do fen√¥meno.  ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   **Tend√™ncia Determin√≠stica:** Se a s√©rie temporal do n√∫mero de visitantes de um site apresentar um crescimento linear ao longo do tempo, e as flutua√ß√µes ao redor dessa tend√™ncia apresentarem comportamento estacion√°rio, ent√£o a modelagem com tend√™ncia determin√≠stica pode ser mais adequada.  Se, por exemplo, o n√∫mero de visitantes cresce a uma taxa m√©dia de 100 visitantes por dia, e as flutua√ß√µes di√°rias s√£o aleat√≥rias e estacion√°rias, um modelo com tend√™ncia determin√≠stica ser√° apropriado.
> *  **Raiz Unit√°ria:** Se a s√©rie temporal do pre√ßo do petr√≥leo apresentar um comportamento de passeio aleat√≥rio, onde choques aleat√≥rios causam mudan√ßas permanentes no pre√ßo, ent√£o a modelagem com raiz unit√°ria pode ser mais apropriada. Se, por exemplo, um evento geopol√≠tico eleva o pre√ßo do petr√≥leo, esse choque ter√° um efeito permanente no n√≠vel do pre√ßo.
> *   Se o resultado de um teste ADF para o logaritmo do PIB de um pa√≠s apresentar um p-valor de 0.70, n√£o rejeitamos a hip√≥tese nula de raiz unit√°ria, e o modelo mais adequado seria o modelo *unit root* com deriva. Se o resultado do teste apresentar um p-valor de 0.01, rejeitamos a hip√≥tese nula e o modelo *trend-stationary* √© o mais adequado.
> *   Se a taxa de juros de um pa√≠s n√£o apresentar uma tend√™ncia clara de crescimento ao longo do tempo e o resultado do teste ADF apresentar um p-valor de 0.03, rejeitamos a hip√≥tese de raiz unit√°ria, e podemos modelar a s√©rie com um modelo *trend-stationary*, considerando poss√≠veis choques que n√£o tem efeito permanente sobre a s√©rie.

**Proposi√ß√£o 13.1:** *A estima√ß√£o dos par√¢metros em modelos *trend-stationary* √© realizada por regress√£o linear, enquanto a estima√ß√£o de modelos *unit root* envolve a modelagem da s√©rie diferenciada com modelos ARMA.*

*Prova:*
I.  Em modelos *trend-stationary*, a estima√ß√£o dos par√¢metros $\alpha$ e $\delta$ pode ser realizada utilizando o m√©todo dos m√≠nimos quadrados (OLS) ap√≥s definir a matriz de design que inclui uma coluna de 1s e uma coluna com o tempo, $t$ [^4].
II.  Em modelos *unit root*, a estima√ß√£o dos par√¢metros $\delta$ e dos par√¢metros que modelam $\psi(L)$ √© realizada ap√≥s aplicar o operador de diferen√ßa na s√©rie temporal.
III. A estima√ß√£o do componente $\psi(L)\epsilon_t$ pode ser realizada utilizando modelos ARMA, que s√£o modelos de s√©ries temporais estacion√°rias. Os modelos ARMA s√£o estimados utilizando m√©todos como m√°xima verossimilhan√ßa ou m√≠nimos quadrados condicionais.
IV. No passeio aleat√≥rio com deriva, $y_t = y_{t-1} + \delta + \epsilon_t$, o estimador de $\delta$ √© a m√©dia amostral da primeira diferen√ßa da s√©rie temporal.
V. Portanto, a estima√ß√£o dos par√¢metros em modelos *trend-stationary* e *unit root* envolve o uso de diferentes abordagens: regress√£o linear no primeiro caso e modelagem ARMA da s√©rie diferenciada no segundo.  ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *  **Trend-Stationary:** Considere o modelo $y_t = \alpha + \delta t + \epsilon_t$. Para estimar os par√¢metros $\alpha$ e $\delta$, podemos construir a matriz de design $X$ e aplicar a regress√£o linear por m√≠nimos quadrados: $X = \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ \vdots & \vdots \\ 1 & n \end{bmatrix}$.  A solu√ß√£o de m√≠nimos quadrados seria $\hat{\beta} = (X'X)^{-1} X' Y$, onde $\beta = [\alpha, \delta]'$, e $Y$ √© o vetor com os valores observados da s√©rie temporal.
>
>   Vamos simular uma s√©rie com tend√™ncia, e estimar os par√¢metros usando a fun√ß√£o OLS do pacote `statsmodels`.
>
>   ```python
>   import numpy as np
>   import statsmodels.api as sm
>   import pandas as pd
>
>   # Simula√ßao de dados
>   np.random.seed(42)
>   n = 100
>   t = np.arange(1, n+1)
>   alpha_true = 5
>   delta_true = 0.3
>   epsilon = np.random.normal(0, 1, n)
>   y_t = alpha_true + delta_true*t + epsilon
>
>   # Criar a matriz X
>   X = np.column_stack((np.ones(n), t))
>
>   # Estimar os par√¢metros via OLS
>   model = sm.OLS(y_t, X)
>   results = model.fit()
>
>   print(results.summary())
>   print("Par√¢metros estimados:", results.params)
>
>   # Os resultados retornam os seguintes valores:
>   # Par√¢metros estimados: [5.19985189 0.29417253]
>   ```
>   Podemos observar que os valores estimados de $\alpha$ e $\delta$ ($5.199$ e $0.294$, respectivamente) s√£o pr√≥ximos dos valores verdadeiros ($5$ e $0.3$), demonstrando que a regress√£o linear consegue estimar os par√¢metros de forma precisa.
> *  **Raiz Unit√°ria:** Considere o modelo $(1-L)y_t = \delta + \epsilon_t$. A primeira diferen√ßa da s√©rie √© $\Delta y_t = y_t - y_{t-1} = \delta + \epsilon_t$.  Para estimar o par√¢metro $\delta$, calculamos a m√©dia amostral da primeira diferen√ßa. Para o caso em que $\psi(L)$ n√£o √© 1, ou seja, que o componente estacion√°rio pode ser modelado por ARMA, o modelo √© estimado via modelos de s√©ries temporais estacion√°rias como ARMA, ap√≥s a aplica√ß√£o da diferen√ßa.
>
>  Vamos simular uma s√©rie com passeio aleat√≥rio com deriva, calcular a primeira diferen√ßa e estimar o par√¢metro $\delta$:
>
> ```python
>   import numpy as np
>   from statsmodels.tsa.arima.model import ARIMA
>   import pandas as pd
>
>   # Simula√ß√£o de dados
>   np.random.seed(42)
>   n = 100
>   epsilon = np.random.normal(0, 1, n)
>   delta_true = 0.1
>   y_t = np.zeros(n)
>   for t in range(1,n):
>     y_t[t] = y_t[t-1] + delta_true + epsilon[t]
>
>   # Aplicar a diferencia√ß√£o
>   diff_y = np.diff(y_t)
>
>   # Estimar a deriva
>   mean_diff = np.mean(diff_y)
>   print(f"Estimativa da deriva: {mean_diff}")
>   # Modelar o res√≠duo
>   model = ARIMA(diff_y, order=(1,0,0))
>   model_fit = model.fit()
>   print(model_fit.summary())
>    # Os resultados retornam uma estimativa de deriva pr√≥xima de 0.1 e estimativas dos par√¢metros AR(1)
> ```

**Teorema 13:** *A an√°lise de res√≠duos √© crucial para validar a adequa√ß√£o de modelos *trend-stationary* e *unit root*, e m√©todos como testes de autocorrela√ß√£o e testes de raiz unit√°ria s√£o utilizados para validar os modelos.*

*Prova:*
I. Em modelos *trend-stationary*, os res√≠duos, dados por $\hat{\epsilon}_t = y_t - \hat{\alpha} - \hat{\delta}t$, devem apresentar um comportamento de ru√≠do branco, ou seja, m√©dia zero, vari√¢ncia constante, e aus√™ncia de autocorrela√ß√£o.
II. Em modelos *unit root*, os res√≠duos do componente estacion√°rio, dados por $\psi(L)\epsilon_t$, devem apresentar um comportamento de ru√≠do branco.
III. O correlograma e o correlograma parcial dos res√≠duos devem ser analisados para verificar a presen√ßa de autocorrela√ß√£o residual, e o teste de Ljung-Box pode ser utilizado para verificar a aleatoriedade dos res√≠duos.
IV. Testes de raiz unit√°ria podem ser utilizados para verificar se os res√≠duos de um modelo *trend-stationary* ou os res√≠duos do componente estacion√°rio de um modelo *unit root* apresentam n√£o estacionariedade.
V. A an√°lise dos res√≠duos permite avaliar a adequa√ß√£o do modelo e verificar se alguma estrutura temporal da s√©rie n√£o foi capturada pelo modelo.
VI. Portanto, a an√°lise de res√≠duos, testes de autocorrela√ß√£o, e testes de raiz unit√°ria s√£o cruciais para validar a adequa√ß√£o dos modelos *trend-stationary* e *unit root*. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *  **Trend-Stationary:** Se modelarmos o PIB com um modelo $PIB_t = \alpha + \delta t + \epsilon_t$, ap√≥s estimar os par√¢metros, podemos analisar os res√≠duos $\hat{\epsilon}_t$ e verificar seu correlograma. Se o correlograma exibir autocorrela√ß√£o em algumas defasagens, isso indica que o modelo n√£o capturou a din√¢mica da s√©rie, e que podemos modelar os res√≠duos com modelos ARMA.
>   Por exemplo, se o teste de Ljung-Box indicar autocorrela√ß√£o, e o correlograma apresentar um padr√£o na primeira defasagem, podemos modelar os res√≠duos com um modelo AR(1).
>   Vamos analisar os res√≠duos do modelo estimado anteriormente:
>
>   ```python
>   import numpy as np
>   import statsmodels.api as sm
>
>   # Simula√ßao de dados (reutilizando o c√≥digo anterior)
>   np.random.seed(42)
>   n = 100
>   t = np.arange(1, n+1)
>   alpha_true = 5
>   delta_true = 0.3
>   epsilon = np.random.normal(0, 1, n)
>   y_t = alpha_true + delta_true*t + epsilon
>   X = np.column_stack((np.ones(n), t))
>   model = sm.OLS(y_t, X)
>   results = model.fit()
>
>   # Calcular os res√≠duos
>   residuals = results.resid
>
>   # Teste de Ljung-Box
>   lb_test = sm.stats.acorr_ljungbox(residuals, lags=[10], return_df=True)
>   print(f"P-valor do teste de Ljung-Box: {lb_test['lb_pvalue'].values[0]}")
>   ```
>   Se o p-valor for alto (por exemplo, maior que 0.05), n√£o rejeitamos a hip√≥tese nula de que os res√≠duos s√£o um ru√≠do branco, indicando que o modelo √© adequado.
> *  **Raiz Unit√°ria:** Se modelarmos o pre√ßo de uma a√ß√£o com um modelo de passeio aleat√≥rio com deriva, como $y_t = y_{t-1} + \delta + \epsilon_t$, ap√≥s estimar o par√¢metro $\delta$ e calcular os res√≠duos, podemos realizar o teste de raiz unit√°ria nos res√≠duos $\epsilon_t$ para verificar se eles apresentam n√£o estacionariedade.  O correlograma dos res√≠duos tamb√©m deve ser analisado.
> Por exemplo, se os res√≠duos apresentarem comportamento de passeio aleat√≥rio, isso indicaria que a s√©rie original n√£o foi adequadamente modelada, e que devemos rever o modelo.
>   O teste de Ljung-Box tamb√©m pode ser utilizado para avaliar se os res√≠duos $\epsilon_t$ s√£o ru√≠do branco.
>
>   Vamos calcular os res√≠duos do modelo de passeio aleat√≥rio e aplicar o teste de Ljung-Box:
>   ```python
>   import numpy as np
>   import statsmodels.api as sm
>
>   # Simula√ß√£o de dados (reutilizando o c√≥digo anterior)
>   np.random.seed(42)
>   n = 100
>   epsilon = np.random.normal(0, 1, n)
>   delta_true = 0.1
>   y_t = np.zeros(n)
>   for t in range(1,n):
>     y_t[t] = y_t[t-1] + delta_true + epsilon[t]
>   diff_y = np.diff(y_t)
>   model = ARIMA(diff_y, order=(1,0,0))
>   model_fit = model.fit()
>
>   # Calcular os res√≠duos
>   residuals = model_fit.resid
>   # Teste de Ljung-Box
>   lb_test = sm.stats.acorr_ljungbox(residuals, lags=[10], return_df=True)
>   print(f"P-valor do teste de Ljung-Box: {lb_test['lb_pvalue'].values[0]}")
>
>   ```
>   Um p-valor alto indicaria que o res√≠duo do componente estacion√°rio se comporta como ru√≠do branco.

**Lema 13.1:** *A previs√£o de s√©ries temporais n√£o estacion√°rias utilizando modelos *trend-stationary* e *unit root* apresenta caracter√≠sticas distintas em termos de incerteza e trajet√≥ria de longo prazo.*
*Prova:*
I. Modelos *trend-stationary* geram previs√µes que tendem a convergir para a trajet√≥ria da tend√™ncia, ou seja, para uma linha reta com inclina√ß√£o $\delta$, com uma incerteza que depende da vari√¢ncia do componente estacion√°rio $\psi(L)\epsilon_t$.
II. Modelos *unit root* geram previs√µes que convergem para uma linha reta com inclina√ß√£o $\delta$, mas o intercepto √© dado pelo √∫ltimo valor observado $y_t$, e a vari√¢ncia do erro de previs√£o tende a crescer com o horizonte de previs√£o.
III.  Em modelos *trend-stationary*, a incerteza da previs√£o se concentra nas flutua√ß√µes ao redor da tend√™ncia, e o erro de previs√£o tende a se estabilizar no longo prazo, j√° que a previs√£o converge para a tend√™ncia.
IV. Em modelos *unit root*, a incerteza da previs√£o tende a aumentar com o horizonte da previs√£o, devido √† natureza persistente dos choques.
V. Modelos ARIMA geram previs√µes que tamb√©m convergem para uma trajet√≥ria de longo prazo, mas a incerteza da previs√£o tende a aumentar com o horizonte de previs√£o, e essa incerteza aumenta com a ordem de integra√ß√£o da s√©rie.
VI. Portanto, as previs√µes de modelos *trend-stationary* e *unit root* se comportam de forma diferente, com diferentes n√≠veis de incerteza e diferentes trajet√≥rias de converg√™ncia no longo prazo. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   **Trend-Stationary:** Se o PIB for modelado como $PIB_t = \alpha + \delta t + \epsilon_t$, a previs√£o de longo prazo ser√° dada por $\hat{PIB}_{t+h} = \hat{\alpha} + \hat{\delta}(t+h)$, que √© uma linha reta com inclina√ß√£o $\hat{\delta}$.  A vari√¢ncia do erro de previs√£o tende a ser constante no longo prazo, e o erro de previs√£o tender√° para a vari√¢ncia do res√≠duo $\epsilon_t$.
>   Vamos usar os par√¢metros estimados anteriormente para gerar uma previs√£o:
>    ```python
>   import numpy as np
>   import statsmodels.api as sm
>
>   # Simula√ßao de dados (reutilizando o c√≥digo anterior)
>   np.random.seed(42)
>   n = 100
>   t = np.arange(1, n+1)
>   alpha_true = 5
>   delta_true = 0.3
>   epsilon = np.random.normal(0, 1, n)
>   y_t = alpha_true + delta_true*t + epsilon
>   X = np.column_stack((np.ones(n), t))
>   model = sm.OLS(y_t, X)
>   results = model.fit()
>
>   # Par√¢metros estimados
>   alpha_hat = results.params[0]
>   delta_hat = results.params[1]
>   # Previs√£o para h=10
>   h = 10
>   t_future = np.arange(n+1, n+h+1)
>   forecast = alpha_hat + delta_hat*t_future
>   print(forecast)
>   ```
>
> *   **Raiz Unit√°ria:** Se o pre√ßo da a√ß√£o for modelado como $Preco_t = Preco_{t-1} + \delta + \epsilon_t$, a previs√£o de longo prazo ser√° dada por $\hat{Preco}_{t+h} = Preco_t + h \hat{\delta}$.  A incerteza da previs√£o aumenta com o horizonte $h$. Se a vari√¢ncia de $\epsilon_t$ for $\sigma^2$, ent√£o a vari√¢ncia do erro de previs√£o para um horizonte $h$ √© $h\sigma^2$.
>   Vamos simular e gerar uma previs√£o para um modelo com raiz unit√°ria:
>
>   ```python
>   import numpy as np
>   from statsmodels.tsa.arima.model import ARIMA
>
>   # Simula√ß√£o de dados (reutilizando o c√≥digo anterior)
>   np.random.seed(42)
>   n = 100
>   epsilon = np.random.normal(0, 1, n)
>   delta_true = 0.1
>   y_t = np.zeros(n)
>   for t in range(1,n):
>     y_t[t] = y_t[t-1] + delta_true + epsilon[t]
>   diff_y = np.diff(y_t)
>   model = ARIMA(diff_y, order=(1,0,0))
>   model_fit = model.fit()
>
>    # Par√¢metro estimado
>   delta_hat = model_fit.params[0]
>   # Previs√£o para h=10
>   h=10
>   last_value = y_t[-1]
>   forecast = last_value + delta_hat*h
>   print(forecast)
>   ```
> * Um modelo ARIMA (1,1,0) para uma s√©rie $y_t$ √© dado por $\Delta y_t = \phi \Delta y_{t-1} + \epsilon_t$.  As previs√µes de longo prazo seguir√£o uma trajet√≥ria com deriva, mas com uma incerteza crescente com o horizonte, mas em uma taxa menor do que em um modelo de passeio aleat√≥rio com deriva.

**Proposi√ß√£o 13.2:** *Modelos com componentes de sazonalidade, que modelam padr√µes peri√≥dicos nas s√©ries temporais, s√£o uma extens√£o natural dos modelos n√£o estacion√°rios, e podem capturar padr√µes temporais importantes em s√©ries econ√¥micas e financeiras.*

*Prova:*
I. S√©ries temporais em economia e finan√ßas podem apresentar padr√µes peri√≥dicos, como varia√ß√µes anuais, trimestrais, mensais ou di√°rias.
II. Modelos com componentes de sazonalidade, como modelos SARIMA, podem ser utilizados para modelar esses padr√µes.
III. Modelos SARIMA generalizam modelos ARIMA, incorporando componentes autoregressivos e de m√©dias m√≥veis sazonais, que capturam as depend√™ncias temporais em diferentes defasagens.
IV. O modelagem da sazonalidade pode ser aditiva ou multiplicativa, dependendo de como a varia√ß√£o peri√≥dica interage com a tend√™ncia da s√©rie.
V. A diferencia√ß√£o sazonal √© uma ferramenta √∫til para remover a n√£o estacionariedade sazonal, ao aplicar o operador $(1 - L^s)$, onde $s$ √© o per√≠odo da sazonalidade.
VI. Portanto, modelos com componentes de sazonalidade s√£o uma extens√£o natural dos modelos n√£o estacion√°rios, e podem capturar padr√µes temporais importantes em s√©ries econ√¥micas e financeiras.  ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   Se uma s√©rie temporal apresentar picos de vendas no final de cada ano, a modelagem com um componente sazonal de per√≠odo 12 (um ano) seria apropriada. Um modelo SARIMA, como $(p, d, q)(P, D, Q)_{12}$, pode ser utilizado.
>   Por exemplo, um modelo SARIMA(1,1,1)(0,1,1)12 pode ser usado para modelar o n√∫mero de vendas de produtos de natal, com um padr√£o de crescimento ao longo do tempo e um pico em dezembro de cada ano.
> *   Se a s√©rie de temperatura apresentar varia√ß√µes di√°rias e anuais, um modelo com componentes de sazonalidade di√°ria e anual seria mais adequado, como um modelo SARIMA com dois componentes sazonais $(p, d, q)(P_1, D_1, Q_1)_{24}(P_2, D_2, Q_2)_{365}$.
>   Um modelo SARIMA(1,0,0)(1,0,0)24(1,0,0)365 pode capturar as varia√ß√µes di√°rias e anuais da temperatura.
> *   Se uma s√©rie de vendas apresentar picos semanais, um modelo com componente sazonal de per√≠odo 7 (uma semana) seria adequado.  O modelo poderia ser da forma $(p, d, q)(P, D, Q)_7$.
>   Um modelo SARIMA(0,0,1)(0,1,1)7 pode capturar o padr√£o semanal de vendas, com picos nos finais de semana e quedas nos dias de semana.
> *   Ao modelar o consumo de energia el√©trica, pode ser apropriado utilizar modelos com componentes de sazonalidade di√°ria e semanal.  O modelo poderia ser da forma $(p, d, q)(P, D, Q)_{24}(P, D, Q)_{168}$.
>  Um modelo SARIMA(1,1,0)(1,1,0)24(0,1,1)168 pode capturar os padr√µes de consumo de energia em hor√°rios do dia e dias da semana.

**Teorema 13.1:** *A presen√ßa de m√∫ltiplas ra√≠zes unit√°rias em uma s√©rie temporal implica que a s√©rie deve ser diferenciada m√∫ltiplas vezes para se tornar estacion√°ria, e que cada diferen√ßa removida corresponde a uma ordem de integra√ß√£o.*

*Prova:*
I. Uma s√©rie temporal $y_t$ que possui uma raiz unit√°ria, como discutido anteriormente, deve ser diferenciada uma vez para se tornar estacion√°ria. Essa s√©rie √© dita integrada de ordem 1, ou I(1).
II. Se a primeira diferen√ßa de uma s√©rie, $\Delta y_t$, ainda apresentar n√£o estacionariedade, mas a segunda diferen√ßa, $\Delta^2 y_t = \Delta (\Delta y_t) = y_t - 2y_{t-1} + y_{t-2}$, for estacion√°ria, ent√£o a s√©rie $y_t$ √© dita integrada de ordem 2, ou I(2). Isso significa que a s√©rie possui duas ra√≠zes unit√°rias.
III. De maneira geral, se uma s√©rie $y_t$ deve ser diferenciada $d$ vezes para se tornar estacion√°ria, ent√£o a s√©rie √© dita integrada de ordem $d$, ou I($d$).
IV.  A presen√ßa de m√∫ltiplas ra√≠zes unit√°rias implica que os choques t√™m efeitos persistentes em diferentes n√≠veis da s√©rie.
V.  A identifica√ß√£o da ordem de integra√ß√£o de uma s√©rie √© fundamental para a correta especifica√ß√£o do modelo.
VI. Portanto, a presen√ßa de m√∫ltiplas ra√≠zes unit√°rias requer diferencia√ß√£o m√∫ltipla para tornar a s√©rie estacion√°ria, e cada diferencia√ß√£o corresponde a uma ordem de integra√ß√£o. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   Se a primeira diferen√ßa da s√©rie de pre√ßo de uma commodity, $\Delta Preco_t$, apresentar um padr√£o de passeio aleat√≥rio com deriva, ent√£o a s√©rie original $Preco_t$ √© I(2), pois √© necess√°rio diferenciar a s√©rie duas vezes para se obter estacionariedade.
>  Se $\Delta Preco_t = \Delta Preco_{t-1} + \delta + \epsilon_t$, onde $\epsilon_t$ √© ru√≠do branco, ent√£o $Preco_t$ √© I(2).
> *   Uma s√©rie temporal $y_t$ que seja a soma de um passeio aleat√≥rio com deriva com um componente estoc√°stico estacion√°rio, pode ser modelada como $y_t = y_{t-1} + \delta + \epsilon_t + u_t$, onde $u_t$ √© um processo estacion√°rio. A s√©rie original $y_t$ √© I(1).
>   Neste caso, a primeira diferen√ßa, $\Delta y_t = \delta + \epsilon_t + u_t - u_{t-1}$, ser√° estacion√°ria.
> *   Uma s√©rie $z_t$ onde $\Delta z_t$ siga um modelo AR(1), como $\Delta z_t = \phi \Delta z_{t-1} + \epsilon_t$, ser√° I(1), pois a primeira diferen√ßa √© estacion√°ria.
>  Neste caso, a s√©rie original> $z_t$ ter√° uma raiz unit√°ria. Modelos com ra√≠zes unit√°rias s√£o importantes em economia e finan√ßas porque muitas s√©ries temporais macroecon√¥micas, como PIB, infla√ß√£o e taxas de juros, mostram esse comportamento.

### Testes de Raiz Unit√°ria

Para verificar se uma s√©rie temporal possui uma raiz unit√°ria, podem ser utilizados testes estat√≠sticos. Os mais comuns s√£o:

*   **Teste de Dickey-Fuller (DF):** Este √© um dos testes mais antigos e simples para verificar a exist√™ncia de uma raiz unit√°ria. A ideia b√°sica √© regredir a s√©rie temporal em seus valores defasados e testar se o coeficiente do termo defasado √© estatisticamente igual a 1.
*   **Teste de Dickey-Fuller Aumentado (ADF):** Este teste √© uma extens√£o do teste DF, que leva em conta a possibilidade de autocorrela√ß√£o nos res√≠duos. Ele inclui termos defasados da primeira diferen√ßa da s√©rie temporal na regress√£o.
*   **Teste de Phillips-Perron (PP):** Este teste √© uma alternativa ao teste ADF que tamb√©m lida com a autocorrela√ß√£o nos res√≠duos, mas de uma maneira diferente.

#### Teste de Dickey-Fuller (DF)

O teste DF baseia-se na seguinte regress√£o:

$$
\Delta y_t = \alpha y_{t-1} + \epsilon_t
$$

onde $\Delta y_t = y_t - y_{t-1}$ √© a primeira diferen√ßa da s√©rie $y_t$, e $\epsilon_t$ √© um termo de erro. A hip√≥tese nula √© que $\alpha = 0$, o que indica a presen√ßa de uma raiz unit√°ria (ou seja, que $y_t$ √© n√£o estacion√°rio). A hip√≥tese alternativa √© que $\alpha < 0$, indicando que $y_t$ √© estacion√°rio.

#### Teste de Dickey-Fuller Aumentado (ADF)

O teste ADF considera a seguinte regress√£o:

$$
\Delta y_t = \alpha y_{t-1} + \sum_{i=1}^{p} \beta_i \Delta y_{t-i} + \epsilon_t
$$

onde $p$ √© o n√∫mero de defasagens inclu√≠das para modelar a autocorrela√ß√£o nos res√≠duos. Similarmente ao teste DF, a hip√≥tese nula √© que $\alpha = 0$.

#### Teste de Phillips-Perron (PP)

O teste PP utiliza uma abordagem diferente para lidar com a autocorrela√ß√£o. Ele n√£o adiciona termos defasados na regress√£o, mas sim ajusta as estat√≠sticas do teste para levar em considera√ß√£o a autocorrela√ß√£o. A hip√≥tese nula tamb√©m √© $\alpha = 0$.

### Escolha do Teste

A escolha do teste depende das caracter√≠sticas da s√©rie temporal. O teste DF √© apropriado quando n√£o h√° autocorrela√ß√£o nos res√≠duos. Se a autocorrela√ß√£o estiver presente, os testes ADF ou PP devem ser preferidos. A escolha entre ADF e PP geralmente se baseia em quais s√£o as suposi√ß√µes que parecem mais adequadas para a s√©rie em an√°lise.

### Interpreta√ß√£o dos Resultados

Os testes de raiz unit√°ria fornecem um valor-p. Se o valor-p for menor do que um n√≠vel de signific√¢ncia pr√©-determinado (como 0.05), a hip√≥tese nula de que a s√©rie possui uma raiz unit√°ria √© rejeitada. Caso contr√°rio, n√£o h√° evid√™ncia estat√≠stica para rejeitar a hip√≥tese nula.

### Aplica√ß√µes em Finan√ßas

Em finan√ßas, os testes de raiz unit√°ria s√£o utilizados em diversas aplica√ß√µes, como:

*   **An√°lise de S√©ries Temporais de Pre√ßos de Ativos:** Muitos pre√ßos de ativos, como a√ß√µes, podem exibir comportamento n√£o estacion√°rio.
*   **Modelagem de Taxas de Juros:** As taxas de juros tamb√©m podem ter ra√≠zes unit√°rias.
*   **An√°lise de Cointegra√ß√£o:** Testar se um conjunto de s√©ries temporais n√£o estacion√°rias possui uma rela√ß√£o de longo prazo est√°vel.
*   **Previs√£o:** A presen√ßa de uma raiz unit√°ria pode afetar a forma como as previs√µes s√£o geradas.

Em resumo, a presen√ßa de ra√≠zes unit√°rias √© um conceito importante em s√©ries temporais, especialmente em economia e finan√ßas. Os testes de raiz unit√°ria s√£o ferramentas essenciais para identificar esse comportamento e modelar as s√©ries temporais de forma apropriada. <!-- END -->
