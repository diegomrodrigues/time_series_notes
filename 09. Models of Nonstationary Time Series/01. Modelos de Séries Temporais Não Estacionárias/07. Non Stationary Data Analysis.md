## Modelos de S√©ries Temporais N√£o Estacion√°rias: A Import√¢ncia da N√£o Estacionariedade em Dados Econ√¥micos e Financeiros

### Introdu√ß√£o

Em continuidade aos cap√≠tulos anteriores, que abordaram as nuances entre processos estacion√°rios e n√£o estacion√°rios, a diferencia√ß√£o entre modelos *trend-stationary* e *unit root*, as implica√ß√µes computacionais dessa escolha, e a limita√ß√£o da premissa de converg√™ncia para uma m√©dia em s√©ries temporais com tend√™ncias, este cap√≠tulo se dedica a explorar a import√¢ncia da n√£o estacionariedade no contexto de dados econ√¥micos e financeiros. A necessidade de estudar a n√£o estacionariedade surge da sua ampla preval√™ncia em dados dessas √°reas, onde tend√™ncias, mudan√ßas de regimes, e comportamentos n√£o constantes s√£o a regra, e n√£o a exce√ß√£o. Modelos n√£o estacion√°rios s√£o, portanto, ferramentas indispens√°veis para an√°lises e previs√µes precisas nesses campos. Este cap√≠tulo enfatiza a relev√¢ncia da modelagem da n√£o estacionariedade para uma compreens√£o aprofundada de fen√¥menos econ√¥micos e financeiros complexos.

### Conceitos Fundamentais

Como vimos anteriormente, processos estacion√°rios s√£o aqueles cujas propriedades estat√≠sticas (m√©dia, vari√¢ncia, autocovari√¢ncia) s√£o constantes ao longo do tempo [^1]. Essa propriedade simplifica a modelagem, mas √© inadequada para muitas s√©ries temporais econ√¥micas e financeiras, que exibem n√£o estacionariedade. A n√£o estacionariedade pode se manifestar de diversas formas, incluindo:

1.  **Tend√™ncias:** As s√©ries temporais podem apresentar tend√™ncias ascendentes ou descendentes ao longo do tempo. Essas tend√™ncias podem ser determin√≠sticas, como no caso de modelos *trend-stationary*, onde a tend√™ncia √© modelada por uma fun√ß√£o linear do tempo, ou podem ser estoc√°sticas, como em modelos *unit root*, onde a tend√™ncia √© resultado de choques acumulados ao longo do tempo.
2.  **Mudan√ßas de Regime:** As s√©ries temporais podem apresentar mudan√ßas abruptas em suas propriedades estat√≠sticas ao longo do tempo, como altera√ß√µes na m√©dia ou na vari√¢ncia. Essas mudan√ßas podem ser causadas por eventos econ√¥micos ou pol√≠ticos, como crises financeiras, mudan√ßas de pol√≠ticas econ√¥micas ou choques de pre√ßos de commodities.
3.  **Sazonalidade:** S√©ries temporais podem apresentar padr√µes sazonais, que se repetem em intervalos regulares, como o aumento das vendas no varejo no final do ano ou as varia√ß√µes na produ√ß√£o agr√≠cola ao longo das esta√ß√µes do ano. A sazonalidade pode ser vista como um tipo de n√£o estacionariedade peri√≥dica.
4.  **Volatilidade Vari√°vel no Tempo:** A volatilidade (desvio padr√£o) de ativos financeiros, como a√ß√µes ou taxas de c√¢mbio, pode variar ao longo do tempo. Em muitos casos, per√≠odos de alta volatilidade se agrupam, seguidos por per√≠odos de baixa volatilidade. Modelos de volatilidade condicional, como modelos ARCH e GARCH, s√£o usados para modelar esse tipo de n√£o estacionariedade.
5.  **Mem√≥ria Longa:** Algumas s√©ries temporais econ√¥micas e financeiras apresentam uma depend√™ncia de longo prazo, ou seja, correla√ß√µes entre observa√ß√µes passadas e futuras que n√£o decaem rapidamente com o aumento do intervalo de tempo. Processos com mem√≥ria longa, como processos fracamente estacion√°rios ou modelos de integra√ß√£o fracion√°ria, s√£o utilizados para modelar esse tipo de n√£o estacionariedade.

> üí° **Exemplo Num√©rico:**
>
> *   **Tend√™ncia:** O Produto Interno Bruto (PIB) de muitos pa√≠ses apresenta uma tend√™ncia de crescimento ao longo do tempo.
> *   **Mudan√ßa de Regime:** A taxa de juros pode ter mudan√ßas de regime abruptas, como no caso de uma mudan√ßa na pol√≠tica monet√°ria de um pa√≠s.
> *   **Sazonalidade:** As vendas no varejo de muitos pa√≠ses apresentam um padr√£o sazonal, com picos no final do ano.
> *   **Volatilidade Vari√°vel no Tempo:** O pre√ßo de uma a√ß√£o pode apresentar alta volatilidade durante uma crise econ√¥mica e baixa volatilidade em per√≠odos de estabilidade.
> *   **Mem√≥ria Longa:** O pre√ßo de algumas commodities, como o petr√≥leo, pode apresentar depend√™ncias de longo prazo.
>
> Esses s√£o alguns exemplos que mostram que a n√£o estacionariedade √© comum em dados econ√¥micos e financeiros, e que modelos estacion√°rios podem ser inadequados para capturar essas caracter√≠sticas.

A modelagem da n√£o estacionariedade √© crucial para que se obtenha uma representa√ß√£o precisa da din√¢mica das s√©ries temporais econ√¥micas e financeiras. Modelos estacion√°rios assumem que os processos s√£o est√°veis, e n√£o permitem mudan√ßas na m√©dia ou na vari√¢ncia ao longo do tempo, o que pode levar a conclus√µes err√¥neas e previs√µes imprecisas. A modelagem da n√£o estacionariedade tamb√©m √© importante para a an√°lise de causalidade e para testes de hip√≥teses em dados econ√¥micos e financeiros.

**Lema 7:** *Dados econ√¥micos e financeiros frequentemente exibem n√£o estacionariedade devido a fatores como crescimento econ√¥mico, choques de mercado e mudan√ßas em pol√≠ticas.*

*Prova:*
I. O crescimento econ√¥mico, tipicamente, leva a tend√™ncias de longo prazo em s√©ries como o PIB e renda nacional, o que causa n√£o estacionariedade na m√©dia dessas s√©ries.
II. Choques de mercado, como crises financeiras, choques de petr√≥leo ou pandemias, levam a mudan√ßas abruptas no comportamento de s√©ries financeiras e macroecon√¥micas, gerando n√£o estacionariedade nas vari√¢ncias.
III. Mudan√ßas em pol√≠ticas econ√¥micas, como altera√ß√µes na taxa de juros, pol√≠ticas fiscais ou regulamenta√ß√µes financeiras, podem alterar a m√©dia e a volatilidade das s√©ries, o que tamb√©m gera n√£o estacionariedade.
IV. Portanto, a presen√ßa de crescimento econ√¥mico, choques de mercado e mudan√ßas em pol√≠ticas s√£o causas comuns de n√£o estacionariedade em dados econ√¥micos e financeiros. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   O crescimento do PIB de um pa√≠s geralmente n√£o √© constante, mas exibe uma tend√™ncia de crescimento ao longo do tempo, tornando a s√©rie n√£o estacion√°ria em termos de m√©dia. Suponha que o PIB de um pa√≠s cres√ßa em m√©dia 2% ao ano. Um modelo estacion√°rio que assuma m√©dia constante n√£o ser√° capaz de capturar essa tend√™ncia.
> *   A crise financeira de 2008 gerou um choque de volatilidade em muitos mercados financeiros, tornando s√©ries de pre√ßos de ativos n√£o estacion√°rias em termos de vari√¢ncia. O √≠ndice S\&P 500, por exemplo, teve uma volatilidade muito alta durante a crise, com desvios padr√£o di√°rios dos retornos mais de tr√™s vezes maiores do que em per√≠odos de calma.
> *   Uma mudan√ßa na pol√≠tica monet√°ria de um pa√≠s pode alterar a taxa de juros, tornando a s√©rie n√£o estacion√°ria em termos de m√©dia e vari√¢ncia. Por exemplo, uma eleva√ß√£o da taxa b√°sica de juros por um banco central de 2% para 4% impacta a m√©dia da s√©rie e a volatilidade, gerando n√£o estacionariedade.
>
> Esses exemplos demonstram como fen√¥menos econ√¥micos e financeiros podem causar n√£o estacionariedade nas s√©ries temporais.

**Proposi√ß√£o 7.1:** *A utiliza√ß√£o de modelos estacion√°rios em s√©ries temporais n√£o estacion√°rias pode levar a previs√µes enviesadas e an√°lises esp√∫rias.*

*Prova:*
I. Modelos estacion√°rios assumem que a m√©dia e a vari√¢ncia da s√©rie s√£o constantes ao longo do tempo.
II. Se uma s√©rie temporal √© n√£o estacion√°ria, suas propriedades estat√≠sticas variam ao longo do tempo.
III. Aplicar um modelo estacion√°rio a uma s√©rie n√£o estacion√°ria pode levar a um ajuste ruim do modelo aos dados.
IV. As previs√µes baseadas em modelos estacion√°rios podem ser enviesadas e levar a conclus√µes err√¥neas sobre o comportamento da s√©rie.
V. A an√°lise de causalidade e testes de hip√≥teses podem ser inv√°lidos em s√©ries temporais n√£o estacion√°rias se as devidas corre√ß√µes (diferencia√ß√£o ou modelagem com componentes de tend√™ncia) n√£o forem realizadas.
VI. Portanto, utilizar modelos estacion√°rios em s√©ries n√£o estacion√°rias pode levar a an√°lises esp√∫rias e conclus√µes incorretas. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
>  Imagine que estamos modelando o pre√ßo de uma a√ß√£o, que tem um comportamento similar a um *random walk with drift*, utilizando um modelo estacion√°rio. Um modelo estacion√°rio ajustar√° uma m√©dia constante para essa s√©rie. O modelo n√£o ser√° capaz de capturar a tend√™ncia de crescimento do pre√ßo da a√ß√£o, o que levar√° a previs√µes que s√£o constantemente menores que os pre√ßos verdadeiros (no caso de uma tend√™ncia positiva) e que n√£o consideram a vari√¢ncia crescente do pre√ßo. Consequentemente, podemos gerar previs√µes enviesadas e com alta vari√¢ncia do erro. Al√©m disso, os testes de hip√≥teses sobre causalidade podem n√£o ser v√°lidos e levar a falsas conclus√µes.
>
> Para modelar corretamente o pre√ßo da a√ß√£o, √© necess√°rio utilizar um modelo n√£o estacion√°rio, como um *random walk with drift* ou um modelo ARIMA com diferencia√ß√£o.
>
> Suponha que temos uma s√©rie de pre√ßos de a√ß√µes simulada, com uma tend√™ncia de crescimento e um componente aleat√≥rio. Utilizando um modelo estacion√°rio AR(1) para prever o pr√≥ximo pre√ßo, os resultados podem ser ruins. Vamos gerar dados de exemplo em Python:
> ```python
> import numpy as np
> import pandas as pd
> import matplotlib.pyplot as plt
> from statsmodels.tsa.arima.model import ARIMA
>
> # Simula√ß√£o de Random Walk com Drift
> np.random.seed(42)
> n = 100
> drift = 0.2
> errors = np.random.normal(0, 1, n)
> price = np.cumsum(drift + errors)
> dates = pd.date_range(start="2023-01-01", periods=n, freq="D")
> ts = pd.Series(price, index=dates)
>
> # Ajuste de um modelo AR(1)
> ar_model = ARIMA(ts, order=(1,0,0))
> ar_fit = ar_model.fit()
> forecast_ar = ar_fit.predict(start=n, end=n+9)
>
> # Ajuste de um modelo ARIMA(1,1,0) - Random Walk com Drift
> arima_model = ARIMA(ts, order=(1,1,0))
> arima_fit = arima_model.fit()
> forecast_arima = arima_fit.predict(start=n, end=n+9)
>
> # Visualiza√ß√£o
> plt.figure(figsize=(10, 6))
> plt.plot(ts, label='Pre√ßo da A√ß√£o')
> plt.plot(pd.date_range(start=dates[-1], periods=10, freq='D'), forecast_ar, label='Previs√£o AR(1)')
> plt.plot(pd.date_range(start=dates[-1], periods=10, freq='D'), forecast_arima, label='Previs√£o ARIMA(1,1,0)')
> plt.xlabel('Tempo')
> plt.ylabel('Pre√ßo')
> plt.title('Previs√£o com Modelo Estacion√°rio vs. Modelo N√£o Estacion√°rio')
> plt.legend()
> plt.show()
>
> print("Previs√µes AR(1):", forecast_ar)
> print("Previs√µes ARIMA(1,1,0):", forecast_arima)
> ```
>
> O gr√°fico gerado ir√° mostrar que a previs√£o usando um modelo estacion√°rio (AR(1)) n√£o consegue capturar a tend√™ncia de crescimento, enquanto a previs√£o com o modelo n√£o estacion√°rio (ARIMA(1,1,0), equivalente ao *random walk with drift*) tem um melhor desempenho.

**Teorema 7:** *Modelos que incorporam n√£o estacionariedade, como modelos *trend-stationary*, modelos *unit root* e modelos ARIMA(p, d, q), s√£o necess√°rios para capturar tend√™ncias, mudan√ßas de regime e outros comportamentos n√£o constantes presentes em dados econ√¥micos e financeiros.*

*Prova:*
I. Modelos *trend-stationary* modelam a n√£o estacionariedade atrav√©s da inclus√£o de uma tend√™ncia linear, o que permite capturar o crescimento ou decrescimento de longo prazo de uma s√©rie.
II. Modelos *unit root* modelam a n√£o estacionariedade atrav√©s da aplica√ß√£o de diferencia√ß√£o, o que permite analisar o impacto persistente de choques aleat√≥rios na s√©rie.
III. Modelos ARIMA(p, d, q) generalizam os modelos ARMA atrav√©s da diferencia√ß√£o, permitindo modelar s√©ries n√£o estacion√°rias que tamb√©m possuem componentes de m√©dia m√≥vel.
IV. Modelos de volatilidade condicional, como modelos ARCH e GARCH, s√£o necess√°rios para modelar a n√£o estacionariedade na vari√¢ncia de ativos financeiros, onde o risco varia ao longo do tempo.
V. Processos com mem√≥ria longa permitem modelar depend√™ncias de longo prazo, necess√°rias para representar fen√¥menos econ√¥micos e financeiros que exibem tal caracter√≠stica.
VI. Portanto, modelos n√£o estacion√°rios s√£o necess√°rios para capturar as diversas formas de n√£o estacionariedade que podem aparecer em dados econ√¥micos e financeiros, levando a previs√µes mais precisas e an√°lises mais robustas. ‚ñ†

> üí° **Exemplo Num√©rico:**
>
> *   Para modelar o PIB de um pa√≠s, que tipicamente tem uma tend√™ncia de crescimento ao longo do tempo, um modelo *trend-stationary* ou um modelo *unit root* com drift seria mais apropriado do que um modelo estacion√°rio. Por exemplo, o modelo *trend-stationary* poderia ser: $PIB_t = \beta_0 + \beta_1 t + \epsilon_t$, onde $t$ √© o tempo, $\beta_0$ √© o intercepto, $\beta_1$ √© a inclina√ß√£o da tend√™ncia e $\epsilon_t$ √© o termo de erro.
> *   Para modelar o pre√ßo de uma a√ß√£o, que tipicamente apresenta volatilidade vari√°vel no tempo, um modelo GARCH seria mais adequado. Por exemplo, um modelo GARCH(1,1) modela a vari√¢ncia condicional como $\sigma_t^2 = \alpha_0 + \alpha_1 \epsilon_{t-1}^2 + \beta_1 \sigma_{t-1}^2$, onde $\sigma_t^2$ √© a vari√¢ncia condicional no tempo $t$, $\epsilon_{t-1}$ √© o erro no tempo $t-1$, $\alpha_0, \alpha_1$ e $\beta_1$ s√£o os par√¢metros do modelo.
> *   Para modelar a taxa de c√¢mbio, que pode exibir tanto tend√™ncias de longo prazo quanto mudan√ßas de regime devido a interven√ß√µes do governo, um modelo ARIMA com componente de tend√™ncia ou modelos de mudan√ßas de regime seriam mais apropriados. Por exemplo, um modelo ARIMA(1,1,1) com uma tend√™ncia linear seria definido por: $\nabla Y_t = \mu + \phi_1 \nabla Y_{t-1} + \theta_1 \epsilon_{t-1} + \epsilon_t$, onde $\nabla Y_t = Y_t - Y_{t-1}$ √© a primeira diferen√ßa da s√©rie, $\mu$ √© a tend√™ncia linear, $\phi_1$ e $\theta_1$ s√£o os par√¢metros do modelo AR e MA, respectivamente, e $\epsilon_t$ √© o termo de erro.
>
> Esses exemplos demonstram como modelos que incorporam n√£o estacionariedade s√£o necess√°rios para modelar diversos fen√¥menos econ√¥micos e financeiros.

**Lema 7.1:** *A presen√ßa de ra√≠zes unit√°rias em s√©ries temporais econ√¥micas e financeiras tem implica√ß√µes importantes para a an√°lise de causalidade, testes de hip√≥teses e previs√µes de longo prazo.*

*Prova:*
I. S√©ries temporais com ra√≠zes unit√°rias s√£o n√£o estacion√°rias, e o uso de testes de causalidade ou modelos de regress√£o com s√©ries n√£o estacion√°rias pode levar a resultados esp√∫rios, como falsas correla√ß√µes ou causalidades inexistentes.
II. Testes de hip√≥tese devem ser realizados com aten√ß√£o em dados n√£o estacion√°rios, uma vez que as distribui√ß√µes assint√≥ticas utilizadas pelos testes s√£o derivadas sob a suposi√ß√£o de estacionaridade.
III. Previs√µes de longo prazo baseadas em modelos estacion√°rios podem n√£o capturar a tend√™ncia de longo prazo ou o impacto permanente de choques em s√©ries com raiz unit√°ria.
IV. Portanto, √© crucial identificar e modelar corretamente a presen√ßa de ra√≠zes unit√°rias em dados econ√¥micos e financeiros para que se obtenha resultados estatisticamente v√°lidos e previs√µes precisas. ‚ñ†

**Teorema 7.1:** *S√©ries temporais com ra√≠zes unit√°rias podem ser transformadas em s√©ries estacion√°rias atrav√©s da diferencia√ß√£o. O n√∫mero de vezes que a diferencia√ß√£o precisa ser aplicada corresponde √† ordem de integra√ß√£o da s√©rie.*

*Prova:*
I. Uma s√©rie com raiz unit√°ria, por defini√ß√£o, √© n√£o estacion√°ria em n√≠vel.
II. A primeira diferen√ßa de uma s√©rie com uma √∫nica raiz unit√°ria (ordem de integra√ß√£o 1) geralmente remove a n√£o estacionariedade na m√©dia.
III. Se a primeira diferen√ßa ainda n√£o for estacion√°ria, uma segunda diferen√ßa pode ser necess√°ria (ordem de integra√ß√£o 2).
IV. Este processo de diferencia√ß√£o sucessiva continua at√© que a s√©rie transformada se torne estacion√°ria.
V. O n√∫mero de vezes que a s√©rie precisa ser diferenciada para se tornar estacion√°ria define a ordem de integra√ß√£o da s√©rie.
VI. Portanto, a diferencia√ß√£o √© uma t√©cnica crucial para transformar s√©ries n√£o estacion√°rias em s√©ries estacion√°rias, permitindo o uso de ferramentas estat√≠sticas que requerem estacionaridade. ‚ñ†

> üí° **Exemplo Num√©rico:** Uma s√©rie de pre√ßos de a√ß√µes pode ter uma raiz unit√°ria (I(1)). Ao calcular a primeira diferen√ßa da s√©rie (retornos), normalmente se obt√©m uma s√©rie estacion√°ria, representando o retorno da a√ß√£o, que n√£o √© influenciado pela tend√™ncia original da s√©rie. J√° uma s√©rie que representa o n√≠vel de pre√ßos de uma commoditie pode exigir duas diferencia√ß√µes para alcan√ßar a estacionariedade (I(2)).
>
>  Para demonstrar, vamos simular uma s√©rie com uma raiz unit√°ria e calcular suas diferen√ßas:
> ```python
> import numpy as np
> import pandas as pd
> import matplotlib.pyplot as plt
> from statsmodels.tsa.stattools import adfuller
>
> # Simula√ß√£o de Random Walk
> np.random.seed(42)
> n = 100
> errors = np.random.normal(0, 1, n)
> price = np.cumsum(errors)
> dates = pd.date_range(start="2023-01-01", periods=n, freq="D")
> ts = pd.Series(price, index=dates)
>
> # Calculando as diferen√ßas
> diff_1 = ts.diff().dropna()
> diff_2 = diff_1.diff().dropna()
>
> # Teste de raiz unit√°ria (ADF)
> adf_original = adfuller(ts)
> adf_diff1 = adfuller(diff_1)
> adf_diff2 = adfuller(diff_2)
>
> # Visualiza√ß√£o
> fig, axs = plt.subplots(3, 1, figsize=(10, 8))
> axs[0].plot(ts, label='S√©rie Original (N√≠vel)')
> axs[0].set_title(f'S√©rie Original - ADF p-valor: {adf_original[1]:.3f}')
> axs[1].plot(diff_1, label='Primeira Diferen√ßa')
> axs[1].set_title(f'Primeira Diferen√ßa - ADF p-valor: {adf_diff1[1]:.3f}')
> axs[2].plot(diff_2, label='Segunda Diferen√ßa')
> axs[2].set_title(f'Segunda Diferen√ßa - ADF p-valor: {adf_diff2[1]:.3f}')
> for ax in axs:
>     ax.legend()
> plt.tight_layout()
> plt.show()
>
> print(f"ADF p-valor da s√©rie original: {adf_original[1]:.3f}")
> print(f"ADF p-valor da primeira diferen√ßa: {adf_diff1[1]:.3f}")
> print(f"ADF p-valor da segunda diferen√ßa: {adf_diff2[1]:.3f}")
>
> ```
> O gr√°fico e os testes de ADF mostram que a s√©rie original √© n√£o estacion√°ria, enquanto a primeira diferen√ßa se torna estacion√°ria (o p-valor do teste de ADF √© menor que 0.05), indicando que a s√©rie original √© integrada de ordem 1 (I(1)). Se a primeira diferen√ßa continuasse sendo n√£o estacion√°ria, seria necess√°rio calcular a segunda diferen√ßa.

### Implica√ß√µes Pr√°ticas

A import√¢ncia da n√£o estacionariedade em dados econ√¥micos e financeiros √© vasta e tem implica√ß√µes em diversos contextos:

1.  **Previs√£o:** Modelos n√£o estacion√°rios s√£o essenciais para obter previs√µes precisas de s√©ries temporais que apresentam tend√™ncias ou mudan√ßas de regime. Modelos estacion√°rios podem gerar previs√µes enviesadas e de baixa acur√°cia em s√©ries n√£o estacion√°rias.
2.  **An√°lise de Pol√≠ticas:** Para analisar o impacto de pol√≠ticas econ√¥micas, √© importante levar em conta a n√£o estacionariedade das s√©ries temporais. Modelos n√£o estacion√°rios podem capturar o impacto permanente de uma pol√≠tica sobre o n√≠vel de uma s√©rie, enquanto modelos estacion√°rios podem levar a uma an√°lise inadequada da efic√°cia da pol√≠tica.
3.  **Gest√£o de Risco:** A modelagem da volatilidade vari√°vel no tempo √© crucial para a gest√£o de risco em mercados financeiros. Modelos ARCH e GARCH permitem estimar o risco de ativos financeiros com mais precis√£o e tomar decis√µes mais assertivas em rela√ß√£o √† aloca√ß√£o de capital.
4.  **Tomada de Decis√£o:** A modelagem de s√©ries temporais n√£o estacion√°rias √© importante para a tomada de decis√£o em diversas √°reas. Por exemplo, um modelo de previs√£o do PIB pode ajudar um governo a planejar suas pol√≠ticas econ√¥micas, enquanto um modelo de previs√£o da taxa de c√¢mbio pode ajudar uma empresa a gerenciar suas opera√ß√µes no mercado internacional.
5.  **Testes de Hip√≥tese e An√°lise Causal:**  Testes de hip√≥teses e an√°lises de causalidade s√≥ s√£o v√°lidos quando os modelos levam em considera√ß√£o o comportamento de s√©ries n√£o estacion√°rias. Uma falha neste aspecto pode levar a conclus√µes esp√∫rias.

> üí° **Exemplo Num√©rico:** Considere que um gestor de fundos deseja modelar a volatilidade de um ativo financeiro para decidir o tamanho de uma posi√ß√£o. Se ele utilizar um modelo estacion√°rio, ele ir√° ignorar que a volatilidade pode variar ao longo do tempo, o que o levaria a subestimar o risco e a tomar decis√µes inadequadas. Um modelo GARCH, que incorpora n√£o estacionariedade, iria ajustar a volatilidade para as mudan√ßas do mercado, permitindo uma gest√£o de risco mais precisa e eficiente.
>
> Por exemplo, considere os retornos di√°rios do √≠ndice S\&P 500. Um modelo estacion√°rio, como um modelo AR(1) sobre os retornos, assumiria que a volatilidade √© constante, o que n√£o √© verdade. A vari√¢ncia dos retornos pode ser baixa em per√≠odos de estabilidade e alta em per√≠odos de crise. Um modelo GARCH(1,1), que modela a volatilidade condicional, capturaria essa din√¢mica, permitindo uma melhor previs√£o do risco e decis√µes mais seguras para o gestor.
>
> Para ilustrar, podemos simular dados e comparar um modelo AR(1) com um modelo GARCH(1,1):
> ```python
> import numpy as np
> import pandas as pd
> import matplotlib.pyplot as plt
> from arch import arch_model
> from statsmodels.tsa.arima.model import ARIMA
>
> # Simula√ß√£o de dados com volatilidade agrupada
> np.random.seed(42)
> n = 1000
> vol = np.zeros(n)
> returns = np.zeros(n)
> vol[0] = 0.01
> for t in range(1, n):
>     vol[t] = 0.00001 + 0.9 * vol[t - 1] + 0.1 * np.random.normal(0, 0.01) ** 2
>     returns[t] = np.random.normal(0, np.sqrt(vol[t]))
>
> dates = pd.date_range(start="2023-01-01", periods=n, freq="D")
> ts = pd.Series(returns, index=dates)
>
> # Ajuste de modelo AR(1) (estacion√°rio)
> ar_model = ARIMA(ts, order=(1, 0, 0))
> ar_fit = ar_model.fit()
>
> # Ajuste de modelo GARCH(1,1) (n√£o estacion√°rio)
> garch_model = arch_model(ts, vol="Garch", p=1, q=1)
> garch_fit = garch_model.fit(disp="off")
>
> # Visualiza√ß√£o da volatilidade condicional
> fig, ax = plt.subplots(figsize=(10, 6))
> ax.plot(ts, label='Retornos Simulado')
> ax.plot(dates, garch_fit.conditional_volatility, label='Volatilidade GARCH')
> ax.set_title('Retornos e Volatilidade GARCH(1,1)')
> ax.legend()
> plt.show()
>
> print("Par√¢metros AR(1):", ar_fit.params)
> print("Par√¢metros GARCH(1,1):", garch_fit.params)
>
>
> ```
> O gr√°fico mostra os retornos simulados e a volatilidade estimada pelo modelo GARCH(1,1). O modelo GARCH captura a varia√ß√£o da volatilidade ao longo do tempo, o que n√£o √© poss√≠vel com um modelo AR(1) estacion√°rio.

**Proposi√ß√£o 7.2:** *Em an√°lises de cointegra√ß√£o, √© crucial que as s√©ries individualmente sejam n√£o estacion√°rias, mas que uma combina√ß√£o linear dessas s√©ries seja estacion√°ria. Essa combina√ß√£o linear estacion√°ria representa uma rela√ß√£o de longo prazo entre as s√©ries.*

*Prova:*
I. O conceito de cointegra√ß√£o √© aplic√°vel quando duas ou mais s√©ries temporais s√£o n√£o estacion√°rias, mas existe uma combina√ß√£o linear dessas s√©ries que resulta em uma s√©rie estacion√°ria.
II. Se as s√©ries individuais fossem estacion√°rias, a cointegra√ß√£o n√£o seria necess√°ria, uma vez que as s√©ries por si s√≥ j√° teriam propriedades estat√≠sticas est√°veis ao longo do tempo.
III. A combina√ß√£o linear estacion√°ria indica uma rela√ß√£o de longo prazo entre as s√©ries originais, que tende a se manter ao longo do tempo, mesmo que as s√©ries individuais flutuem de forma n√£o estacion√°ria.
IV. A cointegra√ß√£o, assim, permite modelar o equil√≠brio de longo prazo entre s√©ries n√£o estacion√°rias, o que √© √∫til em an√°lises econ√¥micas e financeiras.
V. Portanto, a n√£o estacionariedade das s√©ries individuais √© uma condi√ß√£o necess√°ria para a aplica√ß√£o da cointegra√ß√£o. ‚ñ†

> üí° **Exemplo Num√©rico:** O pre√ßo de dois ativos financeiros pode ser n√£o estacion√°rio individualmente, apresentando tend√™ncias ao longo do tempo. No entanto, pode existir uma combina√ß√£o linear desses pre√ßos que resulta em uma s√©rie estacion√°ria, indicando que, apesar das flutua√ß√µes individuais, existe um equil√≠brio de longo prazo entre esses pre√ßos. Modelos de corre√ß√£o de erro (ECM) s√£o utilizados para modelar essas rela√ß√µes de cointegra√ß√£o.
>
> Suponha que temos os pre√ßos de duas a√ß√µes, A e B, que s√£o n√£o estacion√°rios individualmente (I(1)), mas uma combina√ß√£o linear dessas s√©ries √© estacion√°ria. Vamos simular dados:
>
> ```python
> import numpy as np
> import pandas as pd
> import matplotlib.pyplot as plt
> from statsmodels.tsa.stattools import adfuller
> from statsmodels.tsa.vector_ar.vecm import coint_johansen
>
> # Simula√ß√£o de Random Walks com tend√™ncia para as a√ß√µes A e B
> np.random.seed(42)
> n = 100
> errors_A = np.random.normal(0, 1, n)
> errors_B = np.random.normal(0, 1, n)
> drift_A = 0.1
> drift_B = 0.05
> price_A = np.cumsum(drift_A + errors_A)
> price_B = np.cumsum(drift_B + errors_B)
>
> # Cria√ß√£o do DataFrame com as duas s√©ries
> dates = pd.date_range(start="2023-01-01", periods=n, freq="D")
> df = pd.DataFrame({'Price_A': price_A, 'Price_B': price_B}, index=dates)
>
> # Teste de raiz unit√°ria para cada s√©rie
> adf_A = adfuller(df['Price_A'])
> adf_B = adfuller(df['Price_B'])
> print(f"ADF p-valor da a√ß√£o A: {adf_A[1]:.3f}")
> print(f"ADF p-valor da a√ß√£o B: {adf_B[1]:.3f}")
>
> # Teste de cointegra√ß√£o de Johansen
> johansen_test = coint_johansen(df, det_order=0, k_ar_diff=1)
> print(f"Teste de Cointegra√ß√£o - Estat√≠stica de Tra√ßo: {johansen_test.lr1}")
> print(f"Teste de Cointegra√ß√£o - Valor Cr√≠tico (95%): {johansen_test.cvm[0, 1]}")
>
> # Combina√ß√£o linear
> cointegration_vector = johansen_test.evec[:,0]
>
> # Calcula a combina√ß√£o linear
> linear_combination = cointegration_vector[0] * df['Price_A'] + cointegration_vector[1] * df['Price_B']
>
> # Teste de raiz unit√°ria para a combina√ß√£o linear
> adf_comb = adfuller(linear_combination)
>
> # Visualiza√ß√£o
> fig, axs = plt.subplots(2, 1, figsize=(10, 8))
> axs[0].plot(df['Price_A'], label='Pre√ßo A√ß√£o A')
> axs[0].plot(df['Price_B'], label='Pre√ßo A√ß√£o B')
> axs[0].set_title('Pre√ßos das A√ß√µes')
> axs[0].legend()
> axs[1].plot(linear_combination, label='Combina√ß√£o Linear')
> axs[1].set_title(f'Combina√ß√£o Linear - ADF p-valor: {adf_comb[1]:.3f}')
> axs[1].legend()
> plt.tight_layout()
> plt.show()
>
> print(f"ADF p-valor da combina√ß√£o linear: {adf_comb[1]:.3f}")
>
> ```
> Os testes ADF mostram que as s√©ries individuais s√£o n√£o estacion√°rias (p-valor > 0.05), enquanto a combina√ß√£o linear √© estacion√°ria (p-valor < 0.05), indicando a presen√ßa de cointegra√ß√£o. A estat√≠stica de Tra√ßo de Johansen tamb√©m indica a exist√™ncia de uma rela√ß√£o de cointegra√ß√£o se for maior que o valor cr√≠tico.

### Conclus√£o

A n√£o estacionariedade √© uma caracter√≠stica comum em dados econ√¥micos e financeiros, e sua modelagem adequada √© essencial para a obten√ß√£o de an√°lises e previs√µes precisas e robustas. Processos com tend√™ncia, mudan√ßa de regime, volatilidade vari√°vel no tempo e mem√≥ria longa s√£o frequentemente encontrados nesses tipos de dados, e requerem modelagem com t√©cnicas espec√≠ficas. A utiliza√ß√£o de modelos estacion√°rios nesses casos pode levar a conclus√µes err√¥neas, previs√µes enviesadas, e decis√µes inadequadas. Modelos que incorporam n√£o estacionariedade, como modelos *trend-stationary*, modelos *unit root*, modelos ARIMA(p, d, q), modelos ARCH/GARCH, e processos com mem√≥ria longa, s√£o, portanto, ferramentas indispens√°veis para uma an√°lise completa e confi√°vel dos dados econ√¥micos e financeiros. A escolha correta do modelo, assim como as transforma√ß√µes apropriadas, s√£o cruciais para uma correta representa√ß√£o das caracter√≠sticas da s√©rie temporal e para o sucesso de qualquer an√°lise ou previs√£o. A compreens√£o e o tratamento adequado da n√£o estacionariedade s√£o passos indispens√°veis para qualquer pesquisador ou profissional que trabalhe com dados econ√¥micos e financeiros.

### Refer√™ncias
[^1]: [15.1.1]
<!-- END -->
