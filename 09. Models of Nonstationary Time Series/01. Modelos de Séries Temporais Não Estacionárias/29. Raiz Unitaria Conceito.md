## Modelos com Raiz Unit√°ria: An√°lise Detalhada da N√£o Estacionaridade

### Introdu√ß√£o
Este cap√≠tulo explora em profundidade o conceito de **raiz unit√°ria** em modelos de s√©ries temporais n√£o estacion√°rias, um t√≥pico fundamental para a compreens√£o do comportamento de s√©ries temporais cujas propriedades estat√≠sticas variam ao longo do tempo [^1]. Construindo sobre os conceitos j√° apresentados sobre modelos estacion√°rios e a necessidade de modelar s√©ries com comportamento n√£o estacion√°rio [^2], exploraremos como a presen√ßa de uma raiz unit√°ria no polin√¥mio caracter√≠stico do operador autoregressivo implica que a s√©rie n√£o tem m√©dia e vari√¢ncia constantes ao longo do tempo. Este cap√≠tulo tamb√©m ir√° discutir o significado da raiz unit√°ria e como ela se manifesta em processos n√£o estacion√°rios, bem como a diferen√ßa entre modelos com raiz unit√°ria e outros modelos de n√£o estacionaridade [^3]. A an√°lise detalhada desses modelos √© crucial para a modelagem precisa de s√©ries temporais n√£o estacion√°rias e para a interpreta√ß√£o correta dos resultados estat√≠sticos.

### O Conceito de Raiz Unit√°ria
A defini√ß√£o formal de um modelo com raiz unit√°ria surge da an√°lise do polin√¥mio caracter√≠stico do operador autoregressivo. Considere um processo autoregressivo de ordem p, AR(p), dado por:
$$ y_t = \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t $$
Este processo pode ser reescrito usando o operador de retardo $L$ como:
$$ (1 - \phi_1 L - \phi_2 L^2 - \dots - \phi_p L^p)y_t = \epsilon_t $$
Definimos o polin√¥mio caracter√≠stico como:
$$ \phi(z) = 1 - \phi_1 z - \phi_2 z^2 - \dots - \phi_p z^p $$
onde $z$ √© uma vari√°vel complexa. A presen√ßa de uma raiz unit√°ria implica que uma das ra√≠zes do polin√¥mio $\phi(z)$ √© igual a 1. Formalmente, isso significa que $\phi(1) = 0$.
Quando $\phi(1) = 0$, o operador autoregressivo cont√©m um termo $(1-L)$, o que implica que a s√©rie temporal $y_t$ n√£o √© estacion√°ria. A intui√ß√£o por tr√°s da raiz unit√°ria √© que um choque aleat√≥rio $\epsilon_t$ tem um efeito permanente sobre o n√≠vel da s√©rie temporal, em contraste com modelos estacion√°rios onde o efeito de um choque desaparece com o tempo.

#### Representa√ß√£o de um Modelo com Raiz Unit√°ria
A representa√ß√£o de um modelo com raiz unit√°ria pode ser expressa de diversas formas. Uma forma comum √© atrav√©s da introdu√ß√£o do operador de primeira diferen√ßa $(1-L)$. Considere um processo AR(1) com raiz unit√°ria:
$$ y_t = y_{t-1} + \epsilon_t $$
Esta equa√ß√£o indica que o valor da s√©rie no tempo $t$ √© igual ao valor no tempo $t-1$ mais um choque aleat√≥rio $\epsilon_t$. A forma geral para um processo com raiz unit√°ria pode ser escrita como:
$$ (1 - L)y_t = \delta + \psi(L)\epsilon_t $$ [^1]
onde:
*   $(1-L)$ √© o operador de primeira diferen√ßa que remove a raiz unit√°ria.
*   $\delta$ √© uma constante, que representa uma deriva na s√©rie temporal.
*   $\psi(L)\epsilon_t$ √© um processo estacion√°rio, modelado como uma m√©dia m√≥vel, ou similar.
O processo  $(1-L)y_t$ √© estacion√°rio, enquanto a s√©rie original $y_t$ √© n√£o estacion√°ria. A constante $\delta$ representa a taxa m√©dia de crescimento da s√©rie.
> üí° **Exemplo Num√©rico:**
>
>  Considere um processo AR(2) definido por $y_t = 1.5y_{t-1} - 0.5y_{t-2} + \epsilon_t$. O polin√¥mio caracter√≠stico √© $\phi(z) = 1 - 1.5z + 0.5z^2$.
>  Para verificar se existe uma raiz unit√°ria, avaliamos $\phi(1) = 1 - 1.5(1) + 0.5(1)^2 = 1 - 1.5 + 0.5 = 0$. Como $\phi(1) = 0$, este processo tem uma raiz unit√°ria. Se reescrevermos o polin√¥mio $\phi(z) = (1-z)(1-0.5z)$, vemos que as ra√≠zes s√£o $z=1$ e $z=2$. Como uma das ra√≠zes √© 1, h√° uma raiz unit√°ria.
>
> Agora considere o processo AR(1) dado por $y_t = 0.8y_{t-1} + \epsilon_t$. O polin√¥mio caracter√≠stico √© $\phi(z) = 1 - 0.8z$.  Calculando $\phi(1) = 1 - 0.8(1) = 0.2 \neq 0$. Portanto, este processo n√£o tem raiz unit√°ria.
>
> No caso de um processo com raiz unit√°ria, como $y_t = y_{t-1} + \epsilon_t$, o polin√¥mio caracter√≠stico √© $\phi(z) = 1 - z$.  Calculando $\phi(1) = 1 - 1 = 0$. Logo, este processo tem uma raiz unit√°ria.
#### A Implica√ß√£o da Raiz Unit√°ria na N√£o Estacionaridade
A presen√ßa de uma raiz unit√°ria implica que a s√©rie temporal n√£o √© **estacion√°ria**, ou seja, sua m√©dia e vari√¢ncia n√£o s√£o constantes ao longo do tempo. Isso pode ser demonstrado considerando a representa√ß√£o de um processo com raiz unit√°ria:
$$ y_t = \sum_{i=1}^t \epsilon_i $$
A m√©dia deste processo √© $E[y_t] = 0$ para todos os $t$, mas sua vari√¢ncia √© dada por $Var[y_t] = t\sigma^2$, que aumenta linearmente com o tempo. Este √© um exemplo de um passeio aleat√≥rio sem deriva, que possui uma raiz unit√°ria. Em um processo com deriva, a m√©dia tamb√©m n√£o ser√° constante ao longo do tempo. Essa caracter√≠stica de vari√¢ncia n√£o constante distingue um processo com raiz unit√°ria de um processo estacion√°rio.
> üí° **Exemplo Num√©rico:**
>
>  Considere a seguinte simula√ß√£o de um passeio aleat√≥rio (random walk) sem deriva:
>   $$ y_t = y_{t-1} + \epsilon_t $$
>   onde $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2 = 1$. A s√©rie inicial √© $y_0=0$.
>   O gr√°fico da simula√ß√£o mostra que a s√©rie n√£o possui uma m√©dia constante e que sua vari√¢ncia aumenta com o tempo. A s√©rie apresenta um comportamento aleat√≥rio e n√£o estacion√°rio.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> T = 100
> sigma_epsilon = 1
>
> # Generate random noise
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, T)
>
> # Simulate the random walk
> y = np.zeros(T)
> for t in range(1, T):
>    y[t] = y[t-1] + epsilon[t]
>
> # Plotting
> plt.figure(figsize=(10, 6))
> plt.plot(y)
> plt.title('Random Walk com raiz unit√°ria')
> plt.xlabel('Tempo')
> plt.ylabel('Valor')
> plt.grid(True)
> plt.show()
> ```
> O c√≥digo gera e plota a s√©rie temporal. O gr√°fico resultante mostra o comportamento n√£o estacion√°rio da s√©rie, t√≠pico de um passeio aleat√≥rio.

**Proposi√ß√£o 1:** A presen√ßa de uma raiz unit√°ria no polin√¥mio caracter√≠stico do operador autoregressivo implica que a s√©rie temporal n√£o √© estacion√°ria, e que os choques t√™m um efeito permanente sobre o n√≠vel da s√©rie.
*Prova:*
I.  Um modelo com raiz unit√°ria tem um polin√¥mio caracter√≠stico $\phi(z)$ tal que $\phi(1) = 0$.
II.  Isso implica que o operador autorregressivo pode ser expresso na forma $(1-L)\phi^*(L)$, onde $L$ √© o operador de retardo.
III.  A presen√ßa do termo $(1-L)$ indica que a s√©rie original deve ser diferenciada para obter uma s√©rie estacion√°ria.
IV. A diferencia√ß√£o da s√©rie n√£o remove o efeito de choques passados, pois estes se acumulam, ou seja, tem um efeito persistente sobre o n√≠vel da s√©rie.
V. Portanto, a presen√ßa de uma raiz unit√°ria implica que a s√©rie n√£o √© estacion√°ria e que os choques t√™m um efeito permanente. $\blacksquare$

**Lema 1.1:** Se um processo autoregressivo tem uma raiz unit√°ria, ent√£o a soma dos seus coeficientes autoregressivos √© igual a 1.
*Prova:*
I. Seja um processo AR(p) definido como $y_t = \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t$.
II. O polin√¥mio caracter√≠stico √© dado por $\phi(z) = 1 - \phi_1 z - \phi_2 z^2 - \dots - \phi_p z^p$.
III. Uma raiz unit√°ria implica que $\phi(1) = 0$.
IV. Substituindo $z = 1$ em $\phi(z)$, temos $0 = 1 - \phi_1 - \phi_2 - \dots - \phi_p$.
V. Rearranjando a equa√ß√£o, temos $\phi_1 + \phi_2 + \dots + \phi_p = 1$. Portanto, a soma dos coeficientes autoregressivos √© igual a 1. $\blacksquare$
> üí° **Exemplo Num√©rico:**
> Considere um processo AR(2) com uma raiz unit√°ria, como  $y_t = 1.2 y_{t-1} - 0.2 y_{t-2} + \epsilon_t$. Os coeficientes autoregressivos s√£o $\phi_1 = 1.2$ e $\phi_2 = -0.2$. A soma dos coeficientes √© $\phi_1 + \phi_2 = 1.2 - 0.2 = 1$. Isso confirma que a soma dos coeficientes AR √© igual a 1 quando h√° uma raiz unit√°ria.

### Modelos de Raiz Unit√°ria com Deriva
A inclus√£o de uma **deriva** ($\delta$) em um modelo com raiz unit√°ria introduz uma tend√™ncia determin√≠stica na m√©dia da s√©rie temporal. O modelo torna-se um passeio aleat√≥rio com deriva, e √© definido como:
$$ y_t = \delta + y_{t-1} + \epsilon_t $$
Esta equa√ß√£o indica que o valor da s√©rie no tempo $t$ √© igual ao valor no tempo $t-1$, mais uma deriva constante $\delta$ e um choque aleat√≥rio $\epsilon_t$. Em termos do operador de retardo, o modelo √© dado por:
$$ (1-L)y_t = \delta + \epsilon_t $$
A deriva $\delta$ representa a taxa de crescimento m√©dia da s√©rie, e a presen√ßa da raiz unit√°ria implica que os choques t√™m um efeito permanente sobre o n√≠vel da s√©rie.
A m√©dia da s√©rie em um modelo com raiz unit√°ria e deriva √© dada por $E[y_t] = y_0 + \delta t$, onde $y_0$ √© o valor inicial da s√©rie e a vari√¢ncia √© $Var[y_t] = t\sigma^2$, que aumenta com o tempo. Portanto, tanto a m√©dia como a vari√¢ncia variam com o tempo, e o processo n√£o √© estacion√°rio.
> üí° **Exemplo Num√©rico:**
>
>  Vamos simular um passeio aleat√≥rio com deriva, com uma deriva $\delta = 0.2$:
>  $$ y_t = 0.2 + y_{t-1} + \epsilon_t $$
>  A simula√ß√£o mostra que a s√©rie apresenta uma tend√™ncia de crescimento ao longo do tempo, e que a sua vari√¢ncia aumenta com o tempo. A s√©rie apresenta um comportamento n√£o estacion√°rio.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> T = 100
> delta = 0.2
> sigma_epsilon = 1
>
> # Generate random noise
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, T)
>
> # Simulate the random walk with drift
> y = np.zeros(T)
> for t in range(1, T):
>    y[t] = delta + y[t-1] + epsilon[t]
>
> # Plotting
> plt.figure(figsize=(10, 6))
> plt.plot(y)
> plt.title('Random Walk com deriva')
> plt.xlabel('Tempo')
> plt.ylabel('Valor')
> plt.grid(True)
> plt.show()
> ```
> O c√≥digo simula e plota o passeio aleat√≥rio com deriva. O gr√°fico resultante mostra a tend√™ncia de crescimento da s√©rie, al√©m de seu comportamento n√£o estacion√°rio.

**Lema 1:** A inclus√£o de uma deriva constante ($\delta$) em um modelo com raiz unit√°ria introduz uma tend√™ncia determin√≠stica na m√©dia da s√©rie temporal, que cresce linearmente com o tempo, mas a presen√ßa da raiz unit√°ria garante que a s√©rie continue n√£o estacion√°ria.
*Prova:*
I. O modelo de raiz unit√°ria com deriva √© dado por $y_t = \delta + y_{t-1} + \epsilon_t$, onde $y_0$ √© um valor inicial, $\delta$ √© a deriva, e $\epsilon_t$ √© ru√≠do branco.
II. A partir desta defini√ß√£o, podemos escrever $y_t = \delta t + \sum_{i=1}^t \epsilon_i$.
III. A m√©dia da s√©rie √© dada por $E[y_t] = E[\delta t + \sum_{i=1}^t \epsilon_i] = \delta t$, pois a m√©dia de $\epsilon_t$ √© zero. Isso demonstra que a m√©dia da s√©rie varia linearmente com o tempo, ou seja, existe uma tend√™ncia determin√≠stica.
IV. A vari√¢ncia da s√©rie √© dada por $Var[y_t] = Var[\delta t + \sum_{i=1}^t \epsilon_i] = t\sigma^2$, pois a vari√¢ncia de $\delta t$ √© zero e a vari√¢ncia de cada $\epsilon_i$ √© $\sigma^2$. A vari√¢ncia aumenta linearmente com o tempo.
V. Como a m√©dia e a vari√¢ncia variam com o tempo, a s√©rie n√£o √© estacion√°ria. $\blacksquare$

**Teorema 1.1:** Um passeio aleat√≥rio com deriva, definido por $y_t = \delta + y_{t-1} + \epsilon_t$, pode ser expressa como uma soma acumulada de choques mais uma tend√™ncia linear.
*Prova:*
I. A defini√ß√£o do modelo √© $y_t = \delta + y_{t-1} + \epsilon_t$.
II. Expandindo recursivamente a equa√ß√£o:
    $y_t = \delta + (\delta + y_{t-2} + \epsilon_{t-1}) + \epsilon_t = 2\delta + y_{t-2} + \epsilon_{t-1} + \epsilon_t$
    $y_t = 3\delta + y_{t-3} + \epsilon_{t-2} + \epsilon_{t-1} + \epsilon_t$
    ...
    $y_t = t\delta + y_0 + \sum_{i=1}^{t} \epsilon_i$.
III. Definindo $y_0 = 0$, temos $y_t = t\delta + \sum_{i=1}^{t} \epsilon_i$.
IV. Assim, um passeio aleat√≥rio com deriva pode ser expresso como a soma de uma tend√™ncia determin√≠stica linear ($\delta t$) e uma soma acumulada de choques aleat√≥rios ($\sum_{i=1}^{t} \epsilon_i$). $\blacksquare$
> üí° **Exemplo Num√©rico:**
>
>   Seja um passeio aleat√≥rio com deriva dado por $y_t = 0.5 + y_{t-1} + \epsilon_t$, com $y_0=0$, e $\epsilon_t$ sendo ru√≠do branco com m√©dia zero e vari√¢ncia 1. Para $t=3$, temos:
>
>   $y_1 = 0.5 + y_0 + \epsilon_1 = 0.5 + \epsilon_1$
>
>   $y_2 = 0.5 + y_1 + \epsilon_2 = 0.5 + 0.5 + \epsilon_1 + \epsilon_2 = 1 + \epsilon_1 + \epsilon_2$
>
>   $y_3 = 0.5 + y_2 + \epsilon_3 = 0.5 + 1 + \epsilon_1 + \epsilon_2 + \epsilon_3 = 1.5 + \epsilon_1 + \epsilon_2 + \epsilon_3$.
>
>   Generalizando, $y_t = 0.5t + \sum_{i=1}^t \epsilon_i$.

### Diferen√ßa entre Modelos com Raiz Unit√°ria e Modelos Trend-Stationary
√â essencial distinguir entre modelos com raiz unit√°ria e modelos **trend-stationary**. Em ambos os casos, as s√©ries temporais apresentam n√£o estacionaridade, mas a natureza dessa n√£o estacionaridade e a forma de trat√°-la s√£o diferentes.

#### Modelos Trend-Stationary
Em modelos trend-stationary, a n√£o estacionaridade √© causada por uma tend√™ncia determin√≠stica, como uma fun√ß√£o linear ou polinomial do tempo. A remo√ß√£o dessa tend√™ncia, atrav√©s da subtra√ß√£o da tend√™ncia estimada da s√©rie original, resulta em um processo estacion√°rio. A representa√ß√£o geral de um modelo trend-stationary √© dada por:
$$ y_t = \alpha + \delta t + \psi(L)\epsilon_t $$
onde:
*   $\alpha$ √© o intercepto.
*   $\delta$ √© a inclina√ß√£o da tend√™ncia.
*   $t$ √© o √≠ndice de tempo.
*   $\psi(L)\epsilon_t$ √© um processo estacion√°rio.
A remo√ß√£o da tend√™ncia, $y_t - (\alpha + \delta t) = \psi(L)\epsilon_t$, resulta em uma s√©rie estacion√°ria.

#### Modelos com Raiz Unit√°ria
Em modelos com raiz unit√°ria, a n√£o estacionaridade √© causada pela presen√ßa de uma raiz unit√°ria no operador autoregressivo, que faz com que os choques tenham efeito permanente sobre o n√≠vel da s√©rie temporal. A remo√ß√£o da n√£o estacionaridade em um processo com raiz unit√°ria √© realizada atrav√©s da diferencia√ß√£o da s√©rie, dada por:
$$ (1-L)y_t = \delta + \psi(L)\epsilon_t $$
onde:
*   $(1-L)$ √© o operador de primeira diferen√ßa.
*   $\delta$ √© uma constante (deriva).
*   $\psi(L)\epsilon_t$ √© um processo estacion√°rio.

#### Compara√ß√£o
As principais diferen√ßas entre os modelos trend-stationary e com raiz unit√°ria s√£o:
1.  **Natureza da N√£o Estacionaridade:** Modelos trend-stationary apresentam uma tend√™ncia determin√≠stica, enquanto modelos com raiz unit√°ria apresentam uma n√£o estacionaridade estoc√°stica, caracterizada por choques com efeito permanente.
2.  **Transforma√ß√£o para Estacionaridade:** Modelos trend-stationary s√£o tornados estacion√°rios pela remo√ß√£o da tend√™ncia, enquanto modelos com raiz unit√°ria s√£o tornados estacion√°rios pela diferencia√ß√£o.
3.  **Impacto dos Choques:** Em modelos trend-stationary, os choques t√™m um efeito transit√≥rio sobre o n√≠vel da s√©rie, que converge para a tend√™ncia de longo prazo. Em modelos com raiz unit√°ria, os choques t√™m um efeito permanente sobre o n√≠vel da s√©rie, que n√£o retorna para um n√≠vel anterior.
4.  **Implica√ß√µes para a Previs√£o:** Em modelos trend-stationary, a previs√£o converge para uma tend√™ncia determin√≠stica de longo prazo. Em modelos com raiz unit√°ria, a previs√£o n√£o converge para um valor fixo, e a vari√¢ncia da previs√£o aumenta com o horizonte de previs√£o.
5. **Interpreta√ß√£o:** Modelos trend-stationary implicam que existe uma tend√™ncia que deve ser removida, e que o processo volta a uma trajet√≥ria de equil√≠brio ap√≥s flutua√ß√µes. Modelos com raiz unit√°ria implicam que choques afetam a trajet√≥ria da s√©rie de forma permanente, e, portanto, o processo n√£o volta a uma trajet√≥ria anterior.
**Teorema 1.** A aplica√ß√£o da primeira diferen√ßa em um modelo trend-stationary n√£o resulta em um processo estacion√°rio, enquanto a subtra√ß√£o da tend√™ncia linear em um processo com raiz unit√°ria n√£o o torna estacion√°rio.
*Prova:*
I.  Em um modelo trend-stationary, a s√©rie √© definida como $y_t = \alpha + \delta t + \psi(L)\epsilon_t$. Aplicando a primeira diferen√ßa, obtemos:
    $$(1-L)y_t = (1-L)(\alpha + \delta t + \psi(L)\epsilon_t) = \delta + (1-L)\psi(L)\epsilon_t.$$
II.  O componente estoc√°stico $(1-L)\psi(L)\epsilon_t$ continua estacion√°rio, mas a presen√ßa da constante $\delta$ indica que a primeira diferen√ßa da s√©rie n√£o √© um processo de m√©dia zero.  Portanto, ao diferenciar um processo trend-stationary, n√£o obtemos um processo estacion√°rio.
III.  Em um modelo com raiz unit√°ria, a s√©rie √© definida como $(1-L)y_t = \delta + \psi(L)\epsilon_t$. Subtraindo um termo linear $at+b$, obtemos:
    $$(1-L)y_t - at - b = \delta - at -b + \psi(L)\epsilon_t $$
    A s√©rie resultante n√£o √© estacion√°ria devido ao termo determin√≠stico linear $-at$.
IV.  Portanto, a diferencia√ß√£o n√£o torna um processo trend-stationary estacion√°rio e a remo√ß√£o da tend√™ncia n√£o torna um processo de raiz unit√°ria estacion√°rio.  $\blacksquare$
> üí° **Exemplo Num√©rico:**
>
>  Considere um modelo trend-stationary $y_t = 2 + 0.1t + \epsilon_t$. Aplicando a primeira diferen√ßa, obtemos:
>
>  $(1-L)y_t = y_t - y_{t-1} = (2+0.1t+\epsilon_t) - (2+0.1(t-1)+\epsilon_{t-1}) = 0.1 + \epsilon_t - \epsilon_{t-1}$.
>
>  A primeira diferen√ßa resulta em um processo com m√©dia 0.1, que n√£o √© zero. Portanto, a primeira diferen√ßa n√£o torna o processo estacion√°rio, pois ele tem um componente determin√≠stico diferente de zero.
>
>  Por outro lado, considere um processo de raiz unit√°ria $y_t = y_{t-1} + \epsilon_t$. Se tentarmos remover a tend√™ncia $0.5t$, obtemos $y_t - 0.5t$, o que n√£o torna a s√©rie estacion√°ria pois a s√©rie original √© n√£o estacion√°ria, e a subtra√ß√£o da tend√™ncia n√£o remove o componente de raiz unit√°ria.
**Proposi√ß√£o 2:** A vari√¢ncia da primeira diferen√ßa de um modelo trend-stationary converge para uma constante, enquanto a vari√¢ncia da primeira diferen√ßa de um modelo de raiz unit√°ria sem deriva converge para uma constante, e para um termo que cresce linearmente quando h√° deriva.
*Prova:*
I. Para um modelo trend-stationary $y_t = \alpha + \delta t + \psi(L)\epsilon_t$, a primeira diferen√ßa √© $\Delta y_t = y_t - y_{t-1} = \delta + \Delta \psi(L)\epsilon_t$. Como  $\Delta \psi(L)\epsilon_t$ √© estacion√°rio, a vari√¢ncia de $\Delta y_t$ converge para uma constante.
II. Para um modelo com raiz unit√°ria sem deriva $y_t = y_{t-1} + \epsilon_t$, a primeira diferen√ßa √© $\Delta y_t = \epsilon_t$, cuja vari√¢ncia √© $\sigma^2$, que √© constante.
III. Para um modelo com raiz unit√°ria com deriva $y_t = \delta + y_{t-1} + \epsilon_t$, a primeira diferen√ßa √© $\Delta y_t = \delta + \epsilon_t$. A vari√¢ncia de $\Delta y_t$ √© constante e igual a $\sigma^2$.
IV.  No entanto, se considerarmos a s√©rie original do modelo com raiz unit√°ria e deriva, temos $y_t = y_0 + \delta t + \sum_{i=1}^t \epsilon_i$.  A vari√¢ncia √© $Var(y_t) = t\sigma^2$, que aumenta com o tempo.  Se tomarmos a primeira diferen√ßa repetidamente, $y_t-y_{t-1} = \delta+\epsilon_t$, a vari√¢ncia da diferen√ßa primeira √© $\sigma^2$, mas a vari√¢ncia da s√©rie original continua a aumentar com o tempo.  $\blacksquare$

> üí° **Exemplo Num√©rico:**
>
>  Vamos ilustrar a diferen√ßa entre modelos trend-stationary e modelos com raiz unit√°ria atrav√©s da simula√ß√£o de dois processos.
>
> *   **Modelo Trend-Stationary:**
>
>     $$ y_t = 5 + 0.2t + \epsilon_t $$
>
>     onde $\epsilon_t$ √© ru√≠do branco com m√©dia zero e vari√¢ncia 1. A s√©rie apresenta uma tend√™ncia linear de crescimento, mas pode se desviar da tend√™ncia por causa de ru√≠do estoc√°stico.
> *   **Modelo com Raiz Unit√°ria:**
>
>     $$ y_t = y_{t-1} + 0.1 + \epsilon_t $$
>     onde $\epsilon_t$ √© ru√≠do branco com m√©dia zero e vari√¢ncia 1. A s√©rie apresenta um passeio aleat√≥rio com deriva 0.1, e o efeito de cada choque √© permanente.
>
>     O gr√°fico mostra claramente a diferen√ßa entre os dois processos.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> T = 100
> alpha = 5
> delta_trend = 0.2
> delta_rw = 0.1
> sigma_epsilon = 1
>
> # Generate random noise
> np.random.seed(42)
> epsilon_trend = np.random.normal(0, sigma_epsilon, T)
> epsilon_rw = np.random.normal(0, sigma_epsilon, T)
>
> # Simulate the trend-stationary process
> t = np.arange(1, T + 1)
> y_trend = alpha + delta_trend * t + epsilon_trend
>
> # Simulate the random walk with drift
> y_rw = np.zeros(T)
> for i in range(1, T):
>    y_rw[i] = y_rw[i-1] + delta_rw + epsilon_rw[i]
>
> # Plotting
> fig, axs = plt.subplots(1, 2, figsize=(15, 5))
> axs[0].plot(y_trend)
> axs[0].set_title('Trend-Stationary Process')
> axs[0].set_xlabel('Tempo')
> axs[0].set_ylabel('Valor')
> axs[0].grid(True)
> axs[1].plot(y_rw)
> axs[1].set_title('Random Walk with Drift')
> axs[1].set_xlabel('Tempo')
> axs[1].set_ylabel('Valor')
> axs[1].grid(True)
> plt.tight_layout()
> plt.show()
> ```
>
> Os gr√°ficos mostram que a s√©rie trend-stationary tem uma tend√™ncia de crescimento bem definida e que as flutua√ß√µes em torno da tend√™ncia s√£o estacion√°rias, ao passo que a s√©rie com raiz unit√°ria tem uma trajet√≥ria mais aleat√≥ria e n√£o estacion√°ria. A tend√™ncia aparente √© uma consequ√™ncia do componente de deriva e n√£o uma tend√™ncia fixa.
### Modelos de Raiz Unit√°ria com Componentes ARMA
Modelos de raiz unit√°ria podem ser combinados com componentes ARMA para modelar a depend√™ncia temporal dos res√≠duos. A representa√ß√£o geral √© dada por:
$$ (1-L)y_t = \delta + \psi(L)\epsilon_t $$
onde $\psi(L)\epsilon_t$ √© um processo ARMA, que captura a depend√™ncia temporal dos res√≠duos ap√≥s a diferencia√ß√£o. Por exemplo, podemos ter um modelo com raiz unit√°ria e componente AR(1):
$$ (1-L)y_t = \delta + \phi(L)u_t $$
$$ u_t = \phi_1 u_{t-1} + \epsilon_t $$
A modelagem combinada de raiz unit√°ria e ARMA permite capturar tanto a n√£o estacionaridade quanto a depend√™ncia temporal das s√©ries.
> üí° **Exemplo Num√©rico:**
>
> Um modelo com raiz unit√°ria e componente AR(1) pode ser especificado como
>
> $(1-L)y_t = 0.1 + u_t$
>
> $u_t = 0.7 u_{t-1} + \epsilon_t$
>
>  Onde $\epsilon_t$ √© ru√≠do branco com m√©dia zero e vari√¢ncia 1.
>  Neste caso, a primeira diferen√ßa de $y_t$ √© um processo AR(1). O termo $0.1$ representa a deriva.

#### Modelos ARIMA
Os modelos ARIMA (Autoregressive Integrated Moving Average) s√£o uma classe de modelos que combinam a diferencia√ß√£o (para remover a raiz unit√°ria) com componentes AR e MA para capturar a depend√™ncia temporal da s√©rie. Um modelo ARIMA(p, d, q) √© definido por:
*   p: ordem do componente autoregressivo
*   d: ordem da diferencia√ß√£o
*   q: ordem do componente de m√©dias m√≥veis.
Modelos ARIMA s√£o √∫teis para modelar s√©ries temporais que apresentam n√£o estacionaridade e depend√™ncia temporal, e s√£o uma ferramenta fundamental para a an√°lise e previs√£o de s√©ries n√£o estacion√°rias.
> üí° **Exemplo Num√©rico:**
> Um modelo ARIMA(1,1,1) pode ser escrito como:
>
> $(1-\phi_1L)(1-L)y_t = (1+\theta_1L)\epsilon_t$
>
> onde $\phi_1$ √© o coeficiente do AR(1), e $\theta_1$ √© o coeficiente do MA(1). $(1-L)$ √© o operador de primeira diferen√ßa, e o valor $d=1$ representa uma raiz unit√°ria.
> Este modelo pode ser usado para modelar uma s√©rie que precisa de diferencia√ß√£o para se tornar estacion√°ria, e tamb√©m possui um componente AR(1) e MA(1) em sua estrutura.

**Lema 2.1** Um modelo ARIMA(p, d, q) com d > 0 possui uma raiz unit√°ria de multiplicidade *d*.
*Prova:*
I.  Um modelo ARIMA(p, d, q) pode ser representado como $\phi(L)(1-L)^d y_t = \theta(L)\epsilon_t$, onde $\phi(L)$ √© o polin√¥mio AR, $(1-L)^d$ representa o operador de diferencia√ß√£o de ordem d, e $\theta(L)$ √© o polin√¥mio MA.
II.  O polin√¥mio caracter√≠stico do operador autoregressivo √© $\phi(z)(1-z)^d$.
III.  A condi√ß√£o para a exist√™ncia de uma raiz unit√°ria √© que o polin√¥mio caracter√≠stico seja zero para $z=1$.
IV.  Quando $z=1$, temos $\phi(1)(1-1)^d = \phi(1)0^d = 0$. Portanto, $z=1$ √© uma raiz do polin√¥mio caracter√≠stico com multiplicidade *d*.  $\blacksquare$
### Testes de Raiz Unit√°ria
A presen√ßa de uma raiz unit√°ria n√£o pode ser verificada com testes estat√≠sticos tradicionais, e a sua exist√™ncia √© uma hip√≥tese que necessita de testes espec√≠ficos. Diversos testes de raiz unit√°ria foram desenvolvidos para determinar se uma s√©rie temporal possui ou n√£o uma raiz unit√°ria. Os mais comuns s√£o:
1. **Teste de Dickey-Fuller (DF):** O teste de Dickey-Fuller testa a hip√≥tese nula de que uma s√©rie tem uma raiz unit√°ria. O teste √© baseado na estima√ß√£o de um modelo autoregressivo de primeira ordem e na an√°lise da signific√¢ncia estat√≠stica do coeficiente de autoregress√£o.

2. **Teste de Dickey-Fuller Aumentado (ADF):** O teste ADF √© uma extens√£o do teste de Dickey-Fuller, que inclui lags da primeira diferen√ßa da s√©rie para corrigir a autocorrela√ß√£o dos res√≠duos. A hip√≥tese nula tamb√©m √© a presen√ßa de raiz unit√°ria.
3. **Teste de Phillips-Perron (PP):** O teste de Phillips-Perron √© uma alternativa n√£o param√©trica ao teste ADF, que corrige para a heterocedasticidade e a autocorrela√ß√£o dos res√≠duos.
4. **Teste KPSS (Kwiatkowski-Phillips-Schmidt-Shin):** O teste KPSS testa a hip√≥tese nula de estacionaridade, em contraste com os testes ADF e PP, cuja hip√≥tese nula √© a presen√ßa de uma raiz unit√°ria.
A escolha do teste a ser utilizado depende das caracter√≠sticas espec√≠ficas da s√©rie temporal e da natureza da hip√≥tese a ser testada.
> üí° **Exemplo Num√©rico:**
>
> Vamos aplicar o teste ADF √† s√©rie simulada com passeio aleat√≥rio com deriva, para ilustrar o uso de testes estat√≠sticos para determinar a presen√ßa de raiz unit√°ria em uma s√©rie temporal.
>
> ```python
> import numpy as np
> from statsmodels.tsa.stattools import adfuller
>
> # Parameters
> T = 100
> delta = 0.2
> sigma_epsilon = 1
>
> # Generate random noise
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, T)
>
> # Simulate the random walk with drift
> y = np.zeros(T)
> for t in range(1, T):
>    y[t] = delta + y[t-1] + epsilon[t]
>
> # Perform the ADF test
> adf_result = adfuller(y)
>
> # Output results
> print("ADF Statistic:", adf_result[0])
> print("p-value:", adf_result[1])
> print("Critical Values:", adf_result[4])
> ```
> Os resultados indicam a estat√≠stica do teste ADF, o p-valor, e os valores cr√≠ticos para os diferentes n√≠veis de signific√¢ncia. O p-valor √© maior que 0.05, indicando que n√£o podemos rejeitar a hip√≥tese nula de que a s√©rie possui uma raiz unit√°ria.
>
> Se rodarmos o teste ADF na primeira diferen√ßa da s√©rie (para remover a raiz unit√°ria), o resultado ser√° diferente.
> ```python
> # Perform ADF test on differenced series
> y_diff = np.diff(y)
> adf_diff_result = adfuller(y_diff)
> print("\nADF test on differenced series")
> print("ADF Statistic:", adf_diff_result[0])
> print("p-value:", adf_diff_result[1])
> print("Critical Values:", adf_diff_result[4])
> ```
> O p-valor deve ser menor que 0.05, indicando que podemos rejeitar a hip√≥tese nula de raizunit√°ria.

```python
def kpss_test(timeseries, regression='c', nlags='auto'):
    kpss_input = timeseries
    kpss_result = kpss(kpss_input, regression=regression, nlags=nlags)
    print('KPSS Statistic: %f' % kpss_result[0])
    print('p-value: %f' % kpss_result[1])
    print('Critical Values:')
    for key, value in kpss_result[3].items():
        print('\t%s: %.3f' % (key, value))

kpss_test(data['close'].dropna())
```

O teste KPSS, por outro lado, testa a hip√≥tese nula de estacionariedade.  Um p-valor baixo aqui indica que devemos rejeitar a hip√≥tese nula e concluir que a s√©rie n√£o √© estacion√°ria.

Para s√©ries temporais com tend√™ncia, √© importante aplicar diferencia√ß√£o e teste de raiz unit√°ria para remover essa tend√™ncia antes de realizar an√°lise e previs√£o. Uma forma de lidar com isso √© aplicar a diferencia√ß√£o e ent√£o verificar se a s√©rie diferenciada se torna estacion√°ria.

Aqui, usamos o teste KPSS tamb√©m para verificar a estacionariedade ap√≥s a diferencia√ß√£o.

```python
kpss_test(data['close'].diff().dropna())
```

Se a s√©rie for estacion√°ria ap√≥s a primeira diferencia√ß√£o, dizemos que ela √© integrada de ordem 1 (I(1)). Se precisar de mais uma diferencia√ß√£o para se tornar estacion√°ria, ela √© integrada de ordem 2 (I(2)), e assim por diante. O n√∫mero de diferencia√ß√µes necess√°rias para tornar a s√©rie estacion√°ria √© a ordem de integra√ß√£o da s√©rie.

```mermaid
graph LR
    A[S√©rie Temporal Original] --> B{Teste de Raiz Unit√°ria (ADF)};
    B -- N√£o Estacion√°ria --> C[Diferencia√ß√£o];
    C --> D{Teste de Raiz Unit√°ria (ADF)};
    D -- N√£o Estacion√°ria --> E[Diferencia√ß√£o];
    D -- Estacion√°ria --> F[S√©rie Estacion√°ria];
    E --> G{Teste de Raiz Unit√°ria (ADF)};
    G -- Estacion√°ria --> H[S√©rie Estacion√°ria];
    G -- N√£o Estacion√°ria --> I[Outras Transforma√ß√µes];
    I --> J[S√©rie Estacion√°ria];
    F --> K[An√°lise e Previs√£o];
    H --> K;
    J --> K;
    style C fill:#f9f,stroke:#333,stroke-width:2px
    style E fill:#f9f,stroke:#333,stroke-width:2px
```
<!-- END -->
