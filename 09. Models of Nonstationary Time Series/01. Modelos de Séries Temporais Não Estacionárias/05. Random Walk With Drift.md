## Modelos de S√©ries Temporais N√£o Estacion√°rias: O Passeio Aleat√≥rio com Deriva e suas Implica√ß√µes

### Introdu√ß√£o
Em continuidade √† explora√ß√£o de modelos para s√©ries temporais n√£o estacion√°rias, este cap√≠tulo se dedica √† an√°lise detalhada do *random walk with drift*, ou passeio aleat√≥rio com deriva, uma forma protot√≠pica de processo de raiz unit√°ria, que √© obtida ao definirmos $\psi(L) = 1$ na equa√ß√£o $(1 - L)y_t = \delta + \psi(L)\epsilon_t$ [^1]. Esta representa√ß√£o simplificada, por√©m fundamental, permite uma compreens√£o clara das caracter√≠sticas e implica√ß√µes dos processos de raiz unit√°ria. A discuss√£o anterior estabeleceu as diferen√ßas fundamentais entre processos *trend-stationary* e *unit root*, e este cap√≠tulo aprofundar√° o entendimento sobre o *random walk with drift* como um exemplo pr√°tico de processo com raiz unit√°ria. Exploraremos como as propriedades desse modelo afetam a modelagem e previs√£o de s√©ries temporais n√£o estacion√°rias.

### Conceitos Fundamentais

O modelo *random walk with drift* √© definido pela seguinte equa√ß√£o:
$$y_t = y_{t-1} + \delta + \epsilon_t$$ [^1], onde $y_t$ √© o valor da s√©rie no tempo $t$, $y_{t-1}$ √© o valor da s√©rie no tempo anterior, $\delta$ √© a deriva (drift) e $\epsilon_t$ √© um termo de erro aleat√≥rio, geralmente considerado ru√≠do branco com m√©dia zero e vari√¢ncia constante $\sigma^2$ [^1].  Este modelo √© um caso especial do processo de raiz unit√°ria: $(1-L)y_t = \delta + \psi(L)\epsilon_t$, onde $\psi(L) = 1$ [^1].  A simplicidade desta forma protot√≠pica permite uma an√°lise clara das caracter√≠sticas de n√£o estacionariedade e persist√™ncia encontradas em processos com raiz unit√°ria.

A principal caracter√≠stica do *random walk with drift* √© que o valor atual da s√©rie depende do valor anterior, com uma adi√ß√£o de um componente de deriva ($\delta$) e um choque aleat√≥rio ($\epsilon_t$). Se a deriva $\delta$ for igual a zero, temos um passeio aleat√≥rio simples, onde a s√©rie se move aleatoriamente sem uma tend√™ncia definida. Se $\delta$ for diferente de zero, a s√©rie exibir√° uma tend√™ncia de crescimento ($\delta > 0$) ou decrescimento ($\delta < 0$) ao longo do tempo. A variabilidade da s√©rie √© causada pelos choques aleat√≥rios $\epsilon_t$.

> üí° **Exemplo Num√©rico:** Considere um *random walk with drift* com $\delta = 0.2$ e ru√≠do branco $\epsilon_t$ com vari√¢ncia 1. Se o valor inicial for $y_0 = 0$, ent√£o $y_1 = 0 + 0.2 + \epsilon_1$, $y_2 = y_1 + 0.2 + \epsilon_2 = 0.4 + \epsilon_1 + \epsilon_2$, e assim por diante.  Este exemplo mostra como a s√©rie √© constru√≠da iterativamente, incorporando o choque aleat√≥rio e a tend√™ncia (deriva).  Note que se $\delta = 0$, o valor esperado de $y_t$ n√£o se altera a cada per√≠odo.

```python
import numpy as np
import matplotlib.pyplot as plt

# Simula√ß√£o de um random walk com drift
np.random.seed(42)
T = 100
delta = 0.2
epsilon = np.random.normal(0, 1, T+1)
y = np.zeros(T+1)
y[0]=0
for t in range(1,T+1):
  y[t] = y[t-1] + delta + epsilon[t]

plt.plot(y)
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.title('Random Walk com Drift')
plt.show()
```

O *random walk with drift* √© uma forma simples de processo n√£o estacion√°rio. A n√£o estacionariedade pode ser comprovada demonstrando que a vari√¢ncia de $y_t$ cresce com o tempo.  Por defini√ß√£o, $y_t = y_{t-1} + \delta + \epsilon_t$, podemos expressar $y_t$ como $y_t = y_0 + \delta t + \sum_{i=1}^t \epsilon_i$.  Assumindo que $y_0=0$, ent√£o,  $Var(y_t) = Var( \delta t + \sum_{i=1}^t \epsilon_i) = Var(\sum_{i=1}^t \epsilon_i) = t\sigma^2$. Ou seja, a vari√¢ncia de $y_t$ cresce linearmente com o tempo, indicando que a s√©rie √© n√£o estacion√°ria.

> üí° **Exemplo Num√©rico:** Vamos calcular a vari√¢ncia para alguns pontos no tempo. Se $\sigma^2=1$, ent√£o $Var(y_1) = 1 * 1 = 1$, $Var(y_2) = 2 * 1 = 2$, $Var(y_{10}) = 10 * 1 = 10$.  Este crescimento linear da vari√¢ncia com o tempo √© uma caracter√≠stica chave de processos *random walk* e explica por que eles s√£o considerados n√£o estacion√°rios.

**Lema 5:** *A representa√ß√£o $y_t = y_{t-1} + \delta + \epsilon_t$ √© equivalente a $(1-L)y_t = \delta + \epsilon_t$, e representa um processo de raiz unit√°ria onde $\psi(L)=1$.*

*Prova:*
I. Come√ßamos com a equa√ß√£o $y_t = y_{t-1} + \delta + \epsilon_t$.
II. Subtraindo $y_{t-1}$ de ambos os lados, obtemos $y_t - y_{t-1} = \delta + \epsilon_t$.
III. Aplicando o operador de diferen√ßa $(1-L)$ em $y_t$, temos $(1-L)y_t = y_t - y_{t-1}$.
IV. Portanto, $(1-L)y_t = \delta + \epsilon_t$.
V. Comparando com a forma geral do processo de raiz unit√°ria $(1-L)y_t = \delta + \psi(L)\epsilon_t$, conclu√≠mos que $\psi(L) = 1$.
VI. Isso demonstra que a representa√ß√£o dada √© um processo de raiz unit√°ria com $\psi(L) = 1$. ‚ñ†

**Proposi√ß√£o 5.1:** *O *random walk with drift* tem um efeito persistente de choques, ou seja, um choque aleat√≥rio em $\epsilon_t$ afeta permanentemente o n√≠vel da s√©rie.*

*Prova:*
I. Expressamos $y_t$ como a soma de choques passados: $y_t = y_0 + \delta t + \sum_{i=1}^t \epsilon_i$.
II. Um choque no per√≠odo $t$, $\epsilon_t$, tem um impacto direto sobre $y_t$, atrav√©s de sua inclus√£o na soma.
III. Para per√≠odos futuros $t+s$, o choque $\epsilon_t$ continua presente na soma $\sum_{i=1}^{t+s} \epsilon_i$.
IV. Portanto, o efeito do choque $\epsilon_t$ n√£o se dissipa com o tempo, afetando permanentemente o n√≠vel da s√©rie. ‚ñ†

> üí° **Exemplo Num√©rico:** Se no per√≠odo 10 houver um choque $\epsilon_{10} = 2$, ent√£o o n√≠vel da s√©rie ser√° acrescido de 2 a partir desse per√≠odo. Se $\epsilon_{11}$ for igual a zero, o efeito de $\epsilon_{10}=2$ continuar√° a ser transmitido para os valores de $y_t$ com $t > 10$. Digamos que $y_9=10$. Ent√£o, $y_{10} = 10 + 0.2 + 2 = 12.2$. Se $\epsilon_{11} = 0$, $y_{11} = 12.2 + 0.2 + 0 = 12.4$.  O efeito de $\epsilon_{10}=2$ persiste no n√≠vel de $y_{11}$ e em todos os $y_t$ para $t > 10$.

**Teorema 5:** *A previs√£o do *random walk with drift*, dada por $\hat{y}_{t+s|t} = y_t + s\delta$, converge para uma linha reta com inclina√ß√£o $\delta$, onde o intercepto varia a cada nova observa√ß√£o ($y_t$). A vari√¢ncia do erro de previs√£o cresce linearmente com o horizonte de previs√£o s.*

*Prova:*
I. A previs√£o de um passo √† frente √© $\hat{y}_{t+1|t} = y_t + \delta$. A previs√£o de dois passos √† frente √© $\hat{y}_{t+2|t} = y_{t+1|t} + \delta = y_t + 2\delta$.
II. Generalizando para $s$ passos √† frente, a previs√£o √© $\hat{y}_{t+s|t} = y_t + s\delta$.
III. Isso demonstra que a previs√£o converge para uma linha reta com inclina√ß√£o $\delta$. O intercepto, dado por $y_t$, varia com o √∫ltimo valor da s√©rie.
IV. O erro de previs√£o para s passos √† frente √© $e_{t+s} = y_{t+s} - \hat{y}_{t+s|t} = \sum_{i=1}^s \epsilon_{t+i}$. A vari√¢ncia do erro de previs√£o √© $Var(e_{t+s}) = Var(\sum_{i=1}^s \epsilon_{t+i}) = s\sigma^2$, que cresce linearmente com o horizonte de previs√£o $s$.
V. Portanto, a previs√£o converge para uma linha reta, cujo intercepto √© atualizado a cada nova observa√ß√£o, e a vari√¢ncia do erro de previs√£o cresce linearmente com o horizonte de previs√£o. ‚ñ†

> üí° **Exemplo Num√©rico:** Suponha que $y_{10} = 15$, e $\delta = 0.2$. A previs√£o para o tempo 11 √© $\hat{y}_{11|10} = 15 + 0.2(1) = 15.2$. A previs√£o para o tempo 12 √© $\hat{y}_{12|10} = 15 + 0.2(2) = 15.4$. Para o tempo 20, a previs√£o √© $\hat{y}_{20|10} = 15 + 0.2(10) = 17$. Observamos que a previs√£o acompanha uma linha com inclina√ß√£o 0.2, mas o intercepto √© definido pelo valor da s√©rie no √∫ltimo per√≠odo. Vamos calcular a vari√¢ncia do erro de previs√£o. Se $\sigma^2=1$, ent√£o $Var(e_{t+1})=1$, $Var(e_{t+2})=2$, $Var(e_{t+10})=10$.  A vari√¢ncia do erro de previs√£o aumenta linearmente com o horizonte de previs√£o.

```python
import numpy as np
import matplotlib.pyplot as plt

# Simula√ß√£o de um random walk com drift para previs√£o
np.random.seed(42)
T = 100
delta = 0.2
epsilon = np.random.normal(0, 1, T+10)
y = np.zeros(T+10)
y[0] = 0
for t in range(1,T+10):
    y[t] = y[t-1] + delta + epsilon[t]


s=10 #horizonte de previs√£o
forecast_s = y[T-1] + delta * s


plt.plot(range(1,T+10), y[1:], label='S√©rie Real')
plt.plot(T-1, y[T-1], 'ro', label="√öltima observa√ß√£o")
plt.axhline(y = forecast_s, color="g", linestyle="--", label = "Previs√£o para T+10")
plt.xlabel('Tempo')
plt.ylabel('y_t')
plt.legend()
plt.title('Previs√£o em Random Walk com Drift')
plt.show()
```

A import√¢ncia de modelar tend√™ncias fica evidente quando se considera que a premissa de converg√™ncia da previs√£o para uma m√©dia constante √© inadequada para processos como o *random walk with drift*.  A previs√£o para um horizonte de tempo distante n√£o converge para uma m√©dia constante, mas sim para uma linha reta, cuja inclina√ß√£o √© definida pela deriva $\delta$ e o intercepto √© dado pelo √∫ltimo valor observado da s√©rie.

**Proposi√ß√£o 5.2:** *O processo de primeira diferen√ßa do *random walk with drift* $\Delta y_t = y_t - y_{t-1}$ √© um processo estacion√°rio.*

*Prova:*
I.  Partimos da defini√ß√£o de *random walk with drift*: $y_t = y_{t-1} + \delta + \epsilon_t$.
II. Subtraindo $y_{t-1}$ de ambos os lados, temos: $y_t - y_{t-1} = \delta + \epsilon_t$.
III. Definindo $\Delta y_t = y_t - y_{t-1}$, obtemos $\Delta y_t = \delta + \epsilon_t$.
IV. Como $\delta$ √© uma constante e $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia constante $\sigma^2$, $\Delta y_t$ √© um processo com m√©dia constante $\delta$ e vari√¢ncia constante $\sigma^2$.
V. Portanto, o processo $\Delta y_t$ √© estacion√°rio. ‚ñ†

> üí° **Exemplo Num√©rico:** Se tivermos uma s√©rie $y_t$ gerada por um *random walk with drift* com $\delta=0.2$, e $\epsilon_t$ com vari√¢ncia 1, a s√©rie de primeiras diferen√ßas $\Delta y_t$ ter√° uma m√©dia igual a $0.2$ e uma vari√¢ncia igual a 1. A s√©rie original $y_t$ √© n√£o estacion√°ria, enquanto a s√©rie $\Delta y_t$ √© estacion√°ria.

**Lema 5.1:** *A esperan√ßa condicional do *random walk with drift* √© dada por $E[y_{t+s}|y_t] = y_t + s\delta$.*

*Prova:*
I. Sabemos que $y_{t+s} = y_t + s\delta + \sum_{i=1}^{s}\epsilon_{t+i}$.
II. Tomando a esperan√ßa condicional em $y_t$, temos $E[y_{t+s}|y_t] = E[y_t + s\delta + \sum_{i=1}^{s}\epsilon_{t+i}|y_t]$.
III. Como $y_t$ e $\delta$ s√£o conhecidos no tempo $t$,  $E[y_t|y_t] = y_t$ e $E[s\delta|y_t] = s\delta$.
IV. Devido √† propriedade de ru√≠do branco de $\epsilon_t$,  $E[\epsilon_{t+i}|y_t] = 0$ para todo $i>0$. Portanto, $E[\sum_{i=1}^{s}\epsilon_{t+i}|y_t] = 0$.
V. Assim, $E[y_{t+s}|y_t] = y_t + s\delta + 0 = y_t + s\delta$. ‚ñ†

### Implica√ß√µes Pr√°ticas

O *random walk with drift* serve como um modelo fundamental para entender a n√£o estacionariedade e as caracter√≠sticas de processos com raiz unit√°ria. A simplicidade do modelo permite que ele seja usado para ilustrar:

*   **Persist√™ncia de Choques:** Um choque aleat√≥rio tem um efeito permanente sobre o n√≠vel da s√©rie [^1]. Isso contrasta com modelos estacion√°rios, onde o efeito de um choque diminui ao longo do tempo.
*   **Comportamento da Previs√£o:** A previs√£o n√£o converge para uma m√©dia constante, mas para uma linha reta com inclina√ß√£o $\delta$, onde o intercepto √© dado pelo √∫ltimo valor observado. A vari√¢ncia do erro de previs√£o aumenta linearmente com o horizonte de previs√£o.
*   **Necessidade de Transforma√ß√£o:** Para tornar a s√©rie estacion√°ria, √© necess√°rio diferenci√°-la, ou seja, considerar $\Delta y_t$ em vez de $y_t$.

O *random walk with drift* serve como uma base para a modelagem de muitas s√©ries temporais econ√¥micas e financeiras, e a compreens√£o de suas propriedades √© essencial para uma an√°lise adequada. Muitos fen√¥menos econ√¥micos, como pre√ßos de ativos, taxas de c√¢mbio e algumas s√©ries macroecon√¥micas, podem ser adequadamente representados por *random walks with drift*, ou processos similares de raiz unit√°ria.

> üí° **Exemplo Num√©rico:** Modelar o pre√ßo de uma a√ß√£o. Se o pre√ßo da a√ß√£o fosse um processo estacion√°rio, com m√©dia constante, poder√≠amos esperar que ele sempre retornasse √† m√©dia. No entanto, na pr√°tica, o pre√ßo da a√ß√£o se move de forma aleat√≥ria, com a possibilidade de uma tend√™ncia de crescimento ou decrescimento, ou seja, um comportamento muito similar ao *random walk with drift*. Imagine uma a√ß√£o cujo pre√ßo hoje √© R\$ 10. Se fosse estacion√°ria, o pre√ßo tenderia a voltar para algo pr√≥ximo a R\$ 10. Mas, se seguir um *random walk*, amanh√£ o pre√ßo pode ser R\$ 10.50 ou R\$ 9.70, sem nenhuma tend√™ncia de retornar aos R\$ 10. Al√©m disso, se houver uma deriva, ela pode ter uma tend√™ncia consistente de crescimento ou decrescimento ao longo do tempo.

### Conclus√£o

O *random walk with drift* √© uma forma protot√≠pica de processo de raiz unit√°ria, obtido ao definirmos $\psi(L) = 1$ no modelo geral de raiz unit√°ria. Esta representa√ß√£o simples, mas poderosa, fornece um entendimento claro das caracter√≠sticas de n√£o estacionariedade e persist√™ncia presentes nesse tipo de processo. A an√°lise detalhada deste modelo demonstra que, ao contr√°rio de processos estacion√°rios, a expectativa condicional n√£o converge para uma m√©dia constante, mas sim para uma linha reta, cuja inclina√ß√£o √© determinada pela deriva e cujo intercepto √© atualizado a cada nova observa√ß√£o. Os choques, neste modelo, tem um efeito permanente na trajet√≥ria da s√©rie. Al√©m disso, a vari√¢ncia do erro de previs√£o cresce linearmente com o horizonte de previs√£o. Este modelo serve como uma base essencial para a modelagem e previs√£o de s√©ries temporais n√£o estacion√°rias, particularmente em contextos econ√¥micos e financeiros, onde a n√£o estacionariedade e a persist√™ncia s√£o fen√¥menos comuns.

### Refer√™ncias
[^1]: [15.1.4]
<!-- END -->
