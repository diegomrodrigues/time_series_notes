## Modelos de S√©ries Temporais N√£o Estacion√°rias: Uma Compara√ß√£o Abrangente

### Introdu√ß√£o
Nos cap√≠tulos anteriores, exploramos as nuances dos modelos de s√©ries temporais n√£o estacion√°rias, analisando em profundidade a transforma√ß√£o para estacionariedade, previs√µes, equival√™ncia observacional e multiplicadores din√¢micos em modelos com tend√™ncia e com raiz unit√°ria. Estabelecemos a import√¢ncia de compreender as diferen√ßas fundamentais entre esses modelos para uma an√°lise precisa das s√©ries temporais e para a tomada de decis√µes informadas. Este cap√≠tulo tem como objetivo fornecer uma vis√£o geral abrangente, consolidando os principais conceitos discutidos e comparando diretamente modelos estacion√°rios, modelos com tend√™ncia determin√≠stica e modelos com raiz unit√°ria. Essa compara√ß√£o direta nos permitir√° sintetizar o conhecimento adquirido e destacar as abordagens distintas que cada modelo utiliza para capturar diferentes comportamentos das s√©ries temporais. Ao compreender as nuances das diferentes abordagens de modelagem, os pesquisadores podem tomar decis√µes mais informadas sobre quais modelos s√£o mais apropriados para dados espec√≠ficos.

### Conceitos Fundamentais
#### Modelos Estacion√°rios
Modelos estacion√°rios, discutidos nos Cap√≠tulos 3 e 4 [^1], descrevem s√©ries temporais cujas propriedades estat√≠sticas n√£o variam ao longo do tempo. Especificamente, a m√©dia, vari√¢ncia e autocovari√¢ncia da s√©rie s√£o constantes no tempo [^1]. Um modelo estacion√°rio gen√©rico pode ser representado como [15.1.1]:

$$y_t = \mu + \psi(L)\epsilon_t$$
onde $\mu$ √© a m√©dia da s√©rie, $\psi(L)$ √© um operador de m√©dia m√≥vel (que pode incluir um componente autorregressivo) e $\epsilon_t$ √© um ru√≠do branco. As principais caracter√≠sticas desses modelos incluem:
-   **M√©dia constante:** A esperan√ßa condicional e incondicional da s√©rie s√£o iguais e constantes ao longo do tempo: $E[y_t] = \mu$ [^1].
-   **Vari√¢ncia constante:** A vari√¢ncia da s√©rie n√£o varia com o tempo, $\text{Var}(y_t) = \sigma^2_{\epsilon}\sum_{i=0}^\infty \psi_i^2$
-   **Autocovari√¢ncia dependente do lag:** A autocovari√¢ncia entre $y_t$ e $y_{t-k}$ depende apenas do lag $k$, n√£o do tempo $t$.
-   **Previs√µes convergentes:** As previs√µes da s√©rie convergem para a m√©dia incondicional √† medida que o horizonte de previs√£o aumenta:  $\lim_{s \to \infty} \hat{y}_{t+s|t} = \mu$ [^1].
-   **Efeito transit√≥rio dos choques:** O efeito de um choque na s√©rie diminui com o tempo e tende a zero.

**Observa√ß√£o 7.1** (Defini√ß√£o Formal de Estacionaridade)
Formalmente, um processo √© considerado estacion√°rio em sentido amplo ou *fracamente estacion√°rio* se a sua m√©dia e vari√¢ncia forem constantes ao longo do tempo e se a sua autocovari√¢ncia entre dois pontos no tempo depender apenas do intervalo entre eles, n√£o da sua localiza√ß√£o no tempo. Ou seja, para quaisquer $t$ e $s$: $\mathbb{E}[y_t] = \mu$, $\text{Var}(y_t) = \sigma^2$ e $\text{Cov}(y_t, y_{t-s}) = \gamma_s$.

**Lema 7.1** (Estacionaridade e Operador de Deslocamento)
Se $y_t$ √© um processo estacion√°rio, ent√£o $L^k y_t = y_{t-k}$ tamb√©m √© um processo estacion√°rio para qualquer inteiro $k$.
*Prova:*
I. A estacionaridade de $y_t$ implica que $E[y_t] = \mu$, $Var[y_t] = \sigma^2$, e $Cov[y_t, y_{t-s}] = \gamma_s$ para quaisquer $t$ e $s$.
II. O operador de deslocamento $L^k$ simplesmente desloca a s√©rie temporal $k$ per√≠odos para tr√°s, ent√£o $L^k y_t = y_{t-k}$.
III. Portanto, $E[L^k y_t] = E[y_{t-k}] = \mu$, $Var[L^k y_t] = Var[y_{t-k}] = \sigma^2$, e $Cov[L^k y_t, L^k y_{t-s}] = Cov[y_{t-k}, y_{t-k-s}] = \gamma_s$.
IV. Como estas propriedades (m√©dia, vari√¢ncia e autocovari√¢ncia) n√£o mudam com respeito ao tempo, $L^k y_t$ tamb√©m √© estacion√°rio. ‚ñ†
> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal estacion√°ria $y_t$ gerada por um processo AR(1): $y_t = 0.5y_{t-1} + \epsilon_t$, onde $\epsilon_t$ √© um ru√≠do branco com m√©dia 0 e vari√¢ncia 1. Se a m√©dia de $y_t$ √© 2, ent√£o $E[y_t] = 2$ para todo $t$. A vari√¢ncia de $y_t$ tamb√©m √© constante. Vamos supor que a vari√¢ncia de $y_t$ seja igual a $\sigma^2 = 1.33$ (calculada como $\sigma^2 = \frac{\sigma^2_\epsilon}{1 - \phi^2} = \frac{1}{1-0.5^2}$ no caso de AR(1)). Se pegarmos um valor arbitr√°rio de $y_{t-1}$ e $y_t$, digamos $y_{t-1} = 2.2$ e $y_t = 3.0$, e calcularmos a autocovari√¢ncia entre eles com um lag de 1, isso depender√° apenas do lag (1), e n√£o da posi√ß√£o de $t$ na s√©rie temporal. O efeito de um choque em $\epsilon_t$ diminuir√° gradualmente com o tempo.

#### Modelos com Tend√™ncia Determin√≠stica
Modelos com tend√™ncia determin√≠stica, apresentados na equa√ß√£o [15.1.2] [^1],  incorporam uma tend√™ncia determin√≠stica ao longo do tempo, substituindo a m√©dia constante do modelo estacion√°rio por uma fun√ß√£o linear do tempo:
$$
y_t = \alpha + \delta t + \psi(L)\epsilon_t
$$
onde $\alpha$ √© o intercepto, $\delta$ √© a inclina√ß√£o da tend√™ncia linear, e $\psi(L)$ descreve o componente estoc√°stico estacion√°rio. As principais caracter√≠sticas desses modelos s√£o:
-   **M√©dia vari√°vel:** A m√©dia da s√©rie varia linearmente com o tempo: $E[y_t] = \alpha + \delta t$.
-  **Vari√¢ncia constante (ap√≥s remover a tend√™ncia):** A vari√¢ncia do componente estoc√°stico √© constante no tempo.
-   **Tend√™ncia determin√≠stica:** A s√©rie se move em torno de uma tend√™ncia linear determin√≠stica, e desvios s√£o considerados estacion√°rios.
-   **Previs√µes convergentes para a tend√™ncia:** As previs√µes da s√©rie convergem para a tend√™ncia determin√≠stica no longo prazo: $\lim_{s \to \infty} \hat{y}_{t+s|t} = \alpha + \delta(t+s)$ [^5].
-   **Efeito transit√≥rio dos choques em rela√ß√£o √† tend√™ncia:** Desvios da tend√™ncia s√£o tempor√°rios, e a s√©rie eventualmente retorna √† sua trajet√≥ria definida pela tend√™ncia.
-   **Transforma√ß√£o para estacionariedade:** A s√©rie se torna estacion√°ria ao remover a tend√™ncia linear determin√≠stica: $y_t - (\alpha + \delta t) =  \psi(L)\epsilon_t$ [^1].

**Observa√ß√£o 7.2** (Generaliza√ß√£o de Modelos com Tend√™ncia)
√â importante notar que, em alguns casos, a tend√™ncia pode ser uma fun√ß√£o determin√≠stica mais complexa do tempo (como uma fun√ß√£o polinomial do tempo). Nesses casos, a s√©rie torna-se estacion√°ria ap√≥s remover esta tend√™ncia determin√≠stica mais complexa.

**Proposi√ß√£o 7.1** (Decomposi√ß√£o de S√©ries Temporais com Tend√™ncia)
Qualquer s√©rie temporal com tend√™ncia determin√≠stica pode ser decomposta em duas componentes: uma componente determin√≠stica (a tend√™ncia) e uma componente estoc√°stica estacion√°ria.
*Prova:*
I. Considere o modelo $y_t = \alpha + \delta t + \psi(L)\epsilon_t$.
II. A componente determin√≠stica √© dada por $T_t = \alpha + \delta t$.
III. A componente estoc√°stica √© $z_t = \psi(L)\epsilon_t$.
IV. Pela defini√ß√£o de modelos com tend√™ncia determin√≠stica, $z_t$ √© estacion√°rio.
V. Assim, $y_t = T_t + z_t$, demonstrando a decomposi√ß√£o da s√©rie em componentes determin√≠sticas e estoc√°sticas estacion√°rias. ‚ñ†
> üí° **Exemplo Num√©rico:** Suponha que uma s√©rie temporal $y_t$ represente o n√∫mero de vendas de um produto ao longo do tempo e siga o modelo $y_t = 10 + 2t + 0.8\epsilon_{t-1} + \epsilon_t$. Onde $\alpha = 10$ representa o n√∫mero inicial de vendas, $\delta = 2$ representa o aumento m√©dio de vendas por per√≠odo, e $\psi(L)\epsilon_t=0.8\epsilon_{t-1} + \epsilon_t$ √© um processo de m√©dia m√≥vel, com $\epsilon_t$ sendo ru√≠do branco. A m√©dia da s√©rie √© $E[y_t] = 10 + 2t$, que varia com o tempo. Para tornar a s√©rie estacion√°ria, removemos a tend√™ncia determin√≠stica: $y_t - (10 + 2t) = 0.8\epsilon_{t-1} + \epsilon_t$, resultando em uma s√©rie estacion√°ria. Se no per√≠odo $t = 5$ temos $y_5 = 23$ e $\epsilon_{4}=1$, e se temos um choque positivo $\epsilon_{5}=2$. Ter√≠amos que  $y_5 = 10+2*5 + 0.8*1+2=22.8$,  o efeito desse choque se dissipar√° ao longo do tempo retornando para a tend√™ncia $10+2t$.
>
> ```mermaid
>  graph LR
>      A[S√©rie Original y_t] --> B(Remo√ß√£o da Tend√™ncia);
>      B --> C[S√©rie Estacion√°ria z_t];
>      style A fill:#f9f,stroke:#333,stroke-width:2px
>      style C fill:#ccf,stroke:#333,stroke-width:2px
> ```

#### Modelos com Raiz Unit√°ria
Modelos com raiz unit√°ria, descritos na equa√ß√£o [15.1.3] [^1],  incorporam a n√£o estacionariedade na estrutura do processo, diferenciando a s√©rie para se tornar estacion√°ria:
$$
(1-L)y_t = \delta + \psi(L)\epsilon_t
$$
onde $(1-L)y_t = \Delta y_t$ representa a diferen√ßa da s√©rie, $\delta$ √© o drift, e $\psi(L)$ √© o componente estoc√°stico estacion√°rio. As principais caracter√≠sticas desses modelos incluem:
-   **M√©dia vari√°vel (mas estacion√°ria ap√≥s diferen√ßa):** A s√©rie n√£o tem uma m√©dia constante, mas a diferen√ßa da s√©rie, $\Delta y_t$, tem uma m√©dia constante: $E[\Delta y_t] = \delta$.
-   **Vari√¢ncia crescente:** A vari√¢ncia da s√©rie n√£o √© constante e tende a aumentar com o tempo: $\text{Var}(y_t) = t\sigma^2$ [^10].
-   **Previs√µes com incerteza crescente:** A vari√¢ncia do erro de previs√£o n√£o converge e cresce com o horizonte de previs√£o [^5].
-   **Efeito permanente dos choques:** Choques alteram o n√≠vel da s√©rie de forma permanente [^12].
-  **Transforma√ß√£o para estacionariedade:** A s√©rie se torna estacion√°ria ao tomar a primeira diferen√ßa da s√©rie: $ (1-L)y_t = \delta + \psi(L)\epsilon_t$ [^1].
-   **Presen√ßa de raiz unit√°ria:**  A presen√ßa de um operador $(1-L)$ no lado esquerdo da equa√ß√£o indica uma raiz unit√°ria, causando o comportamento n√£o estacion√°rio do processo.

**Observa√ß√£o 7.3** (Integra√ß√£o de Ordem Superior)
Modelos com raiz unit√°ria podem ser generalizados para processos integrados de ordem superior, onde √© necess√°rio diferenciar a s√©rie mais de uma vez para atingir a estacionaridade. Por exemplo, uma s√©rie integrada de ordem 2,  $I(2)$, necessita ser diferenciada duas vezes para se tornar estacion√°ria.

**Teorema 7.1** (Propriedades da Diferencia√ß√£o)
Se $y_t$ √© uma s√©rie temporal integrada de ordem $d$, ent√£o a s√©rie $\Delta^d y_t$ √© estacion√°ria, onde $\Delta = (1-L)$ √© o operador de diferen√ßa e $\Delta^d$ representa a aplica√ß√£o iterada do operador de diferen√ßa $d$ vezes.
*Prova:*
I. Por defini√ß√£o, uma s√©rie temporal integrada de ordem $d$, denotada por $I(d)$, torna-se estacion√°ria ap√≥s ser diferenciada $d$ vezes.
II. Isso significa que $\Delta^d y_t$ tem m√©dia, vari√¢ncia e autocovari√¢ncia constantes ao longo do tempo, satisfazendo a defini√ß√£o de estacionaridade. ‚ñ†
> üí° **Exemplo Num√©rico:** Considere o modelo com raiz unit√°ria $y_t = y_{t-1} + 0.5\epsilon_{t-1} + \epsilon_t$. Aqui, $\delta = 0$, e  $\psi(L) = 0.5L + 1$. Se tomarmos a primeira diferen√ßa, temos $\Delta y_t = y_t - y_{t-1} = 0.5\epsilon_{t-1} + \epsilon_t$, que agora √© estacion√°ria. Inicialmente $y_0 = 10$ e $\epsilon_0 = 0$. Se $\epsilon_1 = 2$, ent√£o $y_1= 10+0+2=12$. Se $\epsilon_2=3$, ent√£o $y_2=12+0.5*2+3=16$. O efeito do choque de $\epsilon_1$ em $y_2$ √© 0.5, e o efeito de um choque $\epsilon_2$ √© 1, esses valores permanecer√£o na s√©rie alterando o n√≠vel de forma permanente. Se um choque negativo ocorrer no per√≠odo t=3, e $\epsilon_3 = -2$, ent√£o teremos $y_3=16+0.5*3-2=15.5$. Vemos que o choque de $\epsilon_2=3$ ainda est√° presente na s√©rie alterando o n√≠vel permanentemente e n√£o retornando √† sua trajet√≥ria original como no caso de modelos com tend√™ncia.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 100
> epsilon_std = 1
> delta = 0
>
> # Simula√ß√£o do modelo com raiz unit√°ria
> y = np.zeros(T)
> epsilon = np.random.normal(0, epsilon_std, T)
>
> for t in range(1, T):
>   y[t] = y[t-1] + 0.5*epsilon[t-1]+epsilon[t] #Modelo com raiz unit√°ria
>
> # Simula√ß√£o do modelo estacion√°rio
> y_stationary = np.zeros(T)
> for t in range(1, T):
>     y_stationary[t] = 0.8*y_stationary[t-1] + epsilon[t]
>
> # Plot
> plt.figure(figsize=(10, 6))
> plt.plot(y, label='Raiz Unit√°ria')
> plt.plot(y_stationary, label='Estacion√°rio AR(1)')
> plt.xlabel('Tempo')
> plt.ylabel('Valor da S√©rie')
> plt.title('Compara√ß√£o de S√©ries Temporais')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```

### Compara√ß√£o Direta
#### Estacionaridade
-   **Modelos estacion√°rios:** S√£o estacion√°rios por defini√ß√£o, com m√©dia e vari√¢ncia constantes no tempo.
-  **Modelos com tend√™ncia:** N√£o s√£o estacion√°rios no seu n√≠vel, mas tornam-se estacion√°rios ao remover a tend√™ncia determin√≠stica.
-   **Modelos com raiz unit√°ria:** N√£o s√£o estacion√°rios no seu n√≠vel, mas tornam-se estacion√°rios ap√≥s a diferencia√ß√£o.
#### Previs√µes
-  **Modelos estacion√°rios:** As previs√µes convergem para a m√©dia incondicional.
-  **Modelos com tend√™ncia:** As previs√µes convergem para a tend√™ncia determin√≠stica.
-   **Modelos com raiz unit√°ria:** As previs√µes s√£o afetadas por choques passados e t√™m uma vari√¢ncia do erro de previs√£o que cresce linearmente com o horizonte de previs√£o.

#### Multiplicadores Din√¢micos
-  **Modelos estacion√°rios:** Os multiplicadores din√¢micos tendem a zero com o aumento do horizonte de tempo, refletindo a transitividade dos choques.
-   **Modelos com tend√™ncia:** Os multiplicadores din√¢micos dos choques em rela√ß√£o √† tend√™ncia determin√≠stica tendem a zero, uma vez que os choques s√£o considerados um desvio de uma trajet√≥ria linear definida, e a s√©rie retorna a esta trajet√≥ria.
-  **Modelos com raiz unit√°ria:** Os multiplicadores din√¢micos n√£o tendem a zero, mas sim a um valor constante, indicando que os choques t√™m um efeito permanente no n√≠vel da s√©rie.
> üí° **Exemplo Num√©rico:** Em um modelo AR(1) estacion√°rio, o efeito de um choque inicial $\epsilon_t$ diminui geometricamente ao longo do tempo. Em um modelo com tend√™ncia, um choque inicial $\epsilon_t$ tamb√©m tem um efeito transit√≥rio em rela√ß√£o a tend√™ncia, o modelo retorna √† sua trajet√≥ria determinada. Mas no modelo com raiz unit√°ria, como visto no exemplo anterior, o efeito do choque √© permanente no n√≠vel da s√©rie, e os multiplicadores din√¢micos n√£o convergem para zero.
>
> | Tempo (s) | Multiplicador Din√¢mico (AR(1) $\phi = 0.8$) | Multiplicador Din√¢mico (Tend√™ncia) | Multiplicador Din√¢mico (Raiz Unit√°ria) |
> |-----------|-------------------------------------------|---------------------------------|-------------------------------------|
> | 1         | 0.8                                       | 1                                 | 1                                   |
> | 2         | 0.64                                      | 0.8                             | 1                                   |
> | 3         | 0.512                                     | 0.8                             | 1                                   |
> | 10        | 0.107                                     | 0.8                             | 1                                  |
> | 50        | 0.000                                     | 0.8                             | 1                                  |

#### Transforma√ß√£o para Estacionaridade
-   **Modelos estacion√°rios:** N√£o necessitam de transforma√ß√£o para estacionariedade.
-   **Modelos com tend√™ncia:** Necessitam da remo√ß√£o da tend√™ncia determin√≠stica.
-   **Modelos com raiz unit√°ria:** Necessitam da diferencia√ß√£o da s√©rie.
#### Equival√™ncia Observacional
-   **Modelos estacion√°rios vs. Modelos com raiz unit√°ria:** √â dif√≠cil distinguir entre modelos com raiz unit√°ria e processos estacion√°rios com um coeficiente autorregressivo pr√≥ximo de 1 em amostras finitas devido √† equival√™ncia observacional [^11].

**Lema 7.2** (Consequ√™ncia da Equival√™ncia Observacional)
Dada a equival√™ncia observacional entre modelos com raiz unit√°ria e modelos estacion√°rios com coeficientes autorregressivos pr√≥ximos de 1, √© poss√≠vel que testes de raiz unit√°ria tenham baixa pot√™ncia em amostras pequenas, levando a erros de tipo II (aceitar a hip√≥tese nula de raiz unit√°ria quando ela √© falsa).

#### Escolha do Modelo
-   **Modelos estacion√°rios:** Adequados para s√©ries temporais com m√©dia e vari√¢ncia constantes ao longo do tempo e para previs√µes de curto e m√©dio prazo.
-   **Modelos com tend√™ncia:** Adequados para s√©ries com uma tend√™ncia clara ao longo do tempo, e onde desvios da tend√™ncia s√£o considerados transit√≥rios.  S√£o √∫teis para previs√µes de longo prazo quando a tend√™ncia subjacente √© esperada para continuar.
-  **Modelos com raiz unit√°ria:** Adequados para s√©ries com efeitos permanentes de choques, onde previs√µes de longo prazo t√™m alta incerteza. √öteis para s√©ries com alto grau de persist√™ncia.
> üí° **Exemplo Num√©rico:** Se analisarmos o pre√ßo de um ativo financeiro e observarmos que ele tem um aumento constante ao longo do tempo, podemos considerar um modelo com tend√™ncia. No entanto, se notarmos que a s√©rie sobe e desce sem uma tend√™ncia clara, e que choques t√™m efeitos permanentes no n√≠vel da s√©rie, ent√£o um modelo com raiz unit√°ria pode ser mais apropriado. Se analisarmos a taxa de crescimento de um pa√≠s que apresenta um comportamento com m√©dia e vari√¢ncia constantes ao longo do tempo, o modelo estacion√°rio pode ser o mais adequado.

### Implica√ß√µes
A escolha do modelo de s√©rie temporal tem implica√ß√µes profundas na an√°lise e interpreta√ß√£o dos dados.
-   A suposi√ß√£o de estacionariedade nos dados pode levar a conclus√µes incorretas se a s√©rie apresentar uma tend√™ncia ou raiz unit√°ria.
-   O uso inadequado de modelos com raiz unit√°ria em s√©ries *trend-stationary* pode resultar em sobreajuste e dificuldade de interpreta√ß√£o do modelo.
-   A distin√ß√£o entre modelos com raiz unit√°ria e modelos estacion√°rios √© fundamental para previs√µes de longo prazo, onde a vari√¢ncia do erro de previs√£o se comporta de forma diferente.
- A escolha do modelo tamb√©m deve se basear no conhecimento econ√¥mico e te√≥rico, n√£o apenas em resultados estat√≠sticos.

### Conclus√£o
Modelos estacion√°rios, modelos com tend√™ncia e modelos com raiz unit√°ria representam abordagens distintas para modelar s√©ries temporais, cada um com suas pr√≥prias caracter√≠sticas, implica√ß√µes e transforma√ß√µes necess√°rias para estacionariedade. A escolha entre esses modelos depende da natureza da s√©rie temporal e dos objetivos da an√°lise. Compreender as diferen√ßas nas previs√µes, multiplicadores din√¢micos, equival√™ncia observacional, e transforma√ß√µes necess√°rias para cada abordagem √© fundamental para uma modelagem adequada e para uma interpreta√ß√£o precisa dos resultados. O conhecimento detalhado de cada abordagem permite aos pesquisadores fazer escolhas mais precisas sobre a modelagem adequada para os seus dados, maximizando a utilidade das an√°lises e previs√µes de s√©ries temporais. Esta discuss√£o consolidada visa proporcionar uma compreens√£o mais profunda das diferentes formas de modelar a n√£o estacionaridade, capacitando os estudiosos da √°rea a escolherem abordagens mais adequadas para cada caso espec√≠fico.

### Refer√™ncias
[^1]: Cap√≠tulo 15, Se√ß√£o 15.1. Introdu√ß√£o.
[^5]: Cap√≠tulo 15, Se√ß√£o 15.3, subse√ß√£o "Comparison of Forecasts".
[^10]: Cap√≠tulo 15, Se√ß√£o 15.3, subse√ß√£o "Transformations to Achieve Stationarity"
[^11]: Cap√≠tulo 15, Se√ß√£o 15.4 "The Meaning of Tests for Unit Roots"
[^12]: Cap√≠tulo 15, Se√ß√£o 15.3, subse√ß√£o "Comparison of Dynamic Multipliers"
<!-- END -->
