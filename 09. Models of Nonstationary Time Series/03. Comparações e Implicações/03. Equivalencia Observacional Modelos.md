## Equival√™ncia Observacional entre Modelos com Raiz Unit√°ria e Processos Estacion√°rios

### Introdu√ß√£o
Nos cap√≠tulos anteriores, exploramos as nuances da modelagem de s√©ries temporais n√£o estacion√°rias, contrastando abordagens baseadas em tend√™ncias determin√≠sticas com aquelas que incorporam ra√≠zes unit√°rias. Analisamos como essas escolhas afetam a transforma√ß√£o dos dados para estacionariedade e como elas se refletem nas previs√µes, com diferentes comportamentos no longo prazo. Agora, adentramos um t√≥pico central e desafiador: a *equival√™ncia observacional* entre modelos com raiz unit√°ria e processos estacion√°rios. Este conceito, crucial para a interpreta√ß√£o dos resultados e testes estat√≠sticos em s√©ries temporais, levanta a quest√£o de se, em amostras finitas, √© poss√≠vel distinguir empiricamente entre esses dois tipos de modelos. A dificuldade inerente em distinguir entre eles tem implica√ß√µes profundas na pr√°tica e teoria econom√©trica, pois significa que as conclus√µes sobre a presen√ßa de ra√≠zes unit√°rias, baseadas em dados observacionais, devem ser interpretadas com cautela.

### Conceitos Fundamentais
#### O Desafio da Distin√ß√£o em Amostras Finitas
A dificuldade em distinguir entre modelos com raiz unit√°ria e processos estacion√°rios surge do fato de que, com um n√∫mero finito de observa√ß√µes, podemos encontrar processos estacion√°rios que mimetizam o comportamento de um processo com raiz unit√°ria, e vice-versa. Em outras palavras, as distribui√ß√µes de probabilidade das s√©ries geradas por esses dois tipos de modelos podem se sobrepor consideravelmente, tornando dif√≠cil determinar qual modelo gerou realmente os dados observados [^11].

Para ilustrar essa dificuldade, vamos considerar um processo de passeio aleat√≥rio sem drift, descrito na equa√ß√£o [15.4.1] [^11]:

$$y_t = y_{t-1} + \epsilon_t$$

e um processo estacion√°rio com um coeficiente autorregressivo pr√≥ximo de 1, como em [15.4.2]:

$$y_t = \phi y_{t-1} + \epsilon_t, \quad |\phi| < 1$$

onde $\epsilon_t$ √© ru√≠do branco. Se $\phi$ for muito pr√≥ximo de 1 (por exemplo, $\phi = 0.999$), a s√©rie gerada pelo segundo modelo se comportar√° de forma muito semelhante √† s√©rie gerada pelo primeiro, especialmente em amostras finitas [^11]. Ambos os modelos apresentar√£o persist√™ncia e uma trajet√≥ria que, √† primeira vista, pode ser considerada n√£o estacion√°ria.

> üí° **Exemplo Num√©rico:** Vamos gerar amostras simuladas de um passeio aleat√≥rio ($y_t = y_{t-1} + \epsilon_t$) e de um processo AR(1) ($y_t = 0.99 y_{t-1} + \epsilon_t$) e comparar suas trajet√≥rias para 100 observa√ß√µes.
```python
import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)
n = 100
sigma_sq = 1
epsilon_rw = np.random.normal(0, np.sqrt(sigma_sq), n)
epsilon_ar = np.random.normal(0, np.sqrt(sigma_sq), n)

# Random Walk
y_rw = np.zeros(n)
y_rw[0] = 0
for t in range(1, n):
    y_rw[t] = y_rw[t-1] + epsilon_rw[t]


# AR(1)
phi = 0.99
y_ar = np.zeros(n)
y_ar[0] = 0
for t in range(1,n):
  y_ar[t] = phi*y_ar[t-1] + epsilon_ar[t]

# Plotando as trajet√≥rias
plt.figure(figsize=(10, 6))
plt.plot(range(n), y_rw, label='Passeio Aleat√≥rio')
plt.plot(range(n), y_ar, label='AR(1) com œÜ=0.99')
plt.xlabel('Tempo (t)')
plt.ylabel('y_t')
plt.title('Compara√ß√£o de Trajet√≥rias: Passeio Aleat√≥rio vs. AR(1)')
plt.legend()
plt.grid(True)
plt.show()
```
As trajet√≥rias dos dois processos mostram uma semelhan√ßa not√°vel, e seria dif√≠cil distinguir entre elas com base apenas em uma observa√ß√£o visual. Isso ilustra o conceito de equival√™ncia observacional em amostras finitas. As distribui√ß√µes dos dois processos podem ser muito parecidas em uma amostra de 100, e portanto, dif√≠cil de discernir.

> üí° **Exemplo Num√©rico:** Para quantificar a similaridade, podemos calcular a autocorrela√ß√£o de ambas as s√©ries. A autocorrela√ß√£o em um *lag* k, $\rho_k$,  mede a correla√ß√£o entre $y_t$ e $y_{t-k}$. Para um passeio aleat√≥rio, a autocorrela√ß√£o tende a decair lentamente. Para um AR(1) com $\phi$ pr√≥ximo de 1, a autocorrela√ß√£o tamb√©m decai lentamente, mas a uma taxa maior que um passeio aleat√≥rio.

```python
def autocorr(y, k):
    n = len(y)
    if k >= n:
        return 0
    y_mean = np.mean(y)
    num = np.sum([(y[t] - y_mean) * (y[t-k] - y_mean) for t in range(k,n)])
    den = np.sum([(y[t] - y_mean)**2 for t in range(n)])
    return num/den

# C√°lculo da autocorrela√ß√£o para diferentes lags
lags = [1, 5, 10, 20]
autocorr_rw = [autocorr(y_rw, lag) for lag in lags]
autocorr_ar = [autocorr(y_ar, lag) for lag in lags]

# Impress√£o dos resultados
print("Autocorrela√ß√µes para Passeio Aleat√≥rio:")
for lag, ac in zip(lags, autocorr_rw):
    print(f"Lag {lag}: {ac:.3f}")
print("\nAutocorrela√ß√µes para AR(1) com œÜ=0.99:")
for lag, ac in zip(lags, autocorr_ar):
    print(f"Lag {lag}: {ac:.3f}")

```
A autocorrela√ß√£o nos lags maiores √© maior para o passeio aleat√≥rio do que para o AR(1), indicando que a persist√™ncia √© maior no passeio aleat√≥rio, mas as autocorrela√ß√µes de ambas as s√©ries s√£o elevadas, o que dificulta uma distin√ß√£o clara em amostras pequenas.

#### Equival√™ncia Observacional: Uma Formula√ß√£o Formal
A equival√™ncia observacional pode ser formalizada considerando a fun√ß√£o de verossimilhan√ßa condicional para processos Gaussianos [^11]. Dado um conjunto de observa√ß√µes $\{y_1, y_2, \ldots, y_T\}$, a fun√ß√£o de verossimilhan√ßa, $L(\theta|y)$, para um modelo parametrizado por $\theta$, mede a probabilidade dos dados observados dada uma escolha de par√¢metros $\theta$. Para um processo com raiz unit√°ria e um processo estacion√°rio, a fun√ß√£o de verossimilhan√ßa pode ser similar para diferentes valores de par√¢metros em um n√∫mero finito de observa√ß√µes, particularmente quando os processos s√£o simulados em tempo finito.

Formalmente, para um processo com raiz unit√°ria, a fun√ß√£o de verossimilhan√ßa √© cont√≠nua em rela√ß√£o ao par√¢metro da raiz unit√°ria ($\lambda_1=1$ ou $\phi = 1$ no exemplo acima). Isso significa que, para qualquer amostra de tamanho finito $T$, podemos encontrar uma especifica√ß√£o estacion√°ria com $\lambda_1<1$ ou $\phi < 1$ com uma fun√ß√£o de verossimilhan√ßa t√£o pr√≥xima quanto se deseje da fun√ß√£o de verossimilhan√ßa do processo com raiz unit√°ria,  e vice-versa [^11].

**Proposi√ß√£o 4.1** (Continuidade da Fun√ß√£o de Verossimilhan√ßa)
Para uma amostra de tamanho fixo $T$, qualquer processo com raiz unit√°ria pode ser arbitrariamente bem aproximado por um processo estacion√°rio, e vice-versa. Formalmente, dadas fun√ß√µes de verossimilhan√ßa $L_{RU}$ para um processo com raiz unit√°ria e $L_{S}$ para um processo estacion√°rio, e dados valores positivos $\eta$ e $\epsilon$, existe um processo estacion√°rio com $L_{S}$ tal que $P(|L_{RU} - L_{S}| > \eta) < \epsilon$, e vice versa.

*Prova:*
I. Considere a fun√ß√£o de verossimilhan√ßa condicional $L$ para um processo Gaussiano caracterizado por um par√¢metro de raiz unit√°ria $\lambda_1$.
II. Assuma que a fun√ß√£o de verossimilhan√ßa condicional para um processo estacion√°rio √© caracterizada por $\lambda_1 < 1$.
III. A fun√ß√£o de verossimilhan√ßa condicional √© uma fun√ß√£o cont√≠nua em rela√ß√£o a $\lambda_1$.
IV. Para qualquer processo com $\lambda_1 = 1$ (raiz unit√°ria) e para qualquer valor pequeno $\eta > 0$, existe um valor $\lambda_1^* < 1$ tal que $|L(\lambda_1 = 1) - L(\lambda_1^*)| < \eta$.
V. Esta continuidade significa que, dado um tamanho amostral fixo $T$, o valor da fun√ß√£o de verossimilhan√ßa para $\lambda_1=1$ (raiz unit√°ria) pode ser t√£o pr√≥xima quanto desejarmos do valor da fun√ß√£o de verossimilhan√ßa com um valor $\lambda_1<1$ (estacion√°rio) e vice versa. Isso implica que a probabilidade de observar uma amostra em que a fun√ß√£o de verossimilhan√ßa para raiz unit√°ria e estacion√°rio sejam distingu√≠veis pode ser arbitrariamente pequena. $\blacksquare$

**Lema 4.1** (Consequ√™ncia da Continuidade)
A continuidade da fun√ß√£o de verossimilhan√ßa em rela√ß√£o ao par√¢metro da raiz unit√°ria implica que, em amostras finitas, a distin√ß√£o entre processos com raiz unit√°ria e processos estacion√°rios √© um problema mal-posto.

*Prova:*
I. Pela Proposi√ß√£o 4.1, para qualquer amostra de tamanho finito, a fun√ß√£o de verossimilhan√ßa de um processo com raiz unit√°ria pode ser arbitrariamente aproximada por um processo estacion√°rio, e vice-versa.
II. Um problema mal-posto √© aquele em que pequenas mudan√ßas nos dados de entrada podem levar a grandes mudan√ßas na solu√ß√£o.
III. No contexto da distin√ß√£o entre processos com raiz unit√°ria e estacion√°rios, pequenas mudan√ßas nos par√¢metros (especificamente, o par√¢metro da raiz unit√°ria $\lambda_1$) podem levar a grandes mudan√ßas nas conclus√µes sobre a natureza do processo gerador de dados.
IV. A continuidade da fun√ß√£o de verossimilhan√ßa garante que, para qualquer processo com raiz unit√°ria, existe um processo estacion√°rio muito pr√≥ximo cujas amostras s√£o quase indistingu√≠veis na pr√°tica. E o contr√°rio tamb√©m vale.
V. Portanto, a distin√ß√£o entre processos com raiz unit√°ria e processos estacion√°rios, dada a continuidade da fun√ß√£o de verossimilhan√ßa e a limita√ß√£o de amostras finitas, √© um problema mal-posto. $\blacksquare$

#### Implica√ß√µes para Testes de Raiz Unit√°ria
A equival√™ncia observacional tem implica√ß√µes profundas para os testes de raiz unit√°ria. Esses testes, frequentemente usados para determinar se uma s√©rie temporal possui uma raiz unit√°ria ou n√£o, baseiam-se em certas propriedades estat√≠sticas da s√©rie, e muitas vezes partem da hip√≥tese de que as s√©ries s√£o processos estacion√°rios na hip√≥tese alternativa [^11]. No entanto, a sobreposi√ß√£o nas distribui√ß√µes de probabilidade torna dif√≠cil, em amostras finitas, rejeitar a hip√≥tese nula de raiz unit√°ria quando ela √© falsa, e vice-versa. A pot√™ncia dos testes (isto √©, a capacidade de rejeitar a hip√≥tese nula quando ela √© falsa) √© reduzida, e os resultados devem ser interpretados com cautela [^11].

> üí° **Exemplo Num√©rico:** Para ilustrar o efeito da equival√™ncia observacional nos testes de raiz unit√°ria, vamos simular 1000 amostras de cada um dos processos discutidos acima: um passeio aleat√≥rio e um AR(1) com $\phi = 0.99$. Ent√£o, aplicaremos um teste de Dickey-Fuller aumentado (ADF) para cada amostra e veremos a frequ√™ncia em que a hip√≥tese nula de raiz unit√°ria √© rejeitada em cada caso.

```python
import pandas as pd
from statsmodels.tsa.stattools import adfuller

np.random.seed(42)
num_simulations = 1000
n = 100
sigma_sq = 1
phi = 0.99

#Fun√ß√£o para simular e rodar teste ADF
def simulate_and_test(process_type, n, num_simulations, sigma_sq, phi):
  rejections = 0
  for _ in range(num_simulations):
      epsilon = np.random.normal(0, np.sqrt(sigma_sq), n)
      y = np.zeros(n)
      y[0] = 0
      if process_type == 'rw':
        for t in range(1, n):
          y[t] = y[t-1] + epsilon[t]
      elif process_type == 'ar1':
        for t in range(1, n):
          y[t] = phi*y[t-1] + epsilon[t]
      adf_result = adfuller(y)
      if adf_result[1] < 0.05:
          rejections += 1
  return rejections / num_simulations

# Simula√ß√£o para Passeio Aleat√≥rio
rejection_rate_rw = simulate_and_test('rw', n, num_simulations, sigma_sq, phi)

# Simula√ß√£o para AR(1)
rejection_rate_ar1 = simulate_and_test('ar1', n, num_simulations, sigma_sq, phi)

print(f"Taxa de rejei√ß√£o da hip√≥tese nula para Passeio Aleat√≥rio: {rejection_rate_rw:.2f}")
print(f"Taxa de rejei√ß√£o da hip√≥tese nula para AR(1) com phi=0.99: {rejection_rate_ar1:.2f}")
```
Em amostras finitas, o teste ADF rejeita a hip√≥tese nula (a s√©rie possui raiz unit√°ria) com maior frequ√™ncia quando a s√©rie √© um AR(1) com $\phi=0.99$ do que quando a s√©rie √© um passeio aleat√≥rio. Isso ocorre porque, mesmo que a s√©rie AR(1) seja estacion√°ria, seu comportamento em amostras finitas se assemelha muito ao de uma s√©rie com raiz unit√°ria. Portanto, testes podem ser confundidos em amostras finitas. A taxa de rejei√ß√£o do passeio aleat√≥rio est√° longe de zero porque o teste rejeita a hip√≥tese nula em algumas amostras, mesmo sendo ela verdadeira (erro do tipo I). A taxa de rejei√ß√£o do AR(1) √© baixa porque ele se parece muito com uma s√©rie com raiz unit√°ria (erro do tipo II).

Al√©m disso, quando a raiz unit√°ria √© modelada por um processo autoregressivo de ordem $p$, a escolha da ordem $p$ torna-se crucial para a conclus√£o do teste, pois as ra√≠zes da equa√ß√£o autoregressiva podem ser arbitrariamente pr√≥ximas de 1 (mas n√£o igual a 1) e mimetizar um comportamento de um processo com raiz unit√°ria.  Em situa√ß√µes pr√°ticas, a escolha do modelo que melhor se ajusta aos dados observados em uma amostra finita, n√£o necessariamente implica o modelo que corretamente descreve o processo gerador de dados.

**Lema 5** (Limita√ß√µes de Testes de Raiz Unit√°ria)
Testes estat√≠sticos de raiz unit√°ria t√™m pot√™ncia limitada em amostras finitas e podem levar a conclus√µes err√¥neas devido √† equival√™ncia observacional entre processos com raiz unit√°ria e processos estacion√°rios.

*Prova:*
I. Testes de raiz unit√°ria buscam rejeitar a hip√≥tese nula de que a s√©rie tem uma raiz unit√°ria $(\lambda_1 = 1)$ contra a hip√≥tese alternativa de que a s√©rie √© estacion√°ria $(\lambda_1 < 1)$.
II. A fun√ß√£o de verossimilhan√ßa para um processo com $\lambda_1 = 1$ e um processo $\lambda_1<1$ pode ser arbitrariamente pr√≥xima em amostras finitas, como demonstrado na proposi√ß√£o 4.1.
III. A pot√™ncia de um teste estat√≠stico se define como a probabilidade de corretamente rejeitar a hip√≥tese nula quando ela √© falsa.
IV. Em fun√ß√£o da equival√™ncia observacional, existe uma probabilidade n√£o nula de que, mesmo que a hip√≥tese nula seja falsa (a s√©rie √© estacion√°ria), o teste falhe em rejeit√°-la, especialmente quando $\lambda_1$ √© muito pr√≥ximo de 1.
V. Assim, a sobreposi√ß√£o das distribui√ß√µes de probabilidade implica que as decis√µes sobre a presen√ßa ou n√£o de uma raiz unit√°ria s√£o baseadas em um teste estat√≠stico que, em amostras finitas, tem dificuldade em discriminar os modelos, concluindo que a capacidade de discriminar entre processos com raiz unit√°ria e estacion√°rios √© limitada para amostras finitas. $\blacksquare$

**Corol√°rio 5.1** (Impacto do Tamanho da Amostra)
A pot√™ncia dos testes de raiz unit√°ria aumenta com o tamanho da amostra, mas a equival√™ncia observacional nunca √© completamente eliminada em amostras finitas.

*Prova:*
I. A equival√™ncia observacional, como demonstrado na Proposi√ß√£o 4.1, √© uma consequ√™ncia da continuidade da fun√ß√£o de verossimilhan√ßa e da limita√ß√£o de amostras finitas.
II. √Ä medida que o tamanho da amostra $T$ aumenta, a fun√ß√£o de verossimilhan√ßa dos processos com raiz unit√°ria e estacion√°rios se tornam mais distintas, o que tende a aumentar a pot√™ncia dos testes.
III. No entanto, a continuidade da fun√ß√£o de verossimilhan√ßa implica que, mesmo para amostras muito grandes, ainda existir√° uma sobreposi√ß√£o, embora menor, nas distribui√ß√µes de probabilidade dos processos.
IV. Portanto, embora a pot√™ncia dos testes aumente com o tamanho da amostra, a equival√™ncia observacional persiste em amostras finitas, impossibilitando uma distin√ß√£o perfeita entre os processos. $\blacksquare$

#### Implica√ß√µes Pr√°ticas
As implica√ß√µes pr√°ticas dessa equival√™ncia observacional s√£o significativas. Primeiro, a decis√£o de modelar uma s√©rie como um processo com raiz unit√°ria ou como um processo estacion√°rio com um coeficiente autorregressivo pr√≥ximo de 1 pode ser dif√≠cil e, em muitos casos, arbitr√°ria com base apenas em dados observacionais. Isso nos leva a ter cautela sobre conclus√µes definitivas sobre a exist√™ncia de uma raiz unit√°ria. Segundo, as decis√µes de pol√≠tica econ√¥mica baseadas em modelos de s√©ries temporais n√£o devem depender exclusivamente de testes de raiz unit√°ria. Em muitos casos, a escolha entre modelos com raiz unit√°ria ou estacion√°rios pode ser mais uma quest√£o de prefer√™ncia para simplificar a modelagem do que uma conclus√£o estat√≠stica robusta.

#### O Papel do Conhecimento Te√≥rico e da Economia
Diante da dificuldade de distinguir entre modelos com raiz unit√°ria e estacion√°rios com base apenas em testes estat√≠sticos, o conhecimento te√≥rico e a economia desempenham um papel crucial. √â fundamental considerar o contexto econ√¥mico da s√©rie temporal, e se a teoria econ√¥mica indica que choques devem ter efeitos permanentes (o que seria consistente com a presen√ßa de uma raiz unit√°ria) ou transit√≥rios (o que seria consistente com um modelo estacion√°rio). A escolha do modelo adequado deve se basear em uma combina√ß√£o de an√°lise estat√≠stica, teoria econ√¥mica e conhecimento do contexto emp√≠rico.

**Observa√ß√£o 5.1** (Modelagem Baseada em Conhecimento)
Em situa√ß√µes de equival√™ncia observacional, a escolha do modelo deve ser guiada pelo conhecimento econ√¥mico e te√≥rico, n√£o apenas por resultados estat√≠sticos. A modelagem deve ser vista como um processo de aproxima√ß√£o da realidade, e n√£o como uma busca por uma verdade absoluta sobre o processo gerador de dados. A escolha do modelo, portanto, deve refletir o que melhor descreve o comportamento dos dados com base em conhecimento externo e parcim√¥nia.

### Conclus√£o
O conceito de equival√™ncia observacional demonstra que, em amostras finitas, √© dif√≠cil distinguir entre modelos com raiz unit√°ria e processos estacion√°rios. Essa dificuldade surge da sobreposi√ß√£o nas distribui√ß√µes de probabilidade dos dois modelos, e tem implica√ß√µes profundas na interpreta√ß√£o dos resultados de testes estat√≠sticos e na modelagem de s√©ries temporais n√£o estacion√°rias. A escolha entre modelos com raiz unit√°ria e estacion√°rios deve ser informada n√£o apenas por resultados estat√≠sticos, mas tamb√©m por teoria econ√¥mica e conhecimento do contexto emp√≠rico, que podem fornecer uma base mais s√≥lida para a tomada de decis√µes. √â importante lembrar que, em muitos casos, a escolha do modelo √© mais uma quest√£o de conveni√™ncia para simplificar a modelagem do que uma verdade absoluta sobre o processo gerador de dados.

### Refer√™ncias
[^11]: Cap√≠tulo 15, Se√ß√£o 15.4 "The Meaning of Tests for Unit Roots"
<!-- END -->
