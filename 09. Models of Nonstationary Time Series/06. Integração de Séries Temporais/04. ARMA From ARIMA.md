## Transforma√ß√£o de Processos ARIMA em ARMA Atrav√©s da Diferencia√ß√£o

### Introdu√ß√£o
Este cap√≠tulo aprofunda nossa explora√ß√£o de modelos de s√©ries temporais n√£o estacion√°rias, focando em como a diferencia√ß√£o transforma processos Autoregressivos Integrados de M√©dias M√≥veis (ARIMA) em processos Autoregressivos de M√©dias M√≥veis (ARMA) estacion√°rios [^1]. Nos cap√≠tulos anteriores, discutimos a import√¢ncia da estacionariedade [^1] e como as transforma√ß√µes logar√≠tmicas [^Prev1] e o conceito de integra√ß√£o de ordem $d$ [^Prev2] s√£o fundamentais para modelar s√©ries temporais n√£o estacion√°rias. Agora, examinaremos como a aplica√ß√£o da diferencia√ß√£o a um processo ARIMA resulta em um processo ARMA estacion√°rio, permitindo-nos utilizar as bem estabelecidas propriedades e ferramentas de an√°lise de s√©ries temporais estacion√°rias.

### Conceitos Fundamentais
Como abordado anteriormente [^1] [^Prev1] [^Prev2], a n√£o estacionariedade em s√©ries temporais √© um desafio significativo na modelagem. As s√©ries n√£o estacion√°rias apresentam caracter√≠sticas estat√≠sticas que variam ao longo do tempo, o que torna inadequada a aplica√ß√£o direta de modelos desenvolvidos para s√©ries estacion√°rias. Modelos como o ARMA, que assumem estacionariedade, n√£o podem ser aplicados diretamente a s√©ries n√£o estacion√°rias. Para contornar este problema, foram introduzidas transforma√ß√µes como diferencia√ß√£o, que tem o objetivo de transformar uma s√©rie n√£o estacion√°ria em uma s√©rie estacion√°ria.

Em particular, um processo **Autoregressivo Integrado de M√©dias M√≥veis (ARIMA)**, denotado como ARIMA(p, d, q), √© um modelo que generaliza os modelos ARMA para s√©ries temporais n√£o estacion√°rias. O componente $d$ em ARIMA(p, d, q) representa a ordem de integra√ß√£o, ou seja, o n√∫mero de vezes que a s√©rie precisa ser diferenciada para se tornar estacion√°ria [^Prev2]. Os modelos ARIMA s√£o uma extens√£o dos modelos ARMA, que incorporam a diferencia√ß√£o para modelar a n√£o estacionariedade.

Um processo **Autoregressivo de M√©dias M√≥veis (ARMA)**, por outro lado, √© um modelo adequado para s√©ries temporais estacion√°rias e √© definido por:
$$ y_t = \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_q \epsilon_{t-q} $$
onde $y_t$ √© a s√©rie temporal, $\phi_i$ s√£o os coeficientes autoregressivos, $\theta_j$ s√£o os coeficientes de m√©dias m√≥veis e $\epsilon_t$ √© o ru√≠do branco. A estacionariedade √© uma condi√ß√£o chave para a aplicabilidade de modelos ARMA.

A transforma√ß√£o de um processo ARIMA em um ARMA √© realizada aplicando o operador de diferencia√ß√£o $(1-L)$ √† s√©rie original $d$ vezes. Essa opera√ß√£o elimina a n√£o estacionariedade, transformando a s√©rie em uma forma que pode ser adequadamente modelada usando as ferramentas tradicionais para s√©ries temporais estacion√°rias. Em ess√™ncia, a componente $I$ no modelo ARIMA trata da n√£o estacionariedade atrav√©s da diferencia√ß√£o.

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal de pre√ßos de a√ß√µes que seguem um processo ARIMA(1, 1, 0). Suponha que a s√©rie original $y_t$ seja:
>
> | t | $y_t$ |
> |---|-------|
> | 1 | 100   |
> | 2 | 102   |
> | 3 | 105   |
> | 4 | 107   |
> | 5 | 110   |
>
> O modelo ARIMA(1, 1, 0) √© dado por: $(1 - L)y_t = \phi (1-L)y_{t-1} + \epsilon_t$. Aplicando a primeira diferen√ßa, obtemos a s√©rie $\Delta y_t = y_t - y_{t-1}$:
>
> | t | $\Delta y_t$ |
> |---|------------|
> | 2 | 2          |
> | 3 | 3          |
> | 4 | 2          |
> | 5 | 3          |
>
>  Se, por exemplo, $\phi = 0.5$ e os erros $\epsilon_t$ s√£o ru√≠do branco com m√©dia zero, o modelo para $\Delta y_t$ torna-se:
>
>  $$ \Delta y_t = 0.5 \Delta y_{t-1} + \epsilon_t $$
>
>  Esta nova s√©rie $\Delta y_t$ agora segue um modelo AR(1) estacion√°rio, demonstrando a transforma√ß√£o de um processo ARIMA(1,1,0) em um processo AR(1). A s√©rie original $y_t$ possui uma tend√™ncia crescente, mas a s√©rie diferenciada $\Delta y_t$ parece variar em torno de uma m√©dia constante, satisfazendo a condi√ß√£o de estacionariedade.
>
>   Onde $\Delta y_t = y_t - y_{t-1}$ √© agora uma s√©rie temporal estacion√°ria que segue um modelo AR(1). Ao diferenciar a s√©rie original $y_t$ uma vez, a componente n√£o estacion√°ria √© removida e resulta em uma s√©rie estacion√°ria, neste caso seguindo um modelo AR(1).

O objetivo da diferencia√ß√£o √© eliminar a depend√™ncia temporal de longo prazo, transformando a s√©rie em uma forma que as propriedades estat√≠sticas s√£o relativamente constantes ao longo do tempo. Isso permite que modelos como o ARMA, que s√£o baseados na estacionariedade, sejam aplicados com efic√°cia.

**Defini√ß√£o 1:** Um processo ARIMA(p, d, q) √© um modelo para s√©ries temporais n√£o estacion√°rias definido por:
$$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
onde $(1-L)^d$ representa o operador de diferencia√ß√£o aplicado $d$ vezes, $\Phi(L)$ √© o polin√¥mio autoregressivo de ordem $p$, $\Theta(L)$ √© o polin√¥mio de m√©dias m√≥veis de ordem $q$ e $\epsilon_t$ √© um ru√≠do branco.

**Defini√ß√£o 2:** Um processo ARMA(p, q) √© um modelo para s√©ries temporais estacion√°rias definido por:
$$ y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
onde $\Phi(L)$ √© o polin√¥mio autoregressivo de ordem $p$, $\Theta(L)$ √© o polin√¥mio de m√©dias m√≥veis de ordem $q$ e $\epsilon_t$ √© um ru√≠do branco.

**Proposi√ß√£o 1:** (Transforma√ß√£o ARIMA em ARMA). Ao aplicar $d$ diferen√ßas a um processo ARIMA(p, d, q), o resultado √© um processo ARMA(p, q) estacion√°rio.
*Proof:*
I. Considere um processo ARIMA(p, d, q) definido por:
    $$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
II. Seja $w_t = (1-L)^d y_t$. Ent√£o, a equa√ß√£o acima pode ser reescrita como:
     $$ w_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
III. A equa√ß√£o acima representa um processo ARMA(p, q).
IV. Como $w_t = (1-L)^d y_t$, o processo original $y_t$ √© diferenciado $d$ vezes, e o processo resultante $w_t$ √© um ARMA estacion√°rio.
‚ñ†

> üí° **Exemplo Num√©rico:** Suponha um processo ARIMA(2, 1, 1) onde:
>  $$ (1-L)y_t = \frac{1+\theta L}{1-\phi_1 L-\phi_2 L^2} \epsilon_t $$
>  Considerando $\phi_1 = 0.8$, $\phi_2 = -0.2$, $\theta = 0.5$. Aplicando o operador de primeira diferen√ßa $(1-L)$ na s√©rie $y_t$, obtemos a nova s√©rie $\Delta y_t = y_t - y_{t-1}$. Essa s√©rie diferenciada agora segue um processo ARMA(2,1):
>   $$ \Delta y_t = \frac{1+0.5 L}{1-0.8 L+0.2 L^2} \epsilon_t $$
>
>  I. Aplicando o operador de primeira diferen√ßa $(1-L)$, obtemos:
>   $$ \Delta y_t = \frac{1+\theta L}{1-\phi_1 L-\phi_2 L^2} \epsilon_t $$
> II. Onde $\Delta y_t = y_t - y_{t-1}$. A s√©rie resultante $\Delta y_t$ agora segue um processo ARMA(2,1) estacion√°rio.

**Teorema 1:** (Propriedade de Transforma√ß√£o). A aplica√ß√£o do operador de diferencia√ß√£o $(1-L)^d$ a um processo ARIMA(p, d, q) resulta em um processo ARMA(p, q) estacion√°rio.
*Proof:*
I.  Considere um processo ARIMA(p, d, q) definido por:
   $$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
II. Seja $w_t = (1-L)^d y_t$. Substituindo na equa√ß√£o acima, obtemos:
    $$ w_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
III. Pela defini√ß√£o, esta equa√ß√£o representa um processo ARMA(p, q) estacion√°rio.
IV.  Portanto, ao aplicar o operador de diferencia√ß√£o $(1-L)^d$ a um processo ARIMA(p, d, q), transformamos a s√©rie original $y_t$ em um processo estacion√°rio ARMA(p, q).
‚ñ†

> üí° **Exemplo Num√©rico:** Considere um processo ARIMA(0, 2, 1). A s√©rie original $y_t$ √© tal que ap√≥s duas diferencia√ß√µes, o processo se torna estacion√°rio. Suponha que:
>
>   $$ (1-L)^2 y_t = (1 + \theta L)\epsilon_t $$
>
> Com $\theta = 0.7$. Desenvolvendo o lado esquerdo:
>
> $$ (1 - 2L + L^2) y_t = y_t - 2y_{t-1} + y_{t-2} = (1 + 0.7L) \epsilon_t $$
>
> Aplicando o operador de segunda diferen√ßa $(1-L)^2$:
>
>   $$ \Delta^2 y_t = (1 + 0.7 L)\epsilon_t $$
>
>   Onde $\Delta^2 y_t = y_t - 2y_{t-1} + y_{t-2}$. A s√©rie resultante $\Delta^2 y_t$ segue um processo MA(1), que √© um caso particular de um ARMA(0,1), sendo, portanto, estacion√°rio.
> I. O modelo √© dado por:
>   $$ (1-L)^2 y_t = (1 + \theta L)\epsilon_t $$
> II. Aplicando o operador de segunda diferen√ßa $(1-L)^2$, obtemos:
>   $$ \Delta^2 y_t = (1 + \theta L)\epsilon_t $$
> III.  Onde $\Delta^2 y_t = y_t - 2y_{t-1} + y_{t-2}$. A s√©rie resultante $\Delta^2 y_t$ segue um processo MA(1), que √© um caso particular de um ARMA(0,1), sendo, portanto, estacion√°rio.

**Lema 1:** Se $y_t$ segue um processo ARIMA(p, d, q), ent√£o $(1-L)^d y_t$ √© um processo ARMA(p, q) estacion√°rio.
*Proof:*
I. Por defini√ß√£o, um processo ARIMA(p, d, q) √© tal que:
   $$ (1-L)^d y_t =  \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
II. A express√£o √† direita da igualdade representa a forma de um processo ARMA(p, q) estacion√°rio.
III. Portanto, ao aplicar o operador $(1-L)^d$ a um processo ARIMA(p, d, q), obtemos um processo ARMA(p, q) estacion√°rio.
‚ñ†

**Corol√°rio 1:** Um processo ARIMA(p, 0, q) √© um processo ARMA(p, q) estacion√°rio.
*Proof:* Este resultado √© uma aplica√ß√£o direta da defini√ß√£o de um processo ARIMA, onde o par√¢metro $d$ representa o n√∫mero de diferencia√ß√µes necess√°rias para se tornar estacion√°rio. Quando d=0, a s√©rie j√° √© estacion√°ria, o que significa que um ARIMA(p, 0, q) √© um ARMA(p, q).
‚ñ†

**Corol√°rio 2:**  Se $y_t$ √© $I(d)$, ent√£o $(1-L)^d y_t$ √© um processo estacion√°rio, que pode ser modelado por um processo ARMA.
*Proof:* Este resultado segue diretamente da defini√ß√£o de integra√ß√£o de ordem $d$, que estabelece que, se uma s√©rie $y_t$ √© $I(d)$, ent√£o aplicar $(1-L)^d$ resulta em um processo estacion√°rio. Sendo estacion√°rio, esse processo pode ser modelado usando a estrutura ARMA.
‚ñ†

> üí° **Exemplo Num√©rico:**
>  Considere um processo ARIMA(1, 2, 1), dado por
>  $$ (1-L)^2 y_t = \frac{1 + \theta L}{1 - \phi L} \epsilon_t $$
>  Assumindo $\phi=0.6$ e $\theta=0.4$.
>  I. Ao aplicar o operador de segunda diferen√ßa $(1-L)^2$, obtemos:
>  $$ \Delta^2 y_t = \frac{1 + \theta L}{1 - \phi L} \epsilon_t $$
>  $$ \Delta^2 y_t = \frac{1 + 0.4 L}{1 - 0.6 L} \epsilon_t $$
> II.  A s√©rie $\Delta^2 y_t$ agora segue um modelo ARMA(1, 1) estacion√°rio. Isso ilustra como duas diferencia√ß√µes transformam o processo original em um modelo ARMA estacion√°rio.

**Lema 1.1:** O operador de diferencia√ß√£o $(1-L)$ √© linear.
*Proof:*
I. Sejam $y_t$ e $z_t$ duas s√©ries temporais, e $a$ e $b$ duas constantes.
II. O operador de primeira diferen√ßa √© definido como $\Delta x_t = x_t - x_{t-1} = (1-L)x_t$
III. Aplicando o operador a uma combina√ß√£o linear de s√©ries temos:
$$ \Delta(a y_t + b z_t) = (a y_t + b z_t) - (a y_{t-1} + b z_{t-1}) $$
IV. Reorganizando, obtemos:
$$ \Delta(a y_t + b z_t) = a(y_t - y_{t-1}) + b(z_t - z_{t-1}) = a\Delta y_t + b\Delta z_t $$
V. Portanto, o operador $(1-L)$ √© linear.
‚ñ†

**Proposi√ß√£o 1.1** A opera√ß√£o de diferencia√ß√£o sucessiva pode ser representada por um operador polinomial em L. Em particular $(1-L)^d$ √© um operador linear.
*Proof:*
I. Pelo Lema 1.1 o operador $(1-L)$ √© linear.
II. A aplica√ß√£o de $(1-L)^d$ corresponde √† aplica√ß√£o do operador $(1-L)$ sucessivas vezes.
III. Como a composi√ß√£o de operadores lineares tamb√©m √© um operador linear, $(1-L)^d$ √© linear.
IV. Desenvolvendo a express√£o $(1-L)^d$, obt√©m-se um polin√¥mio em L, onde os coeficientes do polin√¥mio s√£o os coeficientes binomiais.
‚ñ†

**Teorema 1.1** Se $y_t$ segue um processo ARIMA(p,d,q), ent√£o $w_t = (1-L)^k y_t$ para $k \leq d$  segue um processo ARIMA(p,d-k,q).
*Proof:*
I.  Se $y_t$ segue um processo ARIMA(p,d,q), ent√£o:
$$(1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t$$
II.  Aplicando o operador $(1-L)^k$ a $y_t$ e definindo $w_t = (1-L)^k y_t$, temos
$$(1-L)^{d-k}(1-L)^k y_t = (1-L)^{d-k} w_t =  \frac{\Theta(L)}{\Phi(L)} \epsilon_t$$
III. Portanto, $w_t$ segue um processo ARIMA(p,d-k,q).
‚ñ†

**Corol√°rio 1.1**  Se $y_t$ segue um processo ARIMA(p, d, q), ent√£o $(1-L)^d y_t$  √© um processo estacion√°rio, isto √©, um processo ARMA(p, q).
*Proof:* Este resultado √© um caso particular do Teorema 1.1, onde $k = d$, resultando em um processo ARIMA(p,0,q) que, pelo Corol√°rio 1, √© um ARMA(p, q) estacion√°rio.
‚ñ†

### Conclus√£o
Em resumo, a transforma√ß√£o de processos ARIMA em ARMA por meio da diferencia√ß√£o √© uma t√©cnica fundamental na modelagem de s√©ries temporais n√£o estacion√°rias. Ao aplicar o operador de diferencia√ß√£o $(1-L)$ $d$ vezes, o componente n√£o estacion√°rio √© removido, e o resultado √© um processo ARMA(p, q) estacion√°rio que pode ser analisado usando as ferramentas dispon√≠veis para s√©ries temporais estacion√°rias. Essa transforma√ß√£o permite que modelos estat√≠sticos projetados para s√©ries estacion√°rias sejam aplicados a s√©ries temporais n√£o estacion√°rias, proporcionando uma abordagem robusta e flex√≠vel para modelar dados que apresentam tend√™ncias ou outros tipos de n√£o estacionariedade. Este processo simplifica a modelagem e permite a aplica√ß√£o de t√©cnicas bem estabelecidas para an√°lise de s√©ries temporais estacion√°rias. Em ess√™ncia, ao usar a diferencia√ß√£o, estamos transformando a n√£o estacionariedade em estacionariedade, o que √© essencial para uma an√°lise estat√≠stica rigorosa.

### Refer√™ncias
[^1]: Cap√≠tulo 15 do texto.
[^Prev1]: T√≥pico anterior sobre transforma√ß√µes logar√≠tmicas e modelos de raiz unit√°ria.
[^Prev2]: T√≥pico anterior sobre a integra√ß√£o de s√©ries temporais e a analogia com o c√°lculo.
<!-- END -->
