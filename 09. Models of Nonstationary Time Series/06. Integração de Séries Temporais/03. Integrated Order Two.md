## Integra√ß√£o de Ordem Dois e Diferencia√ß√£o em S√©ries Temporais

### Introdu√ß√£o
Este cap√≠tulo aprofunda nossa an√°lise sobre modelos de s√©ries temporais n√£o estacion√°rias, explorando o conceito de integra√ß√£o de ordem dois e suas implica√ß√µes para a an√°lise de s√©ries temporais [^1]. Construindo sobre a analogia entre integra√ß√£o em c√°lculo e s√©ries temporais, introduzida anteriormente [^Prev], e sobre a discuss√£o das transforma√ß√µes logar√≠tmicas [^Prev1], focaremos especificamente nos processos que exigem duas diferencia√ß√µes para atingir a estacionariedade. Esses processos s√£o considerados integrados de ordem dois, denotados como $y_t \sim I(2)$, e desempenham um papel importante na modelagem de certos fen√¥menos econ√¥micos e financeiros. O objetivo principal √© estabelecer uma compreens√£o s√≥lida de como a presen√ßa de dois autovalores unit√°rios afeta a modelagem e a interpreta√ß√£o de tais s√©ries temporais.

### Conceitos Fundamentais
Como estabelecido em se√ß√µes anteriores [^1] [^Prev], a n√£o estacionariedade em s√©ries temporais √© uma caracter√≠stica que exige tratamento especial, devido √† varia√ß√£o de propriedades estat√≠sticas como m√©dia e vari√¢ncia ao longo do tempo. Discutimos as abordagens de tend√™ncia determin√≠stica e raiz unit√°ria como formas de modelar essa n√£o estacionariedade, introduzindo o conceito de integra√ß√£o de ordem *$d$* [^Prev]. Em particular, um processo $y_t$ √© considerado integrado de ordem *$d$*, denotado como $y_t \sim I(d)$, se ele precisa ser diferenciado *$d$* vezes para se tornar estacion√°rio.

Anteriormente, foi definido que um processo de **raiz unit√°ria** √© modelado como:
$$ (1 - L)y_t = \delta + \psi(L)\epsilon_t $$
onde $(1-L)$ √© o operador de primeira diferen√ßa, $\delta$ √© a deriva, e $\psi(L)\epsilon_t$ representa um processo estacion√°rio. Essa formula√ß√£o caracteriza um processo integrado de ordem 1, ou seja, $y_t \sim I(1)$, pois uma √∫nica aplica√ß√£o do operador de primeira diferen√ßa $(1-L)$ transforma o processo em estacion√°rio.

Agora, vamos considerar um processo que requer duas diferencia√ß√µes para atingir a estacionariedade. Um processo integrado de ordem 2, denotado como $y_t \sim I(2)$, √© caracterizado por ter dois autovalores iguais a 1. Matematicamente, isso significa que o operador $(1 - L)^2$ deve ser aplicado √† s√©rie para torn√°-la estacion√°ria. O operador $(1 - L)^2$ representa a segunda diferen√ßa e pode ser expandido como:
$$ (1 - L)^2 y_t = (1 - 2L + L^2)y_t = y_t - 2y_{t-1} + y_{t-2} = \Delta(\Delta y_t) = \Delta^2 y_t $$
O operador $\Delta^2$ denota a aplica√ß√£o sucessiva da primeira diferen√ßa.

> üí° **Exemplo Num√©rico:** Suponha que uma s√©rie temporal $y_t$ siga o modelo $(1-L)^2y_t = \kappa + \epsilon_t$, onde $\kappa$ √© uma constante e $\epsilon_t$ √© um ru√≠do branco.
> I. Podemos reescrever o modelo como:
>    $$ y_t - 2y_{t-1} + y_{t-2} = \kappa + \epsilon_t $$
> II. A s√©rie $y_t$ √© n√£o estacion√°ria, pois a sua primeira diferen√ßa $\Delta y_t = y_t - y_{t-1}$ tamb√©m n√£o √© estacion√°ria. Para que ela se torne estacion√°ria, precisamos aplicar a diferen√ßa novamente.
> III. Observe que, ao aplicar a primeira diferen√ßa, obtemos:
> $$  (1-L)y_t = y_t - y_{t-1} = z_t $$
>  onde $z_t$ √© n√£o estacion√°ria, mas possui um comportamento de raiz unit√°ria, tal como a s√©rie $y_t$ possu√≠a anteriormente.
> IV. Ao aplicar a primeira diferen√ßa novamente, obtemos:
>    $$ \Delta z_t = \Delta^2 y_t = (1-L)z_t = z_t - z_{t-1} = (y_t - y_{t-1}) - (y_{t-1} - y_{t-2}) =  y_t - 2y_{t-1} + y_{t-2} = \kappa + \epsilon_t $$
> V. A s√©rie $\Delta^2 y_t$ √© estacion√°ria, j√° que ela segue um processo de ru√≠do branco com uma m√©dia constante $\kappa$. Isso demonstra que a s√©rie original $y_t$ necessita de duas diferencia√ß√µes para se tornar estacion√°ria, caracterizando um processo $I(2)$.

A analogia com o c√°lculo pode ser estendida aqui. Se pensarmos na s√©rie original $y_t$ como a posi√ß√£o de um objeto, ent√£o a primeira diferen√ßa, $\Delta y_t$, corresponde √† velocidade do objeto, e a segunda diferen√ßa, $\Delta^2 y_t$, corresponde √† acelera√ß√£o do objeto. Em nosso exemplo, a acelera√ß√£o √© descrita por um ru√≠do branco com uma m√©dia $\kappa$.

> üí° **Exemplo Num√©rico:** Considere a s√©rie $y_t$ como a posi√ß√£o de um objeto ao longo do tempo. Se a primeira diferen√ßa $\Delta y_t = y_t - y_{t-1}$ representa a velocidade do objeto, ent√£o a segunda diferen√ßa $\Delta^2 y_t = \Delta(\Delta y_t) = (y_t - y_{t-1}) - (y_{t-1} - y_{t-2})$ representa a varia√ß√£o da velocidade, ou seja, a acelera√ß√£o. Se a acelera√ß√£o √© um ru√≠do branco com m√©dia zero, ent√£o $\Delta^2 y_t = \epsilon_t$ √© estacion√°ria. Uma situa√ß√£o na f√≠sica que modela esse cen√°rio √© a posi√ß√£o de um objeto sob uma for√ßa aleat√≥ria, onde a acelera√ß√£o √© uma for√ßa aleat√≥ria.
>
> Vamos gerar um exemplo num√©rico com dados simulados em Python.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 200 # N√∫mero de pontos no tempo
> kappa = 0.1 # Constante
>
> # Inicializa√ß√£o
> y = np.zeros(T)
> epsilon = np.random.normal(0, 1, T) # Ru√≠do branco
>
> # Simula√ß√£o da s√©rie I(2)
> for t in range(2, T):
>     y[t] = 2*y[t-1] - y[t-2] + kappa + epsilon[t]
>
> # C√°lculo das primeiras e segundas diferen√ßas
> dy = np.diff(y)
> d2y = np.diff(dy)
>
> # Plotagem das s√©ries
> plt.figure(figsize=(10, 6))
>
> plt.subplot(3, 1, 1)
> plt.plot(y)
> plt.title('S√©rie Temporal I(2) Original $y_t$')
>
> plt.subplot(3, 1, 2)
> plt.plot(dy)
> plt.title('Primeira Diferen√ßa $\Delta y_t$')
>
> plt.subplot(3, 1, 3)
> plt.plot(d2y)
> plt.title('Segunda Diferen√ßa $\Delta^2 y_t$')
>
> plt.tight_layout()
> plt.show()
> ```
> Este c√≥digo simula uma s√©rie I(2), calcula suas primeiras e segundas diferen√ßas, e visualiza as tr√™s s√©ries. Observa-se que a s√©rie original e a primeira diferen√ßa apresentam um comportamento n√£o estacion√°rio, enquanto a segunda diferen√ßa parece estacion√°ria.

Um processo $I(2)$ implica que a s√©rie original $y_t$ tem um comportamento mais err√°tico e menos previs√≠vel do que um processo $I(1)$. A presen√ßa de duas ra√≠zes unit√°rias na representa√ß√£o autorregressiva da s√©rie faz com que ela se afaste ainda mais de uma trajet√≥ria estacion√°ria. A necessidade de aplicar duas diferencia√ß√µes para estacionar o processo implica que a acumula√ß√£o de choques ao longo do tempo afeta a s√©rie de forma mais intensa.

**Lema 1:** Se um processo $y_t$ possui dois autovalores iguais a 1, ent√£o $y_t$ √© um processo integrado de ordem 2, $y_t \sim I(2)$.
*Proof:* Se um processo possui dois autovalores iguais a 1, isso significa que seu polin√¥mio caracter√≠stico possui dois fatores $(1 - L)$. Aplicando o operador $(1-L)$ duas vezes no processo, obtemos $(1-L)^2 y_t$ que resulta em um processo estacion√°rio, como demonstrado no exemplo anterior. Portanto, por defini√ß√£o, a s√©rie $y_t$ √© integrada de ordem 2.
‚ñ†

**Proposi√ß√£o 1:** (Condi√ß√£o para Estacionariedade). Se $y_t \sim I(2)$, ent√£o a segunda diferen√ßa de $y_t$, dada por $\Delta^2 y_t = (1 - L)^2 y_t = y_t - 2y_{t-1} + y_{t-2}$, √© um processo estacion√°rio.
*Proof:*
I. Por defini√ß√£o, um processo $I(2)$ √© aquele que necessita ser diferenciado duas vezes para se tornar estacion√°rio.
II. O operador $(1-L)^2$ representa a segunda diferen√ßa, ou seja, $\Delta^2 y_t = (1-L)^2 y_t$.
III. Aplicando o operador $(1-L)^2$ a um processo $I(2)$, obtemos um processo estacion√°rio.
IV. Portanto, se $y_t \sim I(2)$, ent√£o $\Delta^2 y_t$ √© estacion√°rio.
‚ñ†

> üí° **Exemplo Num√©rico:**
> Seja $y_t$ um processo $I(2)$ tal que $(1-L)^2 y_t = \kappa + \epsilon_t$.
> I. Expandindo o lado esquerdo, temos:
> $$ y_t - 2y_{t-1} + y_{t-2} = \kappa + \epsilon_t $$
> II. Aplicando novamente o operador de primeira diferen√ßa $\Delta$ √† equa√ß√£o acima, obtemos:
>  $$ (y_t - y_{t-1}) - (y_{t-1} - y_{t-2}) = \kappa + \epsilon_t $$
>  $$ \Delta y_t - \Delta y_{t-1} = \kappa + \epsilon_t $$
>  $$ \Delta^2 y_t = \kappa + \epsilon_t $$
>  onde  $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia constante. Isso demonstra que $\Delta^2 y_t$ √© estacion√°rio.
>
> Consideremos um exemplo concreto. Suponha que tenhamos observado a seguinte sequ√™ncia para os tr√™s √∫ltimos per√≠odos de uma s√©rie $y_t$: $y_{t-2} = 100$, $y_{t-1} = 105$, e $y_t = 111$. Podemos calcular $\Delta y_{t-1} = y_{t-1} - y_{t-2} = 105 - 100 = 5$ e $\Delta y_t = y_t - y_{t-1} = 111 - 105 = 6$. A segunda diferen√ßa √© ent√£o: $\Delta^2 y_t = \Delta y_t - \Delta y_{t-1} = 6 - 5 = 1$.  Se a segunda diferen√ßa fosse estacion√°ria em torno de um valor constante, isso refor√ßaria a hip√≥tese de que $y_t$ seja um processo $I(2)$.

**Teorema 1:** (Rela√ß√£o com Modelos ARIMA). Um processo ARIMA(p, d, q) com $d=2$ implica que a s√©rie original $y_t$ √© integrada de ordem 2, ou seja, $y_t \sim I(2)$.
*Proof:*
I. Em um modelo ARIMA(p, d, q), o par√¢metro *d* representa a ordem de integra√ß√£o.
II. Se *d* = 2, ent√£o o modelo √© expresso como:
    $$ (1-L)^2 y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
III. Aplicando o operador $(1-L)^2$ na s√©rie $y_t$ obtemos um processo estacion√°rio de ARMA(p, q).
IV. Portanto, a s√©rie original $y_t$ √© integrada de ordem 2, $y_t \sim I(2)$.
‚ñ†

**Teorema 1.1** (Generaliza√ß√£o para Integra√ß√£o de Ordem *d*): Um processo ARIMA(p, d, q) com ordem de diferencia√ß√£o *d* implica que a s√©rie original $y_t$ √© integrada de ordem *d*, ou seja, $y_t \sim I(d)$.
*Proof:*
I.  Em um modelo ARIMA(p, d, q), o par√¢metro *d* representa a ordem de diferencia√ß√£o necess√°ria para tornar a s√©rie estacion√°ria.
II.  Se a ordem de diferencia√ß√£o √© *d*, ent√£o o modelo √© expresso como:
    $$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
III. Aplicando o operador $(1-L)^d$ na s√©rie $y_t$ obtemos um processo estacion√°rio ARMA(p, q).
IV. Portanto, a s√©rie original $y_t$ √© integrada de ordem *d*, $y_t \sim I(d)$.
‚ñ†

**Lema 1.1** (Consequ√™ncia da Integra√ß√£o): Se $y_t \sim I(d)$, ent√£o $\Delta^k y_t$ √© $I(d-k)$ para $k \leq d$.
*Proof:*
I.  Se $y_t \sim I(d)$, ent√£o $\Delta^d y_t$ √© estacion√°rio.
II. Aplicando o operador $\Delta$ *k* vezes a $y_t$ resulta em $\Delta^k y_t$.
III.  Para tornar $\Delta^k y_t$ estacion√°rio, precisamos aplicar o operador $\Delta$ outras $(d-k)$ vezes.
IV.  Assim, $\Delta^k y_t$ √© $I(d-k)$ por defini√ß√£o.
‚ñ†

**Corol√°rio 1:** Se $y_t \sim I(2)$, ent√£o $\Delta y_t \sim I(1)$ e $\Delta^2 y_t \sim I(0)$, ou seja, $\Delta^2 y_t$ √© estacion√°rio.
*Proof:* Este resultado √© uma aplica√ß√£o direta do Lema 1.1, com d=2, k=1 e k=2, respectivamente.
‚ñ†

### Conclus√£o
A presen√ßa de dois autovalores unit√°rios em um processo autorregressivo implica que a s√©rie temporal √© integrada de ordem dois, $y_t \sim I(2)$. Isso significa que a s√©rie precisa ser diferenciada duas vezes para se tornar estacion√°ria. Essa propriedade tem implica√ß√µes importantes para modelagem e previs√£o, pois sugere um comportamento mais err√°tico e acumulativo do que processos integrados de ordem um. Compreender a natureza da integra√ß√£o de ordem dois √© essencial para escolher a transforma√ß√£o apropriada para tornar uma s√©rie temporal estacion√°ria, e √© fundamental para a aplica√ß√£o de modelos ARIMA e outras t√©cnicas de s√©ries temporais. O operador de segunda diferen√ßa $(1-L)^2$ √© uma ferramenta essencial na an√°lise de s√©ries temporais $I(2)$, e sua aplica√ß√£o nos permite trabalhar com uma vers√£o estacion√°ria da s√©rie original, facilitando a modelagem e an√°lise dos dados. Em suma, o conceito de integra√ß√£o de ordem dois √© uma extens√£o natural da ideia de integra√ß√£o de ordem um e √© crucial para a an√°lise completa de s√©ries temporais n√£o estacion√°rias.

### Refer√™ncias
[^1]: Cap√≠tulo 15 do texto.
[^Prev]: T√≥pico anterior sobre a integra√ß√£o de s√©ries temporais e a analogia com o c√°lculo.
[^Prev1]: T√≥pico anterior sobre transforma√ß√µes logar√≠tmicas e modelos de raiz unit√°ria.
<!-- END -->
