## Modelos ARIMA(p, d, q): Uma Vis√£o Abrangente

### Introdu√ß√£o
Este cap√≠tulo explora o conceito de processos Autoregressivos Integrados de M√©dias M√≥veis (ARIMA), detalhando como a ordem de integra√ß√£o, $d$, influencia a estacionariedade da s√©rie temporal.  Construindo sobre as bases estabelecidas em cap√≠tulos anteriores sobre transforma√ß√µes logar√≠tmicas [^Prev1], a analogia entre integra√ß√£o em c√°lculo e s√©ries temporais [^Prev2], processos com raiz unit√°ria e integra√ß√£o de ordem 1 [^Prev5] e  a transforma√ß√£o de processos ARIMA em ARMA por diferencia√ß√£o [^Prev4], o presente cap√≠tulo tem como objetivo formalizar a defini√ß√£o de modelos ARIMA(p, d, q), demonstrando como a aplica√ß√£o da diferencia√ß√£o de ordem $d$ resulta em um processo ARMA(p, q) estacion√°rio. O objetivo principal √© apresentar uma vis√£o geral do modelo ARIMA como uma ferramenta essencial para modelar s√©ries temporais n√£o estacion√°rias.

### Conceitos Fundamentais
Como j√° discutido em se√ß√µes anteriores, a n√£o estacionariedade √© uma caracter√≠stica chave em muitas s√©ries temporais, e o tratamento adequado dessa propriedade √© crucial para obter previs√µes e an√°lises estat√≠sticas precisas. Modelos ARMA s√£o adequados para modelar s√©ries estacion√°rias, enquanto modelos ARIMA incorporam a diferencia√ß√£o para lidar com a n√£o estacionariedade.

Um processo **Autoregressivo Integrado de M√©dias M√≥veis (ARIMA)**, denotado como ARIMA(p, d, q), √© uma generaliza√ß√£o dos modelos ARMA para s√©ries temporais n√£o estacion√°rias. O modelo ARIMA combina elementos de modelos autoregressivos (AR), m√©dias m√≥veis (MA) e integra√ß√£o (I). O componente $p$ representa a ordem da parte autoregressiva, $q$ representa a ordem da parte de m√©dias m√≥veis e $d$ representa a ordem de integra√ß√£o, ou seja, o n√∫mero de vezes que a s√©rie precisa ser diferenciada para se tornar estacion√°ria.  A defini√ß√£o matem√°tica de um processo ARIMA(p, d, q) √© dada por:
$$(1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t$$
onde $(1-L)^d$ √© o operador de diferen√ßa de ordem $d$, $\Phi(L)$ √© o polin√¥mio autoregressivo de ordem $p$, $\Theta(L)$ √© o polin√¥mio de m√©dias m√≥veis de ordem $q$ e $\epsilon_t$ √© o ru√≠do branco.

O operador de diferen√ßa $(1-L)$ √© definido como $(1-L)y_t = y_t - y_{t-1}$, ou seja, a diferen√ßa entre o valor atual e o valor anterior da s√©rie temporal. A aplica√ß√£o do operador $(1-L)$ $d$ vezes resulta na $d$-√©sima diferen√ßa da s√©rie temporal. Se $d = 1$, temos $(1-L)y_t = y_t - y_{t-1} = \Delta y_t$, e se $d=2$, temos $(1-L)^2y_t = (1-2L+L^2)y_t = y_t - 2y_{t-1} + y_{t-2}$.

> üí° **Exemplo Num√©rico:** Considere um processo ARIMA(1, 1, 1). O modelo √© dado por:
>  $$ (1-L)y_t = \frac{1+\theta L}{1-\phi L} \epsilon_t $$
>  Neste exemplo, a s√©rie original $y_t$ √© n√£o estacion√°ria, necessitando de uma diferencia√ß√£o (d=1) para que se torne estacion√°ria. Ap√≥s a primeira diferen√ßa, a nova s√©rie segue um modelo ARMA(1,1).
>   Se quisermos simular tal s√©rie para analisar seu comportamento, podemos implementar o seguinte c√≥digo em Python:
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 200  # N√∫mero de pontos no tempo
> phi = 0.7  # Coeficiente AR(1)
> theta = 0.4  # Coeficiente MA(1)
>
> # Inicializa√ß√£o
> y = np.zeros(T)
> epsilon = np.random.normal(0, 1, T)  # Ru√≠do branco
>
> # Simula√ß√£o da s√©rie ARIMA(1,1,1)
> for t in range(1, T):
>     if t==1:
>         y[t] = y[t-1] + (epsilon[t] + theta*0)/(1 - phi*0)
>     else:
>         y[t] = y[t-1] + (epsilon[t] + theta*epsilon[t-1])/(1 - phi*y[t-1])
>
> # C√°lculo da primeira diferen√ßa
> dy = np.diff(y)
>
> # Plotagem das s√©ries
> plt.figure(figsize=(10, 5))
>
> plt.subplot(1, 2, 1)
> plt.plot(y)
> plt.title('S√©rie Temporal Original $y_t$ (ARIMA(1,1,1))')
>
> plt.subplot(1, 2, 2)
> plt.plot(dy)
> plt.title('Primeira Diferen√ßa $\Delta y_t$ (ARMA(1,1))')
>
> plt.tight_layout()
> plt.show()
> ```
>  O gr√°fico mostra que a s√©rie original $y_t$ apresenta comportamento n√£o estacion√°rio, enquanto a s√©rie diferenciada $\Delta y_t$ parece ser estacion√°ria.
>  O valor de $\phi = 0.7$ significa que o valor atual da s√©rie depende positivamente do seu valor anterior, enquanto $\theta=0.4$ indica que o erro corrente tamb√©m influencia o valor presente, de modo que o erro do passo anterior tem uma pequena influ√™ncia sobre o valor da s√©rie atual.

A ordem de integra√ß√£o $d$ indica o n√∫mero de vezes que a s√©rie precisa ser diferenciada para que se torne um processo estacion√°rio. Um processo com $d = 0$ √© um processo estacion√°rio, o que implica que um modelo ARIMA(p, 0, q) √© equivalente a um modelo ARMA(p, q).  Um processo $I(1)$ √© tal que a sua primeira diferen√ßa resulta em um processo estacion√°rio, um processo $I(2)$ necessita de duas diferencia√ß√µes para se tornar estacion√°rio, e assim por diante.

Ap√≥s a aplica√ß√£o da diferencia√ß√£o de ordem $d$ em um processo ARIMA(p, d, q), o resultado √© um processo ARMA(p, q) estacion√°rio. Isso significa que, ao diferenciar a s√©rie original, a componente de n√£o estacionariedade √© removida, e a s√©rie resultante pode ser modelada usando as propriedades bem definidas de s√©ries temporais estacion√°rias. Este √© um aspecto fundamental da metodologia de modelagem ARIMA: a transforma√ß√£o da s√©rie n√£o estacion√°ria em uma s√©rie estacion√°ria atrav√©s da diferencia√ß√£o.

> üí° **Exemplo Num√©rico:** Considere um modelo ARIMA(2, 2, 1). Aplicando o operador de segunda diferen√ßa, obtemos um modelo ARMA(2, 1).
>
> $$ (1-L)^2 y_t = \frac{1 + \theta L}{1 - \phi_1 L - \phi_2 L^2} \epsilon_t $$
>
> A s√©rie original $y_t$ necessita de duas diferencia√ß√µes para se tornar estacion√°ria.
> Se  $\phi_1 = 0.5, \phi_2=0.2$ e $\theta = 0.6$ a s√©rie diferenciada segue o modelo ARMA:
>
> $$ \Delta^2 y_t = \frac{1 + 0.6 L}{1 - 0.5 L - 0.2 L^2} \epsilon_t $$
>
> onde $\Delta^2 y_t = y_t - 2y_{t-1} + y_{t-2}$. A s√©rie resultante $\Delta^2 y_t$ √© estacion√°ria e segue um modelo ARMA(2,1).
>  A interpreta√ß√£o dos coeficientes √©: $\phi_1=0.5$ significa que o valor atual da s√©rie diferenciada depende positivamente do valor anterior, $\phi_2=0.2$ significa que o valor atual da s√©rie tamb√©m depende do valor de duas etapas atr√°s, e $\theta=0.6$ implica que o erro corrente depende do erro do per√≠odo passado.

O modelo ARIMA √© uma ferramenta vers√°til e amplamente utilizada na an√°lise de s√©ries temporais, especialmente quando h√° evid√™ncias de n√£o estacionariedade. Ao separar a componente de n√£o estacionariedade da s√©rie original atrav√©s da diferencia√ß√£o, o modelador pode aplicar as ferramentas de an√°lise de s√©ries estacion√°rias √† componente estacion√°ria restante, simplificando o processo de modelagem.

**Defini√ß√£o 1:** Um processo Autoregressivo Integrado de M√©dias M√≥veis (ARIMA) de ordem (p, d, q), denotado por ARIMA(p, d, q), √© definido como:
$$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
onde:
- $y_t$ √© a s√©rie temporal original.
- $(1-L)^d$ √© o operador de diferen√ßa de ordem $d$.
- $\Phi(L) = 1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p$ √© o polin√¥mio autoregressivo de ordem $p$.
- $\Theta(L) = 1 + \theta_1 L + \theta_2 L^2 + \ldots + \theta_q L^q$ √© o polin√¥mio de m√©dias m√≥veis de ordem $q$.
- $\epsilon_t$ √© o ru√≠do branco.

**Defini√ß√£o 2:** Um processo Autoregressivo de M√©dias M√≥veis (ARMA) de ordem (p, q), denotado por ARMA(p, q), √© definido como:
$$ y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
onde:
- $y_t$ √© a s√©rie temporal.
- $\Phi(L) = 1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p$ √© o polin√¥mio autoregressivo de ordem $p$.
- $\Theta(L) = 1 + \theta_1 L + \theta_2 L^2 + \ldots + \theta_q L^q$ √© o polin√¥mio de m√©dias m√≥veis de ordem $q$.
- $\epsilon_t$ √© o ru√≠do branco.

**Proposi√ß√£o 1:** (Rela√ß√£o entre ARIMA e ARMA). Ao aplicar a diferen√ßa de ordem $d$ a um processo ARIMA(p, d, q), o resultado √© um processo ARMA(p, q) estacion√°rio.
*Proof:*
I. Considere um processo ARIMA(p, d, q) dado por:
   $$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
II. Seja $w_t = (1-L)^d y_t$. Substituindo na equa√ß√£o anterior, temos:
    $$ w_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
III. Por defini√ß√£o, a equa√ß√£o acima representa um processo ARMA(p, q) estacion√°rio.
IV. Portanto, a aplica√ß√£o da diferen√ßa de ordem $d$ a um processo ARIMA(p, d, q) resulta em um processo ARMA(p, q) estacion√°rio.
‚ñ†

**Teorema 1:** A d-√©sima diferen√ßa de um processo ARIMA(p, d, q) √© um processo ARMA(p, q) estacion√°rio.
*Proof:*
I. Um processo ARIMA(p, d, q) √© definido por:
     $$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
II. Seja $w_t = (1-L)^d y_t$. Ent√£o a equa√ß√£o acima pode ser reescrita como:
      $$ w_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
III. A equa√ß√£o acima representa a forma de um processo ARMA(p, q) estacion√°rio.
IV.  Portanto, a d-√©sima diferen√ßa de um processo ARIMA(p, d, q) √© um processo ARMA(p, q) estacion√°rio.
‚ñ†

> üí° **Exemplo Num√©rico:** Considere um processo ARIMA(0, 2, 2):
>   $$ (1-L)^2 y_t = (1 + \theta_1 L + \theta_2 L^2) \epsilon_t $$
>   Aplicando a segunda diferen√ßa, obtemos:
>   $$ \Delta^2 y_t = (1 + \theta_1 L + \theta_2 L^2) \epsilon_t $$
>   A s√©rie resultante $\Delta^2 y_t$ segue um processo MA(2), que √© um caso particular de um ARMA(0,2), o qual √© um processo estacion√°rio.
>   Se  $\theta_1=0.4$ e $\theta_2=0.2$ isso significa que o erro corrente depende do erro do per√≠odo passado em $0.4$ e do erro de duas etapas atr√°s em $0.2$.

**Teorema 1.1:** Um processo ARIMA(p, 0, q) √© equivalente a um processo ARMA(p, q).
*Proof:*
I. Um processo ARIMA(p, d, q) √© definido por $(1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t$.
II. Quando $d=0$, o operador de diferen√ßa se torna $(1-L)^0 = 1$.
III. Portanto, o processo ARIMA(p, 0, q) se torna $y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t$, que √© a defini√ß√£o de um processo ARMA(p, q).
IV. Logo, um processo ARIMA(p, 0, q) √© equivalente a um processo ARMA(p, q).
‚ñ†

**Lema 1:** Se $y_t$ segue um processo ARIMA(p, d, q), ent√£o $(1-L)^d y_t$ √© um processo ARMA(p, q) estacion√°rio.
*Proof:*
I. A defini√ß√£o de um processo ARIMA(p, d, q) √© que:
    $$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
II. A express√£o √† direita da igualdade representa a forma de um processo ARMA(p, q) estacion√°rio.
III. Portanto, ao aplicar o operador $(1-L)^d$ a um processo ARIMA(p, d, q), obtemos um processo ARMA(p, q) estacion√°rio.
‚ñ†

**Corol√°rio 1:** Um processo ARIMA(p, 1, q) diferenciado uma vez, $(1-L)y_t$, √© um processo ARMA(p, q).
*Proof:*
I.  Pela defini√ß√£o, se $y_t$ segue um processo ARIMA(p, 1, q), ent√£o $(1-L)y_t$ √© um processo estacion√°rio.
II. Pelo Lema 1, $(1-L)y_t$ √© um processo ARMA(p,q).
III. Portanto, um processo ARIMA(p, 1, q) diferenciado uma vez resulta em um processo ARMA(p, q).
‚ñ†

**Corol√°rio 2:** Um processo ARIMA(p, 2, q) diferenciado duas vezes, $(1-L)^2y_t$, √© um processo ARMA(p, q).
*Proof:*
I.  Pela defini√ß√£o, se $y_t$ segue um processo ARIMA(p, 2, q), ent√£o $(1-L)^2y_t$ √© um processo estacion√°rio.
II. Pelo Lema 1, $(1-L)^2y_t$ √© um processo ARMA(p,q).
III. Portanto, um processo ARIMA(p, 2, q) diferenciado duas vezes resulta em um processo ARMA(p, q).
‚ñ†

**Corol√°rio 3:** Se $y_t$ √© uma s√©rie temporal integrada de ordem $d$, ent√£o $(1-L)^d y_t$ √© um processo estacion√°rio.
*Proof:*
I.  Pela defini√ß√£o, uma s√©rie temporal integrada de ordem $d$ √© tal que  $(1-L)^d y_t$ √© estacion√°ria.
II. Portanto, se $y_t$ √© integrada de ordem $d$, ent√£o  $(1-L)^d y_t$ √© um processo estacion√°rio.
‚ñ†

**Observa√ß√£o 1:** A escolha adequada da ordem de integra√ß√£o $d$ √© crucial para a modelagem ARIMA. Se $d$ for subestimado, a s√©rie resultante ainda pode apresentar n√£o estacionariedade. Se $d$ for superestimado, o modelo pode se tornar excessivamente complexo e apresentar vari√¢ncia inflacionada nas previs√µes, sendo recomendado o uso de testes como o de Dickey-Fuller Aumentado (ADF) para determinar a ordem de integra√ß√£o apropriada.
> üí° **Exemplo Num√©rico:** Para uma s√©rie temporal de pre√ßos de a√ß√µes, um teste ADF pode indicar que a s√©rie original √© n√£o estacion√°ria (p-valor > 0.05), mas sua primeira diferen√ßa √© estacion√°ria (p-valor < 0.05). Isso sugere que d=1 √© a ordem de integra√ß√£o apropriada para modelar essa s√©rie usando um modelo ARIMA.

**Teorema 2:** (Propriedades da Diferencia√ß√£o). A diferencia√ß√£o, como definida pelo operador $(1-L)$, √© uma transforma√ß√£o linear.
*Proof:*
I. Sejam $y_t$ e $x_t$ duas s√©ries temporais e $a$ e $b$ duas constantes.
II. A diferencia√ß√£o de uma combina√ß√£o linear de s√©ries temporais √© dada por:
    $$ (1-L)(ay_t + bx_t) = (ay_t + bx_t) - (ay_{t-1} + bx_{t-1}) $$
III.  Reorganizando os termos, temos:
$$  = a(y_t - y_{t-1}) + b(x_t - x_{t-1}) $$
IV.  Isso pode ser reescrito como:
$$ = a(1-L)y_t + b(1-L)x_t $$
V. Portanto, o operador de diferencia√ß√£o $(1-L)$ satisfaz a propriedade de linearidade.
‚ñ†

**Teorema 2.1:** A diferencia√ß√£o de ordem *d*, denotada por $(1-L)^d$, tamb√©m √© uma transforma√ß√£o linear.
*Proof:*
I. O operador de diferen√ßa de ordem d pode ser expresso como $(1-L)^d = (1-L)(1-L)^{d-1}$.
II.  Pelo Teorema 2, sabemos que $(1-L)$ √© uma transforma√ß√£o linear.
III.  Aplicando o princ√≠pio da indu√ß√£o, se $(1-L)^{d-1}$ tamb√©m √© uma transforma√ß√£o linear, ent√£o $(1-L)^d$ ser√° linear como a composi√ß√£o de dois operadores lineares.
IV. Para o caso base, $(1-L)^1$ √© linear.
V. Logo, por indu√ß√£o, $(1-L)^d$ √© uma transforma√ß√£o linear para todo $d \ge 1$.
‚ñ†

**Lema 2:** Se $y_t$ √© um processo com m√©dia n√£o nula $\mu$, ent√£o $(1-L)y_t$ tem m√©dia zero, ou seja, o operador de diferen√ßa remove a m√©dia n√£o nula de uma s√©rie.
*Proof:*
I. Seja $y_t = \mu + \epsilon_t$, onde $\mu$ √© uma constante e $\epsilon_t$ √© um processo estacion√°rio com m√©dia zero.
II. Aplicando o operador de diferen√ßa, temos:
$$ (1-L)y_t = (\mu + \epsilon_t) - (\mu + \epsilon_{t-1}) = \epsilon_t - \epsilon_{t-1} $$
III. Calculando a esperan√ßa da s√©rie diferenciada, temos:
$$ E[(1-L)y_t] = E[\epsilon_t - \epsilon_{t-1}] = E[\epsilon_t] - E[\epsilon_{t-1}] = 0 - 0 = 0 $$
IV. Portanto, o operador de diferen√ßa $(1-L)$ remove a m√©dia n√£o nula de uma s√©rie.
‚ñ†
> üí° **Exemplo Num√©rico:** Se uma s√©rie temporal tem um n√≠vel m√©dio constante de 10, aplicar o operador de diferen√ßa de primeira ordem remover√° essa m√©dia, centrando os dados em torno de zero.

### Conclus√£o
Em resumo, um processo ARIMA(p, d, q) representa uma classe geral de modelos para s√©ries temporais que podem acomodar n√£o estacionariedade atrav√©s da integra√ß√£o e componentes autoregressivos e de m√©dias m√≥veis. A ordem de integra√ß√£o *d* especifica quantas vezes a s√©rie deve ser diferenciada para que o resultado seja estacion√°rio, transformando o modelo ARIMA em um processo ARMA estacion√°rio. Ao aplicar o operador de diferencia√ß√£o $(1-L)^d$, a n√£o estacionariedade da s√©rie original √© eliminada, e o resultado √© uma s√©rie que pode ser modelada por um ARMA(p, q), facilitando a an√°lise e a previs√£o. Os modelos ARIMA s√£o uma ferramenta essencial no arsenal de modeladores de s√©ries temporais, oferecendo uma abordagem flex√≠vel e robusta para lidar com dados n√£o estacion√°rios. O conhecimento da rela√ß√£o entre ARIMA, ARMA e a opera√ß√£o de diferencia√ß√£o √© fundamental para a aplica√ß√£o de modelos de s√©ries temporais.

### Refer√™ncias
[^1]: Cap√≠tulo 15 do texto.
[^Prev1]: T√≥pico anterior sobre transforma√ß√µes logar√≠tmicas e modelos de raiz unit√°ria.
[^Prev2]: T√≥pico anterior sobre a integra√ß√£o de s√©ries temporais e a analogia com o c√°lculo.
[^Prev4]: T√≥pico anterior sobre transforma√ß√£o de processos ARIMA em ARMA atrav√©s da diferencia√ß√£o.
[^Prev5]: T√≥pico anterior sobre processos com raiz unit√°ria e integra√ß√£o de ordem 1.
<!-- END -->
