## Integra√ß√£o de S√©ries Temporais e a Analogia com o C√°lculo

### Introdu√ß√£o
Este cap√≠tulo aborda modelos para s√©ries temporais n√£o estacion√°rias, explorando as caracter√≠sticas din√¢micas de modelos com raiz unit√°ria e tend√™ncia determin√≠stica [^1]. Discutimos anteriormente como s√©ries temporais com tend√™ncias exponenciais podem ser mais adequadamente modeladas ap√≥s uma transforma√ß√£o logar√≠tmica [^Prev], e agora, focaremos no conceito de integra√ß√£o de ordem *$d$*, que oferece uma perspectiva complementar para entender a n√£o estacionariedade. Em particular, vamos nos aprofundar na analogia entre a integra√ß√£o em s√©ries temporais e a integra√ß√£o em c√°lculo, um conceito que foi mencionado brevemente na se√ß√£o 15.1 [^1]. Esta analogia fornece uma base intuitiva para entender como a n√£o estacionariedade surge em s√©ries temporais.

### Conceitos Fundamentais
Como previamente discutido [^1], uma s√©rie temporal √© considerada **n√£o estacion√°ria** se suas propriedades estat√≠sticas, como m√©dia e vari√¢ncia, variam com o tempo. As s√©ries n√£o estacion√°rias podem apresentar tend√™ncias, mudan√ßas de n√≠vel ou comportamento err√°tico, tornando a modelagem mais complexa. Para lidar com a n√£o estacionariedade, duas abordagens principais s√£o empregadas: modelos com tend√™ncia determin√≠stica e modelos com raiz unit√°ria.

Os modelos com **tend√™ncia determin√≠stica** (trend-stationary) modelam a n√£o estacionariedade por meio de uma tend√™ncia linear no tempo, onde a s√©rie oscila em torno dessa tend√™ncia:
$$ y_t = \alpha + \delta t + \psi(L)\epsilon_t $$
onde $\alpha$ √© o intercepto, $\delta$ √© a inclina√ß√£o da tend√™ncia linear e $\psi(L)\epsilon_t$ representa um processo estacion√°rio. A n√£o estacionariedade √© capturada pela componente $\delta t$.

Por outro lado, os modelos de **raiz unit√°ria** modelam a n√£o estacionariedade como uma propriedade inerente do processo. Um exemplo √© o processo de passeio aleat√≥rio com deriva:
$$ (1-L)y_t = \delta + \psi(L)\epsilon_t $$
onde $(1-L)$ √© o operador de primeira diferen√ßa, $\delta$ √© a deriva, e $\psi(L)\epsilon_t$ √© um processo estacion√°rio. A n√£o estacionariedade √© capturada pela presen√ßa do operador $(1-L)$.

A se√ß√£o 15.1 [^1] introduziu o conceito de **integra√ß√£o de ordem *$d$***, denotado por $y_t \sim I(d)$. Essa nota√ß√£o indica que a s√©rie temporal $y_t$ precisa ser diferenciada *$d$* vezes para se tornar estacion√°ria. A analogia com o c√°lculo √© direta: se, no c√°lculo, a derivada de uma fun√ß√£o $y(t)$ em rela√ß√£o a $t$ √© $dy/dt = x(t)$, ent√£o $y(t)$ √© a integral de $x(t)$. De forma an√°loga, em s√©ries temporais discretas, se a diferen√ßa de $y_t$ √© $\Delta y_t = y_t - y_{t-1} = x_t$, ent√£o $y_t$ √© a integral (ou soma) de $x_t$.

> üí° **Exemplo Num√©rico:** Considere a rela√ß√£o de taxas de varia√ß√£o. No c√°lculo, a integral de uma velocidade (taxa de varia√ß√£o) produz a posi√ß√£o. Em s√©ries temporais, a soma acumulada de varia√ß√µes resulta na s√©rie original. Por exemplo, se tivermos uma s√©rie temporal de varia√ß√µes de temperatura di√°rias $x_t$ (em graus Celsius), a s√©rie temporal da temperatura acumulada $y_t$ pode ser vista como a integral da s√©rie de varia√ß√µes. Se em tr√™s dias consecutivos as varia√ß√µes foram +2, +1 e -0.5, a temperatura acumulada em $t=3$ seria $y_3 = 2 + 1 - 0.5 = 2.5$.

No contexto de s√©ries temporais, a opera√ß√£o de integra√ß√£o implica acumular os valores de um processo. Matematicamente, podemos expressar a rela√ß√£o entre uma s√©rie temporal e sua vers√£o integrada como:
$$ y_t = \sum_{i=0}^{t} x_i $$
onde $y_t$ √© a s√©rie temporal integrada e $x_i$ s√£o os componentes que foram acumulados. Essa express√£o sugere que uma s√©rie temporal $y_t \sim I(1)$ pode ser entendida como a soma cumulativa de um processo estacion√°rio $x_t$.

> üí° **Exemplo Num√©rico:** Imagine que $x_t$ represente as varia√ß√µes di√°rias do pre√ßo de uma a√ß√£o. A s√©rie $y_t$ √© a s√©rie de pre√ßos da a√ß√£o, que √© a integral (soma) das varia√ß√µes. A s√©rie de pre√ßos da a√ß√£o n√£o √© estacion√°ria, j√° que segue um caminho aleat√≥rio e n√£o retorna a uma m√©dia fixa. Se a s√©rie de varia√ß√µes di√°rias $x_t$ em cinco dias foram 0.1, -0.2, 0.05, 0.15 e -0.05 respectivamente e assumirmos que o pre√ßo inicial era $y_0 = 10$, ent√£o os pre√ßos acumulados $y_t$ seriam $y_1 = 10 + 0.1 = 10.1$, $y_2 = 10.1 - 0.2 = 9.9$, $y_3 = 9.9 + 0.05 = 9.95$, $y_4 = 9.95 + 0.15 = 10.1$, e $y_5 = 10.1 - 0.05 = 10.05$.

A ideia central √© que um processo com **integra√ß√£o de ordem 1**, $y_t \sim I(1)$, √© aquele que, quando diferenciado uma vez, se torna estacion√°rio. O operador de primeira diferen√ßa √© definido como $\Delta y_t = (1 - L)y_t = y_t - y_{t-1}$. Portanto, se $y_t$ √© integrado de ordem 1, ent√£o $\Delta y_t$ √© estacion√°rio. Similarmente, um processo com **integra√ß√£o de ordem 2**, $y_t \sim I(2)$, precisa ser diferenciado duas vezes para se tornar estacion√°rio, e assim por diante.

No contexto de modelos com raiz unit√°ria, um processo $y_t$ que segue o modelo $(1-L)y_t = \delta + \psi(L)\epsilon_t$ √© um processo $I(1)$. Ou seja, a primeira diferen√ßa $\Delta y_t$ √© estacion√°ria. Se, ao inv√©s disso, a s√©rie seguisse o modelo $(1-L)^2 y_t = \kappa + \psi(L)\epsilon_t$, ent√£o ela seria um processo $I(2)$. Em geral, um processo √© considerado $I(d)$ se $(1-L)^d y_t$ √© estacion√°rio.

> üí° **Exemplo Num√©rico:** Considere a s√©rie $y_t$ gerada por um passeio aleat√≥rio com deriva: $y_t = y_{t-1} + \delta + \epsilon_t$, onde $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$.
>  I. Aplicando o operador de primeira diferen√ßa, obtemos:
>  $$ \Delta y_t = y_t - y_{t-1} = \delta + \epsilon_t $$
>  II. A s√©rie $\Delta y_t$ √© estacion√°ria, pois sua m√©dia √© $\delta$ e sua vari√¢ncia √© $\sigma^2$, ambos constantes no tempo. Por exemplo, se $\delta = 0.2$ e $\epsilon_t$ segue uma distribui√ß√£o normal com m√©dia 0 e desvio padr√£o 0.1, ent√£o $\Delta y_t$ ter√° m√©dia 0.2 e vari√¢ncia 0.01.
>  III. Portanto, a s√©rie $y_t$ √© integrada de ordem 1, ou seja, $y_t \sim I(1)$.

Essa rela√ß√£o entre a diferencia√ß√£o em s√©ries temporais e a integra√ß√£o no c√°lculo √© crucial para entender as propriedades dos processos n√£o estacion√°rios. A diferencia√ß√£o em s√©ries temporais corresponde √† opera√ß√£o inversa da integra√ß√£o.

**Lema 1:** Se uma s√©rie temporal $y_t$ √© $I(d)$, ent√£o $(1-L)^d y_t$ √© estacion√°ria.
*Proof:* A defini√ß√£o de um processo $I(d)$ √© que a s√©rie temporal $y_t$ precisa ser diferenciada $d$ vezes para se tornar estacion√°ria. O operador de primeira diferen√ßa √© $(1-L)$, e a aplica√ß√£o deste operador *$d$* vezes √© dada por $(1-L)^d$. Portanto, se $y_t$ √© $I(d)$, ent√£o $(1-L)^d y_t$ √© estacion√°rio.
‚ñ†

**Proposi√ß√£o 1:** (Rela√ß√£o entre Diferencia√ß√£o e Integra√ß√£o). Se $\Delta y_t = x_t$, onde $x_t$ √© uma s√©rie estacion√°ria, ent√£o $y_t$ √© uma s√©rie integrada de ordem 1, ou seja, $y_t \sim I(1)$, e pode ser vista como a soma ou integral de $x_t$.
*Proof:*
I. Come√ßando pela defini√ß√£o de diferen√ßa: $\Delta y_t = y_t - y_{t-1} = x_t$.
II. Rearranjando, obtemos: $y_t = y_{t-1} + x_t$.
III. Aplicando recursivamente, temos:
    $$ y_t = y_{t-1} + x_t = (y_{t-2} + x_{t-1}) + x_t = y_{t-2} + x_{t-1} + x_t $$
    $$ y_t = y_{t-3} + x_{t-2} + x_{t-1} + x_t $$
IV. Generalizando para um tempo inicial $t_0$, temos:
    $$ y_t = y_{t_0} + \sum_{i=t_0+1}^t x_i $$
V. Se $t_0$ √© uma constante, ent√£o a express√£o acima pode ser interpretada como uma constante ($y_{t_0}$) mais a soma cumulativa da s√©rie $x_t$. Esta √© a analogia de integra√ß√£o, onde $y_t$ √© a integral de $x_t$.
VI. Dado que $x_t$ √© estacion√°rio, ent√£o a s√©rie $y_t$ √© integrada de ordem 1, $y_t \sim I(1)$.
‚ñ†

> üí° **Exemplo Num√©rico:**
> Suponha $x_t = \epsilon_t$ onde $\epsilon_t$ √© ru√≠do branco. Por exemplo, assuma que $\epsilon_t$ √© uma sequ√™ncia de n√∫meros aleat√≥rios normalmente distribu√≠dos com m√©dia zero e desvio padr√£o 1.
>  I. Se $\Delta y_t = x_t = \epsilon_t$, ent√£o $y_t$ √© $I(1)$.
> II. Substituindo na forma recursiva da prova, temos $y_t = y_{t_0} + \sum_{i=t_0+1}^{t} \epsilon_i$ que representa um processo de passeio aleat√≥rio. Se $y_0 = 0$ e as primeiras cinco realiza√ß√µes de $\epsilon_t$ s√£o 0.5, -1, 0.2, 0.8, e -0.3, ent√£o $y_1 = 0 + 0.5 = 0.5$, $y_2 = 0.5 - 1 = -0.5$, $y_3 = -0.5 + 0.2 = -0.3$, $y_4 = -0.3 + 0.8 = 0.5$, e $y_5 = 0.5 - 0.3 = 0.2$. A s√©rie $y_t$ √© um passeio aleat√≥rio n√£o estacion√°rio.

**Teorema 1:** (Propriedade da Diferencia√ß√£o). Se $y_t$ √© um processo $I(d)$, ent√£o $(1-L)^k y_t$ √© um processo $I(d-k)$, para $k \leq d$.
*Proof:*
I. Se $y_t$ √© um processo $I(d)$, ent√£o, por defini√ß√£o, $(1-L)^d y_t$ √© estacion√°rio.
II. Aplicando o operador de primeira diferen√ßa $(1-L)$ a um processo $I(d)$ reduz a ordem de integra√ß√£o em 1. Portanto $(1-L)y_t$ √© um processo $I(d-1)$.
III. Aplicando o operador de primeira diferen√ßa $k$ vezes a um processo $I(d)$ resulta em $(1-L)^k y_t$ que √© um processo $I(d-k)$.
IV. Logo, se $y_t \sim I(d)$, ent√£o $(1-L)^k y_t \sim I(d-k)$.
‚ñ†

> üí° **Exemplo Num√©rico:**
> Suponha $y_t$ segue um processo $I(2)$, ou seja, $(1-L)^2y_t = \epsilon_t$, onde $\epsilon_t$ √© um ru√≠do branco. Podemos pensar em $y_t$ como a posi√ß√£o de um objeto, onde $\epsilon_t$ √© a acelera√ß√£o aleat√≥ria.
> I. Se aplicamos o operador de primeira diferen√ßa uma vez, temos $(1-L)y_t$.
> II. Sabemos que $(1-L)y_t$ √© $I(1)$, pois precisamos aplicar $(1-L)$ mais uma vez para chegar em $\epsilon_t$, que √© estacion√°rio. Se a s√©rie original $y_t$ representa a posi√ß√£o, $(1-L)y_t$ representa a velocidade e $(1-L)^2y_t$ representa a acelera√ß√£o.
> III. Ou seja, se $y_t \sim I(2)$, ent√£o $(1-L)y_t \sim I(1)$.

**Teorema 1.1:** (Propriedade da Soma de Processos Integrados). Se $y_t \sim I(d_1)$ e $z_t \sim I(d_2)$, ent√£o $w_t = y_t + z_t$ √© $I(\max(d_1, d_2))$.
*Proof:*
I. Seja $d = \max(d_1, d_2)$.
II. Se $y_t \sim I(d_1)$, ent√£o $(1-L)^{d_1} y_t$ √© estacion√°rio.
III. Se $z_t \sim I(d_2)$, ent√£o $(1-L)^{d_2} z_t$ √© estacion√°rio.
IV. Se $d_1 \leq d$, ent√£o $(1-L)^d y_t$ √© estacion√°rio (pelo Teorema 1).
V. Se $d_2 \leq d$, ent√£o $(1-L)^d z_t$ √© estacion√°rio (pelo Teorema 1).
VI. Portanto, $(1-L)^d (y_t + z_t) = (1-L)^d y_t + (1-L)^d z_t$ √© a soma de dois processos estacion√°rios, o que tamb√©m √© estacion√°rio.
VII. Isso implica que $w_t = y_t + z_t$ √© $I(d)$, ou seja, $w_t \sim I(\max(d_1, d_2))$.
‚ñ†

> üí° **Exemplo Num√©rico:**
> Considere um processo $y_t$ que √© $I(1)$, por exemplo, um pre√ßo de uma a√ß√£o, e um processo $z_t$ que tamb√©m √© $I(1)$, por exemplo, o pre√ßo de um produto diferente, ambos apresentando um comportamento de passeio aleat√≥rio. Sua soma $w_t = y_t + z_t$ √© um processo $I(1)$, j√° que $\max(1,1) = 1$. Agora, se $y_t$ √© $I(1)$ e $z_t$ √© $I(2)$, como por exemplo, uma s√©rie de posi√ß√µes de um objeto cuja acelera√ß√£o √© um ru√≠do branco, ent√£o $w_t$ √© $I(2)$ j√° que $\max(1, 2) = 2$.

**Lema 2:** Se $y_t$ √© uma s√©rie temporal $I(d)$, ent√£o $c y_t$ √© tamb√©m uma s√©rie temporal $I(d)$, onde $c$ √© uma constante n√£o nula.
*Proof:*
I. Se $y_t$ √© $I(d)$, ent√£o $(1-L)^d y_t$ √© estacion√°ria.
II. Multiplicando por uma constante $c$, temos $c (1-L)^d y_t = (1-L)^d (c y_t)$.
III. Como a multiplica√ß√£o de um processo estacion√°rio por uma constante resulta em um processo estacion√°rio, $(1-L)^d (c y_t)$ √© estacion√°rio.
IV. Portanto, $c y_t$ √© uma s√©rie temporal $I(d)$.
‚ñ†

### Conclus√£o
O conceito de integra√ß√£o em s√©ries temporais, denotado por $y_t \sim I(d)$, √© uma analogia direta com o processo de integra√ß√£o em c√°lculo. A ideia central √© que uma s√©rie temporal $I(d)$ precisa ser diferenciada *$d$* vezes para se tornar estacion√°ria, refletindo que a s√©rie pode ser vista como a soma cumulativa (ou integral) de um processo estacion√°rio. Essa perspectiva √© crucial para entender como a n√£o estacionariedade surge e como model√°-la adequadamente. A diferencia√ß√£o, por sua vez, √© a opera√ß√£o inversa da integra√ß√£o, reduzindo a ordem da n√£o estacionariedade. A compreens√£o dessa analogia e das propriedades dos processos integrados √© fundamental para o desenvolvimento de modelos robustos e precisos para s√©ries temporais n√£o estacion√°rias. Este conceito fornece uma base s√≥lida para an√°lises posteriores sobre testes de raiz unit√°ria e outras abordagens para modelar n√£o estacionariedade em s√©ries temporais [^1].

### Refer√™ncias
[^1]: Cap√≠tulo 15 do texto.
[^Prev]: T√≥pico anterior sobre transforma√ß√µes logar√≠tmicas e modelos de raiz unit√°ria.
<!-- END -->
