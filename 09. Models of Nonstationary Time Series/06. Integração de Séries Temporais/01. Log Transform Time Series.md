## Transforma√ß√µes Logar√≠tmicas e Modelos de Raiz Unit√°ria

### Introdu√ß√£o
Este cap√≠tulo explora modelos de s√©ries temporais n√£o estacion√°rias, contrastando abordagens de tend√™ncia determin√≠stica e processos de raiz unit√°ria. Foi estabelecido que a n√£o estacionariedade pode ser modelada pela inclus√£o de uma tend√™ncia temporal determin√≠stica ou atrav√©s de um processo de raiz unit√°ria. Em particular, a se√ß√£o 15.2 introduz a ideia de que as s√©ries temporais econ√¥micas, como o Produto Nacional Bruto (PNB), podem exibir tend√™ncias exponenciais que podem ser mais bem modeladas atrav√©s de transforma√ß√µes logar√≠tmicas antes da aplica√ß√£o de modelos de raiz unit√°ria. O presente t√≥pico se aprofunda na raz√£o pela qual as transforma√ß√µes logar√≠tmicas s√£o especialmente √∫teis neste contexto, focando na aproxima√ß√£o da varia√ß√£o percentual que elas proporcionam.

### Conceitos Fundamentais
Como previamente discutido, um processo estacion√°rio possui m√©dia e vari√¢ncia constantes ao longo do tempo. No entanto, muitas s√©ries temporais econ√¥micas e financeiras exibem comportamento n√£o estacion√°rio, como tend√™ncias de crescimento ou variabilidade crescente. Para modelar essas s√©ries, duas abordagens populares foram introduzidas: a tend√™ncia determin√≠stica (trend-stationary) e o processo de raiz unit√°ria.

A abordagem de **tend√™ncia determin√≠stica** adiciona uma fun√ß√£o linear do tempo √† m√©dia do processo estacion√°rio:
$$ y_t = \alpha + \delta t + \psi(L)\epsilon_t $$
onde $\alpha$ √© o intercepto, $\delta$ a inclina√ß√£o da tend√™ncia linear, e $\psi(L)\epsilon_t$ o componente estacion√°rio.

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal com uma tend√™ncia determin√≠stica: $y_t = 10 + 0.5t + \epsilon_t$, onde $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia 1. Aqui, $\alpha = 10$ e $\delta = 0.5$. Se observarmos os valores de $y_t$ ao longo do tempo, veremos que a m√©dia aumenta linearmente com o tempo, com uma taxa de 0.5 por per√≠odo.

A abordagem de **raiz unit√°ria**, por outro lado, modela a n√£o estacionariedade como parte inerente do processo. Um exemplo √© o processo de passeio aleat√≥rio com deriva (random walk with drift):
$$ (1-L)y_t = \delta + \psi(L)\epsilon_t $$
onde $(1-L)$ √© o operador de primeira diferen√ßa e $\delta$ representa a deriva.

> üí° **Exemplo Num√©rico:** Considere um passeio aleat√≥rio com deriva: $(1-L)y_t = 0.2 + \epsilon_t$. Isso significa que $y_t = y_{t-1} + 0.2 + \epsilon_t$. A cada per√≠odo, $y_t$ aumenta em m√©dia 0.2, al√©m de um choque aleat√≥rio $\epsilon_t$. A s√©rie n√£o possui uma m√©dia constante, caracterizando a n√£o estacionariedade.

A se√ß√£o 15.2 introduz a ideia de que s√©ries temporais econ√¥micas frequentemente exibem tend√™ncias exponenciais. Uma tend√™ncia exponencial √© caracterizada por crescimento proporcional constante, o que significa que a taxa de crescimento √© constante em termos percentuais. Se $y_t = e^{\delta t}$ ent√£o $\frac{dy}{dt} = \delta y_t$. Nesses casos, a transforma√ß√£o logar√≠tmica facilita a modelagem da tend√™ncia, pois ela transforma uma tend√™ncia exponencial em uma linear:
$$ \log(y_t) = \delta t $$

Essa transforma√ß√£o √© particularmente √∫til quando se modelam s√©ries temporais com modelos de raiz unit√°ria. Ao aplicar a transforma√ß√£o logar√≠tmica, estamos indiretamente trabalhando com a varia√ß√£o percentual da vari√°vel, o que geralmente estabiliza a vari√¢ncia e facilita a modelagem. A raz√£o para isso reside na aproxima√ß√£o:
$$(1 - L)\log(y_t) = \log(y_t) - \log(y_{t-1}) = \log\left(\frac{y_t}{y_{t-1}}\right) = \log\left(1 + \frac{y_t - y_{t-1}}{y_{t-1}}\right)$$
Para pequenas varia√ß√µes, quando $x$ √© pr√≥ximo de zero, $\log(1+x) \approx x$. Assim,
$$(1-L)\log(y_t) \approx \frac{y_t - y_{t-1}}{y_{t-1}}$$
Esta aproxima√ß√£o mostra que a primeira diferen√ßa do logaritmo de uma vari√°vel √© aproximadamente igual √† mudan√ßa percentual da vari√°vel. Isso significa que, ao aplicar o operador de primeira diferen√ßa ao logaritmo de uma s√©rie temporal, estamos trabalhando com uma aproxima√ß√£o da varia√ß√£o percentual, que pode ser uma representa√ß√£o mais estacion√°ria do que a s√©rie temporal original. Esta transforma√ß√£o √© √∫til para modelar s√©ries que exibem crescimento exponencial e para estabilizar a vari√¢ncia da s√©rie.

> üí° **Exemplo Num√©rico:** Vamos supor que o PNB de um pa√≠s cres√ßa exponencialmente. Em um per√≠odo, o PNB √© 100, e no per√≠odo seguinte √© 105. A varia√ß√£o percentual √© $\frac{105 - 100}{100} = 0.05$ ou 5%. Se aplicarmos a transforma√ß√£o logar√≠tmica e calcularmos a primeira diferen√ßa: $\log(105) - \log(100) \approx 0.0487$. Observe que esse valor se aproxima da varia√ß√£o percentual, especialmente quando a varia√ß√£o √© pequena.

Al√©m disso, a transforma√ß√£o logar√≠tmica pode mitigar problemas de n√£o-normalidade e heterocedasticidade que podem surgir em s√©ries temporais que apresentam crescimento exponencial. Ao estabilizar a vari√¢ncia, a transforma√ß√£o logar√≠tmica torna a s√©rie mais compat√≠vel com os pressupostos de muitos modelos estat√≠sticos, como aqueles pertencentes √† classe ARMA/ARIMA.
**Observa√ß√£o 1:** √â importante notar que a aproxima√ß√£o $\log(1+x) \approx x$ √© uma aproxima√ß√£o de primeira ordem da s√©rie de Taylor de $\log(1+x)$ em torno de $x=0$. Mais especificamente, a s√©rie de Taylor de $\log(1+x)$ √© dada por:
$$ \log(1+x) = \sum_{n=1}^{\infty} (-1)^{n-1} \frac{x^n}{n} = x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4} + \ldots $$
Para $x$ pr√≥ximo de zero, os termos de ordem superior ($x^2$, $x^3$, etc.) tornam-se negligenci√°veis, e a aproxima√ß√£o $\log(1+x) \approx x$ torna-se v√°lida. A precis√£o dessa aproxima√ß√£o depende do tamanho da varia√ß√£o percentual; quanto menor a varia√ß√£o, melhor a aproxima√ß√£o.

**Lema 1:** Seja $y_t$ uma s√©rie temporal positiva. A varia√ß√£o percentual de $y_t$ em rela√ß√£o a $y_{t-1}$ √© dada por $\frac{y_t - y_{t-1}}{y_{t-1}}$. A primeira diferen√ßa do logaritmo de $y_t$, ou seja, $(1-L)\log(y_t) = \log(y_t) - \log(y_{t-1})$, aproxima-se da varia√ß√£o percentual para pequenas varia√ß√µes.
*Proof:* Como visto anteriormente, $(1-L)\log(y_t) = \log\left(\frac{y_t}{y_{t-1}}\right) = \log\left(1 + \frac{y_t - y_{t-1}}{y_{t-1}}\right)$. Usando a aproxima√ß√£o $\log(1+x) \approx x$ para pequenas varia√ß√µes, onde $x = \frac{y_t - y_{t-1}}{y_{t-1}}$, temos $(1-L)\log(y_t) \approx \frac{y_t - y_{t-1}}{y_{t-1}}$.
‚ñ†

**Proposi√ß√£o 1:** Se uma s√©rie temporal $y_t$ segue uma tend√™ncia exponencial $y_t = Ae^{\delta t}$, onde $A$ √© uma constante e $\delta$ √© a taxa de crescimento, ent√£o a transforma√ß√£o logar√≠tmica, dada por $\log(y_t)$, transforma essa tend√™ncia exponencial em uma tend√™ncia linear.
*Proof:* 
I. Dado que $y_t = Ae^{\delta t}$, aplique o logaritmo natural em ambos os lados da equa√ß√£o:
    $$ \log(y_t) = \log(Ae^{\delta t}) $$
II. Use as propriedades do logaritmo para separar o produto:
    $$ \log(y_t) = \log(A) + \log(e^{\delta t}) $$
III. Use a propriedade de logaritmo de pot√™ncia:
    $$ \log(y_t) = \log(A) + \delta t \log(e) $$
IV. Como $\log(e) = 1$, simplifique a express√£o:
    $$ \log(y_t) = \log(A) + \delta t $$
V. Seja $\alpha = \log(A)$, que √© uma constante. Substitua $\alpha$ na equa√ß√£o:
    $$ \log(y_t) = \alpha + \delta t $$
VI. Essa √© uma equa√ß√£o linear em rela√ß√£o ao tempo $t$, onde $\alpha$ √© o intercepto e $\delta$ √© a inclina√ß√£o. Portanto, a transforma√ß√£o logar√≠tmica transforma a tend√™ncia exponencial em uma tend√™ncia linear.
‚ñ†

> üí° **Exemplo Num√©rico:** Suponha que $y_t = 2e^{0.1t}$. Aplicando o logaritmo, temos:
>  $\log(y_t) = \log(2e^{0.1t}) = \log(2) + 0.1t$.
>  Aqui, $\alpha = \log(2) \approx 0.693$ e $\delta = 0.1$. A tend√™ncia exponencial em $y_t$ se torna uma tend√™ncia linear em $\log(y_t)$.
>
> ```mermaid
> graph LR
>     A[S√©rie Original: y_t = 2e^(0.1t)] --> B(Transforma√ß√£o Logar√≠tmica);
>     B --> C[S√©rie Transformada: log(y_t) = 0.693 + 0.1t];
>     style C fill:#ccf,stroke:#333,stroke-width:2px
> ```

**Teorema 1:** (Estabiliza√ß√£o da Vari√¢ncia). A aplica√ß√£o da transforma√ß√£o logar√≠tmica a uma s√©rie temporal com crescimento exponencial pode resultar em uma s√©rie transformada com vari√¢ncia mais est√°vel.
*Proof Strategy:* Embora uma prova formal possa exigir suposi√ß√µes espec√≠ficas sobre a distribui√ß√£o dos erros, a intui√ß√£o √© que o crescimento exponencial em $y_t$ causa uma vari√¢ncia que tamb√©m aumenta ao longo do tempo. Ao trabalhar com a varia√ß√£o percentual, que √© aproximada por $(1-L)\log(y_t)$, a magnitude da varia√ß√£o √© expressa em termos relativos, mitigando a tend√™ncia de aumento da vari√¢ncia. Isso estabiliza a vari√¢ncia, tornando a s√©rie log-transformada mais adequada para modelos que assumem homocedasticidade. Uma prova formal exigiria suposi√ß√µes adicionais sobre os processos geradores de dados, mas a ideia √© que o logaritmo "comprime" os valores grandes e expande os pequenos, reduzindo a heterocedasticidade.

*Proof:*
I. Seja $y_t$ uma s√©rie temporal com crescimento exponencial. Isso significa que a varia√ß√£o em $y_t$ √© proporcional a $y_t$. Em outras palavras, as varia√ß√µes absolutas em $y_t$ aumentam √† medida que $y_t$ aumenta.
II. Pela defini√ß√£o da varia√ß√£o percentual, vemos que ela expressa a varia√ß√£o em $y_t$ em rela√ß√£o a seu n√≠vel atual, o que √©:
    $$ \frac{y_t - y_{t-1}}{y_{t-1}} $$
III. Mostramos anteriormente que:
    $$ (1-L)\log(y_t) \approx \frac{y_t - y_{t-1}}{y_{t-1}} $$
IV. Portanto, a primeira diferen√ßa do logaritmo de $y_t$ aproxima-se da varia√ß√£o percentual de $y_t$. Essa aproxima√ß√£o faz a variabilidade ser relativa ao n√≠vel de $y_t$ em vez de absoluta.
V. Devido a esse relacionamento, em vez de observar varia√ß√µes absolutas que crescem exponencialmente com o tempo, observamos varia√ß√µes percentuais, que s√£o aproximadamente constantes quando o crescimento √© exponencial.
VI. Ao estabilizar a vari√¢ncia, a s√©rie log-transformada torna-se mais apropriada para modelos que assumem vari√¢ncia constante (homocedasticidade), e problemas de heterocedasticidade podem ser mitigados.
‚ñ†

> üí° **Exemplo Num√©rico:** Suponha uma s√©rie temporal $y_t$ que cresce exponencialmente com vari√¢ncia crescente:
>
> | t   | $y_t$ | Varia√ß√£o Absoluta | Varia√ß√£o Percentual | $\log(y_t)$ | Primeira Diferen√ßa de $\log(y_t)$ |
> |-----|-------|-------------------|--------------------|-------------|-------------------------------|
> | 1   | 10    | -                 | -                  | 2.30        | -                              |
> | 2   | 12    | 2                 | 0.2                | 2.48        | 0.18                           |
> | 3   | 14.5  | 2.5               | 0.208               | 2.67        | 0.19                          |
> | 4   | 17.4  | 2.9               | 0.2                | 2.86        | 0.19                           |
> | 5   | 21    | 3.6               | 0.207              | 3.04        | 0.18                           |
>
> A varia√ß√£o absoluta aumenta, enquanto a varia√ß√£o percentual permanece relativamente constante. Observamos que a primeira diferen√ßa do logaritmo, que aproxima a varia√ß√£o percentual, tamb√©m se mant√©m mais est√°vel ao longo do tempo. Isso ilustra como a transforma√ß√£o logar√≠tmica ajuda a estabilizar a vari√¢ncia.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> t = np.arange(1, 6)
> y = np.array([10, 12, 14.5, 17.4, 21])
> log_y = np.log(y)
>
> plt.figure(figsize=(10, 5))
>
> plt.subplot(1, 2, 1)
> plt.plot(t, y, marker='o')
> plt.title('S√©rie Temporal Original')
> plt.xlabel('Tempo (t)')
> plt.ylabel('y_t')
>
> plt.subplot(1, 2, 2)
> plt.plot(t, log_y, marker='o')
> plt.title('S√©rie Temporal Log-Transformada')
> plt.xlabel('Tempo (t)')
> plt.ylabel('log(y_t)')
>
> plt.tight_layout()
> plt.show()
> ```
>
> Note que o gr√°fico da s√©rie original mostra um crescimento exponencial, enquanto o gr√°fico da s√©rie log-transformada aparenta ser linear.

### Conclus√£o
Em resumo, a aplica√ß√£o da transforma√ß√£o logar√≠tmica antes de modelar s√©ries temporais com modelos de raiz unit√°ria √© uma pr√°tica comum e bem fundamentada. Ela transforma tend√™ncias exponenciais em tend√™ncias lineares, o que simplifica a modelagem. Mais importante, a primeira diferen√ßa do logaritmo de uma vari√°vel aproxima a mudan√ßa percentual, resultando em uma s√©rie temporal que √© mais estacion√°ria em termos de m√©dia e vari√¢ncia, facilitando assim a aplica√ß√£o de modelos de raiz unit√°ria. Este procedimento ajuda a estabilizar a vari√¢ncia, mitigar problemas de n√£o-normalidade e tornar as s√©ries temporais mais apropriadas para os pressupostos dos modelos estat√≠sticos. A aplica√ß√£o da transforma√ß√£o logar√≠tmica representa uma ferramenta essencial na caixa de ferramentas do modelador de s√©ries temporais n√£o estacion√°rias, possibilitando uma an√°lise mais robusta e confi√°vel dos dados.

### Refer√™ncias
[^1]: Cap√≠tulo 15 do texto.
<!-- END -->
