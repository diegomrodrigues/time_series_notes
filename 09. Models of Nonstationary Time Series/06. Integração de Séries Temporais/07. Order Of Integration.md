## Processos Integrados de Ordem $d$: Uma Generaliza√ß√£o da N√£o Estacionariedade

### Introdu√ß√£o
Este cap√≠tulo avan√ßa em nossa discuss√£o sobre modelos de s√©ries temporais n√£o estacion√°rias, consolidando os conceitos de integra√ß√£o de ordem 1 (I(1)) e ordem 2 (I(2)), e generalizando-os para a integra√ß√£o de ordem $d$ (I($d$)) [^1]. Partindo da base te√≥rica estabelecida anteriormente sobre transforma√ß√µes logar√≠tmicas [^Prev1], a analogia entre integra√ß√£o em c√°lculo e s√©ries temporais [^Prev2], processos com raiz unit√°ria e integra√ß√£o de ordem 1 [^Prev5], a transforma√ß√£o de processos ARIMA em ARMA por diferencia√ß√£o [^Prev4] e a defini√ß√£o abrangente de modelos ARIMA(p, d, q) [^Prev6], este cap√≠tulo tem como objetivo formalizar a compreens√£o da integra√ß√£o de ordem $d$, demonstrando como a aplica√ß√£o da diferencia√ß√£o de ordem $d$ resulta em um processo estacion√°rio. O objetivo √© fornecer uma vis√£o consolidada da integra√ß√£o como um mecanismo para modelar diferentes graus de n√£o estacionariedade em s√©ries temporais.

### Conceitos Fundamentais
A n√£o estacionariedade, como discutido em detalhes nos cap√≠tulos anteriores, √© uma caracter√≠stica fundamental em muitas s√©ries temporais, exigindo abordagens espec√≠ficas para modelagem. As s√©ries n√£o estacion√°rias apresentam caracter√≠sticas estat√≠sticas (m√©dia, vari√¢ncia, autocorrela√ß√£o) que variam com o tempo. Para modelar tais s√©ries, as transforma√ß√µes lineares, como a diferencia√ß√£o, t√™m sido empregadas para tornar as s√©ries estacion√°rias.

Em cap√≠tulos anteriores [^Prev5], definimos que um processo de **raiz unit√°ria** pode ser expresso como:
$$(1-L)y_t = \delta + \psi(L)\epsilon_t$$
onde $(1-L)$ √© o operador de primeira diferen√ßa, $\delta$ √© a deriva, e $\psi(L)\epsilon_t$ √© um processo estacion√°rio. Este modelo implica que a primeira diferen√ßa da s√©rie temporal $y_t$ √© um processo estacion√°rio, e por conseguinte, a s√©rie original $y_t$ √© um processo **integrado de ordem 1**, denotado por $y_t \sim I(1)$. Isso significa que uma √∫nica aplica√ß√£o do operador de primeira diferen√ßa, $(1-L)$, transforma a s√©rie em estacion√°ria.

> üí° **Exemplo Num√©rico:** Suponha que temos uma s√©rie temporal $y_t$ que √© gerada como a soma cumulativa de um ru√≠do branco $\epsilon_t$. Matematicamente, podemos escrever $y_t = y_{t-1} + \epsilon_t$, ou equivalentemente, $(1-L)y_t = \epsilon_t$.  Neste caso, $y_t$ √© I(1), pois a primeira diferen√ßa $\Delta y_t = y_t - y_{t-1} = \epsilon_t$ √© um processo estacion√°rio (ru√≠do branco). Para simular esta situa√ß√£o em Python:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 100  # N√∫mero de pontos no tempo
>
> # Inicializa√ß√£o
> y = np.zeros(T)
> epsilon = np.random.normal(0, 1, T)  # Ru√≠do branco
>
> # Simula√ß√£o da s√©rie I(1)
> for t in range(1, T):
>    y[t] = y[t-1] + epsilon[t]
>
> # C√°lculo da primeira diferen√ßa
> dy = np.diff(y)
>
> # Plotagem das s√©ries
> plt.figure(figsize=(8, 6))
>
> plt.subplot(2, 1, 1)
> plt.plot(y)
> plt.title('S√©rie Temporal I(1) Original $y_t$')
>
> plt.subplot(2, 1, 2)
> plt.plot(dy)
> plt.title('Primeira Diferen√ßa $\Delta y_t$')
>
> plt.tight_layout()
> plt.show()
> ```
>
> A s√©rie original $y_t$ demonstra um comportamento n√£o estacion√°rio (caminhada aleat√≥ria), enquanto sua primeira diferen√ßa $\Delta y_t$ √© um ru√≠do branco, que √© estacion√°rio.

Em seguida [^Prev2], vimos que um processo que requer duas diferencia√ß√µes para atingir a estacionariedade √© um processo integrado de ordem 2, denotado como $y_t \sim I(2)$. Matematicamente, isso significa que o operador $(1-L)^2$ deve ser aplicado √† s√©rie para torn√°-la estacion√°ria.

> üí° **Exemplo Num√©rico:** Considere que a s√©rie $y_t$ √© a soma cumulativa de uma s√©rie $x_t$ que j√° √© integrada de ordem 1. Ou seja, $y_t = y_{t-1} + x_t$ onde $(1-L)x_t = \epsilon_t$ onde $\epsilon_t$ √© ru√≠do branco. Temos, ent√£o, $(1-L)^2 y_t = (1-L)x_t = \epsilon_t$. Logo, $y_t$ √© um processo I(2). Podemos visualizar isso com uma simula√ß√£o:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 100 # N√∫mero de pontos no tempo
>
> # Inicializa√ß√£o
> x = np.zeros(T)
> y = np.zeros(T)
> epsilon = np.random.normal(0, 1, T) # Ru√≠do branco
>
> # Simula√ß√£o da s√©rie I(2)
> for t in range(1, T):
>   x[t] = x[t-1] + epsilon[t]
>
> for t in range(1, T):
>  y[t] = y[t-1] + x[t]
>
> # C√°lculo das diferen√ßas
> dy = np.diff(y)
> d2y = np.diff(dy)
>
> # Plotagem das s√©ries
> plt.figure(figsize=(10, 6))
>
> plt.subplot(3, 1, 1)
> plt.plot(y)
> plt.title('S√©rie Temporal I(2) Original $y_t$')
>
> plt.subplot(3, 1, 2)
> plt.plot(dy)
> plt.title('Primeira Diferen√ßa $\Delta y_t$')
>
> plt.subplot(3, 1, 3)
> plt.plot(d2y)
> plt.title('Segunda Diferen√ßa $\Delta^2 y_t$')
>
> plt.tight_layout()
> plt.show()
> ```
>
> A s√©rie original $y_t$ e sua primeira diferen√ßa apresentam um comportamento n√£o estacion√°rio, enquanto a segunda diferen√ßa $\Delta^2 y_t$ aparenta ser estacion√°ria.

Para generalizar esses conceitos, introduzimos o conceito de **integra√ß√£o de ordem $d$**, denotada como $y_t \sim I(d)$, onde $d$ √© um n√∫mero inteiro n√£o negativo. Um processo $y_t$ √© considerado integrado de ordem $d$ se necessita ser diferenciado $d$ vezes para se tornar estacion√°rio. Matematicamente, isso √© expresso como:
$$ (1-L)^d y_t = x_t $$
onde $x_t$ √© um processo estacion√°rio. O operador $(1-L)^d$ representa a diferen√ßa de ordem $d$ e pode ser expandido como um polin√¥mio em $L$. A s√©rie $y_t$ √© a integral ou soma de ordem $d$ da s√©rie estacion√°ria $x_t$.

> üí° **Exemplo Num√©rico:** Considere um processo $y_t$ que segue um modelo integrado de ordem 3, $y_t \sim I(3)$. O operador de diferen√ßa de terceira ordem √© definido como $(1-L)^3 = (1-L)(1-L)(1-L) = (1-L)(1-2L+L^2) = 1 - 3L + 3L^2 - L^3$.  Portanto,
>
> $$ (1-L)^3 y_t = y_t - 3y_{t-1} + 3y_{t-2} - y_{t-3} $$
>
> Se a terceira diferen√ßa, $\Delta^3 y_t = (1-L)^3 y_t$, resultar em uma s√©rie estacion√°ria, ent√£o $y_t$ √© integrado de ordem 3, $y_t \sim I(3)$.
> Para simular esse cen√°rio em Python, considere que o modelo √© dado por:
>
> $$ (1-L)^3 y_t = \epsilon_t $$
>
> onde $\epsilon_t$ √© um ru√≠do branco com m√©dia zero. Podemos simular essa s√©rie, calcular as suas primeiras, segundas e terceiras diferen√ßas e plotar:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 200 # N√∫mero de pontos no tempo
>
> # Inicializa√ß√£o
> y = np.zeros(T)
> epsilon = np.random.normal(0, 1, T) # Ru√≠do branco
>
> # Simula√ß√£o da s√©rie I(3)
> for t in range(3, T):
>     y[t] = 3*y[t-1] - 3*y[t-2] + y[t-3] + epsilon[t]
>
> # C√°lculo das primeiras, segundas e terceiras diferen√ßas
> dy = np.diff(y)
> d2y = np.diff(dy)
> d3y = np.diff(d2y)
>
> # Plotagem das s√©ries
> plt.figure(figsize=(10, 8))
>
> plt.subplot(4, 1, 1)
> plt.plot(y)
> plt.title('S√©rie Temporal I(3) Original $y_t$')
>
> plt.subplot(4, 1, 2)
> plt.plot(dy)
> plt.title('Primeira Diferen√ßa $\Delta y_t$')
>
> plt.subplot(4, 1, 3)
> plt.plot(d2y)
> plt.title('Segunda Diferen√ßa $\Delta^2 y_t$')
>
> plt.subplot(4, 1, 4)
> plt.plot(d3y)
> plt.title('Terceira Diferen√ßa $\Delta^3 y_t$')
>
> plt.tight_layout()
> plt.show()
> ```
> Observa-se que a s√©rie original $y_t$ e as suas primeiras e segundas diferen√ßas aparentam n√£o estacionariedade, enquanto a terceira diferen√ßa $\Delta^3 y_t$ parece variar em torno de uma m√©dia constante, o que indica que a s√©rie √© integrada de ordem 3.

A ideia fundamental √© que uma s√©rie $I(d)$ pode ser entendida como a acumula√ß√£o de um processo estacion√°rio ao longo do tempo. Essa acumula√ß√£o se manifesta na necessidade de aplicar a diferen√ßa de ordem $d$ para tornar a s√©rie estacion√°ria.  Um processo $I(d)$ √©, portanto, um processo mais err√°tico do que um processo $I(d-1)$, pois a acumula√ß√£o dos choques estoc√°sticos ocorre de forma mais intensa.

> üí° **Exemplo Num√©rico:** Se $x_t$ for um processo de ru√≠do branco com m√©dia zero e desvio padr√£o 1, e definirmos uma s√©rie $y_t$ como a soma cumulativa de $x_t$, ent√£o $y_t$ ser√° um processo $I(1)$. Se, em vez disso, $z_t$ fosse a soma acumulada de $y_t$, ent√£o $z_t$ seria um processo $I(2)$ e assim por diante.
>
> $$ y_t = \sum_{i=1}^t x_i $$
>
> $$ z_t = \sum_{j=1}^t y_j = \sum_{j=1}^t \sum_{i=1}^j x_i $$
>
> Onde $x_t$ √© $I(0)$ (estacion√°rio), $y_t$ √© $I(1)$, e $z_t$ √© $I(2)$. Podemos construir esse exemplo num√©rico em Python.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 200
>
> # Inicializa√ß√£o
> x = np.random.normal(0, 1, T) # Ru√≠do branco
> y = np.zeros(T)
> z = np.zeros(T)
>
> # Simula√ß√£o
> for t in range(1,T):
>   y[t] = \sum_{i=0}^{t-1} x[i]
>   z[t] = \sum_{j=0}^{t-1} y[j]
>
> # C√°lculo das diferen√ßas
> dy = np.diff(y)
> dz = np.diff(z)
> d2z = np.diff(dz)
>
>
> # Plotagem
> plt.figure(figsize=(10, 8))
>
> plt.subplot(4, 1, 1)
> plt.plot(x)
> plt.title('S√©rie Temporal $x_t$ (I(0))')
>
> plt.subplot(4, 1, 2)
> plt.plot(y)
> plt.title('S√©rie Temporal $y_t$ (I(1))')
>
> plt.subplot(4, 1, 3)
> plt.plot(z)
> plt.title('S√©rie Temporal $z_t$ (I(2))')
>
> plt.subplot(4, 1, 4)
> plt.plot(d2z)
> plt.title('Segunda Diferen√ßa da S√©rie z $\Delta^2 z_t$')
>
> plt.tight_layout()
> plt.show()
> ```
>
> Os gr√°ficos mostram o comportamento da s√©rie original $x_t$ que √© estacion√°ria, a s√©rie $y_t$ que exibe um comportamento n√£o estacion√°rio e a s√©rie $z_t$ que tamb√©m tem um comportamento n√£o estacion√°rio. A segunda diferen√ßa da s√©rie $z_t$, no entanto, √© estacion√°ria.

Em geral, a necessidade de aplicar uma diferencia√ß√£o de ordem $d$ resulta em uma s√©rie temporal com caracter√≠sticas estat√≠sticas que variam cada vez menos no tempo, facilitando a aplica√ß√£o de t√©cnicas e modelos projetados para s√©ries estacion√°rias.

**Defini√ß√£o 1:** Um processo integrado de ordem $d$, denotado por $y_t \sim I(d)$, √© um processo cuja $d$-√©sima diferen√ßa, $(1-L)^d y_t$, √© estacion√°ria.

**Defini√ß√£o 2:** A d-√©sima diferen√ßa de um processo $y_t$ √© definida como $\Delta^d y_t = (1-L)^d y_t$.

**Lema 1:** Se $y_t$ √© um processo integrado de ordem $d$, $y_t \sim I(d)$, ent√£o a aplica√ß√£o do operador $(1-L)^d$ em $y_t$ resulta em um processo estacion√°rio.
*Proof:*
I. A defini√ß√£o de um processo integrado de ordem $d$ √© tal que, ao aplicar o operador $(1-L)^d$ em $y_t$, resulta em um processo estacion√°rio.
II. Portanto, se $y_t \sim I(d)$, ent√£o $(1-L)^d y_t$ √© estacion√°rio.
‚ñ†

**Proposi√ß√£o 1:** A s√©rie temporal $y_t$ √© integrada de ordem $d$ se, e somente se, $(1-L)^d y_t$ √© estacion√°ria.
*Proof:*
I. Por defini√ß√£o, uma s√©rie temporal $y_t$ √© integrada de ordem $d$ se a aplica√ß√£o do operador $(1-L)^d$ resulta em uma s√©rie estacion√°ria.
II. Portanto, $y_t$ √© integrada de ordem $d$ se e somente se $(1-L)^d y_t$ √© estacion√°ria.
‚ñ†

**Teorema 1:** Se $y_t$ √© um processo $I(d)$, ent√£o $(1-L)^k y_t$ √© um processo $I(d-k)$, para $k \leq d$.
*Proof:*
I. Se $y_t$ √© um processo $I(d)$, ent√£o, por defini√ß√£o, $(1-L)^d y_t$ √© estacion√°rio.
II. Aplicando o operador de primeira diferen√ßa $(1-L)$ a um processo $I(d)$ reduz a ordem de integra√ß√£o em 1. Portanto $(1-L)y_t$ √© um processo $I(d-1)$.
III. Aplicando o operador de primeira diferen√ßa $k$ vezes a um processo $I(d)$ resulta em $(1-L)^k y_t$ que √© um processo $I(d-k)$.
IV. Logo, se $y_t \sim I(d)$, ent√£o $(1-L)^k y_t \sim I(d-k)$.
‚ñ†

**Corol√°rio 1:** Se $y_t$ √© um processo $I(d)$, ent√£o $\Delta y_t = (1-L)y_t$ √© um processo $I(d-1)$.
*Proof:* Este resultado √© um caso particular do Teorema 1, onde $k=1$.
‚ñ†

**Corol√°rio 2:** Se $y_t$ √© um processo $I(d)$, ent√£o $\Delta^2 y_t = (1-L)^2y_t$ √© um processo $I(d-2)$.
*Proof:* Este resultado √© um caso particular do Teorema 1, onde $k=2$.
‚ñ†

**Teorema 1.1:** Se $y_t$ √© um processo $I(d)$, ent√£o $(1-L)^d y_t$ √© um processo estacion√°rio.
*Proof:* Este resultado √© um caso particular do Teorema 1, onde $k=d$.
‚ñ†

**Lema 1.1:** Se $y_t \sim I(d)$, e $c$ √© uma constante, ent√£o $cy_t \sim I(d)$.
*Proof:*
I. Se $y_t \sim I(d)$, ent√£o $(1-L)^d y_t$ √© estacion√°rio.
II. Multiplicando por uma constante $c$, temos $c(1-L)^d y_t$.
III. Pela propriedade de linearidade de $(1-L)^d$ temos $(1-L)^d cy_t$ que √© estacion√°rio.
IV. Portanto, $cy_t$ √© integrado de ordem $d$.
‚ñ†

**Lema 1.2:** Se $y_t \sim I(d)$ e $z_t \sim I(d)$, ent√£o $y_t + z_t \sim I(d)$.
*Proof:*
I. Se $y_t \sim I(d)$ e $z_t \sim I(d)$, ent√£o $(1-L)^d y_t$ e $(1-L)^d z_t$ s√£o estacion√°rios.
II. Consideremos a soma das s√©ries $y_t + z_t$.
III. Aplicando o operador $(1-L)^d$ na soma, temos $(1-L)^d (y_t + z_t) = (1-L)^d y_t + (1-L)^d z_t$.
IV. A soma de dois processos estacion√°rios √© um processo estacion√°rio.
V. Portanto, $y_t + z_t \sim I(d)$.
‚ñ†

**Teorema 2:** Um processo ARIMA(p, d, q) √© tal que a d-√©sima diferen√ßa da s√©rie temporal, $(1-L)^d y_t$, √© um processo ARMA(p, q) estacion√°rio.
*Proof:*
I. Um processo ARIMA(p, d, q) √© definido como:
    $$ (1-L)^d y_t = \frac{\Theta(L)}{\Phi(L)} \epsilon_t $$
II.  A express√£o √† direita da igualdade representa a forma de um processo ARMA(p, q) estacion√°rio.
III. Portanto, a d-√©sima diferen√ßa da s√©rie temporal, $(1-L)^d y_t$, √© um processo ARMA(p, q) estacion√°rio.
‚ñ†

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal $y_t$ que siga um processo ARIMA(1, 2, 1), dado por:
>
> $$ (1-L)^2 y_t = \frac{1 + \theta_1 L}{1 - \phi_1 L} \epsilon_t $$
>
> onde $\epsilon_t$ √© ru√≠do branco. Isso significa que a segunda diferen√ßa de $y_t$,  $\Delta^2 y_t = y_t - 2y_{t-1} + y_{t-2}$, segue um processo ARMA(1,1), que √© estacion√°rio.
> Podemos simular este processo, com $\phi_1 = 0.7$ e $\theta_1 = 0.4$, para visualizar o efeito das diferencia√ß√µes.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> T = 200
> phi1 = 0.7
> theta1 = 0.4
>
> # Inicializa√ß√£o
> y = np.zeros(T)
> epsilon = np.random.normal(0, 1, T)
> ar_part = np.zeros(T)
> ma_part = np.zeros(T)
>
> # Simula√ß√£o do ARMA(1,1)
> for t in range(1, T):
>    ar_part[t] = phi1 * ar_part[t-1] + epsilon[t]
>
> ma_part[0] = ar_part[0]
> for t in range(1, T):
>   ma_part[t] = ar_part[t] + theta1*epsilon[t-1]
>
> # Simula√ß√£o da s√©rie I(2)
> for t in range(2, T):
>  y[t] = 2*y[t-1] - y[t-2] + ma_part[t]
>
>
> # Calculo das diferen√ßas
> dy = np.diff(y)
> d2y = np.diff(dy)
>
>
> # Plotagem das s√©ries
> plt.figure(figsize=(10, 6))
>
> plt.subplot(3, 1, 1)
> plt.plot(y)
> plt.title('S√©rie Temporal Original I(2) $y_t$')
>
> plt.subplot(3, 1, 2)
> plt.plot(dy)
> plt.title('Primeira Diferen√ßa $\Delta y_t$')
>
> plt.subplot(3, 1, 3)
> plt.plot(d2y)
> plt.title('Segunda Diferen√ßa $\Delta^2 y_t$')
>
> plt.tight_layout()
> plt.show()
> ```
>
> Observamos que a s√©rie original $y_t$ e sua primeira diferen√ßa $\Delta y_t$ s√£o claramente n√£o estacion√°rias, enquanto a segunda diferen√ßa $\Delta^2 y_t$ parece ser estacion√°ria.

**Corol√°rio 1:** Se $y_t$ √© $I(d)$, ent√£o $(1-L)^k y_t$ para $k < d$ √© n√£o estacion√°rio e $I(d-k)$.
*Proof:*
I. Se $y_t$ √© $I(d)$, ent√£o $(1-L)^d y_t$ √© estacion√°rio.
II. Aplicar o operador $(1-L)^k$ com $k<d$ na s√©rie original $y_t$ n√£o resulta em uma s√©rie estacion√°ria, mas sim em uma s√©rie $I(d-k)$, como demonstrado no Teorema 1.
III. Portanto, se $y_t$ √© $I(d)$, ent√£o $(1-L)^k y_t$ para $k < d$ √© n√£o estacion√°rio e $I(d-k)$.
‚ñ†

**Teorema 2.1:** Se $y_t$ √© um processo ARIMA(p, d, q), ent√£o $(1-L)^k y_t$ √© um processo ARIMA(p, d-k, q) para $k \le d$.
*Proof:*
I. Se $y_t$ √© um processo ARIMA(p, d, q), ent√£o $(1-L)^d y_t$ √© um processo ARMA(p, q).
II. Aplicando o operador $(1-L)$ a um processo ARIMA(p, d, q), reduz a ordem de integra√ß√£o em 1, resultando em um processo ARIMA(p, d-1, q).
III. Aplicando o operador $(1-L)$ k vezes, resulta em um processo ARIMA(p, d-k, q).
IV. Portanto, se $y_t$ √© um processo ARIMA(p, d, q), ent√£o $(1-L)^k y_t$ √© um processo ARIMA(p, d-k, q).
‚ñ†

### Conclus√£o
Em resumo, a generaliza√ß√£o da integra√ß√£o para ordem $d$ proporciona um arcabou√ßo abrangente para modelar s√©ries temporais n√£o estacion√°rias. Um processo integrado de ordem $d$, $y_t \sim I(d)$, requer a aplica√ß√£o da diferen√ßa de ordem $d$, $(1-L)^d$, para se tornar um processo estacion√°rio.  A aplica√ß√£o da diferencia√ß√£o de ordem $d$ a um processo $I(d)$ resulta em um processo estacion√°rio, que pode ser adequadamente modelado por um processo ARMA(p, q). Os modelos ARIMA(p, d, q) fornecem uma ferramenta poderosa para modelar s√©ries temporais que apresentam diferentes graus de n√£o estacionariedade.  A compreens√£o da integra√ß√£o e das propriedades da diferencia√ß√£o s√£o cruciais para a aplica√ß√£o adequada dos modelos de s√©ries temporais n√£o estacion√°rias.

### Refer√™ncias
[^1]: Cap√≠tulo 15 do texto.
[^Prev1]: T√≥pico anterior sobre transforma√ß√µes logar√≠tmicas e modelos de raiz unit√°ria.
[^Prev2]: T√≥pico anterior sobre a integra√ß√£o de s√©ries temporais e a analogia com o c√°lculo.
[^Prev4]: T√≥pico anterior sobre transforma√ß√£o de processos ARIMA em ARMA atrav√©s da diferencia√ß√£o.
[^Prev5]: T√≥pico anterior sobre processos com raiz unit√°ria e integra√ß√£o de ordem 1.
[^Prev6]: T√≥pico anterior sobre Modelos ARIMA(p, d, q): Uma Vis√£o Abrangente
<!-- END -->
