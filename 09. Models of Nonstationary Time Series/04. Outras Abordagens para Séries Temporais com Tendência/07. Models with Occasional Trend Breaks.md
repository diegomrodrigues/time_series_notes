## Modelos com Quebras Ocasionais na Tend√™ncia: Uma Perspectiva de Raiz Unit√°ria com Inova√ß√µes N√£o Gaussianas

### Introdu√ß√£o

Em continuidade √† discuss√£o sobre modelos de s√©ries temporais n√£o estacion√°rias, este cap√≠tulo explora os **modelos com quebras ocasionais na tend√™ncia** sob uma perspectiva alternativa. Enquanto os cap√≠tulos anteriores abordaram a modelagem de quebras ocasionais na tend√™ncia como mudan√ßas discretas em uma tend√™ncia determin√≠stica [^1], este cap√≠tulo detalha como esses modelos podem ser interpretados como **processos de raiz unit√°ria com inova√ß√µes n√£o gaussianas**. Esta perspectiva oferece uma compreens√£o mais profunda da din√¢mica de s√©ries temporais sujeitas a eventos raros, integrando conceitos de n√£o estacionariedade, mudan√ßas estruturais e distribui√ß√µes n√£o gaussianas [^1]. A abordagem aqui apresentada permite uma vis√£o mais completa dos modelos com quebras, ligando-os a outros modelos j√° apresentados e abrindo caminhos para novas formas de an√°lise.

### Conceitos Fundamentais

#### A Perspectiva da Raiz Unit√°ria

Como vimos nos cap√≠tulos anteriores [^1], um processo de raiz unit√°ria √© caracterizado pela propriedade de que inova√ß√µes (choques) t√™m um efeito permanente no n√≠vel da s√©rie. Um modelo com raiz unit√°ria √© dado por:
$$(1-L)y_t = \delta + \psi(L)\epsilon_t$$ [15.1.3]

onde $y_t$ √© a s√©rie temporal, $L$ √© o operador de defasagem, $\delta$ √© uma constante (drift) e $\psi(L)\epsilon_t$ representa um componente estacion√°rio de m√©dia m√≥vel.

Por outro lado, um modelo com quebra ocasional na tend√™ncia pode ser escrito como:

$$y_t = \begin{cases}
    \alpha_1 + \delta t + \epsilon_t & \text{para } t < T_0 \\
    \alpha_2 + \delta t + \epsilon_t & \text{para } t \geq T_0
\end{cases}$$ [15.5.7]

onde $T_0$ √© o instante da quebra, e $\alpha_1$ e $\alpha_2$ s√£o os n√≠veis da tend√™ncia antes e depois da quebra [^1]. Como abordado nos cap√≠tulos anteriores, este modelo pode ser reformulado como:
$$\Delta y_t = \xi_t + \delta + \epsilon_t - \epsilon_{t-1}$$ [15.5.8]

onde $\xi_t = \alpha_2 - \alpha_1$ no tempo $T_0$ e zero caso contr√°rio, representando a mudan√ßa abrupta no n√≠vel da s√©rie. Aqui, $\xi_t$ pode ser considerado uma vari√°vel aleat√≥ria que assume o valor $\alpha_2-\alpha_1$ com probabilidade $p$ (que √© a probabilidade da ocorr√™ncia de uma quebra) e zero com probabilidade $1-p$.

> A liga√ß√£o entre esses modelos surge quando reconhecemos que a quebra ocasional na tend√™ncia pode ser vista como um evento raro que causa uma mudan√ßa permanente no n√≠vel da s√©rie, de maneira an√°loga ao efeito das inova√ß√µes em um processo de raiz unit√°ria. No entanto, em um modelo de raiz unit√°ria tradicional, as inova√ß√µes $\epsilon_t$ seguem uma distribui√ß√£o gaussiana, enquanto em um modelo com quebras ocasionais, as inova√ß√µes s√£o n√£o gaussianas, devido √† natureza discreta de $\xi_t$.

Essa perspectiva da raiz unit√°ria se torna mais clara ao analisar o modelo em primeira diferen√ßa. Ao reescrevermos o modelo [15.5.8] como
$$\Delta y_t = \mu + \eta_t$$ [15.5.9]
onde $\mu = p(\alpha_2-\alpha_1) + \delta$ e $\eta_t = \xi_t - p(\alpha_2-\alpha_1) + \epsilon_t - \epsilon_{t-1}$, podemos notar que $\eta_t$ √© uma combina√ß√£o de um processo de ru√≠do branco e um processo MA(1), ou seja, podemos representar $\eta_t$ como $\eta_t = \nu_t + \theta\nu_{t-1}$, em que $\nu_t$ √© uma inova√ß√£o com distribui√ß√£o n√£o gaussiana. Assim, um modelo com quebras ocasionais pode ser visto como um processo ARIMA(0,1,1) com inova√ß√µes n√£o gaussianas, que √© uma forma de representar um processo de raiz unit√°ria com algumas adapta√ß√µes.

> Em um modelo tradicional de raiz unit√°ria, a componente $\epsilon_t$ √© assumida como seguindo uma distribui√ß√£o normal, e a inova√ß√£o $\nu_t$ seria normalmente distribu√≠da tamb√©m. No modelo de quebra ocasional, no entanto, as inova√ß√µes $\nu_t$ e portanto $\eta_t$ s√£o n√£o gaussianas.

**Lema 1:** *O termo $\eta_t = \xi_t - p(\alpha_2-\alpha_1) + \epsilon_t - \epsilon_{t-1}$ em [15.5.9] pode ser expresso como um processo MA(1) com inova√ß√µes n√£o gaussianas*.

*Proof:*
I. Definimos $\nu_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t$.
II. Observamos que $\mathbb{E}[\nu_t] = \mathbb{E}[\xi_t] - p(\alpha_2-\alpha_1) + \mathbb{E}[\epsilon_t] = p(\alpha_2 - \alpha_1) - p(\alpha_2-\alpha_1) + 0 = 0$ e  $\text{Var}(\nu_t) = \text{Var}(\xi_t) + \text{Var}(\epsilon_t) = p(1-p)(\alpha_2-\alpha_1)^2 + \sigma^2_{\epsilon}$, onde $\sigma^2_{\epsilon}$ √© a vari√¢ncia de $\epsilon_t$, assumindo que $\epsilon_t$ tem m√©dia zero e √© i.i.d.
III. Portanto, $\eta_t$ pode ser reescrito como $\eta_t = \nu_t - \epsilon_{t-1}$.
IV. Note que $\epsilon_{t-1}$ √© o componente de m√©dia m√≥vel, que pode ser representado por $-\theta \nu_{t-1}$.
V. Assim, temos $\eta_t = \nu_t + \theta \nu_{t-1}$, onde $\nu_t$ tem distribui√ß√£o n√£o gaussiana devido √† presen√ßa de $\xi_t$, comprovando que $\eta_t$ √© um processo MA(1) com inova√ß√µes n√£o gaussianas. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal com uma quebra √∫nica, onde o n√≠vel da s√©rie passa de $\alpha_1 = 10$ para $\alpha_2 = 20$ no tempo $T_0 = 100$. O drift $\delta$ √© igual a 0.5 e a probabilidade de ocorr√™ncia da quebra √© $p=0.01$. As inova√ß√µes $\epsilon_t$ seguem uma distribui√ß√£o normal com m√©dia zero e desvio padr√£o $\sigma_{\epsilon} = 2$. Vamos simular 200 observa√ß√µes dessa s√©rie e verificar a distribui√ß√£o das inova√ß√µes $\eta_t$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> from scipy.stats import norm
>
> # Definindo os par√¢metros
> T = 200
> T0 = 100
> alpha1 = 10
> alpha2 = 20
> delta = 0.5
> p = 0.01
> sigma_epsilon = 2
>
> # Gerando os erros epsilon
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, T)
>
> # Inicializando a s√©rie temporal
> y = np.zeros(T)
>
> # Gerando a s√©rie com a quebra
> time = np.arange(1, T + 1)
> for t in range(T):
>    if t < T0:
>        y[t] = alpha1 + delta * time[t] + epsilon[t]
>    else:
>        y[t] = alpha2 + delta * time[t] + epsilon[t]
>
> # Calculando a vari√°vel xi
> xi = np.zeros(T)
> xi[T0] = alpha2 - alpha1
>
> # Calculando as inova√ß√µes eta
> eta = np.diff(y) - (p * (alpha2 - alpha1) + delta)
>
> # Plotando o histograma das inova√ß√µes eta
> plt.figure(figsize=(8, 6))
> plt.hist(eta, bins=20, density=True, alpha=0.6, label='Inova√ß√µes Œ∑t')
>
> # Ajustando a distribui√ß√£o normal
> xmin, xmax = plt.xlim()
> x = np.linspace(xmin, xmax, 100)
> mu_eta = np.mean(eta)
> sigma_eta = np.std(eta)
> p_norm = norm.pdf(x, mu_eta, sigma_eta)
> plt.plot(x, p_norm, 'k', linewidth=2, label='Distribui√ß√£o Normal Ajustada')
>
> plt.xlabel('Valores de Œ∑t')
> plt.ylabel('Densidade')
> plt.title('Histograma das Inova√ß√µes Œ∑t e Distribui√ß√£o Normal Ajustada')
> plt.legend()
> plt.show()
>
> ```
> O histograma das inova√ß√µes $\eta_t$ mostra uma distribui√ß√£o com caudas mais pesadas do que a distribui√ß√£o normal, especialmente ao redor do valor da quebra, indicando a n√£o normalidade dessas inova√ß√µes. A linha preta representa a distribui√ß√£o normal ajustada com a m√©dia e o desvio padr√£o amostrais das inova√ß√µes $\eta_t$, e a diferen√ßa visual entre o histograma e a curva normal confirma que a distribui√ß√£o de $\eta_t$ √© n√£o-gaussiana.

#### Inova√ß√µes N√£o Gaussianas

A principal distin√ß√£o entre o modelo de quebra ocasional e um modelo de raiz unit√°ria tradicional reside na natureza das inova√ß√µes. No modelo de quebra ocasional, as inova√ß√µes s√£o n√£o gaussianas devido √† presen√ßa da vari√°vel aleat√≥ria $\xi_t$, que representa o choque na tend√™ncia [^1]. Esta vari√°vel, como vimos, assume o valor $\alpha_2 - \alpha_1$ com probabilidade $p$ e zero com probabilidade $1 - p$.

> A n√£o gaussianidade das inova√ß√µes implica que os testes de raiz unit√°ria tradicionais, baseados na normalidade dos res√≠duos, podem n√£o ser apropriados para verificar a presen√ßa de raiz unit√°ria em modelos com quebras ocasionais. Em particular, a presen√ßa de quebras pode levar testes tradicionais de raiz unit√°ria a rejeitar incorretamente a hip√≥tese nula, ou seja, concluir que existe raiz unit√°ria quando o processo subjacente √© estacion√°rio ao redor de uma tend√™ncia com quebras.

Essa caracter√≠stica dos modelos com quebras ocasionais exige o desenvolvimento de m√©todos de infer√™ncia estat√≠stica que levem em considera√ß√£o a n√£o normalidade das inova√ß√µes. Uma abordagem comum √© o uso de m√©todos de estima√ß√£o de m√°xima verossimilhan√ßa ou de m√©todos bayesianos que n√£o assumam a normalidade das inova√ß√µes, permitindo um tratamento mais adequado da distribui√ß√£o da vari√°vel $\xi_t$.

**Proposi√ß√£o 1:** *A presen√ßa de inova√ß√µes n√£o gaussianas nos modelos de quebra ocasionais pode levar a resultados enviesados em testes de raiz unit√°ria tradicionais, que assumem normalidade dos res√≠duos.*
*Proof:*
I. Testes de raiz unit√°ria como o teste de Dickey-Fuller s√£o desenvolvidos sob a premissa de que os res√≠duos do modelo seguem uma distribui√ß√£o normal.
II. Em modelos com quebras ocasionais na tend√™ncia, as inova√ß√µes ($\eta_t$) t√™m uma distribui√ß√£o n√£o gaussiana devido √† presen√ßa da vari√°vel aleat√≥ria $\xi_t$, que √© n√£o cont√≠nua.
III. A n√£o normalidade dos res√≠duos viola as premissas dos testes de raiz unit√°ria tradicionais.
IV.  A viola√ß√£o das premissas pode levar √† rejei√ß√£o incorreta da hip√≥tese nula de n√£o estacionariedade, levando a um falso positivo, ou seja, a conclus√£o err√¥nea de que a s√©rie possui raiz unit√°ria.
V. Portanto, √© necess√°rio utilizar m√©todos estat√≠sticos mais robustos para realizar testes de raiz unit√°ria em presen√ßa de quebras ocasionais, que n√£o assumam a normalidade dos res√≠duos. ‚ñ†

**Teorema 1:** Um modelo de quebras ocasionais na tend√™ncia, com uma √∫nica quebra, pode ser expresso como um processo ARIMA(0,1,1) com inova√ß√µes n√£o gaussianas.

*Proof:*
I. O modelo com uma √∫nica quebra √© definido como:
$$y_t = \begin{cases}
    \alpha_1 + \delta t + \epsilon_t & \text{para } t < T_0 \\
    \alpha_2 + \delta t + \epsilon_t & \text{para } t \geq T_0
\end{cases}$$
II. Tomando a primeira diferen√ßa da s√©rie:
$$\Delta y_t = \xi_t + \delta + \epsilon_t - \epsilon_{t-1}$$
onde $\xi_t = \alpha_2 - \alpha_1$ quando $t=T_0$ e zero caso contr√°rio.
III. Definindo $\mu = p(\alpha_2-\alpha_1)+\delta$ e $\eta_t = \xi_t - p(\alpha_2-\alpha_1) + \epsilon_t - \epsilon_{t-1}$, obtemos:
$$\Delta y_t = \mu + \eta_t$$
IV. A vari√°vel $\eta_t$ √© uma combina√ß√£o de um termo de ru√≠do branco com um processo MA(1). Portanto, o processo √© um ARIMA(0,1,1) com res√≠duos $\eta_t$.
V.  A diferen√ßa entre este modelo e um modelo ARIMA(0,1,1) tradicional reside na distribui√ß√£o dos erros.  No modelo ARIMA tradicional, assume-se que os erros s√£o gaussianos, enquanto no modelo de quebras ocasionais, os erros,  $\eta_t$, s√£o n√£o gaussianos devido √† vari√°vel aleat√≥ria $\xi_t$.
VI.  Portanto, um modelo de quebras ocasionais na tend√™ncia pode ser expresso como um processo ARIMA(0,1,1) com inova√ß√µes n√£o gaussianas. ‚ñ†

**Teorema 1.1:** Um modelo de quebras ocasionais na tend√™ncia, com *k* quebras, pode ser expresso como um processo ARIMA(0,1,q) com inova√ß√µes n√£o gaussianas, onde *q* √© fun√ß√£o do n√∫mero de quebras *k*.

*Proof:*
I. Generalizando o modelo com uma √∫nica quebra para *k* quebras, temos:
$$y_t = \alpha_j + \delta t + \epsilon_t \text{ para } T_{j-1} \leq t < T_j, j=1, \ldots, k+1$$
onde $T_0=0$, $T_{k+1}=T$ e $\alpha_j$ s√£o os n√≠veis da tend√™ncia nos intervalos.
II. Tomando a primeira diferen√ßa:
$$\Delta y_t = \sum_{j=1}^{k} (\alpha_{j+1} - \alpha_{j}) I(t=T_j) + \delta + \epsilon_t - \epsilon_{t-1} = \sum_{j=1}^{k} \xi_{jt}  + \delta + \epsilon_t - \epsilon_{t-1}$$
onde $\xi_{jt} = \alpha_{j+1} - \alpha_j$ se $t=T_j$ e zero caso contr√°rio, e $I$ √© a fun√ß√£o indicadora.
III. Definindo $\mu = \delta + \sum_{j=1}^{k} p_j(\alpha_{j+1} - \alpha_j)$ e  $\eta_t = \sum_{j=1}^{k} (\xi_{jt} - p_j(\alpha_{j+1} - \alpha_j)) + \epsilon_t - \epsilon_{t-1}$, temos
$$ \Delta y_t = \mu + \eta_t $$
onde $p_j$ √© a probabilidade de ocorr√™ncia da quebra no tempo $T_j$.
IV. O termo $\eta_t$ √© uma combina√ß√£o linear de processos de ru√≠do branco e componentes MA, com *q* dependendo da configura√ß√£o das quebras, e onde as inova√ß√µes s√£o n√£o gaussianas.
V.  Dessa forma, o modelo com *k* quebras pode ser expresso como um processo ARIMA(0,1,*q*) com inova√ß√µes n√£o gaussianas, onde *q* √© uma fun√ß√£o do n√∫mero de quebras e suas posi√ß√µes. ‚ñ†

> üí° **Exemplo Num√©rico:** Suponha que temos uma s√©rie temporal com duas quebras, ocorrendo em $T_1 = 50$ e $T_2 = 120$, e os n√≠veis da tend√™ncia s√£o $\alpha_1=5$, $\alpha_2=15$ e $\alpha_3=25$ respectivamente. O drift √© $\delta=0.2$, e as probabilidades de quebra s√£o $p_1=0.02$ e $p_2=0.01$.  Vamos simular essa s√©rie e analisar as inova√ß√µes $\eta_t$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> from scipy.stats import norm
>
> # Par√¢metros
> T = 200
> T1 = 50
> T2 = 120
> alpha1 = 5
> alpha2 = 15
> alpha3 = 25
> delta = 0.2
> p1 = 0.02
> p2 = 0.01
> sigma_epsilon = 1.5
>
> # Gerando os erros
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, T)
>
> # Gerando a s√©rie
> time = np.arange(1, T + 1)
> y = np.zeros(T)
> for t in range(T):
>    if t < T1:
>        y[t] = alpha1 + delta * time[t] + epsilon[t]
>    elif t < T2:
>        y[t] = alpha2 + delta * time[t] + epsilon[t]
>    else:
>        y[t] = alpha3 + delta * time[t] + epsilon[t]
>
> # Calculando as variaveis xi
> xi = np.zeros(T)
> xi[T1] = alpha2-alpha1
> xi[T2] = alpha3-alpha2
>
> # Calculando as inova√ß√µes eta
> mu = delta + p1*(alpha2-alpha1) + p2*(alpha3-alpha2)
> eta = np.diff(y) - mu
>
> # Plotando o histograma das inova√ß√µes eta
> plt.figure(figsize=(8, 6))
> plt.hist(eta, bins=20, density=True, alpha=0.6, label='Inova√ß√µes Œ∑t')
>
> # Ajustando a distribui√ß√£o normal
> xmin, xmax = plt.xlim()
> x = np.linspace(xmin, xmax, 100)
> mu_eta = np.mean(eta)
> sigma_eta = np.std(eta)
> p_norm = norm.pdf(x, mu_eta, sigma_eta)
> plt.plot(x, p_norm, 'k', linewidth=2, label='Distribui√ß√£o Normal Ajustada')
>
> plt.xlabel('Valores de Œ∑t')
> plt.ylabel('Densidade')
> plt.title('Histograma das Inova√ß√µes Œ∑t com Duas Quebras e Distribui√ß√£o Normal Ajustada')
> plt.legend()
> plt.show()
>
> ```
> O histograma das inova√ß√µes $\eta_t$ com duas quebras mostra uma distribui√ß√£o ainda mais desviada da normalidade, com maior dispers√£o e caudas mais pesadas, demonstrando que, quanto maior o n√∫mero de quebras, mais acentuada √© a n√£o gaussianidade das inova√ß√µes, como previsto pelos Teoremas 1 e 1.1.

#### Implica√ß√µes para a Modelagem e Infer√™ncia

A interpreta√ß√£o dos modelos com quebras ocasionais como processos de raiz unit√°ria com inova√ß√µes n√£o gaussianas tem implica√ß√µes significativas para a modelagem e infer√™ncia estat√≠stica.
1. **Testes de raiz unit√°ria:** Os testes de raiz unit√°ria tradicionais baseados na hip√≥tese de normalidade das inova√ß√µes podem n√£o ser apropriados para modelos com quebras ocasionais. Testes mais robustos, que levem em considera√ß√£o a n√£o gaussianidade dos res√≠duos, devem ser utilizados.
2. **Estima√ß√£o de par√¢metros:** M√©todos de estima√ß√£o de m√°xima verossimilhan√ßa que n√£o assumam a normalidade dos erros, como aqueles que utilizam distribui√ß√µes de cauda pesada ou distribui√ß√µes mistas, podem ser mais adequados para estimar os par√¢metros do modelo.
3. **Infer√™ncia estat√≠stica:** M√©todos bayesianos que permitem a especifica√ß√£o de distribui√ß√µes a priori n√£o gaussianas tamb√©m podem ser empregados para realizar infer√™ncia sobre os par√¢metros do modelo.
4. **Previs√£o:** Os m√©todos de previs√£o devem ser adaptados para levar em considera√ß√£o a possibilidade de ocorr√™ncia de quebras no futuro, o que implica em modelos com previs√£o n√£o linear, dado o car√°ter n√£o linear das quebras.

**Proposi√ß√£o 2:** *A estima√ß√£o de par√¢metros em modelos de quebras ocasionais, utilizando m√©todos de m√°xima verossimilhan√ßa, exige o uso de distribui√ß√µes n√£o gaussianas para as inova√ß√µes*.

*Proof:*
I. O modelo de quebras ocasionais, como visto, possui inova√ß√µes n√£o gaussianas ($\eta_t$).
II.  A estima√ß√£o de m√°xima verossimilhan√ßa busca os par√¢metros que maximizam a fun√ß√£o de verossimilhan√ßa, que √© baseada na distribui√ß√£o das inova√ß√µes.
III. Assumir uma distribui√ß√£o gaussiana para $\eta_t$ leva a uma fun√ß√£o de verossimilhan√ßa inadequada, uma vez que a distribui√ß√£o real √© n√£o gaussiana.
IV. Logo, √© necess√°rio utilizar uma distribui√ß√£o n√£o gaussiana que melhor se ajuste √† distribui√ß√£o emp√≠rica de $\eta_t$.
V. Assim, para estimar os par√¢metros de forma consistente,  m√©todos de m√°xima verossimilhan√ßa em modelos com quebras ocasionais devem utilizar distribui√ß√µes n√£o gaussianas para as inova√ß√µes. ‚ñ†

### Conclus√£o
Os modelos com quebras ocasionais na tend√™ncia podem ser interpretados como processos de raiz unit√°ria com inova√ß√µes n√£o gaussianas. Esta perspectiva oferece uma compreens√£o mais profunda da din√¢mica de s√©ries temporais sujeitas a eventos raros, unificando conceitos de n√£o estacionariedade, mudan√ßas estruturais e distribui√ß√µes n√£o gaussianas. A principal distin√ß√£o entre os modelos est√° na distribui√ß√£o das inova√ß√µes, que s√£o gaussianas nos modelos tradicionais de raiz unit√°ria e n√£o gaussianas nos modelos com quebras. Esta caracter√≠stica tem implica√ß√µes importantes para os testes de raiz unit√°ria, m√©todos de estima√ß√£o de par√¢metros e infer√™ncia estat√≠stica. O reconhecimento da liga√ß√£o entre estes modelos permite o desenvolvimento de t√©cnicas mais robustas para a an√°lise de s√©ries temporais com quebras.

### Refer√™ncias
[^1]: Cap√≠tulo 15 do livro "Time Series Analysis" (informa√ß√µes retiradas de todo o cap√≠tulo).
<!-- END -->
