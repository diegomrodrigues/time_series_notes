## Modelagem de Quebras Ocasionais na Tend√™ncia: Uma An√°lise Detalhada

### Introdu√ß√£o
Em continuidade √† nossa explora√ß√£o de modelos para s√©ries temporais n√£o estacion√°rias, este cap√≠tulo se dedica a uma an√°lise detalhada da modelagem de **quebras ocasionais e discretas na tend√™ncia**, contrastando com a modelagem de uma tend√™ncia constante. Como abordado anteriormente, s√©ries temporais podem exibir comportamentos que n√£o s√£o adequadamente descritos por modelos com tend√™ncias determin√≠sticas fixas ou por modelos de raiz unit√°ria, e por isso modelos de quebras ocasionais na tend√™ncia surgem como uma alternativa para capturar a din√¢mica de eventos com efeitos discretos e potencialmente permanentes na trajet√≥ria de uma s√©rie [^1]. A introdu√ß√£o de quebras na tend√™ncia permite que a s√©rie temporal se ajuste a diferentes trajet√≥rias ao longo do tempo, refletindo eventos econ√¥micos, pol√≠ticos ou tecnol√≥gicos que possam causar mudan√ßas abruptas na sua din√¢mica.

### Conceitos Fundamentais

#### Modelagem de Quebras na Tend√™ncia

A modelagem de quebras ocasionais na tend√™ncia reconhece que a din√¢mica de uma s√©rie temporal $y_t$ pode ser afetada por eventos discretos que causam mudan√ßas abruptas no n√≠vel ou na inclina√ß√£o da tend√™ncia. Ao contr√°rio dos modelos com tend√™ncias determin√≠sticas lineares ou n√£o lineares, que assumem uma trajet√≥ria suave e cont√≠nua, ou de modelos de raiz unit√°ria, que assumem que inova√ß√µes causam mudan√ßas permanentes, mas de forma suave, os modelos com quebras ocasionais na tend√™ncia permitem acomodar mudan√ßas abruptas causadas por eventos pontuais.

A representa√ß√£o matem√°tica b√°sica de um modelo com uma √∫nica quebra na tend√™ncia pode ser expressa como:
$$
y_t =
\begin{cases}
    \alpha_1 + \delta t + \epsilon_t & \text{para } t < T_0 \\
    \alpha_2 + \delta t + \epsilon_t & \text{para } t \geq T_0
\end{cases}
$$ [15.5.7]
onde:

*   $y_t$ √© a s√©rie temporal no tempo $t$.
*   $T_0$ √© o ponto no tempo em que ocorre a quebra na tend√™ncia.
*   $\alpha_1$ √© o n√≠vel da tend√™ncia antes da quebra.
*   $\alpha_2$ √© o n√≠vel da tend√™ncia ap√≥s a quebra.
*   $\delta$ √© a inclina√ß√£o da tend√™ncia (assumida constante neste modelo).
*   $\epsilon_t$ √© um ru√≠do branco com m√©dia zero e vari√¢ncia constante $\sigma^2_\epsilon$, representando o componente estoc√°stico da s√©rie.

Nessa representa√ß√£o, a s√©rie temporal segue uma tend√™ncia linear com inclina√ß√£o $\delta$ at√© o tempo $T_0$, quando ocorre uma mudan√ßa abrupta no n√≠vel da tend√™ncia de $\alpha_1$ para $\alpha_2$, mantendo a inclina√ß√£o $\delta$ inalterada. A diferen√ßa entre $\alpha_2$ e $\alpha_1$ representa a magnitude da quebra no n√≠vel da tend√™ncia.

> A modelagem de quebras na tend√™ncia √© uma ferramenta √∫til para modelar s√©ries temporais que s√£o afetadas por eventos discretos com efeitos significativos, tais como mudan√ßas na pol√≠tica econ√¥mica, crises financeiras, desastres naturais ou novas tecnologias, que podem levar a altera√ß√µes abruptas e permanentes na trajet√≥ria de uma s√©rie temporal.

> üí° **Exemplo Num√©rico:** Suponha que temos uma s√©rie temporal que representa o PIB de um pa√≠s. Antes de uma crise econ√¥mica que ocorre no per√≠odo $T_0 = 100$, o PIB cresce a uma taxa constante, mas ap√≥s a crise, o n√≠vel do PIB se ajusta a uma nova trajet√≥ria, com a mesma inclina√ß√£o. Os par√¢metros do modelo s√£o:
> *   $\alpha_1 = 100$ (n√≠vel inicial do PIB antes da crise)
> *   $\alpha_2 = 90$ (n√≠vel do PIB ap√≥s a crise)
> *   $\delta = 2$ (crescimento anual do PIB)
> Nesse exemplo, o n√≠vel do PIB decresceria em 10 unidades no momento da crise, ajustando-se a uma nova trajet√≥ria. Este cen√°rio pode ser representado com o modelo acima.
>
> Podemos ilustrar a s√©rie com uma simula√ß√£o e um gr√°fico:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> alpha1 = 100
> alpha2 = 90
> delta = 2
> T0 = 100
> n = 200  # N√∫mero total de per√≠odos
> sigma_epsilon = 5  # Desvio padr√£o do ru√≠do branco
>
> # Gerar ru√≠do branco
> np.random.seed(42) # Definindo uma seed para reprodutibilidade
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # Gerar s√©rie temporal
> y = np.zeros(n)
> for t in range(n):
>     if t < T0:
>         y[t] = alpha1 + delta * t + epsilon[t]
>     else:
>         y[t] = alpha2 + delta * t + epsilon[t]
>
> # Plot da s√©rie temporal
> plt.figure(figsize=(10, 6))
> plt.plot(range(n), y, label='S√©rie Temporal com Quebra')
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra em T0')
> plt.xlabel('Tempo (t)')
> plt.ylabel('PIB (yt)')
> plt.title('S√©rie Temporal com Quebra na Tend√™ncia')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este gr√°fico demonstra visualmente o efeito da quebra no n√≠vel da s√©rie, onde antes de $T_0=100$ a s√©rie segue uma trajet√≥ria com n√≠vel $\alpha_1=100$ e ap√≥s $T_0$ o n√≠vel muda para $\alpha_2=90$, mantendo a mesma inclina√ß√£o.

#### A Representa√ß√£o $\Delta y_t = \mu + \eta_t$ e sua Rela√ß√£o com Modelos de Raiz Unit√°ria

Uma forma alternativa de expressar o modelo com quebras na tend√™ncia √© utilizando a primeira diferen√ßa da s√©rie temporal, como j√° demonstrado em cap√≠tulos anteriores [^1]:
$$ \Delta y_t = \xi_t + \delta + \epsilon_t - \epsilon_{t-1} $$ [15.5.8]
onde $\Delta y_t = y_t - y_{t-1}$ e $\xi_t$ representa a mudan√ßa no n√≠vel da s√©rie no tempo $T_0$, tal que $\xi_t = \alpha_2 - \alpha_1$ se $t=T_0$ e $\xi_t = 0$ caso contr√°rio.
Essa representa√ß√£o pode ser ainda escrita como:
$$ \Delta y_t = \mu + \eta_t $$ [15.5.9]
onde:
*   $\mu = p(\alpha_2 - \alpha_1) + \delta$ √© a mudan√ßa m√©dia por per√≠odo, englobando o efeito m√©dio da quebra ($p$ √© a probabilidade da quebra) e da tend√™ncia determin√≠stica.
*   $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$ representa o desvio da varia√ß√£o m√©dia, incorporando os efeitos das quebras e das inova√ß√µes estoc√°sticas.

Essa representa√ß√£o √© interessante pois revela a rela√ß√£o entre modelos com quebras ocasionais na tend√™ncia e modelos de raiz unit√°ria.  O processo √© visto como um processo com raiz unit√°ria, dado que ao tomar a primeira diferen√ßa obtemos uma s√©rie que se ajusta a um processo estacion√°rio do tipo MA(1).  Contudo, a distribui√ß√£o de $\eta_t$ n√£o √© gaussiana, devido √† presen√ßa de $\xi_t$.

>  A formula√ß√£o $\Delta y_t = \mu + \eta_t$ estabelece que modelos com quebras ocasionais na tend√™ncia podem ser interpretados como uma generaliza√ß√£o de um processo de raiz unit√°ria com inova√ß√µes n√£o gaussianas, ou seja, um modelo com processos integrados, mas onde a distribui√ß√£o das inova√ß√µes n√£o √© normal, e sim, caracterizada por caudas pesadas (isto √©, tem mais probabilidade de ocorr√™ncias de eventos extremos).

> üí° **Exemplo Num√©rico:**
>  Continuando o exemplo do PIB com uma quebra devido a uma crise econ√¥mica, suponha que $p=0.05$ (probabilidade de quebra por per√≠odo),  $\alpha_1 = 100$ (n√≠vel do PIB antes da crise), $\alpha_2 = 90$ (n√≠vel do PIB ap√≥s a crise) e $\delta = 2$ (crescimento anual do PIB).  Ent√£o:
>
> $$\mu = 0.05(90 - 100) + 2 = 1.5$$
>
> A mudan√ßa m√©dia por per√≠odo √© de 1.5 unidades, levando em considera√ß√£o o crescimento anual e a probabilidade de ocorr√™ncia da crise. O termo $\eta_t$ incorpora o desvio da varia√ß√£o m√©dia para cada per√≠odo $t$, devido a poss√≠veis novas quebras e a inova√ß√µes estoc√°sticas.
>
>  Caso n√£o haja quebra em um per√≠odo, $\xi_t = 0$,  e o termo $\eta_t$ se reduz a:
>  $$ \eta_t = -0.05(90 - 100) + \epsilon_t - \epsilon_{t-1} = 0.5 + \epsilon_t - \epsilon_{t-1}$$
>  Ou seja, o desvio da m√©dia ser√° fun√ß√£o do componente estoc√°stico. Caso ocorra uma quebra, por exemplo, em $T_0$, $\xi_{T_0} = -10$, e $\eta_{T_0}$ ser√°:
>   $$ \eta_{T_0} = -10 - 0.05(90 - 100) + \epsilon_{T_0} - \epsilon_{T_0-1} = -9.5  + \epsilon_{T_0} - \epsilon_{T_0-1}$$
> O desvio da m√©dia ser√° muito maior, representando a magnitude da quebra.
>
>  Podemos analisar os resultados da simula√ß√£o anterior calculando $\mu$ e $\eta_t$:
>
> ```python
> # C√°lculo de mu
> mu = p * (alpha2 - alpha1) + delta
>
> # C√°lculo de eta
> delta_y = np.diff(y)
> eta = delta_y - mu
>
> # Imprimir os primeiros valores de eta
> print("Primeiros 10 valores de eta:")
> print(eta[:10])
> print("Eta em T0:", eta[T0-1])
> ```
>
> Os primeiros valores de $\eta_t$ mostram o comportamento de desvio da m√©dia, que √© em torno de 0.5 quando n√£o h√° quebra. O valor de $\eta_t$ em $T_0-1$ demonstra um desvio bem maior, que representa o efeito da quebra.

#### Distribui√ß√£o N√£o Gaussiana das Inova√ß√µes
Uma caracter√≠stica fundamental da modelagem de quebras ocasionais na tend√™ncia √© que a distribui√ß√£o das inova√ß√µes $\eta_t$ n√£o √© gaussiana, devido √† presen√ßa do componente $\xi_t$, que representa a quebra e que assume valores discretos (zero quando n√£o h√° quebra ou o valor $\alpha_2 - \alpha_1$ no tempo da quebra). Modelos de raiz unit√°ria tradicionais, por sua vez, assumem que as inova√ß√µes seguem uma distribui√ß√£o gaussiana.

Essa diferen√ßa na distribui√ß√£o das inova√ß√µes tem implica√ß√µes importantes para a an√°lise estat√≠stica de s√©ries temporais com quebras ocasionais na tend√™ncia:
1. **Teste de Raiz Unit√°ria:** Testes de raiz unit√°ria tradicionais, que s√£o baseados na premissa da normalidade dos res√≠duos, podem n√£o ser apropriados para modelos com quebras ocasionais na tend√™ncia. A presen√ßa de quebras pode levar testes tradicionais a rejeitar incorretamente a hip√≥tese nula de n√£o estacionariedade. Testes robustos √† n√£o normalidade devem ser utilizados.
2. **Estima√ß√£o de Par√¢metros:** M√©todos de estima√ß√£o baseados na normalidade, como o m√©todo de m√≠nimos quadrados ordin√°rios (OLS), n√£o s√£o apropriados para modelos com quebras ocasionais na tend√™ncia. M√©todos que acomodem a n√£o gaussianidade dos res√≠duos, como m√°xima verossimilhan√ßa com distribui√ß√µes de cauda pesada ou mistura de distribui√ß√µes, s√£o mais apropriados.
3. **Infer√™ncia Estat√≠stica:** A infer√™ncia estat√≠stica sobre os par√¢metros dos modelos com quebras ocasionais na tend√™ncia deve ser realizada com cautela, considerando a n√£o normalidade dos res√≠duos. M√©todos bayesianos que permitam especificar distribui√ß√µes a priori n√£o gaussianas podem ser utilizados para garantir infer√™ncias mais robustas.

> A n√£o gaussianidade das inova√ß√µes $\eta_t$ nos modelos com quebras ocasionais na tend√™ncia surge da natureza discreta das quebras, que representam eventos raros e pontuais, ao contr√°rio de modelos com raiz unit√°ria em que as inova√ß√µes podem ser assumidas como gaussianas.

> üí° **Exemplo Num√©rico:**
> Para ilustrar como a distribui√ß√£o de $\eta_t$ se desvia da normalidade, podemos simular uma s√©rie temporal com uma quebra e analisar o histograma dos res√≠duos $\eta_t$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> from scipy.stats import norm
>
> # Par√¢metros do modelo
> alpha1 = 100
> alpha2 = 90
> delta = 2
> T0 = 100
> n = 200
> p = 0.05
> sigma_epsilon = 1
>
> # Simula√ß√£o da s√©rie temporal
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
> y = np.zeros(n)
>
> for t in range(n):
>    if t < T0:
>        y[t] = alpha1 + delta * t + epsilon[t]
>    else:
>        y[t] = alpha2 + delta * t + epsilon[t]
>
> # C√°lculo de mu e eta
> mu = p * (alpha2 - alpha1) + delta
> eta = np.diff(y) - mu
>
> # Plot do histograma e da distribui√ß√£o normal
> plt.figure(figsize=(8, 6))
> plt.hist(eta, bins=30, density=True, alpha=0.6, label='Res√≠duos Œ∑t')
> xmin, xmax = plt.xlim()
> x = np.linspace(xmin, xmax, 100)
> mu_eta = np.mean(eta)
> sigma_eta = np.std(eta)
> p_norm = norm.pdf(x, mu_eta, sigma_eta)
> plt.plot(x, p_norm, 'k', linewidth=2, label='Distribui√ß√£o Normal Ajustada')
> plt.xlabel('Valores de Œ∑t')
> plt.ylabel('Densidade')
> plt.title('Histograma dos Res√≠duos e Distribui√ß√£o Normal Ajustada')
> plt.legend()
> plt.show()
> ```
>
> O histograma dos res√≠duos $\eta_t$ n√£o segue uma distribui√ß√£o normal, como demonstrado pela compara√ß√£o com a densidade da distribui√ß√£o normal, comprovando a n√£o gaussianidade das inova√ß√µes em modelos com quebras ocasionais na tend√™ncia. A maior concentra√ß√£o de res√≠duos perto de 0 e em valores extremos demonstra a presen√ßa das caudas pesadas.

**Teorema 1:** Em modelos de quebras ocasionais na tend√™ncia, o termo $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$ segue um processo MA(1) com inova√ß√µes n√£o gaussianas.
*Prova:*
I. A s√©rie temporal em primeira diferen√ßa √© dada por $\Delta y_t = \mu + \eta_t$, onde $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$.
II. A fun√ß√£o de autocovari√¢ncia para $\eta_t$ pode ser calculada como $\gamma_k = E[(\eta_t - E[\eta_t])(\eta_{t-k} - E[\eta_{t-k}])]$.
III. Como $E[\eta_t] = 0$, temos $\gamma_k = E[\eta_t\eta_{t-k}]$.
IV. Para $k=0$, temos $\gamma_0 = E[\eta_t^2]$, que √© a vari√¢ncia de $\eta_t$ e portanto diferente de zero.
V. Para $k=1$, temos $\gamma_1 = E[(\xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1})(\xi_{t-1} - p(\alpha_2 - \alpha_1) + \epsilon_{t-1} - \epsilon_{t-2})]$. Como $\xi_t$ s√≥ √© n√£o nulo para $t=T_0$, $\epsilon_t$ √© ru√≠do branco, e $\epsilon_t$ √© independente de $\xi_t$, resulta $\gamma_1 = - \sigma^2_\epsilon$, que √© diferente de zero.
VI. Para $k > 1$, temos $\gamma_k = 0$, devido a independ√™ncia entre os termos $\xi_t$ e $\epsilon_t$.
VII. Portanto, a autocovari√¢ncia de $\eta_t$ √© diferente de zero apenas para o primeiro lag, caracterizando um processo MA(1).
VIII. Como $\xi_t$ assume valores discretos, e $\epsilon_t$ √© normal, $\eta_t$ tem uma distribui√ß√£o n√£o gaussiana.
IX. Portanto, $\eta_t$ segue um processo MA(1) com inova√ß√µes n√£o gaussianas.  $\blacksquare$
> O teorema acima demonstra formalmente que o processo $\eta_t$ tem uma distribui√ß√£o n√£o gaussiana e que possui depend√™ncia de primeira ordem, caracterizando um processo MA(1) com inova√ß√µes n√£o gaussianas.

**Teorema 1.1:** A fun√ß√£o de autocorrela√ß√£o de $\eta_t$, denotada por $\rho_k$, √© dada por $\rho_1 = \frac{-\sigma^2_\epsilon}{\sigma^2_\eta}$ e $\rho_k = 0$ para $k \neq 1$, onde $\sigma^2_\eta$ √© a vari√¢ncia de $\eta_t$.
*Prova:*
I. Do Teorema 1, sabemos que $\eta_t$ segue um processo MA(1).
II. A fun√ß√£o de autocorrela√ß√£o √© definida como $\rho_k = \frac{\gamma_k}{\gamma_0}$, onde $\gamma_k$ √© a fun√ß√£o de autocovari√¢ncia.
III.  Do Teorema 1, temos $\gamma_1 = -\sigma^2_\epsilon$.
IV. Tamb√©m do Teorema 1, temos $\gamma_0 = E[\eta_t^2] = \sigma^2_\eta$.
V. Para $k=1$, temos $\rho_1 = \frac{\gamma_1}{\gamma_0} = \frac{-\sigma^2_\epsilon}{\sigma^2_\eta}$.
VI. Para $k \neq 1$, temos $\gamma_k = 0$, e portanto $\rho_k = 0$.
VII. Assim, a fun√ß√£o de autocorrela√ß√£o de $\eta_t$ √© n√£o nula apenas para $k=1$ e √© dada por $\rho_1 = \frac{-\sigma^2_\epsilon}{\sigma^2_\eta}$.  $\blacksquare$

> üí° **Exemplo Num√©rico:**
> Continuando o exemplo do PIB, podemos calcular o valor te√≥rico da autocorrela√ß√£o de $\eta_t$ dado o exemplo num√©rico anterior.  Assumindo que $\sigma^2_\epsilon = 1$, temos  $\alpha_1 = 100$, $\alpha_2 = 90$ e $p=0.05$.  Do Lema 1.1, $\sigma^2_\eta = 0.05(1-0.05)(90-100)^2 + 2(1) = 0.05 * 0.95 * 100 + 2 = 4.75 + 2 = 6.75$.  Assim, a autocorrela√ß√£o de primeira ordem √© dada por $\rho_1 = \frac{-1}{6.75} \approx -0.148$.
>
> Podemos tamb√©m calcular empiricamente a fun√ß√£o de autocorrela√ß√£o da s√©rie simulada e verificar que o valor se aproxima do valor te√≥rico:
>
> ```python
> import statsmodels.api as sm
> # C√°lculo da fun√ß√£o de autocorrela√ß√£o (ACF)
> acf = sm.tsa.acf(eta, nlags=10)
>
> # Plot da fun√ß√£o de autocorrela√ß√£o
> plt.figure(figsize=(8, 5))
> plt.stem(range(len(acf)), acf, markerfmt='o', linefmt='-')
> plt.axhline(y=0, color='k', linestyle='--', linewidth=0.8)
> plt.xlabel('Lag (k)')
> plt.ylabel('Autocorrela√ß√£o')
> plt.title('Fun√ß√£o de Autocorrela√ß√£o (ACF) de Œ∑t')
> plt.grid(True)
> plt.show()
>
> print("Autocorrela√ß√£o no lag 1:", acf[1])
> ```
> O gr√°fico e o valor da autocorrela√ß√£o de primeira ordem demonstram que os resultados se aproximam do valor te√≥rico.

### Implica√ß√µes para Modelagem e Infer√™ncia
A modelagem de quebras ocasionais na tend√™ncia com a perspectiva de raiz unit√°ria com inova√ß√µes n√£o gaussianas implica as seguintes considera√ß√µes:
1.  **Teste de Raiz Unit√°ria:** Testes de raiz unit√°ria tradicionais, que assumem normalidade dos res√≠duos, podem levar √† rejei√ß√£o incorreta da hip√≥tese nula de n√£o estacionariedade. Testes que sejam robustos √† n√£o normalidade dos res√≠duos, tais como testes bootstrap, devem ser utilizados.
2.  **Estima√ß√£o:** A estima√ß√£o dos par√¢metros de modelos com quebras ocasionais na tend√™ncia deve ser feita usando m√©todos que n√£o assumam a normalidade dos res√≠duos. M√©todos de m√°xima verossimilhan√ßa com distribui√ß√µes de cauda pesada ou mistura de distribui√ß√µes podem ser usados. M√©todos bayesianos podem ser mais adequados pois permitem incorporar incertezas com rela√ß√£o ao modelo, e n√£o somente aos par√¢metros, al√©m de serem uma forma natural de incorporar conhecimento a priori sobre a ocorr√™ncia e magnitude das quebras.
3.  **Infer√™ncia:** A infer√™ncia sobre os par√¢metros deve ser realizada com cautela, utilizando intervalos de confian√ßa que levem em conta a n√£o normalidade dos res√≠duos. M√©todos bootstrap ou infer√™ncia bayesiana podem ser apropriados.
4. **Previs√£o:** A previs√£o de s√©ries com quebras ocasionais na tend√™ncia requer modelos n√£o lineares que incorporem a probabilidade de ocorr√™ncia de novas quebras e a incerteza sobre a sua magnitude. A previs√£o pode ser realizada por meio de simula√ß√µes com diferentes cen√°rios para a ocorr√™ncia das quebras.
5. **Compara√ß√£o com outros modelos:** A compara√ß√£o com modelos de tend√™ncia determin√≠stica ou de raiz unit√°ria deve levar em conta n√£o somente o ajuste do modelo aos dados, mas tamb√©m a capacidade de cada modelo de capturar a din√¢mica da s√©rie e a interpreta√ß√£o econ√¥mica dos par√¢metros.
6.  **Robustez:** A an√°lise de robustez dos resultados, variando os par√¢metros e as premissas do modelo, √© fundamental para garantir a confiabilidade das conclus√µes.

**Proposi√ß√£o 1:** M√©todos de m√≠nimos quadrados ordin√°rios (OLS) geram estimadores enviesados e inconsistentes para modelos com quebras ocasionais na tend√™ncia.

*Proof:*
I. A representa√ß√£o do modelo com quebras √© dada por $\Delta y_t = \mu + \eta_t$, onde $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$.
II. O m√©todo OLS assume que os res√≠duos t√™m m√©dia zero, vari√¢ncia constante, e s√£o n√£o correlacionados.
III. Em modelos com quebras ocasionais na tend√™ncia, $\eta_t$ n√£o √© um ru√≠do branco pois tem autocorrela√ß√£o de primeira ordem e n√£o possui distribui√ß√£o gaussiana.
IV. Como resultado, os estimadores OLS s√£o enviesados e inconsistentes.
V. Portanto, OLS n√£o √© um m√©todo apropriado para estima√ß√£o de par√¢metros em modelos com quebras ocasionais na tend√™ncia. $\blacksquare$
> üí° **Exemplo Num√©rico:**
> Para ilustrar a inefici√™ncia de OLS, podemos estimar o modelo $\Delta y_t = \mu + \eta_t$ usando OLS e comparar os resultados com os par√¢metros conhecidos.
>
> ```python
> import statsmodels.api as sm
>
> # Estima√ß√£o do modelo usando OLS
> X = np.ones((len(delta_y), 1))  # Matriz com apenas uma coluna de 1s
> model = sm.OLS(delta_y, X)
> results = model.fit()
>
> # Resultados da estima√ß√£o
> print(results.summary())
>
> # Imprimir o valor estimado de mu e o valor real
> mu_hat = results.params[0]
> print("Valor Estimado de mu (OLS):", mu_hat)
> print("Valor Real de mu:", mu)
>
> ```
> Os resultados da estima√ß√£o demonstram que o estimador de $\mu$ via OLS √© diferente do valor real, o que demonstra o vi√©s do m√©todo. O summary tamb√©m mostra que os res√≠duos n√£o s√£o normais, indicando que o modelo OLS n√£o √© apropriado.

**Corol√°rio 1.1:** Testes de hip√≥teses baseados nos resultados da estima√ß√£o por OLS para modelos com quebras ocasionais n√£o s√£o confi√°veis.

*Proof:*
I. Pela Proposi√ß√£o 1, estimadores OLS s√£o enviesados e inconsistentes em modelos com quebras ocasionais na tend√™ncia.
II. Testes de hip√≥teses s√£o baseados nos resultados de estima√ß√£o, especialmente em desvios padr√µes e estat√≠sticas de teste calculados a partir dos estimadores.
III. Como os estimadores OLS s√£o enviesados e inconsistentes, seus desvios padr√µes e estat√≠sticas de teste n√£o s√£o v√°lidos.
IV. Portanto, testes de hip√≥teses baseados em estimadores OLS em modelos com quebras ocasionais n√£o s√£o confi√°veis. $\blacksquare$

**Lema 1:** A autocovari√¢ncia da s√©rie $\Delta y_t$ nos modelos com quebras ocasionais √© n√£o nula apenas no primeiro lag.
*Prova:*
I. Pelo Teorema 1, $\eta_t$ segue um processo MA(1)
II. A s√©rie $\Delta y_t$ √© dada por $\Delta y_t = \mu + \eta_t$.
III. Como a autocovari√¢ncia de uma constante √© zero,  a autocovari√¢ncia de $\Delta y_t$ √© dada por $Cov(\Delta y_t, \Delta y_{t-k}) = Cov(\eta_t, \eta_{t-k})$.
IV. A autocovari√¢ncia de $\eta_t$ √© n√£o nula apenas para k=1, como demonstrado pelo Teorema 1.
V. Portanto, a autocovari√¢ncia de $\Delta y_t$ √© n√£o nula apenas para k=1. $\blacksquare$
> O lema acima demonstra que a s√©rie em primeira diferen√ßa, nos modelos com quebras ocasionais na tend√™ncia, possui uma autocorrela√ß√£o de primeira ordem, o que justifica a modelagem de $\eta_t$ como um processo MA(1).

**Lema 1.1:** A vari√¢ncia de $\eta_t$, denotada por $\sigma^2_\eta$, √© dada por $\sigma^2_\eta = p(1-p)(\alpha_2 - \alpha_1)^2 + 2\sigma^2_\epsilon$.
*Prova:*
I. Sabemos que $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$.
II. A vari√¢ncia de $\eta_t$ √© $Var(\eta_t) = E[(\eta_t - E[\eta_t])^2]$.
III. Como $E[\eta_t] = 0$, temos $Var(\eta_t) = E[\eta_t^2] = E[(\xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1})^2]$.
IV. Expandindo o quadrado, obtemos $Var(\eta_t) = E[\xi_t^2] + p^2(\alpha_2 - \alpha_1)^2 + E[(\epsilon_t - \epsilon_{t-1})^2] + 2E[\xi_t(-p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1})]$.
V.  Como $E[\xi_t] = p(\alpha_2-\alpha_1)$, temos $E[\xi_t^2] = Var(\xi_t) + [E(\xi_t)]^2 = p(1-p)(\alpha_2-\alpha_1)^2 + p^2(\alpha_2-\alpha_1)^2$.
VI. Como $\xi_t$ √© independente de $\epsilon_t$ e $\epsilon_{t-1}$, temos $2E[\xi_t(-p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1})] = 2E[\xi_t(-p(\alpha_2 - \alpha_1))] = -2p^2(\alpha_2-\alpha_1)^2$
VII. Tamb√©m $E[(\epsilon_t - \epsilon_{t-1})^2] = E[\epsilon_t^2 - 2\epsilon_t\epsilon_{t-1} + \epsilon_{t-1}^2] = 2\sigma^2_\epsilon$.
VIII.  Assim, $Var(\eta_t) = p(1-p)(\alpha_2-\alpha_1)^2 + p^2(\alpha_2-\alpha_1)^2 + p^2(\alpha_2-\alpha_1)^2 - 2p^2(\alpha_2-\alpha_1)^2+ 2\sigma^2_\epsilon = p(1-p)(\alpha_2-\alpha_1)^2 + 2\sigma^2_\epsilon$.
IX. Portanto, a vari√¢ncia de $\eta_t$ √© $\sigma^2_\eta = p(1-p)(\alpha_2 - \alpha_1)^2 + 2\sigma^2_\epsilon$. $\blacksquare$
> üí° **Exemplo Num√©rico:**
> Usando os valores do exemplo anterior $(\alpha_1=100, \alpha_2=90, p=0.05, \sigma^2_\epsilon = 1)$, a vari√¢ncia de $\eta_t$ pode ser calculada como:
> $\sigma^2_\eta = 0.05(1-0.05)(90-100)^2 + 2(1) = 0.05 * 0.95 * 100 + 2 = 4.75 + 2 = 6.75$.  Podemos comparar o resultado com a vari√¢ncia emp√≠rica calculada anteriormente:
>
> ```python
> # C√°lculo da vari√¢ncia emp√≠rica de eta
> var_eta_emp = np.var(eta)
>
> # C√°lculo da vari√¢ncia te√≥rica de eta
> var_eta_teorica = p * (1-p) * (alpha2 - alpha1)**2 + 2 * sigma_epsilon**2
>
> print("Vari√¢ncia emp√≠rica de eta:", var_eta_emp)
> print("Vari√¢ncia te√≥rica de eta:", var_eta_teorica)
>
> ```
> Os resultados demonstram que a vari√¢ncia emp√≠rica se aproxima do valor te√≥rico, confirmando o Lema 1.1.

### Conclus√£o
A modelagem de quebras ocasionais na tend√™ncia oferece uma abordagem flex√≠vel e realista para a an√°lise de s√©ries temporais n√£o estacion√°rias. A formula√ß√£o $\Delta y_t = \mu + \eta_t$, juntamente com a interpreta√ß√£o como uma generaliza√ß√£o de modelos de raiz unit√°ria com inova√ß√µes n√£o gaussianas, permite uma melhor compreens√£o da din√¢mica de s√©ries temporais que s√£o afetadas por eventos discretos. A necessidade de m√©todos de estima√ß√£o e infer√™ncia que acomodem a n√£o gaussianidade das inova√ß√µes √© crucial para obter resultados confi√°veis. A modelagem de quebras ocasionais na tend√™ncia representa um avan√ßo em rela√ß√£o aos modelos tradicionais, permitindo uma an√°lise mais precisa e uma melhor compreens√£o da din√¢mica de s√©ries temporais em diversas √°reas do conhecimento.
### Refer√™ncias
[^1]: Cap√≠tulo 15 do livro "Time Series Analysis" (informa√ß√µes retiradas de todo o cap√≠tulo).
<!-- END -->
