## Modelagem de Quebras Ocasionais na Tend√™ncia: Capturando Efeitos Permanentes em S√©ries Temporais

### Introdu√ß√£o

Em continuidade √† discuss√£o sobre modelos de s√©ries temporais n√£o estacion√°rias, este cap√≠tulo se aprofunda na modelagem de **quebras ocasionais na tend√™ncia**, explorando como esta abordagem pode capturar eventos econ√¥micos com grandes efeitos permanentes, em contraste com a modelagem tradicional de tend√™ncias constantes ou raiz unit√°ria [^1]. Enquanto modelos de raiz unit√°ria assumem que inova√ß√µes t√™m um efeito permanente no n√≠vel da s√©rie, e modelos com tend√™ncia determin√≠stica assumem uma trajet√≥ria suave, modelos com quebras ocasionais permitem acomodar eventos raros que alteram a trajet√≥ria da s√©rie de forma abrupta [^1]. Este cap√≠tulo explorar√° como as quebras ocasionais na tend√™ncia s√£o modeladas, como elas se diferenciam de modelos de raiz unit√°ria e tend√™ncia, e como a modelagem de quebras ocasionais pode levar a uma compreens√£o mais precisa da din√¢mica de s√©ries temporais em diversas √°reas.

### Conceitos Fundamentais

#### Modelagem de Quebras Ocasionais na Tend√™ncia

Modelos que incorporam quebras ocasionais na tend√™ncia assumem que a trajet√≥ria de uma s√©rie temporal $y_t$ pode ser afetada por eventos discretos, que causam mudan√ßas abruptas e permanentes no n√≠vel ou na inclina√ß√£o da tend√™ncia [^1]. Ao contr√°rio de modelos de tend√™ncia determin√≠stica, que assumem uma trajet√≥ria suave, ou de modelos de raiz unit√°ria, que atribuem toda a n√£o estacionariedade a inova√ß√µes, os modelos de quebras ocasionais reconhecem que a trajet√≥ria da s√©rie pode ser alterada por eventos pontuais.

Um modelo simples com uma √∫nica quebra na tend√™ncia pode ser representado da seguinte forma:
$$
y_t =
\begin{cases}
    \alpha_1 + \delta t + \epsilon_t & \text{para } t < T_0 \\
    \alpha_2 + \delta t + \epsilon_t & \text{para } t \geq T_0
\end{cases}
$$ [15.5.7]

onde:

*   $y_t$ √© a s√©rie temporal.
*   $t$ √© o tempo.
*   $T_0$ √© o tempo em que ocorre a quebra.
*   $\alpha_1$ √© o n√≠vel da tend√™ncia antes da quebra.
*   $\alpha_2$ √© o n√≠vel da tend√™ncia ap√≥s a quebra.
*   $\delta$ √© a inclina√ß√£o da tend√™ncia (assumida constante neste modelo).
*   $\epsilon_t$ √© um ru√≠do branco, representando inova√ß√µes estoc√°sticas com m√©dia zero e vari√¢ncia constante.

Este modelo assume que a s√©rie segue uma tend√™ncia linear com inclina√ß√£o $\delta$, mas que no instante $T_0$ ocorre uma mudan√ßa abrupta no n√≠vel da s√©rie, que passa de $\alpha_1$ para $\alpha_2$.

Uma formula√ß√£o equivalente pode ser obtida tomando a primeira diferen√ßa:
$$\Delta y_t = \xi_t + \delta + \epsilon_t - \epsilon_{t-1}$$ [15.5.8]
onde $\Delta y_t = y_t - y_{t-1}$, e $\xi_t = \alpha_2 - \alpha_1$ para $t=T_0$ e $\xi_t=0$ caso contr√°rio. O termo $\xi_t$ representa o impacto da quebra no momento $T_0$.

> A modelagem de quebras ocasionais na tend√™ncia √© fundamental para entender a din√¢mica de s√©ries temporais em que eventos raros e pontuais, como crises econ√¥micas, mudan√ßas pol√≠ticas, ou desastres naturais, podem ter um efeito permanente sobre a trajet√≥ria da s√©rie [^1].

> üí° **Exemplo Num√©rico:** Vamos considerar um exemplo simples onde uma s√©rie temporal representa a produ√ß√£o de um setor industrial. Suponha que, antes do tempo $T_0 = 100$, a produ√ß√£o se ajusta a uma tend√™ncia linear, mas ap√≥s esse per√≠odo, devido a uma mudan√ßa tecnol√≥gica, o n√≠vel de produ√ß√£o se ajusta a uma nova trajet√≥ria, com a mesma inclina√ß√£o. A seguir, est√£o os par√¢metros do modelo:
>
> *   $\alpha_1 = 50$ (n√≠vel inicial da produ√ß√£o)
> *   $\alpha_2 = 70$ (n√≠vel da produ√ß√£o ap√≥s a mudan√ßa tecnol√≥gica)
> *   $\delta = 2$ (crescimento anual da produ√ß√£o)
>
> Nesse exemplo, o n√≠vel da produ√ß√£o aumentaria em 20 unidades no tempo da mudan√ßa. A representa√ß√£o $\Delta y_t = \xi_t + \delta + \epsilon_t - \epsilon_{t-1}$ demonstra como a varia√ß√£o da produ√ß√£o se ajusta a uma tend√™ncia de crescimento, com um choque no momento $T_0$.
>
> Em termos da formula√ß√£o $\Delta y_t = \mu + \eta_t$, temos que $\mu = p(\alpha_2-\alpha_1) + \delta$ e $\eta_t = \xi_t - p(\alpha_2-\alpha_1) + \epsilon_t - \epsilon_{t-1}$.  Em que $\xi_t$ √© $\alpha_2 - \alpha_1$ no tempo da quebra e zero caso contr√°rio. Caso a probabilidade da quebra em cada per√≠odo seja $p=0.02$,  e $\delta=2$, ent√£o a mudan√ßa m√©dia por per√≠odo seria $\mu = 0.02\times(70-50)+2 = 2.4$, que √© a soma do crescimento e da probabilidade da quebra. O desvio $\eta_t$ representa a varia√ß√£o ao redor da m√©dia.
>
> Vamos simular alguns valores para ilustrar. Considere que $\epsilon_t$ segue uma distribui√ß√£o normal com m√©dia 0 e desvio padr√£o 1, e que a quebra acontece em $t=100$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)  # para reprodutibilidade
>
> alpha1 = 50
> alpha2 = 70
> delta = 2
> T0 = 100
> p = 0.02
> n_periods = 200
>
> epsilon = np.random.normal(0, 1, n_periods)
> y = np.zeros(n_periods)
>
> for t in range(n_periods):
>   if t < T0:
>     y[t] = alpha1 + delta * t + epsilon[t]
>   else:
>     y[t] = alpha2 + delta * t + epsilon[t]
>
> dy = np.diff(y)
> xi = np.zeros(n_periods-1)
> xi[T0-1]= alpha2-alpha1
> eta = xi - p*(alpha2-alpha1) + epsilon[1:] - epsilon[:-1]
>
>
> t_values = np.arange(1, n_periods)
>
> plt.figure(figsize=(12, 6))
> plt.plot(t_values,dy, label='Œîy_t')
> plt.xlabel('Tempo (t)')
> plt.ylabel('Varia√ß√£o da Produ√ß√£o (Œîy_t)')
> plt.title('Simula√ß√£o da S√©rie Temporal com Quebra')
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra em T0=100')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> plt.figure(figsize=(12, 6))
> plt.plot(t_values, eta, label='Œ∑_t')
> plt.xlabel('Tempo (t)')
> plt.ylabel('Inova√ß√µes (Œ∑_t)')
> plt.title('Inova√ß√µes n√£o Gaussianas Œ∑_t')
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra em T0=100')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Observa-se no gr√°fico da varia√ß√£o da produ√ß√£o ($\Delta y_t$) um comportamento aproximadamente constante (devido ao $\delta=2$ ser constante) e uma mudan√ßa abrupta em $t=100$ devido √† quebra. No gr√°fico de $\eta_t$ observamos um choque grande em $t=100$ (o pico na linha vertical) e ru√≠do aleat√≥rio ao redor de 0 em outros per√≠odos. Este choque √© a diferen√ßa entre o novo n√≠vel da produ√ß√£o e o n√≠vel anterior da produ√ß√£o corrigido pela probabilidade de quebra, mais o ru√≠do aleat√≥rio.

#### Compara√ß√£o com Modelos de Raiz Unit√°ria e Tend√™ncia Determin√≠stica

Modelos com quebras ocasionais na tend√™ncia se diferenciam dos modelos de raiz unit√°ria e tend√™ncia determin√≠stica nas seguintes caracter√≠sticas:
1. **Modelos de Raiz Unit√°ria:**
   *   Assumem que a n√£o estacionariedade da s√©rie √© causada por inova√ß√µes que t√™m um efeito permanente no n√≠vel da s√©rie.
   *   S√£o representados como $\Delta y_t = \mu + \psi(L)\epsilon_t$, onde o operador $\Delta$ indica que a s√©rie em primeira diferen√ßa √© estacion√°ria, e o n√≠vel da s√©rie possui raiz unit√°ria.
   *   Implicam um comportamento aleat√≥rio para o n√≠vel da s√©rie, o que √© incompat√≠vel com eventos que alteram a trajet√≥ria da s√©rie de forma discreta.

2. **Modelos de Tend√™ncia Determin√≠stica:**
    *   Assumem que a trajet√≥ria da s√©rie segue uma tend√™ncia predeterminada (linear, quadr√°tica, exponencial, etc.), sendo que as inova√ß√µes estoc√°sticas causam varia√ß√µes em torno desta trajet√≥ria.
    *   S√£o representados como $y_t = \alpha + \delta t + \psi(L)\epsilon_t$, onde $\alpha$ e $\delta$ s√£o os par√¢metros da tend√™ncia, e $\psi(L)\epsilon_t$ s√£o as inova√ß√µes.
    *   N√£o incorporam a possibilidade de eventos discretos que causem altera√ß√µes abruptas e permanentes na trajet√≥ria da s√©rie.

3. **Modelos com Quebras Ocasionais na Tend√™ncia:**
   *   Reconhecem que a trajet√≥ria da s√©rie pode ser alterada por eventos raros que causam mudan√ßas discretas e permanentes no n√≠vel da tend√™ncia.
   *   Podem ser representados como um processo de raiz unit√°ria com inova√ß√µes n√£o gaussianas.
   *   Podem ser vistos como modelos intermedi√°rios entre modelos de raiz unit√°ria e de tend√™ncia determin√≠stica.

> Modelos com quebras ocasionais podem ser mais apropriados para s√©ries temporais que s√£o afetadas por eventos econ√¥micos e pol√≠ticos que alteram sua din√¢mica de maneira abrupta, como crises financeiras, reformas econ√¥micas, ou mudan√ßas na legisla√ß√£o.

> üí° **Exemplo Num√©rico:** Considere tr√™s cen√°rios para uma s√©rie temporal que representa o PIB de um pa√≠s:
>
> 1.  **Modelo de Raiz Unit√°ria:** O PIB √© afetado por choques que t√™m efeitos permanentes. Por exemplo, uma inova√ß√£o tecnol√≥gica que melhora a produtividade.
>     *   $\Delta y_t = 0.02 + \epsilon_t$, onde $\epsilon_t \sim N(0, 0.01)$.
>     *   Este modelo indica que o crescimento do PIB $\Delta y_t$ tem uma m√©dia de 2% ao ano e que o n√≠vel do PIB √© afetado por choques aleat√≥rios com efeito permanente.
>
> 2.  **Modelo de Tend√™ncia Determin√≠stica:** O PIB cresce seguindo uma tend√™ncia linear.
>     *   $y_t = 100 + 2t + \epsilon_t$, onde $\epsilon_t \sim N(0, 0.5)$.
>     *   Este modelo indica que o PIB tem um n√≠vel inicial de 100 e um crescimento de 2 unidades por per√≠odo.
>
> 3.  **Modelo com Quebra Ocasional:** O PIB cresce, mas sofre uma quebra devido a uma crise econ√¥mica.
>     *   $y_t = \begin{cases} 100 + 2t + \epsilon_t & \text{se } t < 100 \\ 80 + 2t + \epsilon_t & \text{se } t \geq 100 \end{cases}$, onde $\epsilon_t \sim N(0, 0.5)$.
>     *   Este modelo indica um crescimento do PIB em 2 unidades por per√≠odo, com uma quebra abrupta para 80 em $t=100$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)  # para reprodutibilidade
>
> n_periods = 200
>
> # Modelo de Raiz Unit√°ria
> epsilon_ru = np.random.normal(0, 0.1, n_periods)
> dy_ru = 0.02 + epsilon_ru
> y_ru = np.cumsum(dy_ru)
>
> # Modelo de Tend√™ncia Determin√≠stica
> epsilon_td = np.random.normal(0, 0.5, n_periods)
> t = np.arange(n_periods)
> y_td = 100 + 2*t + epsilon_td
>
> # Modelo com Quebra Ocasional
> epsilon_qo = np.random.normal(0, 0.5, n_periods)
> y_qo = np.zeros(n_periods)
> for i in range(n_periods):
>     if i < 100:
>         y_qo[i] = 100 + 2*i + epsilon_qo[i]
>     else:
>         y_qo[i] = 80 + 2*i + epsilon_qo[i]
>
>
>
> plt.figure(figsize=(12, 6))
> plt.plot(y_ru, label='Raiz Unit√°ria')
> plt.plot(y_td, label='Tend√™ncia Determin√≠stica')
> plt.plot(y_qo, label='Quebra Ocasional')
> plt.xlabel('Tempo (t)')
> plt.ylabel('PIB (y_t)')
> plt.title('Compara√ß√£o de Modelos')
> plt.axvline(x=100, color='r', linestyle='--', label='Quebra em t=100')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> O gr√°fico demonstra como cada modelo captura diferentes caracter√≠sticas da s√©rie temporal. O modelo de raiz unit√°ria mostra um caminho aleat√≥rio (sem tend√™ncia fixa), o modelo de tend√™ncia determin√≠stica mostra uma linha reta, e o modelo com quebra mostra uma mudan√ßa no n√≠vel da s√©rie no tempo $t=100$.

#### An√°lise de Dados com Quebras Ocasionais: A Perspectiva de Raiz Unit√°ria com Inova√ß√µes N√£o Gaussianas

Como vimos no cap√≠tulo anterior, a an√°lise de dados com quebras ocasionais pode ser abordada como um problema de **raiz unit√°ria com inova√ß√µes n√£o gaussianas** [^1]. Isto √©, ap√≥s tomar a primeira diferen√ßa do modelo, temos:
$$\Delta y_t = \mu + \eta_t$$ [15.5.9]
onde $\mu$ representa a mudan√ßa m√©dia por per√≠odo, e $\eta_t$ incorpora os efeitos das quebras e das inova√ß√µes estoc√°sticas.

A principal diferen√ßa entre um modelo de raiz unit√°ria tradicional e um modelo com quebras ocasionais est√° na distribui√ß√£o das inova√ß√µes, $\eta_t$. Em modelos de raiz unit√°ria, assume-se que as inova√ß√µes seguem uma distribui√ß√£o gaussiana. Em modelos com quebras ocasionais, as inova√ß√µes, $\eta_t$, s√£o n√£o gaussianas devido √† presen√ßa do termo $\xi_t$, que representa os choques discretos na tend√™ncia.

Esta formula√ß√£o nos permite caracterizar o processo como um ARIMA(0,1,1) com inova√ß√µes n√£o gaussianas, o que significa que:
*   A s√©rie em primeira diferen√ßa √© modelada como um processo estacion√°rio.
*   O modelo possui depend√™ncia de primeira ordem (MA(1)) devido ao componente $\epsilon_t - \epsilon_{t-1}$ e ao componente $\xi_t$.
*   A distribui√ß√£o dos res√≠duos √© n√£o gaussiana, o que exige o uso de m√©todos de estima√ß√£o e infer√™ncia estat√≠stica apropriados.

> A representa√ß√£o de quebras ocasionais como um processo de raiz unit√°ria com inova√ß√µes n√£o gaussianas destaca que a n√£o estacionariedade √© causada, em parte, por eventos discretos que afetam o n√≠vel da s√©rie, o que √© diferente da hip√≥tese de inova√ß√µes gaussianas com efeito permanente em modelos de raiz unit√°ria tradicionais.

**Lema 1:** *O termo $\eta_t$ em modelos de quebras ocasionais n√£o √© um ru√≠do branco.*

*Proof:*
I. No modelo com quebras ocasionais, $\eta_t$ √© definido como $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$.
II.  Para ser um ru√≠do branco, $\eta_t$ deve ser n√£o autocorrelacionado, ou seja, $Cov(\eta_t, \eta_{t-k}) = 0$ para todo $k \neq 0$.
III. A autocovari√¢ncia de $\eta_t$ em lag $k$ √© dada por $Cov(\eta_t, \eta_{t-k}) = E[(\eta_t - E[\eta_t])(\eta_{t-k} - E[\eta_{t-k}])]$, e como $E[\eta_t] = 0$, $Cov(\eta_t, \eta_{t-k}) = E[\eta_t \eta_{t-k}]$.
IV. Para $k=0$, temos $Cov(\eta_t, \eta_t) = Var(\eta_t)$, que √© diferente de zero.
V. Para $k=1$, temos $Cov(\eta_t, \eta_{t-1}) = E[(\xi_t - p(\alpha_2-\alpha_1) + \epsilon_t-\epsilon_{t-1})(\xi_{t-1} - p(\alpha_2-\alpha_1) + \epsilon_{t-1}-\epsilon_{t-2})] = E[\epsilon_t\epsilon_{t-1} - \epsilon_{t-1}^2-\epsilon_{t}\epsilon_{t-2} +\epsilon_{t-1}\epsilon_{t-2}] = -E[\epsilon_{t-1}^2] = -\sigma_\epsilon^2$, que √© diferente de zero.
VI. Para $k>1$, temos $Cov(\eta_t, \eta_{t-k}) = 0$, pois $\xi_t$ s√£o n√£o autocorrelacionadas e o mesmo vale para $\epsilon_t$.
VII. Portanto, o termo $\eta_t$ n√£o √© um ru√≠do branco, pois possui autocorrela√ß√£o de lag 1.  $\blacksquare$

> üí° **Exemplo Num√©rico:** Vamos considerar o exemplo da produ√ß√£o industrial e a quebra tecnol√≥gica onde $\alpha_1=50$, $\alpha_2=70$, e $\delta=2$, com a quebra ocorrendo no tempo $T_0 = 100$. Vamos supor que as inova√ß√µes $\epsilon_t$ seguem uma distribui√ß√£o normal com m√©dia zero e vari√¢ncia $\sigma^2_\epsilon = 4$, e a probabilidade da quebra √© $p=0.05$.
>
> Calculando os primeiros valores de $\eta_t$ :
>
> Para $t < T_0$: $\eta_t = \epsilon_t - \epsilon_{t-1}$.
>
> Para $t = T_0$: $\eta_t = \xi_{T_0} - p(\alpha_2 - \alpha_1) + \epsilon_{T_0} - \epsilon_{T_0-1} = (70 - 50) - 0.05(70-50) + \epsilon_{T_0} - \epsilon_{T_0-1}= 19 + \epsilon_{T_0} - \epsilon_{T_0-1}$.
>
> Para $t>T_0$: $\eta_t = \epsilon_t - \epsilon_{t-1}$
>
> A distribui√ß√£o de $\eta_t$ para $t=T_0$ n√£o ser√° normal, devido a presen√ßa do choque, $\xi_t$.  Podemos verificar que $\text{Cov}(\eta_t, \eta_{t-1}) = -\sigma^2_{\epsilon} = -4$, ou seja, a s√©rie √© autocorrelacionada. Isso demonstra que $\eta_t$ n√£o √© um ru√≠do branco, pois existe autocorrela√ß√£o de primeira ordem. Al√©m disso, a distribui√ß√£o de $\eta_t$ n√£o √© gaussiana devido ao choque $\xi_t$ na √©poca da quebra.
>
> Para ilustrar a autocorrela√ß√£o de $\eta_t$, podemos gerar uma s√©rie e calcular a autocorrela√ß√£o amostral:
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
>
> np.random.seed(42)
>
> alpha1 = 50
> alpha2 = 70
> delta = 2
> T0 = 100
> p = 0.05
> n_periods = 200
> sigma_epsilon = 2
>
> epsilon = np.random.normal(0, sigma_epsilon, n_periods)
>
>
> eta = np.zeros(n_periods - 1)
> for t in range(n_periods-1):
>     if t == T0-1:
>         eta[t] = (alpha2-alpha1) - p*(alpha2-alpha1) + epsilon[t+1] - epsilon[t]
>     else:
>       eta[t]= epsilon[t+1] - epsilon[t]
>
> def autocorr(x, lag):
>   n = len(x)
>   if lag >= n:
>       return 0
>   x_mean = np.mean(x)
>   covariance = np.mean((x[:n-lag]-x_mean)*(x[lag:]-x_mean))
>   variance = np.var(x)
>   if variance == 0:
>       return 0
>   return covariance / variance
>
> lags = range(10)
> acf = [autocorr(eta, k) for k in lags]
>
> plt.figure(figsize=(8, 4))
> plt.stem(lags, acf, use_line_collection = True)
> plt.title("Fun√ß√£o de Autocorrela√ß√£o Amostral de Œ∑_t")
> plt.xlabel("Lag (k)")
> plt.ylabel("Autocorrela√ß√£o")
> plt.axhline(y=0, color='r', linestyle='--')
> plt.grid(True)
> plt.show()
> print(f"Autocorrela√ß√£o em lag 1: {acf[1]:.4f}")
> ```
> O gr√°fico mostra que a autocorrela√ß√£o √© alta em lag 1 (pr√≥xima de -0.5, conforme esperado) e pr√≥xima de zero para os outros lags. A sa√≠da do console confirma que a autocorrela√ß√£o em lag 1 √© significantemente diferente de zero.

### Implica√ß√µes para a Modelagem e Infer√™ncia

A modelagem de quebras ocasionais na tend√™ncia, com a perspectiva de raiz unit√°ria com inova√ß√µes n√£o gaussianas, implica uma s√©rie de considera√ß√µes importantes para a an√°lise de dados:

1.  **Testes de Raiz Unit√°ria:** Testes de raiz unit√°ria tradicionais, que assumem a normalidade dos res√≠duos, podem n√£o ser apropriados para modelos com quebras ocasionais [^1]. A presen√ßa de quebras pode levar testes tradicionais a rejeitar incorretamente a hip√≥tese nula de n√£o estacionariedade. Testes mais robustos, que n√£o assumam a normalidade dos res√≠duos, devem ser utilizados.

2.  **Estima√ß√£o de Par√¢metros:** M√©todos de estima√ß√£o que levem em considera√ß√£o a n√£o gaussianidade dos res√≠duos devem ser utilizados para a estima√ß√£o de par√¢metros em modelos com quebras ocasionais. M√©todos de m√°xima verossimilhan√ßa com distribui√ß√µes de cauda pesada ou misturas de distribui√ß√µes s√£o algumas alternativas.

3.  **Infer√™ncia Estat√≠stica:** A infer√™ncia sobre os par√¢metros deve ser realizada com cautela, considerando a n√£o gaussianidade dos res√≠duos. M√©todos bayesianos que permitam especificar distribui√ß√µes a priori n√£o gaussianas podem ser √∫teis.

4.  **Previs√£o:** Modelos de previs√£o devem levar em considera√ß√£o a possibilidade de novas quebras no futuro. M√©todos de previs√£o n√£o lineares e que considerem diferentes cen√°rios para a ocorr√™ncia de quebras podem ser apropriados.
5.  **Interpreta√ß√£o Econ√¥mica:** A modelagem de quebras ocasionais permite identificar eventos econ√¥micos e pol√≠ticos que causam mudan√ßas permanentes na trajet√≥ria da s√©rie temporal, o que facilita a interpreta√ß√£o econ√¥mica dos resultados.
6.  **Sele√ß√£o do Modelo:** A escolha entre um modelo de raiz unit√°ria, um modelo de tend√™ncia determin√≠stica ou um modelo com quebras ocasionais depende da natureza dos dados e das quest√µes de pesquisa. A modelagem com quebras ocasionais √© √∫til quando h√° fortes evid√™ncias de eventos que alteram a trajet√≥ria da s√©rie.

**Proposi√ß√£o 1:** *Em modelos de quebras ocasionais, testes de raiz unit√°ria que assumem normalidade das inova√ß√µes podem levar √† rejei√ß√£o incorreta da hip√≥tese nula de n√£o estacionariedade.*

*Proof:*
I.  Testes de raiz unit√°ria, como o teste de Dickey-Fuller, s√£o constru√≠dos sob a suposi√ß√£o de que as inova√ß√µes seguem uma distribui√ß√£o normal.
II.  Em modelos de quebras ocasionais, as inova√ß√µes, $\eta_t$, t√™m distribui√ß√£o n√£o gaussiana devido √† presen√ßa do choque $\xi_t$.
III. A viola√ß√£o da premissa de normalidade pode levar √† rejei√ß√£o da hip√≥tese nula de n√£o estacionariedade, ou seja, a uma conclus√£o err√¥nea de que a s√©rie tem raiz unit√°ria, mesmo quando a s√©rie √© estacion√°ria com quebras.
IV. Portanto, √© necess√°rio utilizar testes de raiz unit√°ria que n√£o assumam a normalidade dos res√≠duos em presen√ßa de quebras ocasionais. $\blacksquare$

> üí° **Exemplo Num√©rico:** Suponha que temos uma s√©rie simulada com uma quebra e vamos aplicar o teste de Dickey-Fuller. Se ignorarmos a quebra e aplicarmos o teste padr√£o, podemos concluir erroneamente que a s√©rie √© estacion√°ria. Vamos simular um exemplo:
>
> ```python
> import numpy as np
> import pandas as pd
> from statsmodels.tsa.stattools import adfuller
>
> np.random.seed(42)
>
> alpha1 = 50
> alpha2 = 70
> delta = 2
> T0 = 100
> n_periods = 200
> sigma_epsilon = 1
>
> epsilon = np.random.normal(0, sigma_epsilon, n_periods)
> y = np.zeros(n_periods)
>
> for t in range(n_periods):
>   if t < T0:
>     y[t] = alpha1 + delta * t + epsilon[t]
>   else:
>     y[t] = alpha2 + delta * t + epsilon[t]
>
> adf_result = adfuller(y)
> print(f"Estat√≠stica ADF: {adf_result[0]:.4f}")
> print(f"p-valor: {adf_result[1]:.4f}")
> print("Valores cr√≠ticos:")
> for key, value in adf_result[4].items():
>     print(f"   {key}: {value:.4f}")
>
> ```
> O resultado do teste de Dickey-Fuller mostrar√° que o p-valor √© menor que 0.05 em alguns casos, o que levaria √† rejei√ß√£o da hip√≥tese nula de raiz unit√°ria, concluindo erroneamente que a s√©rie √© estacion√°ria. No entanto, essa conclus√£o √© err√¥nea porque a s√©rie tem uma quebra estrutural, e o teste de Dickey-Fuller tradicional n√£o leva isso em considera√ß√£o.

**Teorema 1:** *Sob certas condi√ß√µes, a distribui√ß√£o de $\eta_t$ pode ser aproximada por uma mistura de distribui√ß√µes normais, facilitando a estima√ß√£o por m√°xima verossimilhan√ßa.*

*Proof Outline:*
I. A inova√ß√£o $\eta_t$ √© definida como $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$. O termo $\xi_t$ √© um choque discreto que ocorre com probabilidade $p$ em um dado per√≠odo.
II. Se o choque $\xi_t$ for de magnitude constante ($\alpha_2-\alpha_1$) quando ocorre, e $\epsilon_t$ for normalmente distribu√≠do, $\eta_t$ pode ser considerada como uma mistura de duas distribui√ß√µes: uma normal com m√©dia zero e vari√¢ncia $2\sigma_\epsilon^2$ (quando n√£o h√° quebra), e outra normal com m√©dia $\alpha_2 - \alpha_1 - p(\alpha_2 - \alpha_1)$ e vari√¢ncia $2\sigma_\epsilon^2$ (quando h√° quebra), ocorrendo com probabilidades $1-p$ e $p$, respectivamente.
III. Assim, $\eta_t$ pode ser aproximada por uma mistura de distribui√ß√µes normais, com cada componente correspondendo a uma poss√≠vel ocorr√™ncia ou n√£o de uma quebra. A densidade de $\eta_t$ pode ser escrita como $f(\eta_t) = (1-p)\phi(\eta_t; 0, 2\sigma^2_\epsilon) + p\phi(\eta_t; \alpha_2 - \alpha_1 - p(\alpha_2 - \alpha_1), 2\sigma^2_\epsilon)$, onde $\phi(.; \mu, \sigma^2)$ √© a fun√ß√£o de densidade de probabilidade normal com m√©dia $\mu$ e vari√¢ncia $\sigma^2$.
IV. O uso de misturas de normais na modelagem de $\eta_t$ permite usar m√©todos de m√°xima verossimilhan√ßa para estima√ß√£o de par√¢metros, dado que a distribui√ß√£o resultante tem uma forma anal√≠tica.  $\blacksquare$

**Lema 1.1:** *A fun√ß√£o de autocorrela√ß√£o da s√©rie $\Delta y_t$ nos modelos de quebras ocasionais √© n√£o nula apenas para o primeiro lag.*
*Proof:*
I. A s√©rie $\Delta y_t$ √© dada por $\Delta y_t = \mu + \eta_t$, onde $\eta_t = \xi_t - p(\alpha_2-\alpha_1) + \epsilon_t - \epsilon_{t-1}$.
II. A fun√ß√£o de autocorrela√ß√£o de $\Delta y_t$ em lag $k$ √© dada por $Corr(\Delta y_t, \Delta y_{t-k}) = \frac{Cov(\Delta y_t, \Delta y_{t-k})}{ \sqrt{Var(\Delta y_t) Var(\Delta y_{t-k})}}$.
III.  $Cov(\Delta y_t, \Delta y_{t-k}) = Cov(\mu + \eta_t, \mu + \eta_{t-k}) = Cov(\eta_t, \eta_{t-k})$.
IV.  Pelo Lema 1, $Cov(\eta_t, \eta_{t-k}) = 0$ para $k > 1$.
V.  Portanto, a fun√ß√£o de autocorrela√ß√£o de $\Delta y_t$ √© n√£o nula apenas para o primeiro lag.   $\blacksquare$

**Corol√°rio 1.1:** *Modelos de quebras ocasionais com uma √∫nica quebra na tend√™ncia podem ser representados como um processo MA(1) com inova√ß√µes n√£o gaussianas.*
*Proof:*
I.  Como $\Delta y_t = \mu + \eta_t$ e $\eta_t$ √© n√£o autocorrelacionada, exceto no primeiro lag (Lema 1.1), temos que a s√©rie $\Delta y_t$ segue um processo MA(1).
II.  Al√©m disso, como $\eta_t$ possui uma distribui√ß√£o n√£o gaussiana, o processo $\Delta y_t$ √© caracterizado como um MA(1) com inova√ß√µes n√£o gaussianas.   $\blacksquare$

### Conclus√£o

Modelos que incorporam quebras ocasionais na tend√™ncia representam uma abordagem flex√≠vel e poderosa para modelar s√©ries temporais n√£o estacion√°rias que s√£o afetadas por eventos raros com efeitos permanentes. A formula√ß√£o matem√°tica $\Delta y_t = \mu + \eta_t$, a rela√ß√£o com processos de raiz unit√°ria com inova√ß√µes n√£o gaussianas, e o reconhecimento da n√£o normalidade dos res√≠duos s√£o fundamentais para a modelagem e infer√™ncia estat√≠stica adequadas. A escolha de modelos com quebras ocasionais deve ser baseada na natureza dos dados e nas quest√µes de pesquisa, oferecendo uma alternativa para a modelagem da complexa din√¢mica de s√©ries temporais com eventos que alteram sua trajet√≥ria de forma abrupta.

### Refer√™ncias

[^1]: Cap√≠tulo 15 do livro "Time Series Analysis" (informa√ß√µes retiradas de todo o cap√≠tulo).
<!-- END -->
