## Modelagem de Quebras Ocasionais na TendÃªncia: Capturando Efeitos Permanentes em SÃ©ries Temporais

### IntroduÃ§Ã£o

Em continuidade Ã  discussÃ£o sobre modelos de sÃ©ries temporais nÃ£o estacionÃ¡rias, este capÃ­tulo se aprofunda na modelagem de **quebras ocasionais na tendÃªncia**, explorando como esta abordagem pode capturar eventos econÃ´micos com grandes efeitos permanentes, em contraste com a modelagem tradicional de tendÃªncias constantes ou raiz unitÃ¡ria [^1]. Enquanto modelos de raiz unitÃ¡ria assumem que inovaÃ§Ãµes tÃªm um efeito permanente no nÃ­vel da sÃ©rie, e modelos com tendÃªncia determinÃ­stica assumem uma trajetÃ³ria suave, modelos com quebras ocasionais permitem acomodar eventos raros que alteram a trajetÃ³ria da sÃ©rie de forma abrupta [^1]. Este capÃ­tulo explorarÃ¡ como as quebras ocasionais na tendÃªncia sÃ£o modeladas, como elas se diferenciam de modelos de raiz unitÃ¡ria e tendÃªncia, e como a modelagem de quebras ocasionais pode levar a uma compreensÃ£o mais precisa da dinÃ¢mica de sÃ©ries temporais em diversas Ã¡reas.

### Conceitos Fundamentais

#### Modelagem de Quebras Ocasionais na TendÃªncia

Modelos que incorporam quebras ocasionais na tendÃªncia assumem que a trajetÃ³ria de uma sÃ©rie temporal $y_t$ pode ser afetada por eventos discretos, que causam mudanÃ§as abruptas e permanentes no nÃ­vel ou na inclinaÃ§Ã£o da tendÃªncia [^1]. Ao contrÃ¡rio de modelos de tendÃªncia determinÃ­stica, que assumem uma trajetÃ³ria suave, ou de modelos de raiz unitÃ¡ria, que atribuem toda a nÃ£o estacionariedade a inovaÃ§Ãµes, os modelos de quebras ocasionais reconhecem que a trajetÃ³ria da sÃ©rie pode ser alterada por eventos pontuais.

Um modelo simples com uma Ãºnica quebra na tendÃªncia pode ser representado da seguinte forma:
$$
y_t =
\begin{cases}
    \alpha_1 + \delta t + \epsilon_t & \text{para } t < T_0 \\
    \alpha_2 + \delta t + \epsilon_t & \text{para } t \geq T_0
\end{cases}
$$ [15.5.7]

onde:

*   $y_t$ Ã© a sÃ©rie temporal.
*   $t$ Ã© o tempo.
*   $T_0$ Ã© o tempo em que ocorre a quebra.
*   $\alpha_1$ Ã© o nÃ­vel da tendÃªncia antes da quebra.
*   $\alpha_2$ Ã© o nÃ­vel da tendÃªncia apÃ³s a quebra.
*   $\delta$ Ã© a inclinaÃ§Ã£o da tendÃªncia (assumida constante neste modelo).
*   $\epsilon_t$ Ã© um ruÃ­do branco, representando inovaÃ§Ãµes estocÃ¡sticas com mÃ©dia zero e variÃ¢ncia constante.

Este modelo assume que a sÃ©rie segue uma tendÃªncia linear com inclinaÃ§Ã£o $\delta$, mas que no instante $T_0$ ocorre uma mudanÃ§a abrupta no nÃ­vel da sÃ©rie, que passa de $\alpha_1$ para $\alpha_2$.

Uma formulaÃ§Ã£o equivalente pode ser obtida tomando a primeira diferenÃ§a:
$$\Delta y_t = \xi_t + \delta + \epsilon_t - \epsilon_{t-1}$$ [15.5.8]
onde $\Delta y_t = y_t - y_{t-1}$, e $\xi_t = \alpha_2 - \alpha_1$ para $t=T_0$ e $\xi_t=0$ caso contrÃ¡rio. O termo $\xi_t$ representa o impacto da quebra no momento $T_0$.

> A modelagem de quebras ocasionais na tendÃªncia Ã© fundamental para entender a dinÃ¢mica de sÃ©ries temporais em que eventos raros e pontuais, como crises econÃ´micas, mudanÃ§as polÃ­ticas, ou desastres naturais, podem ter um efeito permanente sobre a trajetÃ³ria da sÃ©rie [^1].

> ğŸ’¡ **Exemplo NumÃ©rico:** Vamos considerar um exemplo simples onde uma sÃ©rie temporal representa a produÃ§Ã£o de um setor industrial. Suponha que, antes do tempo $T_0 = 100$, a produÃ§Ã£o se ajusta a uma tendÃªncia linear, mas apÃ³s esse perÃ­odo, devido a uma mudanÃ§a tecnolÃ³gica, o nÃ­vel de produÃ§Ã£o se ajusta a uma nova trajetÃ³ria, com a mesma inclinaÃ§Ã£o. A seguir, estÃ£o os parÃ¢metros do modelo:
>
> *   $\alpha_1 = 50$ (nÃ­vel inicial da produÃ§Ã£o)
> *   $\alpha_2 = 70$ (nÃ­vel da produÃ§Ã£o apÃ³s a mudanÃ§a tecnolÃ³gica)
> *   $\delta = 2$ (crescimento anual da produÃ§Ã£o)
>
> Nesse exemplo, o nÃ­vel da produÃ§Ã£o aumentaria em 20 unidades no tempo da mudanÃ§a. A representaÃ§Ã£o $\Delta y_t = \xi_t + \delta + \epsilon_t - \epsilon_{t-1}$ demonstra como a variaÃ§Ã£o da produÃ§Ã£o se ajusta a uma tendÃªncia de crescimento, com um choque no momento $T_0$.
>
> Em termos da formulaÃ§Ã£o $\Delta y_t = \mu + \eta_t$, temos que $\mu = p(\alpha_2-\alpha_1) + \delta$ e $\eta_t = \xi_t - p(\alpha_2-\alpha_1) + \epsilon_t - \epsilon_{t-1}$.  Em que $\xi_t$ Ã© $\alpha_2 - \alpha_1$ no tempo da quebra e zero caso contrÃ¡rio. Caso a probabilidade da quebra em cada perÃ­odo seja $p=0.02$,  e $\delta=2$, entÃ£o a mudanÃ§a mÃ©dia por perÃ­odo seria $\mu = 0.02\times(70-50)+2 = 2.4$, que Ã© a soma do crescimento e da probabilidade da quebra. O desvio $\eta_t$ representa a variaÃ§Ã£o ao redor da mÃ©dia.
>
> Vamos simular alguns valores para ilustrar. Considere que $\epsilon_t$ segue uma distribuiÃ§Ã£o normal com mÃ©dia 0 e desvio padrÃ£o 1, e que a quebra acontece em $t=100$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)  # para reprodutibilidade
>
> alpha1 = 50
> alpha2 = 70
> delta = 2
> T0 = 100
> p = 0.02
> n_periods = 200
>
> epsilon = np.random.normal(0, 1, n_periods)
> y = np.zeros(n_periods)
>
> for t in range(n_periods):
>   if t < T0:
>     y[t] = alpha1 + delta * t + epsilon[t]
>   else:
>     y[t] = alpha2 + delta * t + epsilon[t]
>
> dy = np.diff(y)
> xi = np.zeros(n_periods-1)
> xi[T0-1]= alpha2-alpha1
> eta = xi - p*(alpha2-alpha1) + epsilon[1:] - epsilon[:-1]
>
>
> t_values = np.arange(1, n_periods)
>
> plt.figure(figsize=(12, 6))
> plt.plot(t_values,dy, label='Î”y_t')
> plt.xlabel('Tempo (t)')
> plt.ylabel('VariaÃ§Ã£o da ProduÃ§Ã£o (Î”y_t)')
> plt.title('SimulaÃ§Ã£o da SÃ©rie Temporal com Quebra')
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra em T0=100')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> plt.figure(figsize=(12, 6))
> plt.plot(t_values, eta, label='Î·_t')
> plt.xlabel('Tempo (t)')
> plt.ylabel('InovaÃ§Ãµes (Î·_t)')
> plt.title('InovaÃ§Ãµes nÃ£o Gaussianas Î·_t')
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra em T0=100')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Observa-se no grÃ¡fico da variaÃ§Ã£o da produÃ§Ã£o ($\Delta y_t$) um comportamento aproximadamente constante (devido ao $\delta=2$ ser constante) e uma mudanÃ§a abrupta em $t=100$ devido Ã  quebra. No grÃ¡fico de $\eta_t$ observamos um choque grande em $t=100$ (o pico na linha vertical) e ruÃ­do aleatÃ³rio ao redor de 0 em outros perÃ­odos. Este choque Ã© a diferenÃ§a entre o novo nÃ­vel da produÃ§Ã£o e o nÃ­vel anterior da produÃ§Ã£o corrigido pela probabilidade de quebra, mais o ruÃ­do aleatÃ³rio.

#### ComparaÃ§Ã£o com Modelos de Raiz UnitÃ¡ria e TendÃªncia DeterminÃ­stica

Modelos com quebras ocasionais na tendÃªncia se diferenciam dos modelos de raiz unitÃ¡ria e tendÃªncia determinÃ­stica nas seguintes caracterÃ­sticas:
1. **Modelos de Raiz UnitÃ¡ria:**
   *   Assumem que a nÃ£o estacionariedade da sÃ©rie Ã© causada por inovaÃ§Ãµes que tÃªm um efeito permanente no nÃ­vel da sÃ©rie.
   *   SÃ£o representados como $\Delta y_t = \mu + \psi(L)\epsilon_t$, onde o operador $\Delta$ indica que a sÃ©rie em primeira diferenÃ§a Ã© estacionÃ¡ria, e o nÃ­vel da sÃ©rie possui raiz unitÃ¡ria.
   *   Implicam um comportamento aleatÃ³rio para o nÃ­vel da sÃ©rie, o que Ã© incompatÃ­vel com eventos que alteram a trajetÃ³ria da sÃ©rie de forma discreta.

2. **Modelos de TendÃªncia DeterminÃ­stica:**
    *   Assumem que a trajetÃ³ria da sÃ©rie segue uma tendÃªncia predeterminada (linear, quadrÃ¡tica, exponencial, etc.), sendo que as inovaÃ§Ãµes estocÃ¡sticas causam variaÃ§Ãµes em torno desta trajetÃ³ria.
    *   SÃ£o representados como $y_t = \alpha + \delta t + \psi(L)\epsilon_t$, onde $\alpha$ e $\delta$ sÃ£o os parÃ¢metros da tendÃªncia, e $\psi(L)\epsilon_t$ sÃ£o as inovaÃ§Ãµes.
    *   NÃ£o incorporam a possibilidade de eventos discretos que causem alteraÃ§Ãµes abruptas e permanentes na trajetÃ³ria da sÃ©rie.

3. **Modelos com Quebras Ocasionais na TendÃªncia:**
   *   Reconhecem que a trajetÃ³ria da sÃ©rie pode ser alterada por eventos raros que causam mudanÃ§as discretas e permanentes no nÃ­vel da tendÃªncia.
   *   Podem ser representados como um processo de raiz unitÃ¡ria com inovaÃ§Ãµes nÃ£o gaussianas.
   *   Podem ser vistos como modelos intermediÃ¡rios entre modelos de raiz unitÃ¡ria e de tendÃªncia determinÃ­stica.

> Modelos com quebras ocasionais podem ser mais apropriados para sÃ©ries temporais que sÃ£o afetadas por eventos econÃ´micos e polÃ­ticos que alteram sua dinÃ¢mica de maneira abrupta, como crises financeiras, reformas econÃ´micas, ou mudanÃ§as na legislaÃ§Ã£o.

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere trÃªs cenÃ¡rios para uma sÃ©rie temporal que representa o PIB de um paÃ­s:
>
> 1.  **Modelo de Raiz UnitÃ¡ria:** O PIB Ã© afetado por choques que tÃªm efeitos permanentes. Por exemplo, uma inovaÃ§Ã£o tecnolÃ³gica que melhora a produtividade.
>     *   $\Delta y_t = 0.02 + \epsilon_t$, onde $\epsilon_t \sim N(0, 0.01)$.
>     *   Este modelo indica que o crescimento do PIB $\Delta y_t$ tem uma mÃ©dia de 2% ao ano e que o nÃ­vel do PIB Ã© afetado por choques aleatÃ³rios com efeito permanente.
>
> 2.  **Modelo de TendÃªncia DeterminÃ­stica:** O PIB cresce seguindo uma tendÃªncia linear.
>     *   $y_t = 100 + 2t + \epsilon_t$, onde $\epsilon_t \sim N(0, 0.5)$.
>     *   Este modelo indica que o PIB tem um nÃ­vel inicial de 100 e um crescimento de 2 unidades por perÃ­odo.
>
> 3.  **Modelo com Quebra Ocasional:** O PIB cresce, mas sofre uma quebra devido a uma crise econÃ´mica.
>     *   $y_t = \begin{cases} 100 + 2t + \epsilon_t & \text{se } t < 100 \\ 80 + 2t + \epsilon_t & \text{se } t \geq 100 \end{cases}$, onde $\epsilon_t \sim N(0, 0.5)$.
>     *   Este modelo indica um crescimento do PIB em 2 unidades por perÃ­odo, com uma quebra abrupta para 80 em $t=100$.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)  # para reprodutibilidade
>
> n_periods = 200
>
> # Modelo de Raiz UnitÃ¡ria
> epsilon_ru = np.random.normal(0, 0.1, n_periods)
> dy_ru = 0.02 + epsilon_ru
> y_ru = np.cumsum(dy_ru)
>
> # Modelo de TendÃªncia DeterminÃ­stica
> epsilon_td = np.random.normal(0, 0.5, n_periods)
> t = np.arange(n_periods)
> y_td = 100 + 2*t + epsilon_td
>
> # Modelo com Quebra Ocasional
> epsilon_qo = np.random.normal(0, 0.5, n_periods)
> y_qo = np.zeros(n_periods)
> for i in range(n_periods):
>     if i < 100:
>         y_qo[i] = 100 + 2*i + epsilon_qo[i]
>     else:
>         y_qo[i] = 80 + 2*i + epsilon_qo[i]
>
>
>
> plt.figure(figsize=(12, 6))
> plt.plot(y_ru, label='Raiz UnitÃ¡ria')
> plt.plot(y_td, label='TendÃªncia DeterminÃ­stica')
> plt.plot(y_qo, label='Quebra Ocasional')
> plt.xlabel('Tempo (t)')
> plt.ylabel('PIB (y_t)')
> plt.title('ComparaÃ§Ã£o de Modelos')
> plt.axvline(x=100, color='r', linestyle='--', label='Quebra em t=100')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> O grÃ¡fico demonstra como cada modelo captura diferentes caracterÃ­sticas da sÃ©rie temporal. O modelo de raiz unitÃ¡ria mostra um caminho aleatÃ³rio (sem tendÃªncia fixa), o modelo de tendÃªncia determinÃ­stica mostra uma linha reta, e o modelo com quebra mostra uma mudanÃ§a no nÃ­vel da sÃ©rie no tempo $t=100$.

#### AnÃ¡lise de Dados com Quebras Ocasionais: A Perspectiva de Raiz UnitÃ¡ria com InovaÃ§Ãµes NÃ£o Gaussianas

Como vimos no capÃ­tulo anterior, a anÃ¡lise de dados com quebras ocasionais pode ser abordada como um problema de **raiz unitÃ¡ria com inovaÃ§Ãµes nÃ£o gaussianas** [^1]. Isto Ã©, apÃ³s tomar a primeira diferenÃ§a do modelo, temos:
$$\Delta y_t = \mu + \eta_t$$ [15.5.9]
onde $\mu$ representa a mudanÃ§a mÃ©dia por perÃ­odo, e $\eta_t$ incorpora os efeitos das quebras e das inovaÃ§Ãµes estocÃ¡sticas.

A principal diferenÃ§a entre um modelo de raiz unitÃ¡ria tradicional e um modelo com quebras ocasionais estÃ¡ na distribuiÃ§Ã£o das inovaÃ§Ãµes, $\eta_t$. Em modelos de raiz unitÃ¡ria, assume-se que as inovaÃ§Ãµes seguem uma distribuiÃ§Ã£o gaussiana. Em modelos com quebras ocasionais, as inovaÃ§Ãµes, $\eta_t$, sÃ£o nÃ£o gaussianas devido Ã  presenÃ§a do termo $\xi_t$, que representa os choques discretos na tendÃªncia.

Esta formulaÃ§Ã£o nos permite caracterizar o processo como um ARIMA(0,1,1) com inovaÃ§Ãµes nÃ£o gaussianas, o que significa que:
*   A sÃ©rie em primeira diferenÃ§a Ã© modelada como um processo estacionÃ¡rio.
*   O modelo possui dependÃªncia de primeira ordem (MA(1)) devido ao componente $\epsilon_t - \epsilon_{t-1}$ e ao componente $\xi_t$.
*   A distribuiÃ§Ã£o dos resÃ­duos Ã© nÃ£o gaussiana, o que exige o uso de mÃ©todos de estimaÃ§Ã£o e inferÃªncia estatÃ­stica apropriados.

> A representaÃ§Ã£o de quebras ocasionais como um processo de raiz unitÃ¡ria com inovaÃ§Ãµes nÃ£o gaussianas destaca que a nÃ£o estacionariedade Ã© causada, em parte, por eventos discretos que afetam o nÃ­vel da sÃ©rie, o que Ã© diferente da hipÃ³tese de inovaÃ§Ãµes gaussianas com efeito permanente em modelos de raiz unitÃ¡ria tradicionais.

**Lema 1:** *O termo $\eta_t$ em modelos de quebras ocasionais nÃ£o Ã© um ruÃ­do branco.*

*Proof:*
I. No modelo com quebras ocasionais, $\eta_t$ Ã© definido como $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$.
II.  Para ser um ruÃ­do branco, $\eta_t$ deve ser nÃ£o autocorrelacionado, ou seja, $Cov(\eta_t, \eta_{t-k}) = 0$ para todo $k \neq 0$.
III. A autocovariÃ¢ncia de $\eta_t$ em lag $k$ Ã© dada por $Cov(\eta_t, \eta_{t-k}) = E[(\eta_t - E[\eta_t])(\eta_{t-k} - E[\eta_{t-k}])]$, e como $E[\eta_t] = 0$, $Cov(\eta_t, \eta_{t-k}) = E[\eta_t \eta_{t-k}]$.
IV. Para $k=0$, temos $Cov(\eta_t, \eta_t) = Var(\eta_t)$, que Ã© diferente de zero.
V. Para $k=1$, temos $Cov(\eta_t, \eta_{t-1}) = E[(\xi_t - p(\alpha_2-\alpha_1) + \epsilon_t-\epsilon_{t-1})(\xi_{t-1} - p(\alpha_2-\alpha_1) + \epsilon_{t-1}-\epsilon_{t-2})] = E[\epsilon_t\epsilon_{t-1} - \epsilon_{t-1}^2-\epsilon_{t}\epsilon_{t-2} +\epsilon_{t-1}\epsilon_{t-2}] = -E[\epsilon_{t-1}^2] = -\sigma_\epsilon^2$, que Ã© diferente de zero.
VI. Para $k>1$, temos $Cov(\eta_t, \eta_{t-k}) = 0$, pois $\xi_t$ sÃ£o nÃ£o autocorrelacionadas e o mesmo vale para $\epsilon_t$.
VII. Portanto, o termo $\eta_t$ nÃ£o Ã© um ruÃ­do branco, pois possui autocorrelaÃ§Ã£o de lag 1.  $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Vamos considerar o exemplo da produÃ§Ã£o industrial e a quebra tecnolÃ³gica onde $\alpha_1=50$, $\alpha_2=70$, e $\delta=2$, com a quebra ocorrendo no tempo $T_0 = 100$. Vamos supor que as inovaÃ§Ãµes $\epsilon_t$ seguem uma distribuiÃ§Ã£o normal com mÃ©dia zero e variÃ¢ncia $\sigma^2_\epsilon = 4$, e a probabilidade da quebra Ã© $p=0.05$.
>
> Calculando os primeiros valores de $\eta_t$ :
>
> Para $t < T_0$: $\eta_t = \epsilon_t - \epsilon_{t-1}$.
>
> Para $t = T_0$: $\eta_t = \xi_{T_0} - p(\alpha_2 - \alpha_1) + \epsilon_{T_0} - \epsilon_{T_0-1} = (70 - 50) - 0.05(70-50) + \epsilon_{T_0} - \epsilon_{T_0-1}= 19 + \epsilon_{T_0} - \epsilon_{T_0-1}$.
>
> Para $t>T_0$: $\eta_t = \epsilon_t - \epsilon_{t-1}$
>
> A distribuiÃ§Ã£o de $\eta_t$ para $t=T_0$ nÃ£o serÃ¡ normal, devido a presenÃ§a do choque, $\xi_t$.  Podemos verificar que $\text{Cov}(\eta_t, \eta_{t-1}) = -\sigma^2_{\epsilon} = -4$, ou seja, a sÃ©rie Ã© autocorrelacionada. Isso demonstra que $\eta_t$ nÃ£o Ã© um ruÃ­do branco, pois existe autocorrelaÃ§Ã£o de primeira ordem. AlÃ©m disso, a distribuiÃ§Ã£o de $\eta_t$ nÃ£o Ã© gaussiana devido ao choque $\xi_t$ na Ã©poca da quebra.
>
> Para ilustrar a autocorrelaÃ§Ã£o de $\eta_t$, podemos gerar uma sÃ©rie e calcular a autocorrelaÃ§Ã£o amostral:
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
>
> np.random.seed(42)
>
> alpha1 = 50
> alpha2 = 70
> delta = 2
> T0 = 100
> p = 0.05
> n_periods = 200
> sigma_epsilon = 2
>
> epsilon = np.random.normal(0, sigma_epsilon, n_periods)
>
>
> eta = np.zeros(n_periods - 1)
> for t in range(n_periods-1):
>     if t == T0-1:
>         eta[t] = (alpha2-alpha1) - p*(alpha2-alpha1) + epsilon[t+1] - epsilon[t]
>     else:
>       eta[t]= epsilon[t+1] - epsilon[t]
>
> def autocorr(x, lag):
>   n = len(x)
>   if lag >= n:
>       return 0
>   x_mean = np.mean(x)
>   covariance = np.mean((x[:n-lag]-x_mean)*(x[lag:]-x_mean))
>   variance = np.var(x)
>   if variance == 0:
>       return 0
>   return covariance / variance
>
> lags = range(10)
> acf = [autocorr(eta, k) for k in lags]
>
> plt.figure(figsize=(8, 4))
> plt.stem(lags, acf, use_line_collection = True)
> plt.title("FunÃ§Ã£o de AutocorrelaÃ§Ã£o Amostral de Î·_t")
> plt.xlabel("Lag (k)")
> plt.ylabel("AutocorrelaÃ§Ã£o")
> plt.axhline(y=0, color='r', linestyle='--')
> plt.grid(True)
> plt.show()
> print(f"AutocorrelaÃ§Ã£o em lag 1: {acf[1]:.4f}")
> ```
> O grÃ¡fico mostra que a autocorrelaÃ§Ã£o Ã© alta em lag 1 (prÃ³xima de -0.5, conforme esperado) e prÃ³xima de zero para os outros lags. A saÃ­da do console confirma que a autocorrelaÃ§Ã£o em lag 1 Ã© significantemente diferente de zero.

### ImplicaÃ§Ãµes para a Modelagem e InferÃªncia

A modelagem de quebras ocasionais na tendÃªncia, com a perspectiva de raiz unitÃ¡ria com inovaÃ§Ãµes nÃ£o gaussianas, implica uma sÃ©rie de consideraÃ§Ãµes importantes para a anÃ¡lise de dados:

1.  **Testes de Raiz UnitÃ¡ria:** Testes de raiz unitÃ¡ria tradicionais, que assumem a normalidade dos resÃ­duos, podem nÃ£o ser apropriados para modelos com quebras ocasionais [^1]. A presenÃ§a de quebras pode levar testes tradicionais a rejeitar incorretamente a hipÃ³tese nula de nÃ£o estacionariedade. Testes mais robustos, que nÃ£o assumam a normalidade dos resÃ­duos, devem ser utilizados.

2.  **EstimaÃ§Ã£o de ParÃ¢metros:** MÃ©todos de estimaÃ§Ã£o que levem em consideraÃ§Ã£o a nÃ£o gaussianidade dos resÃ­duos devem ser utilizados para a estimaÃ§Ã£o de parÃ¢metros em modelos com quebras ocasionais. MÃ©todos de mÃ¡xima verossimilhanÃ§a com distribuiÃ§Ãµes de cauda pesada ou misturas de distribuiÃ§Ãµes sÃ£o algumas alternativas.

3.  **InferÃªncia EstatÃ­stica:** A inferÃªncia sobre os parÃ¢metros deve ser realizada com cautela, considerando a nÃ£o gaussianidade dos resÃ­duos. MÃ©todos bayesianos que permitam especificar distribuiÃ§Ãµes a priori nÃ£o gaussianas podem ser Ãºteis.

4.  **PrevisÃ£o:** Modelos de previsÃ£o devem levar em consideraÃ§Ã£o a possibilidade de novas quebras no futuro. MÃ©todos de previsÃ£o nÃ£o lineares e que considerem diferentes cenÃ¡rios para a ocorrÃªncia de quebras podem ser apropriados.
5.  **InterpretaÃ§Ã£o EconÃ´mica:** A modelagem de quebras ocasionais permite identificar eventos econÃ´micos e polÃ­ticos que causam mudanÃ§as permanentes na trajetÃ³ria da sÃ©rie temporal, o que facilita a interpretaÃ§Ã£o econÃ´mica dos resultados.
6.  **SeleÃ§Ã£o do Modelo:** A escolha entre um modelo de raiz unitÃ¡ria, um modelo de tendÃªncia determinÃ­stica ou um modelo com quebras ocasionais depende da natureza dos dados e das questÃµes de pesquisa. A modelagem com quebras ocasionais Ã© Ãºtil quando hÃ¡ fortes evidÃªncias de eventos que alteram a trajetÃ³ria da sÃ©rie.

**ProposiÃ§Ã£o 1:** *Em modelos de quebras ocasionais, testes de raiz unitÃ¡ria que assumem normalidade das inovaÃ§Ãµes podem levar Ã  rejeiÃ§Ã£o incorreta da hipÃ³tese nula de nÃ£o estacionariedade.*

*Proof:*
I.  Testes de raiz unitÃ¡ria, como o teste de Dickey-Fuller, sÃ£o construÃ­dos sob a suposiÃ§Ã£o de que as inovaÃ§Ãµes seguem uma distribuiÃ§Ã£o normal.
II.  Em modelos de quebras ocasionais, as inovaÃ§Ãµes, $\eta_t$, tÃªm distribuiÃ§Ã£o nÃ£o gaussiana devido Ã  presenÃ§a do choque $\xi_t$.
III. A violaÃ§Ã£o da premissa de normalidade pode levar Ã  rejeiÃ§Ã£o da hipÃ³tese nula de nÃ£o estacionariedade, ou seja, a uma conclusÃ£o errÃ´nea de que a sÃ©rie tem raiz unitÃ¡ria, mesmo quando a sÃ©rie Ã© estacionÃ¡ria com quebras.
IV. Portanto, Ã© necessÃ¡rio utilizar testes de raiz unitÃ¡ria que nÃ£o assumam a normalidade dos resÃ­duos em presenÃ§a de quebras ocasionais. $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:** Suponha que temos uma sÃ©rie simulada com uma quebra e vamos aplicar o teste de Dickey-Fuller. Se ignorarmos a quebra e aplicarmos o teste padrÃ£o, podemos concluir erroneamente que a sÃ©rie Ã© estacionÃ¡ria. Vamos simular um exemplo:
>
> ```python
> import numpy as np
> import pandas as pd
> from statsmodels.tsa.stattools import adfuller
>
> np.random.seed(42)
>
> alpha1 = 50
> alpha2 = 70
> delta = 2
> T0 = 100
> n_periods = 200
> sigma_epsilon = 1
>
> epsilon = np.random.normal(0, sigma_epsilon, n_periods)
> y = np.zeros(n_periods)
>
> for t in range(n_periods):
>   if t < T0:
>     y[t] = alpha1 + delta * t + epsilon[t]
>   else:
>     y[t] = alpha2 + delta * t + epsilon[t]
>
> adf_result = adfuller(y)
> print(f"EstatÃ­stica ADF: {adf_result[0]:.4f}")
> print(f"p-valor: {adf_result[1]:.4f}")
> print("Valores crÃ­ticos:")
> for key, value in adf_result[4].items():
>     print(f"   {key}: {value:.4f}")
>
> ```
> O resultado do teste de Dickey-Fuller mostrarÃ¡ que o p-valor Ã© menor que 0.05 em alguns casos, o que levaria Ã  rejeiÃ§Ã£o da hipÃ³tese nula de raiz unitÃ¡ria, concluindo erroneamente que a sÃ©rie Ã© estacionÃ¡ria. No entanto, essa conclusÃ£o Ã© errÃ´nea porque a sÃ©rie tem uma quebra estrutural, e o teste de Dickey-Fuller tradicional nÃ£o leva isso em consideraÃ§Ã£o.

**Teorema 1:** *Sob certas condiÃ§Ãµes, a distribuiÃ§Ã£o de $\eta_t$ pode ser aproximada por uma mistura de distribuiÃ§Ãµes normais, facilitando a estimaÃ§Ã£o por mÃ¡xima verossimilhanÃ§a.*

*Proof Outline:*
I. A inovaÃ§Ã£o $\eta_t$ Ã© definida como $\eta_t = \xi_t - p(\alpha_2 - \alpha_1) + \epsilon_t - \epsilon_{t-1}$. O termo $\xi_t$ Ã© um choque discreto que ocorre com probabilidade $p$ em um dado perÃ­odo.
II. Se o choque $\xi_t$ for de magnitude constante ($\alpha_2-\alpha_1$) quando ocorre, e $\epsilon_t$ for normalmente distribuÃ­do, $\eta_t$ pode ser considerada como uma mistura de duas distribuiÃ§Ãµes: uma normal com mÃ©dia zero e variÃ¢ncia $2\sigma_\epsilon^2$ (quando nÃ£o hÃ¡ quebra), e outra normal com mÃ©dia $\alpha_2 - \alpha_1 - p(\alpha_2 - \alpha_1)$ e variÃ¢ncia $2\sigma_\epsilon^2$ (quando hÃ¡ quebra), ocorrendo com probabilidades $1-p$ e $p$, respectivamente.
III. Assim, $\eta_t$ pode ser aproximada por uma mistura de distribuiÃ§Ãµes normais, com cada componente correspondendo a uma possÃ­vel ocorrÃªncia ou nÃ£o de uma quebra. A densidade de $\eta_t$ pode ser escrita como $f(\eta_t) = (1-p)\phi(\eta_t; 0, 2\sigma^2_\epsilon) + p\phi(\eta_t; \alpha_2 - \alpha_1 - p(\alpha_2 - \alpha_1), 2\sigma^2_\epsilon)$, onde $\phi(.; \mu, \sigma^2)$ Ã© a funÃ§Ã£o de densidade de probabilidade normal com mÃ©dia $\mu$ e variÃ¢ncia $\sigma^2$.
IV. O uso de misturas de normais na modelagem de $\eta_t$ permite usar mÃ©todos de mÃ¡xima verossimilhanÃ§a para estimaÃ§Ã£o de parÃ¢metros, dado que a distribuiÃ§Ã£o resultante tem uma forma analÃ­tica.  $\blacksquare$

**Lema 1.1:** *A funÃ§Ã£o de autocorrelaÃ§Ã£o da sÃ©rie $\Delta y_t$ nos modelos de quebras ocasionais Ã© nÃ£o nula apenas para o primeiro lag.*
*Proof:*
I. A sÃ©rie $\Delta y_t$ Ã© dada por $\Delta y_t = \mu + \eta_t$, onde $\eta_t = \xi_t - p(\alpha_2-\alpha_1) + \epsilon_t - \epsilon_{t-1}$.
II. A funÃ§Ã£o de autocorrelaÃ§Ã£o de $\Delta y_t$ em lag $k$ Ã© dada por $Corr(\Delta y_t, \Delta y_{t-k}) = \frac{Cov(\Delta y_t, \Delta y_{t-k})}{ \sqrt{Var(\Delta y_t) Var(\Delta y_{t-k})}}$.
III.  $Cov(\Delta y_t, \Delta y_{t-k}) = Cov(\mu + \eta_t, \mu + \eta_{t-k}) = Cov(\eta_t, \eta_{t-k})$.
IV.  Pelo Lema 1, $Cov(\eta_t, \eta_{t-k}) = 0$ para $k > 1$.
V.  Portanto, a funÃ§Ã£o de autocorrelaÃ§Ã£o de $\Delta y_t$ Ã© nÃ£o nula apenas para o primeiro lag.   $\blacksquare$

**CorolÃ¡rio 1.1:** *Modelos de quebras ocasionais com uma Ãºnica quebra na tendÃªncia podem ser representados como um processo MA(1) com inovaÃ§Ãµes nÃ£o gaussianas.*
*Proof:*
I.  Como $\Delta y_t = \mu + \eta_t$ e $\eta_t$ Ã© nÃ£o autocorrelacionada, exceto no primeiro lag (Lema 1.1), temos que a sÃ©rie $\Delta y_t$ segue um processo MA(1).
II.  AlÃ©m disso, como $\eta_t$ possui uma distribuiÃ§Ã£o nÃ£o gaussiana, o processo $\Delta y_t$ Ã© caracterizado como um MA(1) com inovaÃ§Ãµes nÃ£o gaussianas.   $\blacksquare$

### ConclusÃ£o

Modelos que incorporam quebras ocasionais na tendÃªncia representam uma abordagem flexÃ­vel e poderosa para modelar sÃ©ries temporais nÃ£o estacionÃ¡rias que sÃ£o afetadas por eventos raros com efeitos permanentes. A formulaÃ§Ã£o matemÃ¡tica $\Delta y_t = \mu + \eta_t$, a relaÃ§Ã£o com processos de raiz unitÃ¡ria com inovaÃ§Ãµes nÃ£o gaussianas, e o reconhecimento da nÃ£o normalidade dos resÃ­duos sÃ£o fundamentais para a modelagem e inferÃªncia estatÃ­stica adequadas. A escolha de modelos com quebras ocasionais deve ser baseada na natureza dos dados e nas questÃµes de pesquisa, oferecendo uma alternativa para a modelagem da complexa dinÃ¢mica de sÃ©ries temporais com eventos que alteram sua trajetÃ³ria de forma abrupta.

### ReferÃªncias

[^1]: CapÃ­tulo 15 do livro "Time Series Analysis" (informaÃ§Ãµes retiradas de todo o capÃ­tulo).
<!-- END -->
