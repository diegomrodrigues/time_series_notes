## Modelagem de Quebras Ocasionais na TendÃªncia com VariÃ¡veis Dummy e ImplicaÃ§Ãµes para Testes de Raiz UnitÃ¡ria

### IntroduÃ§Ã£o

Em continuidade Ã  discussÃ£o sobre modelos para sÃ©ries temporais nÃ£o estacionÃ¡rias, este capÃ­tulo se aprofunda na modelagem de **quebras ocasionais na tendÃªncia utilizando variÃ¡veis dummy**, explorando como esta tÃ©cnica permite representar mudanÃ§as no intercepto ou na inclinaÃ§Ã£o da tendÃªncia. Como vimos em capÃ­tulos anteriores [^1], a presenÃ§a de quebras estruturais pode levar a resultados enganosos em testes de raiz unitÃ¡ria tradicionais, e por isso a modelagem explÃ­cita de quebras utilizando variÃ¡veis dummy permite obter estimativas mais precisas e inferÃªncias estatÃ­sticas mais confiÃ¡veis. Este capÃ­tulo abordarÃ¡ como incorporar variÃ¡veis dummy em modelos de quebras ocasionais, como interpretar seus coeficientes, e como essa modelagem afeta os testes de raiz unitÃ¡ria, construindo sobre o conhecimento jÃ¡ apresentado nos capÃ­tulos anteriores.

### Conceitos Fundamentais

#### Modelagem de Quebras na TendÃªncia com VariÃ¡veis Dummy

A modelagem de quebras ocasionais na tendÃªncia utilizando variÃ¡veis dummy Ã© uma abordagem flexÃ­vel que permite representar mudanÃ§as discretas no intercepto ou na inclinaÃ§Ã£o da tendÃªncia, ou em ambos, em diferentes pontos no tempo. Uma variÃ¡vel dummy Ã© uma variÃ¡vel binÃ¡ria que assume o valor 1 se um determinado evento ocorre, e 0 caso contrÃ¡rio. Em modelos de quebra de tendÃªncia, as variÃ¡veis dummy sÃ£o usadas para indicar o momento em que ocorre uma mudanÃ§a na tendÃªncia.

Um modelo com uma Ãºnica quebra no intercepto da tendÃªncia no tempo $T_0$ pode ser representado como:
$$y_t = \alpha + \delta t + \beta D_t + \epsilon_t$$
onde:
*   $y_t$ Ã© a sÃ©rie temporal.
*   $t$ Ã© o tempo.
*   $\alpha$ Ã© o intercepto da tendÃªncia antes da quebra.
*   $\delta$ Ã© a inclinaÃ§Ã£o da tendÃªncia (assumida constante neste modelo).
*   $\beta$ Ã© o coeficiente que representa a mudanÃ§a no intercepto da tendÃªncia no momento da quebra.
*   $D_t$ Ã© uma variÃ¡vel dummy que assume o valor 1 para $t \geq T_0$ e 0 para $t < T_0$.
*   $\epsilon_t$ Ã© o termo de erro, assumido como um ruÃ­do branco com mÃ©dia zero e variÃ¢ncia constante.

Nesse modelo, a sÃ©rie temporal segue uma tendÃªncia linear com intercepto $\alpha$ e inclinaÃ§Ã£o $\delta$ atÃ© o tempo $T_0$, quando ocorre uma mudanÃ§a abrupta no intercepto da tendÃªncia, que passa a ser $\alpha + \beta$. O coeficiente $\beta$ representa a magnitude da mudanÃ§a no intercepto.

> ğŸ’¡ **Exemplo NumÃ©rico:**
> Imagine que vocÃª estÃ¡ modelando o preÃ§o mÃ©dio de uma aÃ§Ã£o ao longo do tempo. Suponha que antes do tempo $T_0 = 50$, o preÃ§o da aÃ§Ã£o estava em torno de $\alpha = 10$ e aumentava a uma taxa de $\delta = 0.2$ por perÃ­odo. No tempo $T_0 = 50$, houve um anÃºncio de um novo produto da empresa, que fez com que o preÃ§o da aÃ§Ã£o desse um salto. O novo intercepto da tendÃªncia apÃ³s o anÃºncio Ã© $\alpha + \beta = 15$, o que significa que $\beta=5$. O modelo seria entÃ£o:
> $$y_t = 10 + 0.2t + 5D_t + \epsilon_t$$
>  onde $D_t=0$ para $t < 50$ e $D_t=1$ para $t\geq 50$.
>
>  O coeficiente $\beta = 5$ representa o salto no preÃ§o da aÃ§Ã£o causado pelo anÃºncio do novo produto.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros
> alpha = 10
> delta = 0.2
> beta = 5
> T0 = 50
> n = 100
> sigma_epsilon = 1
>
> # SimulaÃ§Ã£o de ruÃ­do branco
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # VariÃ¡vel dummy
> D = np.zeros(n)
> D[T0:] = 1
>
> # Vetor de tempo
> t = np.arange(n)
>
> # Gera a sÃ©rie temporal com a quebra no intercepto
> y = alpha + delta*t + beta*D + epsilon
>
> # Plota a sÃ©rie
> plt.figure(figsize=(10, 6))
> plt.plot(t, y)
> plt.xlabel("Tempo (t)")
> plt.ylabel("PreÃ§o da AÃ§Ã£o (y_t)")
> plt.title("SÃ©rie Temporal com Quebra no Intercepto")
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra no Intercepto')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> Este grÃ¡fico mostra um salto abrupto no nÃ­vel da sÃ©rie no tempo $T_0=50$, evidenciando a quebra no intercepto.

Um modelo com uma Ãºnica quebra na inclinaÃ§Ã£o da tendÃªncia no tempo $T_0$ pode ser representado como:
$$y_t = \alpha + \delta t + \gamma (t-T_0)D_t + \epsilon_t$$
onde:
*   $\gamma$ Ã© o coeficiente que representa a mudanÃ§a na inclinaÃ§Ã£o da tendÃªncia apÃ³s a quebra.
*   $D_t$ Ã© uma variÃ¡vel dummy que assume o valor 1 para $t \geq T_0$ e 0 para $t < T_0$.

Neste modelo, a sÃ©rie temporal segue uma tendÃªncia linear com intercepto $\alpha$ e inclinaÃ§Ã£o $\delta$ atÃ© o tempo $T_0$, e a partir desse momento a inclinaÃ§Ã£o passa a ser $\delta + \gamma$. O coeficiente $\gamma$ representa a magnitude da mudanÃ§a na inclinaÃ§Ã£o.

> ğŸ’¡ **Exemplo NumÃ©rico:**
> Suponha que estamos modelando a produÃ§Ã£o de uma fÃ¡brica. Inicialmente, a produÃ§Ã£o cresce a uma taxa $\delta = 0.5$ unidades por perÃ­odo, com um nÃ­vel inicial de $\alpha = 20$ unidades. Em $T_0=70$ Ã© implementada uma nova tecnologia que aumenta a taxa de crescimento da produÃ§Ã£o para $\delta + \gamma = 1.2$, o que significa que $\gamma = 0.7$.  O modelo seria:
> $$y_t = 20 + 0.5t + 0.7(t-70)D_t + \epsilon_t$$
> onde $D_t=0$ para $t<70$ e $D_t=1$ para $t\geq 70$.  O coeficiente $\gamma = 0.7$ representa o aumento na taxa de crescimento da produÃ§Ã£o devido Ã  nova tecnologia.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # ParÃ¢metros
> alpha = 20
> delta = 0.5
> gamma = 0.7
> T0 = 70
> n = 150
> sigma_epsilon = 2
>
> # SimulaÃ§Ã£o de ruÃ­do branco
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # VariÃ¡vel dummy
> D = np.zeros(n)
> D[T0:] = 1
>
> # Vetor de tempo
> t = np.arange(n)
>
> # Gera a sÃ©rie temporal com a quebra na inclinaÃ§Ã£o
> y = alpha + delta*t + gamma*(t-T0)*D + epsilon
>
> # Plota a sÃ©rie
> plt.figure(figsize=(10, 6))
> plt.plot(t, y)
> plt.xlabel("Tempo (t)")
> plt.ylabel("ProduÃ§Ã£o da FÃ¡brica (y_t)")
> plt.title("SÃ©rie Temporal com Quebra na InclinaÃ§Ã£o")
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra na InclinaÃ§Ã£o')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> O grÃ¡fico ilustra como a inclinaÃ§Ã£o da tendÃªncia muda abruptamente apÃ³s $t = 70$.

> A modelagem com variÃ¡veis dummy permite a representaÃ§Ã£o flexÃ­vel de quebras na tendÃªncia, podendo acomodar diferentes tipos de mudanÃ§as, e a interpretaÃ§Ã£o direta dos coeficientes das variÃ¡veis dummy, que representam a magnitude e o sentido da mudanÃ§a na tendÃªncia.

> ğŸ’¡ **Exemplo NumÃ©rico:**
> Suponha que temos uma sÃ©rie temporal representando a taxa de desemprego em um paÃ­s, e que no tempo $T_0 = 100$ houve uma grande mudanÃ§a na polÃ­tica econÃ´mica que altera a inclinaÃ§Ã£o da tendÃªncia de desemprego. Antes de $T_0$, a taxa de desemprego cresce lentamente, e apÃ³s $T_0$ o crescimento Ã© muito maior. Os parÃ¢metros do modelo sÃ£o:
>
> *  $\alpha = 5$ (nÃ­vel inicial da taxa de desemprego)
> *  $\delta = 0.1$ (crescimento anual da taxa de desemprego antes da quebra)
> *  $\gamma = 0.5$ (aumento no crescimento anual da taxa de desemprego apÃ³s a quebra)
>
> Para modelar essa quebra na inclinaÃ§Ã£o da tendÃªncia, utilizamos a seguinte equaÃ§Ã£o:
> $$ y_t = 5 + 0.1t + 0.5(t-100)D_t + \epsilon_t$$
> onde $D_t$ Ã© uma variÃ¡vel dummy que assume o valor 0 para $t<100$ e 1 para $t \geq 100$.  Esta equaÃ§Ã£o permite analisar o efeito da mudanÃ§a na polÃ­tica econÃ´mica na taxa de desemprego. Antes da quebra, a taxa de desemprego cresce a 0.1 unidades por perÃ­odo, e depois da quebra, a taxa de desemprego cresce a $0.1+0.5=0.6$ unidades por perÃ­odo. O coeficiente $\gamma = 0.5$ quantifica o efeito da mudanÃ§a na polÃ­tica econÃ´mica sobre a inclinaÃ§Ã£o da tendÃªncia.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> alpha = 5
> delta = 0.1
> gamma = 0.5
> T0 = 100
> n = 200
> sigma_epsilon = 1
>
> # Generate white noise
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # Generate dummy variable
> D = np.zeros(n)
> D[T0:] = 1
>
> # Generate time
> t = np.arange(n)
>
> # Generate the series with a change in slope
> y = alpha + delta*t + gamma*(t-T0)*D + epsilon
>
> # Plot the series
> plt.figure(figsize=(10,6))
> plt.plot(t,y)
> plt.xlabel("Time (t)")
> plt.ylabel("Unemployment Rate (y_t)")
> plt.title("Time series with a change in slope")
> plt.axvline(x=T0, color='r', linestyle='--', label='Break in Trend')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> Este grÃ¡fico demonstra como a sÃ©rie temporal apresenta um aumento da inclinaÃ§Ã£o apÃ³s o tempo $T_0 = 100$.

Um modelo mais geral com uma quebra no intercepto e na inclinaÃ§Ã£o pode ser representado como:
$$y_t = \alpha + \delta t + \beta D_t + \gamma(t-T_0)D_t + \epsilon_t$$
Neste modelo, ocorrem tanto uma mudanÃ§a no nÃ­vel da tendÃªncia ($\beta$) quanto na inclinaÃ§Ã£o ($\gamma$).

> O uso de variÃ¡veis dummy oferece uma maneira flexÃ­vel de modelar diferentes tipos de quebras na tendÃªncia e permite obter uma descriÃ§Ã£o precisa do comportamento da sÃ©rie temporal ao longo do tempo.

#### Incorporando MÃºltiplas Quebras na TendÃªncia
A flexibilidade da modelagem com variÃ¡veis dummy permite a incorporaÃ§Ã£o de mÃºltiplas quebras na tendÃªncia. Para representar $n$ quebras na tendÃªncia, Ã© necessÃ¡rio incluir $n$ variÃ¡veis dummy no modelo, cada uma representando uma quebra diferente no tempo $T_i$, $i=1, 2, \ldots, n$.

Por exemplo, um modelo com duas quebras, uma no intercepto em $T_1$ e outra na inclinaÃ§Ã£o em $T_2$, pode ser representado como:
$$y_t = \alpha + \delta t + \beta_1 D_{1t} + \gamma_1 (t-T_1) D_{1t} + \beta_2 D_{2t} + \epsilon_t$$
onde:
*   $D_{1t}$ Ã© uma variÃ¡vel dummy que assume o valor 1 para $t \geq T_1$ e 0 para $t < T_1$, representando a quebra em $T_1$.
*   $D_{2t}$ Ã© uma variÃ¡vel dummy que assume o valor 1 para $t \geq T_2$ e 0 para $t < T_2$, representando a quebra em $T_2$.
*   $\beta_1$ e $\beta_2$ sÃ£o os coeficientes das variÃ¡veis dummy, representando a magnitude das mudanÃ§as no intercepto.
*   $\gamma_1$ Ã© o coeficiente da variÃ¡vel dummy, representando a magnitude das mudanÃ§as na inclinaÃ§Ã£o.

> A capacidade de modelar mÃºltiplas quebras na tendÃªncia permite a anÃ¡lise de sÃ©ries temporais que sÃ£o afetadas por diversos eventos discretos, oferecendo uma modelagem mais realista do que modelos com uma Ãºnica quebra.

> ğŸ’¡ **Exemplo NumÃ©rico:**
> Suponha que temos uma sÃ©rie temporal representando o nÃ­vel de atividade econÃ´mica de um paÃ­s, que sofreu duas grandes mudanÃ§as: uma crise financeira em $T_1=50$ e uma grande reforma econÃ´mica em $T_2=150$. A crise financeira causa uma reduÃ§Ã£o abrupta no nÃ­vel de atividade econÃ´mica, e a reforma econÃ´mica causa um aumento da inclinaÃ§Ã£o da tendÃªncia, como segue:
>
> * $\alpha = 100$ (nÃ­vel inicial da atividade econÃ´mica)
> * $\delta = 0.5$ (crescimento inicial da atividade econÃ´mica)
> * $\beta_1 = -15$ (queda no nÃ­vel de atividade devido Ã  crise financeira)
> * $\gamma_1 = 0.8$ (aumento na inclinaÃ§Ã£o da tendÃªncia devido Ã  reforma econÃ´mica)
>
> Para modelar estas duas quebras, utilizamos o seguinte modelo:
> $$y_t = 100 + 0.5t - 15D_{1t} + 0.8(t-150)D_{2t} + \epsilon_t$$
> onde $D_{1t}$ assume o valor 1 para $t \geq 50$ e 0 caso contrÃ¡rio, e $D_{2t}$ assume o valor 1 para $t \geq 150$ e 0 caso contrÃ¡rio.
>
> Podemos ilustrar essa sÃ©rie com uma simulaÃ§Ã£o:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> alpha = 100
> delta = 0.5
> beta1 = -15
> gamma1 = 0.8
> T1 = 50
> T2 = 150
> n = 200
> sigma_epsilon = 5
>
> # Generate white noise
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # Generate dummy variables
> D1 = np.zeros(n)
> D1[T1:] = 1
> D2 = np.zeros(n)
> D2[T2:] = 1
>
> # Generate time
> t = np.arange(n)
>
> # Generate series with a shift and a change in slope
> y = alpha + delta*t + beta1*D1 + gamma1*(t-T2)*D2 + epsilon
>
> # Plot the series
> plt.figure(figsize=(10,6))
> plt.plot(t,y)
> plt.xlabel("Time (t)")
> plt.ylabel("Economic Activity (y_t)")
> plt.title("Time Series with a Shift and a Change in Slope")
> plt.axvline(x=T1, color='r', linestyle='--', label='Shift in Trend')
> plt.axvline(x=T2, color='g', linestyle='--', label='Change in Slope')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> O grÃ¡fico mostra uma queda abrupta no nÃ­vel da sÃ©rie no tempo $T_1=50$ e um aumento na inclinaÃ§Ã£o da tendÃªncia a partir do tempo $T_2=150$.

#### Efeito das Quebras Ocasionais em Testes de Raiz UnitÃ¡ria

A presenÃ§a de quebras ocasionais na tendÃªncia pode levar a resultados enganosos em testes de raiz unitÃ¡ria tradicionais. Testes de raiz unitÃ¡ria, como o teste de Dickey-Fuller (ADF), sÃ£o construÃ­dos sob a premissa de que a sÃ©rie temporal segue um modelo com uma tendÃªncia linear (ou nenhuma tendÃªncia) e que as inovaÃ§Ãµes sÃ£o gaussianas. Quando existem quebras na tendÃªncia, as hipÃ³teses do teste sÃ£o violadas, o que pode resultar em dois tipos de erros:

1.  **Falsa RejeiÃ§Ã£o da HipÃ³tese Nula:** Se um modelo com raiz unitÃ¡ria Ã© testado em uma sÃ©rie que, na verdade, segue um processo estacionÃ¡rio com quebras na tendÃªncia, o teste pode rejeitar incorretamente a hipÃ³tese nula de raiz unitÃ¡ria. Isso ocorre porque o teste confunde a nÃ£o estacionariedade causada pela presenÃ§a das quebras com a nÃ£o estacionariedade causada por uma raiz unitÃ¡ria.
2.  **Falsa AceitaÃ§Ã£o da HipÃ³tese Nula:** Se um modelo com raiz unitÃ¡ria Ã© testado em uma sÃ©rie que, na verdade, possui uma tendÃªncia determinÃ­stica com quebras, o teste pode nÃ£o rejeitar a hipÃ³tese nula de raiz unitÃ¡ria. Isso ocorre porque o teste nÃ£o consegue identificar corretamente a forma funcional da tendÃªncia, sendo incapaz de distinguir entre uma tendÃªncia com quebras e um processo de raiz unitÃ¡ria.

> A presenÃ§a de quebras estruturais nas sÃ©ries temporais pode gerar resultados errÃ´neos em testes de raiz unitÃ¡ria tradicionais, o que torna fundamental o uso de mÃ©todos mais robustos que levem em consideraÃ§Ã£o a presenÃ§a de quebras ocasionais.

> ğŸ’¡ **Exemplo NumÃ©rico:** Vamos analisar o efeito de uma quebra na tendÃªncia em um teste de raiz unitÃ¡ria. Suponha que temos uma sÃ©rie temporal com uma quebra no intercepto em $T_0 = 100$:
>
> $$y_t = \begin{cases} 100 + 0.5t + \epsilon_t & \text{se } t < 100 \\ 80 + 0.5t + \epsilon_t & \text{se } t \geq 100 \end{cases}$$
> onde $\epsilon_t$ Ã© um ruÃ­do branco normal com mÃ©dia zero e desvio padrÃ£o igual a 2. Se aplicarmos o teste de Dickey-Fuller (ADF) diretamente a essa sÃ©rie, o teste pode rejeitar a hipÃ³tese nula de raiz unitÃ¡ria, mesmo que a sÃ©rie nÃ£o tenha uma raiz unitÃ¡ria.
>
>  A seguir, uma simulaÃ§Ã£o do exemplo numÃ©rico que demonstra esse resultado:
>
> ```python
> import numpy as np
> import pandas as pd
> from statsmodels.tsa.stattools import adfuller
>
> # Parameters
> alpha1 = 100
> alpha2 = 80
> delta = 0.5
> T0 = 100
> n = 200
> sigma_epsilon = 2
>
> # Simulate data
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
> y = np.zeros(n)
> for t in range(n):
>    if t < T0:
>        y[t] = alpha1 + delta * t + epsilon[t]
>    else:
>        y[t] = alpha2 + delta * t + epsilon[t]
>
> # Apply ADF test
> adf_result = adfuller(y)
>
> print("ADF Statistics:", adf_result[0])
> print("p-value:", adf_result[1])
> print("Critical Values:", adf_result[4])
> ```
> O resultado do teste ADF pode levar a uma rejeiÃ§Ã£o da hipÃ³tese nula de raiz unitÃ¡ria, mesmo que a sÃ©rie seja estacionÃ¡ria com quebras, o que Ã© um resultado espÃºrio, pois o teste nÃ£o Ã© apropriado para sÃ©ries com quebras.

### ImplicaÃ§Ãµes para Modelagem e InferÃªncia

A modelagem de quebras ocasionais na tendÃªncia usando variÃ¡veis dummy tem as seguintes implicaÃ§Ãµes para a anÃ¡lise de sÃ©ries temporais:

1.  **InclusÃ£o de VariÃ¡veis Dummy:** VariÃ¡veis dummy devem ser incluÃ­das em modelos de sÃ©ries temporais sempre que houver evidÃªncias de quebras estruturais na tendÃªncia. A inclusÃ£o de variÃ¡veis dummy permite que o modelo capture corretamente as mudanÃ§as no nÃ­vel ou na inclinaÃ§Ã£o da tendÃªncia, e evita resultados enviesados.
2. **SeleÃ§Ã£o dos Pontos de Quebra:** A seleÃ§Ã£o dos pontos de quebra Ã© uma etapa crucial na modelagem com variÃ¡veis dummy.  AnÃ¡lises grÃ¡ficas da sÃ©rie temporal e o conhecimento de eventos econÃ´micos ou polÃ­ticos podem auxiliar na identificaÃ§Ã£o de possÃ­veis quebras estruturais. MÃ©todos estatÃ­sticos, como o teste de Chow, tambÃ©m podem ser usados para testar a significÃ¢ncia das quebras em perÃ­odos prÃ©-determinados.
3.  **InterpretaÃ§Ã£o dos Coeficientes:** Os coeficientes das variÃ¡veis dummy devem ser interpretados como a magnitude das mudanÃ§as no intercepto ou na inclinaÃ§Ã£o da tendÃªncia. Uma interpretaÃ§Ã£o precisa desses coeficientes permite avaliar o efeito de eventos discretos na trajetÃ³ria da sÃ©rie temporal.
4. **Teste de Raiz UnitÃ¡ria:** Testes de raiz unitÃ¡ria, ao serem aplicados a modelos com quebras ocasionais, devem incluir variÃ¡veis dummy para representar explicitamente as quebras estruturais. Caso contrÃ¡rio, os testes podem levar a resultados enviesados. O uso de testes de raiz unitÃ¡ria que sejam robustos Ã  presenÃ§a de quebras tambÃ©m Ã© recomendado.
5. **Modelos de PrevisÃ£o:** A modelagem com quebras ocasionais na tendÃªncia tambÃ©m deve ser considerada na modelagem da previsÃ£o. Modelos que nÃ£o considerem as quebras podem levar a projeÃ§Ãµes imprecisas para o futuro.
6.  **Complexidade do Modelo:**  A inclusÃ£o de um grande nÃºmero de variÃ¡veis dummy pode aumentar a complexidade do modelo e reduzir o nÃºmero de graus de liberdade. A escolha entre um modelo mais complexo e um modelo mais simples deve ser baseada em um balanÃ§o entre o ajuste do modelo aos dados e a interpretaÃ§Ã£o dos parÃ¢metros.

**ProposiÃ§Ã£o 1:** A inclusÃ£o de variÃ¡veis dummy em modelos de sÃ©ries temporais com quebras ocasionais na tendÃªncia corrige o viÃ©s dos testes de raiz unitÃ¡ria tradicionais.

*Proof:*
I. Testes de raiz unitÃ¡ria, como o teste ADF, assumem que a sÃ©rie segue uma tendÃªncia linear e que os resÃ­duos sÃ£o gaussianos.
II. A presenÃ§a de quebras ocasionais na tendÃªncia viola essa premissa, levando a resultados enviesados nos testes de raiz unitÃ¡ria tradicionais.
III. A inclusÃ£o de variÃ¡veis dummy permite modelar explicitamente as quebras na tendÃªncia, corrigindo o viÃ©s e levando a resultados mais precisos.
IV. Assim, modelos com variÃ¡veis dummy para quebras ocasionais sÃ£o mais adequados para testes de raiz unitÃ¡ria em sÃ©ries com quebras, pois acomodam corretamente a dinÃ¢mica da sÃ©rie.  $\blacksquare$

> ğŸ’¡ **Exemplo NumÃ©rico:**
> Retomando o exemplo da sÃ©rie temporal com quebra no intercepto, podemos aplicar novamente o teste de Dickey-Fuller, agora incluindo uma variÃ¡vel dummy que representa a quebra.
>
> ```python
> import numpy as np
> import pandas as pd
> from statsmodels.tsa.stattools import adfuller
> import statsmodels.api as sm
>
> # Parameters
> alpha1 = 100
> alpha2 = 80
> delta = 0.5
> T0 = 100
> n = 200
> sigma_epsilon = 2
>
> # Simulate data
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
> y = np.zeros(n)
>
> for t in range(n):
>    if t < T0:
>        y[t] = alpha1 + delta * t + epsilon[t]
>    else:
>        y[t] = alpha2 + delta * t + epsilon[t]
>
> # Create dummy variable
> D = np.zeros(n)
> D[T0:] = 1
>
> # Add dummy variable to the regression
> X = np.column_stack((np.ones(n), np.arange(n), D))
> model = sm.OLS(y, X)
> results = model.fit()
>
> # Apply Augmented Dickey-Fuller test
> adf_result = adfuller(y, regression='ct', maxlag=5)
> print("ADF Statistics with linear trend and intercept:", adf_result[0])
> print("p-value:", adf_result[1])
> print("Critical Values:", adf_result[4])
>
> adf_result_dummy = adfuller(y, regression='ct', maxlag=5,
>                                  autolag=None, addtrend='c',
>                                  regresults=results)
>
> print("ADF Statistics with linear trend, intercept and dummy variable:", adf_result_dummy[0])
> print("p-value:", adf_result_dummy[1])
> print("Critical Values:", adf_result_dummy[4])
>
> ```
>
> Ao executar o cÃ³digo acima, os resultados mostram que, ao incluir a variÃ¡vel dummy, o teste de Dickey-Fuller agora nÃ£o rejeita a hipÃ³tese nula de raiz unitÃ¡ria de forma incorreta. O teste sem a dummy pode levar Ã  falsa rejeiÃ§Ã£o da hipÃ³tese nula, indicando incorretamente que a sÃ©rie Ã© estacionÃ¡ria, enquanto a inclusÃ£o da variÃ¡vel dummy corrige esse viÃ©s.

**Teorema 1:** A inclusÃ£o de variÃ¡veis dummy para quebras estruturais no modelo de teste de raiz unitÃ¡ria implica em um teste condicional Ã  localizaÃ§Ã£o e magnitude das quebras.
*Prova:*
I.  O teste de raiz unitÃ¡ria tradicional busca determinar se o processo Ã© estacionÃ¡rio, assumindo que a tendÃªncia Ã© linear e as inovaÃ§Ãµes sÃ£o gaussianas.
II. Ao incluir variÃ¡veis dummy no modelo de teste de raiz unitÃ¡ria, o teste passa a ser condicional aos pontos onde ocorrem as quebras.  O modelo que Ã© testado passa a ser:
$$ y_t = \alpha + \delta t + \sum_i \beta_i D_{it} + \epsilon_t $$
III. O teste passa a avaliar se, condicional aos pontos de quebra  $(T_1, T_2, \ldots, T_n)$ especificados pelas dummies, a sÃ©rie possui raiz unitÃ¡ria.
IV.  Os resultados do teste sÃ£o vÃ¡lidos para a especificaÃ§Ã£o do modelo com as dummies.
V. Portanto, a inclusÃ£o de dummies no teste de raiz unitÃ¡ria implica que o resultado do teste seja condicional Ã  presenÃ§a das quebras nos pontos especificados pelas dummies. $\blacksquare$

**Lema 1:** A inclusÃ£o de variÃ¡veis dummy nÃ£o remove o problema da nÃ£o gaussianidade dos resÃ­duos, mas torna o modelo mais adequado para anÃ¡lise estatÃ­stica.
*Prova:*
I.  A inclusÃ£o de variÃ¡veis dummy permite modelar explicitamente as mudanÃ§as no intercepto ou na inclinaÃ§Ã£o da tendÃªncia, ou ambos.
II.  Contudo, a nÃ£o gaussianidade dos resÃ­duos pode se manter devido Ã  natureza discreta das quebras.
III.  A modelagem com dummies nÃ£o muda as propriedades da distribuiÃ§Ã£o de $\eta_t$, que continua sendo uma distribuiÃ§Ã£o nÃ£o gaussiana com caudas pesadas.
IV.  O que ocorre Ã© que, com a modelagem correta da quebra, os resÃ­duos da regressÃ£o se aproximam do conceito de ruÃ­do branco, com mÃ©dia zero e variÃ¢ncia constante.
V.  Portanto, embora as dummies corrijam o problema da quebra estrutural, a nÃ£o gaussianidade dos resÃ­duos requer a utilizaÃ§Ã£o de mÃ©todos de estimaÃ§Ã£o e inferÃªncia que acomodem essa caracterÃ­stica.  $\blacksquare$

**Teorema 1.1:** Sob a hipÃ³tese nula de raiz unitÃ¡ria, e com o modelo de quebras modelado adequadamente, o teste de Dickey-Fuller aumentado (ADF) converge para sua distribuiÃ§Ã£o assintÃ³tica padrÃ£o, condicional aos pontos de quebra.
*Prova:*
I. O teste ADF tradicional Ã© conhecido por convergir para uma distribuiÃ§Ã£o assintÃ³tica nÃ£o padrÃ£o sob a hipÃ³tese nula de raiz unitÃ¡ria.
II. Ao incluir as variÃ¡veis dummy, a forma funcional da tendÃªncia determinÃ­stica Ã© modelada adequadamente.
III.  A convergÃªncia para a distribuiÃ§Ã£o assintÃ³tica padrÃ£o sob a hipÃ³tese nula,  e condicional aos pontos de quebra $T_i$,  Ã© garantida pelas condiÃ§Ãµes de regularidade dos estimadores de mÃ­nimos quadrados ordinÃ¡rios (OLS).
IV. Portanto, com a inclusÃ£o das variÃ¡veis dummy, podemos utilizar as tabelas padrÃ£o do teste ADF para avaliar a significÃ¢ncia estatÃ­stica da hipÃ³tese nula, sempre que a especificaÃ§Ã£o do modelo de quebras estiver correta. $\blacksquare$

**Lema 1.1:** A correta modelagem das quebras na tendÃªncia atravÃ©s de variÃ¡veis dummy reduz a autocorrelaÃ§Ã£o nos resÃ­duos do modelo, tornando a anÃ¡lise de inferÃªncia mais confiÃ¡vel.
*Prova:*
I. Modelos que nÃ£o consideram quebras na tendÃªncia podem apresentar resÃ­duos com forte autocorrelaÃ§Ã£o, devido a erros de especificaÃ§Ã£o na forma funcional da tendÃªncia.
II. A inclusÃ£o de dummies modela explicitamente as quebras, capturando parte da dependÃªncia serial nos resÃ­duos.
III.  Dessa forma, ao modelarmos explicitamente as quebras, reduzimos a autocorrelaÃ§Ã£o nos resÃ­duos, aproximando a sua distribuiÃ§Ã£o das premissas do modelo clÃ¡ssico de regressÃ£o linear.
IV.  Essa reduÃ§Ã£o na autocorrelaÃ§Ã£o dos resÃ­duos torna a anÃ¡lise de inferÃªncia baseada no modelo de regressÃ£o com dummies mais confiÃ¡vel.  $\blacksquare$

**ProposiÃ§Ã£o 2:** A utilizaÃ§Ã£o de testes de raiz unitÃ¡ria robustos a quebras estruturais, como o teste de Zivot-Andrews, complementa a modelagem com variÃ¡veis dummy, oferecendo uma anÃ¡lise mais completa da estacionariedade da sÃ©rie temporal.

*Prova:*
I.  Testes de raiz unitÃ¡ria tradicionais como o ADF sÃ£o sensÃ­veis Ã  presenÃ§a de quebras estruturais, podendo levar a resultados errÃ´neos.
II.  Testes como o de Zivot-Andrews, por outro lado, sÃ£o construÃ­dos para identificar a presenÃ§a de quebras endogenamente, de acordo com os dados.
III.  A modelagem com variÃ¡veis dummy, como discutido nesse texto, permite quebrar explicitamente a nÃ£o estacionariedade do processo em suas diferentes formas (tendÃªncia, nÃ­vel, etc.).
IV. A combinaÃ§Ã£o de modelagem com variÃ¡veis dummy e o uso de testes robustos a quebras estruturais, como o Zivot-Andrews, oferece uma estratÃ©gia mais completa para a anÃ¡lise de sÃ©ries temporais, permitindo que as quebras sejam modeladas de forma adequada e que a estacionariedade seja avaliada corretamente, mesmo quando existe a presenÃ§a de quebras estruturais. $\blacksquare$

### ConclusÃ£o

A modelagem de quebras ocasionais na tendÃªncia utilizando variÃ¡veis dummy Ã© uma ferramenta fundamental para a anÃ¡lise de sÃ©ries temporais nÃ£o estacionÃ¡rias que sÃ£o afetadas por eventos discretos. A inclusÃ£o de variÃ¡veis dummy permite a representaÃ§Ã£o flexÃ­vel de quebras no intercepto ou na inclinaÃ§Ã£o da tendÃªncia, corrige o viÃ©s dos testes de raiz unitÃ¡ria tradicionais e permite obter estimativas mais precisas e inferÃªncias mais confiÃ¡veis. Contudo, os resÃ­duos, em geral, mantÃªm caracterÃ­sticas nÃ£o gaussianas. A modelagem com dummies, em conjunto com mÃ©todos apropriados de estimaÃ§Ã£o e inferÃªncia, Ã© essencial para uma anÃ¡lise rigorosa de sÃ©ries temporais com quebras estruturais.
### ReferÃªncias
[^1]: CapÃ­tulo 15 do livro "Time Series Analysis" (informaÃ§Ãµes retiradas de todo o capÃ­tulo).
<!-- END -->
