## Modelagem de Quebras Ocasionais na Tend√™ncia com Vari√°veis Dummy e Implica√ß√µes para Testes de Raiz Unit√°ria

### Introdu√ß√£o

Em continuidade √† discuss√£o sobre modelos para s√©ries temporais n√£o estacion√°rias, este cap√≠tulo se aprofunda na modelagem de **quebras ocasionais na tend√™ncia utilizando vari√°veis dummy**, explorando como esta t√©cnica permite representar mudan√ßas no intercepto ou na inclina√ß√£o da tend√™ncia. Como vimos em cap√≠tulos anteriores [^1], a presen√ßa de quebras estruturais pode levar a resultados enganosos em testes de raiz unit√°ria tradicionais, e por isso a modelagem expl√≠cita de quebras utilizando vari√°veis dummy permite obter estimativas mais precisas e infer√™ncias estat√≠sticas mais confi√°veis. Este cap√≠tulo abordar√° como incorporar vari√°veis dummy em modelos de quebras ocasionais, como interpretar seus coeficientes, e como essa modelagem afeta os testes de raiz unit√°ria, construindo sobre o conhecimento j√° apresentado nos cap√≠tulos anteriores.

### Conceitos Fundamentais

#### Modelagem de Quebras na Tend√™ncia com Vari√°veis Dummy

A modelagem de quebras ocasionais na tend√™ncia utilizando vari√°veis dummy √© uma abordagem flex√≠vel que permite representar mudan√ßas discretas no intercepto ou na inclina√ß√£o da tend√™ncia, ou em ambos, em diferentes pontos no tempo. Uma vari√°vel dummy √© uma vari√°vel bin√°ria que assume o valor 1 se um determinado evento ocorre, e 0 caso contr√°rio. Em modelos de quebra de tend√™ncia, as vari√°veis dummy s√£o usadas para indicar o momento em que ocorre uma mudan√ßa na tend√™ncia.

Um modelo com uma √∫nica quebra no intercepto da tend√™ncia no tempo $T_0$ pode ser representado como:
$$y_t = \alpha + \delta t + \beta D_t + \epsilon_t$$
onde:
*   $y_t$ √© a s√©rie temporal.
*   $t$ √© o tempo.
*   $\alpha$ √© o intercepto da tend√™ncia antes da quebra.
*   $\delta$ √© a inclina√ß√£o da tend√™ncia (assumida constante neste modelo).
*   $\beta$ √© o coeficiente que representa a mudan√ßa no intercepto da tend√™ncia no momento da quebra.
*   $D_t$ √© uma vari√°vel dummy que assume o valor 1 para $t \geq T_0$ e 0 para $t < T_0$.
*   $\epsilon_t$ √© o termo de erro, assumido como um ru√≠do branco com m√©dia zero e vari√¢ncia constante.

Nesse modelo, a s√©rie temporal segue uma tend√™ncia linear com intercepto $\alpha$ e inclina√ß√£o $\delta$ at√© o tempo $T_0$, quando ocorre uma mudan√ßa abrupta no intercepto da tend√™ncia, que passa a ser $\alpha + \beta$. O coeficiente $\beta$ representa a magnitude da mudan√ßa no intercepto.

> üí° **Exemplo Num√©rico:**
> Imagine que voc√™ est√° modelando o pre√ßo m√©dio de uma a√ß√£o ao longo do tempo. Suponha que antes do tempo $T_0 = 50$, o pre√ßo da a√ß√£o estava em torno de $\alpha = 10$ e aumentava a uma taxa de $\delta = 0.2$ por per√≠odo. No tempo $T_0 = 50$, houve um an√∫ncio de um novo produto da empresa, que fez com que o pre√ßo da a√ß√£o desse um salto. O novo intercepto da tend√™ncia ap√≥s o an√∫ncio √© $\alpha + \beta = 15$, o que significa que $\beta=5$. O modelo seria ent√£o:
> $$y_t = 10 + 0.2t + 5D_t + \epsilon_t$$
>  onde $D_t=0$ para $t < 50$ e $D_t=1$ para $t\geq 50$.
>
>  O coeficiente $\beta = 5$ representa o salto no pre√ßo da a√ß√£o causado pelo an√∫ncio do novo produto.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> alpha = 10
> delta = 0.2
> beta = 5
> T0 = 50
> n = 100
> sigma_epsilon = 1
>
> # Simula√ß√£o de ru√≠do branco
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # Vari√°vel dummy
> D = np.zeros(n)
> D[T0:] = 1
>
> # Vetor de tempo
> t = np.arange(n)
>
> # Gera a s√©rie temporal com a quebra no intercepto
> y = alpha + delta*t + beta*D + epsilon
>
> # Plota a s√©rie
> plt.figure(figsize=(10, 6))
> plt.plot(t, y)
> plt.xlabel("Tempo (t)")
> plt.ylabel("Pre√ßo da A√ß√£o (y_t)")
> plt.title("S√©rie Temporal com Quebra no Intercepto")
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra no Intercepto')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> Este gr√°fico mostra um salto abrupto no n√≠vel da s√©rie no tempo $T_0=50$, evidenciando a quebra no intercepto.

Um modelo com uma √∫nica quebra na inclina√ß√£o da tend√™ncia no tempo $T_0$ pode ser representado como:
$$y_t = \alpha + \delta t + \gamma (t-T_0)D_t + \epsilon_t$$
onde:
*   $\gamma$ √© o coeficiente que representa a mudan√ßa na inclina√ß√£o da tend√™ncia ap√≥s a quebra.
*   $D_t$ √© uma vari√°vel dummy que assume o valor 1 para $t \geq T_0$ e 0 para $t < T_0$.

Neste modelo, a s√©rie temporal segue uma tend√™ncia linear com intercepto $\alpha$ e inclina√ß√£o $\delta$ at√© o tempo $T_0$, e a partir desse momento a inclina√ß√£o passa a ser $\delta + \gamma$. O coeficiente $\gamma$ representa a magnitude da mudan√ßa na inclina√ß√£o.

> üí° **Exemplo Num√©rico:**
> Suponha que estamos modelando a produ√ß√£o de uma f√°brica. Inicialmente, a produ√ß√£o cresce a uma taxa $\delta = 0.5$ unidades por per√≠odo, com um n√≠vel inicial de $\alpha = 20$ unidades. Em $T_0=70$ √© implementada uma nova tecnologia que aumenta a taxa de crescimento da produ√ß√£o para $\delta + \gamma = 1.2$, o que significa que $\gamma = 0.7$.  O modelo seria:
> $$y_t = 20 + 0.5t + 0.7(t-70)D_t + \epsilon_t$$
> onde $D_t=0$ para $t<70$ e $D_t=1$ para $t\geq 70$.  O coeficiente $\gamma = 0.7$ representa o aumento na taxa de crescimento da produ√ß√£o devido √† nova tecnologia.
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Par√¢metros
> alpha = 20
> delta = 0.5
> gamma = 0.7
> T0 = 70
> n = 150
> sigma_epsilon = 2
>
> # Simula√ß√£o de ru√≠do branco
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # Vari√°vel dummy
> D = np.zeros(n)
> D[T0:] = 1
>
> # Vetor de tempo
> t = np.arange(n)
>
> # Gera a s√©rie temporal com a quebra na inclina√ß√£o
> y = alpha + delta*t + gamma*(t-T0)*D + epsilon
>
> # Plota a s√©rie
> plt.figure(figsize=(10, 6))
> plt.plot(t, y)
> plt.xlabel("Tempo (t)")
> plt.ylabel("Produ√ß√£o da F√°brica (y_t)")
> plt.title("S√©rie Temporal com Quebra na Inclina√ß√£o")
> plt.axvline(x=T0, color='r', linestyle='--', label='Quebra na Inclina√ß√£o')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> O gr√°fico ilustra como a inclina√ß√£o da tend√™ncia muda abruptamente ap√≥s $t = 70$.

> A modelagem com vari√°veis dummy permite a representa√ß√£o flex√≠vel de quebras na tend√™ncia, podendo acomodar diferentes tipos de mudan√ßas, e a interpreta√ß√£o direta dos coeficientes das vari√°veis dummy, que representam a magnitude e o sentido da mudan√ßa na tend√™ncia.

> üí° **Exemplo Num√©rico:**
> Suponha que temos uma s√©rie temporal representando a taxa de desemprego em um pa√≠s, e que no tempo $T_0 = 100$ houve uma grande mudan√ßa na pol√≠tica econ√¥mica que altera a inclina√ß√£o da tend√™ncia de desemprego. Antes de $T_0$, a taxa de desemprego cresce lentamente, e ap√≥s $T_0$ o crescimento √© muito maior. Os par√¢metros do modelo s√£o:
>
> *  $\alpha = 5$ (n√≠vel inicial da taxa de desemprego)
> *  $\delta = 0.1$ (crescimento anual da taxa de desemprego antes da quebra)
> *  $\gamma = 0.5$ (aumento no crescimento anual da taxa de desemprego ap√≥s a quebra)
>
> Para modelar essa quebra na inclina√ß√£o da tend√™ncia, utilizamos a seguinte equa√ß√£o:
> $$ y_t = 5 + 0.1t + 0.5(t-100)D_t + \epsilon_t$$
> onde $D_t$ √© uma vari√°vel dummy que assume o valor 0 para $t<100$ e 1 para $t \geq 100$.  Esta equa√ß√£o permite analisar o efeito da mudan√ßa na pol√≠tica econ√¥mica na taxa de desemprego. Antes da quebra, a taxa de desemprego cresce a 0.1 unidades por per√≠odo, e depois da quebra, a taxa de desemprego cresce a $0.1+0.5=0.6$ unidades por per√≠odo. O coeficiente $\gamma = 0.5$ quantifica o efeito da mudan√ßa na pol√≠tica econ√¥mica sobre a inclina√ß√£o da tend√™ncia.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> alpha = 5
> delta = 0.1
> gamma = 0.5
> T0 = 100
> n = 200
> sigma_epsilon = 1
>
> # Generate white noise
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # Generate dummy variable
> D = np.zeros(n)
> D[T0:] = 1
>
> # Generate time
> t = np.arange(n)
>
> # Generate the series with a change in slope
> y = alpha + delta*t + gamma*(t-T0)*D + epsilon
>
> # Plot the series
> plt.figure(figsize=(10,6))
> plt.plot(t,y)
> plt.xlabel("Time (t)")
> plt.ylabel("Unemployment Rate (y_t)")
> plt.title("Time series with a change in slope")
> plt.axvline(x=T0, color='r', linestyle='--', label='Break in Trend')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> Este gr√°fico demonstra como a s√©rie temporal apresenta um aumento da inclina√ß√£o ap√≥s o tempo $T_0 = 100$.

Um modelo mais geral com uma quebra no intercepto e na inclina√ß√£o pode ser representado como:
$$y_t = \alpha + \delta t + \beta D_t + \gamma(t-T_0)D_t + \epsilon_t$$
Neste modelo, ocorrem tanto uma mudan√ßa no n√≠vel da tend√™ncia ($\beta$) quanto na inclina√ß√£o ($\gamma$).

> O uso de vari√°veis dummy oferece uma maneira flex√≠vel de modelar diferentes tipos de quebras na tend√™ncia e permite obter uma descri√ß√£o precisa do comportamento da s√©rie temporal ao longo do tempo.

#### Incorporando M√∫ltiplas Quebras na Tend√™ncia
A flexibilidade da modelagem com vari√°veis dummy permite a incorpora√ß√£o de m√∫ltiplas quebras na tend√™ncia. Para representar $n$ quebras na tend√™ncia, √© necess√°rio incluir $n$ vari√°veis dummy no modelo, cada uma representando uma quebra diferente no tempo $T_i$, $i=1, 2, \ldots, n$.

Por exemplo, um modelo com duas quebras, uma no intercepto em $T_1$ e outra na inclina√ß√£o em $T_2$, pode ser representado como:
$$y_t = \alpha + \delta t + \beta_1 D_{1t} + \gamma_1 (t-T_1) D_{1t} + \beta_2 D_{2t} + \epsilon_t$$
onde:
*   $D_{1t}$ √© uma vari√°vel dummy que assume o valor 1 para $t \geq T_1$ e 0 para $t < T_1$, representando a quebra em $T_1$.
*   $D_{2t}$ √© uma vari√°vel dummy que assume o valor 1 para $t \geq T_2$ e 0 para $t < T_2$, representando a quebra em $T_2$.
*   $\beta_1$ e $\beta_2$ s√£o os coeficientes das vari√°veis dummy, representando a magnitude das mudan√ßas no intercepto.
*   $\gamma_1$ √© o coeficiente da vari√°vel dummy, representando a magnitude das mudan√ßas na inclina√ß√£o.

> A capacidade de modelar m√∫ltiplas quebras na tend√™ncia permite a an√°lise de s√©ries temporais que s√£o afetadas por diversos eventos discretos, oferecendo uma modelagem mais realista do que modelos com uma √∫nica quebra.

> üí° **Exemplo Num√©rico:**
> Suponha que temos uma s√©rie temporal representando o n√≠vel de atividade econ√¥mica de um pa√≠s, que sofreu duas grandes mudan√ßas: uma crise financeira em $T_1=50$ e uma grande reforma econ√¥mica em $T_2=150$. A crise financeira causa uma redu√ß√£o abrupta no n√≠vel de atividade econ√¥mica, e a reforma econ√¥mica causa um aumento da inclina√ß√£o da tend√™ncia, como segue:
>
> * $\alpha = 100$ (n√≠vel inicial da atividade econ√¥mica)
> * $\delta = 0.5$ (crescimento inicial da atividade econ√¥mica)
> * $\beta_1 = -15$ (queda no n√≠vel de atividade devido √† crise financeira)
> * $\gamma_1 = 0.8$ (aumento na inclina√ß√£o da tend√™ncia devido √† reforma econ√¥mica)
>
> Para modelar estas duas quebras, utilizamos o seguinte modelo:
> $$y_t = 100 + 0.5t - 15D_{1t} + 0.8(t-150)D_{2t} + \epsilon_t$$
> onde $D_{1t}$ assume o valor 1 para $t \geq 50$ e 0 caso contr√°rio, e $D_{2t}$ assume o valor 1 para $t \geq 150$ e 0 caso contr√°rio.
>
> Podemos ilustrar essa s√©rie com uma simula√ß√£o:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Parameters
> alpha = 100
> delta = 0.5
> beta1 = -15
> gamma1 = 0.8
> T1 = 50
> T2 = 150
> n = 200
> sigma_epsilon = 5
>
> # Generate white noise
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
>
> # Generate dummy variables
> D1 = np.zeros(n)
> D1[T1:] = 1
> D2 = np.zeros(n)
> D2[T2:] = 1
>
> # Generate time
> t = np.arange(n)
>
> # Generate series with a shift and a change in slope
> y = alpha + delta*t + beta1*D1 + gamma1*(t-T2)*D2 + epsilon
>
> # Plot the series
> plt.figure(figsize=(10,6))
> plt.plot(t,y)
> plt.xlabel("Time (t)")
> plt.ylabel("Economic Activity (y_t)")
> plt.title("Time Series with a Shift and a Change in Slope")
> plt.axvline(x=T1, color='r', linestyle='--', label='Shift in Trend')
> plt.axvline(x=T2, color='g', linestyle='--', label='Change in Slope')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
> O gr√°fico mostra uma queda abrupta no n√≠vel da s√©rie no tempo $T_1=50$ e um aumento na inclina√ß√£o da tend√™ncia a partir do tempo $T_2=150$.

#### Efeito das Quebras Ocasionais em Testes de Raiz Unit√°ria

A presen√ßa de quebras ocasionais na tend√™ncia pode levar a resultados enganosos em testes de raiz unit√°ria tradicionais. Testes de raiz unit√°ria, como o teste de Dickey-Fuller (ADF), s√£o constru√≠dos sob a premissa de que a s√©rie temporal segue um modelo com uma tend√™ncia linear (ou nenhuma tend√™ncia) e que as inova√ß√µes s√£o gaussianas. Quando existem quebras na tend√™ncia, as hip√≥teses do teste s√£o violadas, o que pode resultar em dois tipos de erros:

1.  **Falsa Rejei√ß√£o da Hip√≥tese Nula:** Se um modelo com raiz unit√°ria √© testado em uma s√©rie que, na verdade, segue um processo estacion√°rio com quebras na tend√™ncia, o teste pode rejeitar incorretamente a hip√≥tese nula de raiz unit√°ria. Isso ocorre porque o teste confunde a n√£o estacionariedade causada pela presen√ßa das quebras com a n√£o estacionariedade causada por uma raiz unit√°ria.
2.  **Falsa Aceita√ß√£o da Hip√≥tese Nula:** Se um modelo com raiz unit√°ria √© testado em uma s√©rie que, na verdade, possui uma tend√™ncia determin√≠stica com quebras, o teste pode n√£o rejeitar a hip√≥tese nula de raiz unit√°ria. Isso ocorre porque o teste n√£o consegue identificar corretamente a forma funcional da tend√™ncia, sendo incapaz de distinguir entre uma tend√™ncia com quebras e um processo de raiz unit√°ria.

> A presen√ßa de quebras estruturais nas s√©ries temporais pode gerar resultados err√¥neos em testes de raiz unit√°ria tradicionais, o que torna fundamental o uso de m√©todos mais robustos que levem em considera√ß√£o a presen√ßa de quebras ocasionais.

> üí° **Exemplo Num√©rico:** Vamos analisar o efeito de uma quebra na tend√™ncia em um teste de raiz unit√°ria. Suponha que temos uma s√©rie temporal com uma quebra no intercepto em $T_0 = 100$:
>
> $$y_t = \begin{cases} 100 + 0.5t + \epsilon_t & \text{se } t < 100 \\ 80 + 0.5t + \epsilon_t & \text{se } t \geq 100 \end{cases}$$
> onde $\epsilon_t$ √© um ru√≠do branco normal com m√©dia zero e desvio padr√£o igual a 2. Se aplicarmos o teste de Dickey-Fuller (ADF) diretamente a essa s√©rie, o teste pode rejeitar a hip√≥tese nula de raiz unit√°ria, mesmo que a s√©rie n√£o tenha uma raiz unit√°ria.
>
>  A seguir, uma simula√ß√£o do exemplo num√©rico que demonstra esse resultado:
>
> ```python
> import numpy as np
> import pandas as pd
> from statsmodels.tsa.stattools import adfuller
>
> # Parameters
> alpha1 = 100
> alpha2 = 80
> delta = 0.5
> T0 = 100
> n = 200
> sigma_epsilon = 2
>
> # Simulate data
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
> y = np.zeros(n)
> for t in range(n):
>    if t < T0:
>        y[t] = alpha1 + delta * t + epsilon[t]
>    else:
>        y[t] = alpha2 + delta * t + epsilon[t]
>
> # Apply ADF test
> adf_result = adfuller(y)
>
> print("ADF Statistics:", adf_result[0])
> print("p-value:", adf_result[1])
> print("Critical Values:", adf_result[4])
> ```
> O resultado do teste ADF pode levar a uma rejei√ß√£o da hip√≥tese nula de raiz unit√°ria, mesmo que a s√©rie seja estacion√°ria com quebras, o que √© um resultado esp√∫rio, pois o teste n√£o √© apropriado para s√©ries com quebras.

### Implica√ß√µes para Modelagem e Infer√™ncia

A modelagem de quebras ocasionais na tend√™ncia usando vari√°veis dummy tem as seguintes implica√ß√µes para a an√°lise de s√©ries temporais:

1.  **Inclus√£o de Vari√°veis Dummy:** Vari√°veis dummy devem ser inclu√≠das em modelos de s√©ries temporais sempre que houver evid√™ncias de quebras estruturais na tend√™ncia. A inclus√£o de vari√°veis dummy permite que o modelo capture corretamente as mudan√ßas no n√≠vel ou na inclina√ß√£o da tend√™ncia, e evita resultados enviesados.
2. **Sele√ß√£o dos Pontos de Quebra:** A sele√ß√£o dos pontos de quebra √© uma etapa crucial na modelagem com vari√°veis dummy.  An√°lises gr√°ficas da s√©rie temporal e o conhecimento de eventos econ√¥micos ou pol√≠ticos podem auxiliar na identifica√ß√£o de poss√≠veis quebras estruturais. M√©todos estat√≠sticos, como o teste de Chow, tamb√©m podem ser usados para testar a signific√¢ncia das quebras em per√≠odos pr√©-determinados.
3.  **Interpreta√ß√£o dos Coeficientes:** Os coeficientes das vari√°veis dummy devem ser interpretados como a magnitude das mudan√ßas no intercepto ou na inclina√ß√£o da tend√™ncia. Uma interpreta√ß√£o precisa desses coeficientes permite avaliar o efeito de eventos discretos na trajet√≥ria da s√©rie temporal.
4. **Teste de Raiz Unit√°ria:** Testes de raiz unit√°ria, ao serem aplicados a modelos com quebras ocasionais, devem incluir vari√°veis dummy para representar explicitamente as quebras estruturais. Caso contr√°rio, os testes podem levar a resultados enviesados. O uso de testes de raiz unit√°ria que sejam robustos √† presen√ßa de quebras tamb√©m √© recomendado.
5. **Modelos de Previs√£o:** A modelagem com quebras ocasionais na tend√™ncia tamb√©m deve ser considerada na modelagem da previs√£o. Modelos que n√£o considerem as quebras podem levar a proje√ß√µes imprecisas para o futuro.
6.  **Complexidade do Modelo:**  A inclus√£o de um grande n√∫mero de vari√°veis dummy pode aumentar a complexidade do modelo e reduzir o n√∫mero de graus de liberdade. A escolha entre um modelo mais complexo e um modelo mais simples deve ser baseada em um balan√ßo entre o ajuste do modelo aos dados e a interpreta√ß√£o dos par√¢metros.

**Proposi√ß√£o 1:** A inclus√£o de vari√°veis dummy em modelos de s√©ries temporais com quebras ocasionais na tend√™ncia corrige o vi√©s dos testes de raiz unit√°ria tradicionais.

*Proof:*
I. Testes de raiz unit√°ria, como o teste ADF, assumem que a s√©rie segue uma tend√™ncia linear e que os res√≠duos s√£o gaussianos.
II. A presen√ßa de quebras ocasionais na tend√™ncia viola essa premissa, levando a resultados enviesados nos testes de raiz unit√°ria tradicionais.
III. A inclus√£o de vari√°veis dummy permite modelar explicitamente as quebras na tend√™ncia, corrigindo o vi√©s e levando a resultados mais precisos.
IV. Assim, modelos com vari√°veis dummy para quebras ocasionais s√£o mais adequados para testes de raiz unit√°ria em s√©ries com quebras, pois acomodam corretamente a din√¢mica da s√©rie.  $\blacksquare$

> üí° **Exemplo Num√©rico:**
> Retomando o exemplo da s√©rie temporal com quebra no intercepto, podemos aplicar novamente o teste de Dickey-Fuller, agora incluindo uma vari√°vel dummy que representa a quebra.
>
> ```python
> import numpy as np
> import pandas as pd
> from statsmodels.tsa.stattools import adfuller
> import statsmodels.api as sm
>
> # Parameters
> alpha1 = 100
> alpha2 = 80
> delta = 0.5
> T0 = 100
> n = 200
> sigma_epsilon = 2
>
> # Simulate data
> np.random.seed(42)
> epsilon = np.random.normal(0, sigma_epsilon, n)
> y = np.zeros(n)
>
> for t in range(n):
>    if t < T0:
>        y[t] = alpha1 + delta * t + epsilon[t]
>    else:
>        y[t] = alpha2 + delta * t + epsilon[t]
>
> # Create dummy variable
> D = np.zeros(n)
> D[T0:] = 1
>
> # Add dummy variable to the regression
> X = np.column_stack((np.ones(n), np.arange(n), D))
> model = sm.OLS(y, X)
> results = model.fit()
>
> # Apply Augmented Dickey-Fuller test
> adf_result = adfuller(y, regression='ct', maxlag=5)
> print("ADF Statistics with linear trend and intercept:", adf_result[0])
> print("p-value:", adf_result[1])
> print("Critical Values:", adf_result[4])
>
> adf_result_dummy = adfuller(y, regression='ct', maxlag=5,
>                                  autolag=None, addtrend='c',
>                                  regresults=results)
>
> print("ADF Statistics with linear trend, intercept and dummy variable:", adf_result_dummy[0])
> print("p-value:", adf_result_dummy[1])
> print("Critical Values:", adf_result_dummy[4])
>
> ```
>
> Ao executar o c√≥digo acima, os resultados mostram que, ao incluir a vari√°vel dummy, o teste de Dickey-Fuller agora n√£o rejeita a hip√≥tese nula de raiz unit√°ria de forma incorreta. O teste sem a dummy pode levar √† falsa rejei√ß√£o da hip√≥tese nula, indicando incorretamente que a s√©rie √© estacion√°ria, enquanto a inclus√£o da vari√°vel dummy corrige esse vi√©s.

**Teorema 1:** A inclus√£o de vari√°veis dummy para quebras estruturais no modelo de teste de raiz unit√°ria implica em um teste condicional √† localiza√ß√£o e magnitude das quebras.
*Prova:*
I.  O teste de raiz unit√°ria tradicional busca determinar se o processo √© estacion√°rio, assumindo que a tend√™ncia √© linear e as inova√ß√µes s√£o gaussianas.
II. Ao incluir vari√°veis dummy no modelo de teste de raiz unit√°ria, o teste passa a ser condicional aos pontos onde ocorrem as quebras.  O modelo que √© testado passa a ser:
$$ y_t = \alpha + \delta t + \sum_i \beta_i D_{it} + \epsilon_t $$
III. O teste passa a avaliar se, condicional aos pontos de quebra  $(T_1, T_2, \ldots, T_n)$ especificados pelas dummies, a s√©rie possui raiz unit√°ria.
IV.  Os resultados do teste s√£o v√°lidos para a especifica√ß√£o do modelo com as dummies.
V. Portanto, a inclus√£o de dummies no teste de raiz unit√°ria implica que o resultado do teste seja condicional √† presen√ßa das quebras nos pontos especificados pelas dummies. $\blacksquare$

**Lema 1:** A inclus√£o de vari√°veis dummy n√£o remove o problema da n√£o gaussianidade dos res√≠duos, mas torna o modelo mais adequado para an√°lise estat√≠stica.
*Prova:*
I.  A inclus√£o de vari√°veis dummy permite modelar explicitamente as mudan√ßas no intercepto ou na inclina√ß√£o da tend√™ncia, ou ambos.
II.  Contudo, a n√£o gaussianidade dos res√≠duos pode se manter devido √† natureza discreta das quebras.
III.  A modelagem com dummies n√£o muda as propriedades da distribui√ß√£o de $\eta_t$, que continua sendo uma distribui√ß√£o n√£o gaussiana com caudas pesadas.
IV.  O que ocorre √© que, com a modelagem correta da quebra, os res√≠duos da regress√£o se aproximam do conceito de ru√≠do branco, com m√©dia zero e vari√¢ncia constante.
V.  Portanto, embora as dummies corrijam o problema da quebra estrutural, a n√£o gaussianidade dos res√≠duos requer a utiliza√ß√£o de m√©todos de estima√ß√£o e infer√™ncia que acomodem essa caracter√≠stica.  $\blacksquare$

**Teorema 1.1:** Sob a hip√≥tese nula de raiz unit√°ria, e com o modelo de quebras modelado adequadamente, o teste de Dickey-Fuller aumentado (ADF) converge para sua distribui√ß√£o assint√≥tica padr√£o, condicional aos pontos de quebra.
*Prova:*
I. O teste ADF tradicional √© conhecido por convergir para uma distribui√ß√£o assint√≥tica n√£o padr√£o sob a hip√≥tese nula de raiz unit√°ria.
II. Ao incluir as vari√°veis dummy, a forma funcional da tend√™ncia determin√≠stica √© modelada adequadamente.
III.  A converg√™ncia para a distribui√ß√£o assint√≥tica padr√£o sob a hip√≥tese nula,  e condicional aos pontos de quebra $T_i$,  √© garantida pelas condi√ß√µes de regularidade dos estimadores de m√≠nimos quadrados ordin√°rios (OLS).
IV. Portanto, com a inclus√£o das vari√°veis dummy, podemos utilizar as tabelas padr√£o do teste ADF para avaliar a signific√¢ncia estat√≠stica da hip√≥tese nula, sempre que a especifica√ß√£o do modelo de quebras estiver correta. $\blacksquare$

**Lema 1.1:** A correta modelagem das quebras na tend√™ncia atrav√©s de vari√°veis dummy reduz a autocorrela√ß√£o nos res√≠duos do modelo, tornando a an√°lise de infer√™ncia mais confi√°vel.
*Prova:*
I. Modelos que n√£o consideram quebras na tend√™ncia podem apresentar res√≠duos com forte autocorrela√ß√£o, devido a erros de especifica√ß√£o na forma funcional da tend√™ncia.
II. A inclus√£o de dummies modela explicitamente as quebras, capturando parte da depend√™ncia serial nos res√≠duos.
III.  Dessa forma, ao modelarmos explicitamente as quebras, reduzimos a autocorrela√ß√£o nos res√≠duos, aproximando a sua distribui√ß√£o das premissas do modelo cl√°ssico de regress√£o linear.
IV.  Essa redu√ß√£o na autocorrela√ß√£o dos res√≠duos torna a an√°lise de infer√™ncia baseada no modelo de regress√£o com dummies mais confi√°vel.  $\blacksquare$

**Proposi√ß√£o 2:** A utiliza√ß√£o de testes de raiz unit√°ria robustos a quebras estruturais, como o teste de Zivot-Andrews, complementa a modelagem com vari√°veis dummy, oferecendo uma an√°lise mais completa da estacionariedade da s√©rie temporal.

*Prova:*
I.  Testes de raiz unit√°ria tradicionais como o ADF s√£o sens√≠veis √† presen√ßa de quebras estruturais, podendo levar a resultados err√¥neos.
II.  Testes como o de Zivot-Andrews, por outro lado, s√£o constru√≠dos para identificar a presen√ßa de quebras endogenamente, de acordo com os dados.
III.  A modelagem com vari√°veis dummy, como discutido nesse texto, permite quebrar explicitamente a n√£o estacionariedade do processo em suas diferentes formas (tend√™ncia, n√≠vel, etc.).
IV. A combina√ß√£o de modelagem com vari√°veis dummy e o uso de testes robustos a quebras estruturais, como o Zivot-Andrews, oferece uma estrat√©gia mais completa para a an√°lise de s√©ries temporais, permitindo que as quebras sejam modeladas de forma adequada e que a estacionariedade seja avaliada corretamente, mesmo quando existe a presen√ßa de quebras estruturais. $\blacksquare$

### Conclus√£o

A modelagem de quebras ocasionais na tend√™ncia utilizando vari√°veis dummy √© uma ferramenta fundamental para a an√°lise de s√©ries temporais n√£o estacion√°rias que s√£o afetadas por eventos discretos. A inclus√£o de vari√°veis dummy permite a representa√ß√£o flex√≠vel de quebras no intercepto ou na inclina√ß√£o da tend√™ncia, corrige o vi√©s dos testes de raiz unit√°ria tradicionais e permite obter estimativas mais precisas e infer√™ncias mais confi√°veis. Contudo, os res√≠duos, em geral, mant√™m caracter√≠sticas n√£o gaussianas. A modelagem com dummies, em conjunto com m√©todos apropriados de estima√ß√£o e infer√™ncia, √© essencial para uma an√°lise rigorosa de s√©ries temporais com quebras estruturais.
### Refer√™ncias
[^1]: Cap√≠tulo 15 do livro "Time Series Analysis" (informa√ß√µes retiradas de todo o cap√≠tulo).
<!-- END -->
