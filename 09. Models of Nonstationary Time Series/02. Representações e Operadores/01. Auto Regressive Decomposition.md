## An√°lise de Ra√≠zes e Estacionariedade em Modelos de S√©ries Temporais N√£o Estacion√°rias

### Introdu√ß√£o
Este cap√≠tulo explora modelos para s√©ries temporais n√£o estacion√°rias, expandindo os conceitos de modelos de s√©ries temporais univariadas apresentados nos Cap√≠tulos 3 e 4, que se limitavam a processos estacion√°rios [^1]. A n√£o estacionariedade √© uma caracter√≠stica comum em muitas s√©ries econ√¥micas e financeiras, como exemplificado pela tend√™ncia de crescimento do Produto Nacional Bruto (PNB) nominal dos Estados Unidos desde a Segunda Guerra Mundial [^1]. Para modelar tais tend√™ncias, introduzimos abordagens como a inclus√£o de tend√™ncias determin√≠sticas lineares e processos com raiz unit√°ria. Nesta se√ß√£o, vamos nos aprofundar na an√°lise do operador auto-regressivo e suas ra√≠zes, um conceito fundamental para entender a estacionariedade e a n√£o estacionariedade em s√©ries temporais.

### Conceitos Fundamentais
Como vimos anteriormente [^1], modelos de s√©ries temporais podem ser expressos na forma:

$$ y_t = \mu + \epsilon_t + \psi_1 \epsilon_{t-1} + \psi_2 \epsilon_{t-2} + \ldots = \mu + \psi(L)\epsilon_t $$

onde $\sum_{i=0}^{\infty} |\psi_i| < \infty$, as ra√≠zes de $\psi(z) = 0$ est√£o fora do c√≠rculo unit√°rio e $\{\epsilon_t\}$ √© uma sequ√™ncia de ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$. Essa formula√ß√£o garante a estacionariedade do processo, onde a esperan√ßa incondicional da vari√°vel √© constante e o forecast converge para a m√©dia incondicional √† medida que o horizonte de tempo avan√ßa [^1].

No entanto, para modelar tend√™ncias como a observada no PNB, abordagens alternativas s√£o necess√°rias. A primeira abordagem introduz uma tend√™ncia determin√≠stica linear [^1]:

$$ y_t = \alpha + \delta t + \psi(L)\epsilon_t $$

Nesse caso, a m√©dia $\mu$ do processo estacion√°rio √© substitu√≠da por uma fun√ß√£o linear do tempo $t$. Esse processo √© chamado *trend-stationary* porque, ao subtrair a tend√™ncia $\alpha + \delta t$, o resultado √© um processo estacion√°rio.

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal simulada com uma tend√™ncia linear e um componente AR(1): $y_t = 2 + 0.5t + u_t$, onde $u_t = 0.7u_{t-1} + \epsilon_t$ e $\epsilon_t \sim N(0, 1)$.  Aqui $\alpha = 2$ e $\delta = 0.5$. Ao longo do tempo, o valor de $y_t$ ir√° seguir uma trajet√≥ria ascendente, mas se removermos a tend√™ncia $2+0.5t$ o res√≠duo $u_t$ ser√° estacion√°rio.

A segunda especifica√ß√£o √© um processo com raiz unit√°ria [^1]:

$$(1 - L)y_t = \delta + \psi(L)\epsilon_t$$

Onde $(1-L)$ √© o operador de primeira diferen√ßa, denotado por $\Delta$.
A an√°lise das ra√≠zes do polin√¥mio caracter√≠stico do operador auto-regressivo (AR) √© crucial para distinguir entre processos estacion√°rios e n√£o estacion√°rios. Considere a seguinte especifica√ß√£o geral [^1]:

$$ y_t = \alpha + \delta t + u_t $$

onde $u_t$ segue um processo ARMA de m√©dia zero:
$$(1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)u_t = (1 + \theta_1 L + \theta_2 L^2 + \ldots + \theta_q L^q)\epsilon_t$$
que tamb√©m pode ser escrito como [^1]:
$$ \phi(L)u_t = \theta(L)\epsilon_t $$

Aqui, o operador autoregressivo $\phi(L)$ pode ser fatorado em termos lineares [^1]:
$$ \phi(L) = (1 - \lambda_1 L)(1 - \lambda_2 L) \ldots (1 - \lambda_p L) $$

onde $\lambda_i$ s√£o as ra√≠zes do polin√¥mio caracter√≠stico do operador auto-regressivo, que s√£o equivalentes aos autovalores da matriz associada ao modelo AR.
Se todas as ra√≠zes $\lambda_i$ est√£o dentro do c√≠rculo unit√°rio ( $|\lambda_i| < 1$ ), ent√£o o processo $u_t$ √© estacion√°rio e, por consequ√™ncia, $y_t$ √© um processo *trend-stationary*. No entanto, se pelo menos uma das ra√≠zes for igual a 1 (ou seja, $|\lambda_i| = 1$), o processo tem uma raiz unit√°ria e √© considerado n√£o estacion√°rio [^1]. Essa raiz unit√°ria implica que a s√©rie temporal n√£o retorna a uma m√©dia constante ao longo do tempo, mas pode ter uma tend√™ncia estoc√°stica.

> üí° **Exemplo Num√©rico:** Considere um modelo AR(1) onde $u_t = \phi u_{t-1} + \epsilon_t$. O polin√¥mio caracter√≠stico √© $1 - \phi L = 0$, ou seja,  $L = 1/\phi$.  Para que o processo seja estacion√°rio,  $|1/\phi| > 1$ que implica $|\phi| < 1$. Se $\phi = 0.8$ o processo √© estacion√°rio. Mas se $\phi = 1$,  $L = 1$ e o processo tem uma raiz unit√°ria.

Se uma das ra√≠zes for igual a 1 (por exemplo, $\lambda_1 = 1$), o processo pode ser escrito como [^1]:
$$(1 - L)(1 - \lambda_2 L)\ldots(1 - \lambda_p L)u_t = (1 + \theta_1 L + \theta_2 L^2 + \ldots + \theta_q L^q)\epsilon_t$$
que, aplicando a primeira diferen√ßa, resulta em:

$$ (1 - L)u_t = (1 + \theta_1^* L + \theta_2^* L^2 + \ldots + \theta_q^* L^q)\epsilon_t $$
Aqui $\theta^*(L)$ denota o operador de m√©dia m√≥vel resultante da manipula√ß√£o do polin√¥mio original.  Esta forma √© similar √† defini√ß√£o de um processo com raiz unit√°ria [^1]. Quando $\lambda_1 = 1$, o processo √© descrito como *integrated of order 1*, denotado como $y_t \sim I(1)$. Se duas ra√≠zes forem iguais a 1, ent√£o √© necess√°rio tomar a segunda diferen√ßa para obter um processo estacion√°rio, denotado como $y_t \sim I(2)$ [^1]. Em geral, um processo ARIMA(p, d, q) √© um modelo com p lags autoregressivos, d diferen√ßas e q lags de m√©dia m√≥vel [^1].

> üí° **Exemplo Num√©rico:** Suponha que temos um processo $y_t$ modelado como $y_t = y_{t-1} + \epsilon_t$. Este √© um processo com raiz unit√°ria. Aplicando a primeira diferen√ßa, temos: $(1-L)y_t = y_t - y_{t-1} = \epsilon_t$.  O processo diferenciado $\Delta y_t$ √© estacion√°rio, sendo um ru√≠do branco com m√©dia zero. Se tivermos uma s√©rie temporal $y_t = 1.2 y_{t-1} - 0.2 y_{t-2} + \epsilon_t$, o polin√¥mio caracter√≠stico √© $1 - 1.2L + 0.2L^2 = 0$. As ra√≠zes s√£o $L_1 = 1$ e $L_2 = 5$. Como uma das ra√≠zes √© igual a 1, o processo tem uma raiz unit√°ria e √© n√£o estacion√°rio. Ao aplicar a primeira diferen√ßa na s√©rie original, obteremos um processo estacion√°rio.

**Lema 1**
A equival√™ncia entre as ra√≠zes do polin√¥mio caracter√≠stico e os autovalores da matriz associada ao modelo AR pode ser demonstrada atrav√©s da representa√ß√£o do modelo AR em espa√ßo de estados.

*Demonstra√ß√£o:*
Um modelo AR(p) pode ser reescrito na forma de um sistema din√¢mico de primeira ordem, utilizando o que √© conhecido como representa√ß√£o em espa√ßo de estados. Para um modelo AR(p):
$$ u_t = \phi_1 u_{t-1} + \phi_2 u_{t-2} + \ldots + \phi_p u_{t-p} + \epsilon_t $$
Definimos um vetor de estados $x_t = [u_t, u_{t-1}, \ldots, u_{t-p+1}]^T$. Assim, podemos expressar o modelo AR(p) como:

$$x_t = A x_{t-1} + B \epsilon_t $$

onde:

$$
A = \begin{bmatrix}
\phi_1 & \phi_2 & \cdots & \phi_{p-1} & \phi_p \\
1 & 0 & \cdots & 0 & 0 \\
0 & 1 & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & 1 & 0
\end{bmatrix}, \quad
B = \begin{bmatrix}
1 \\ 0 \\ 0 \\ \vdots \\ 0
\end{bmatrix}
$$

O polin√¥mio caracter√≠stico da matriz *A* √© dado por $\det(A - \lambda I) = 0$, onde *I* √© a matriz identidade. Calculando este determinante, encontra-se que as ra√≠zes deste polin√¥mio caracter√≠stico s√£o id√™nticas √†s ra√≠zes do polin√¥mio caracter√≠stico do operador AR, ou seja,  $(1 - \phi_1 z - \phi_2 z^2 - \ldots - \phi_p z^p) = 0$. Portanto, os autovalores da matriz A s√£o exatamente as ra√≠zes do polin√¥mio caracter√≠stico do operador AR, completando a demonstra√ß√£o.
*Prova:*
I. O modelo AR(p) √© dado por:
    $$u_t = \phi_1 u_{t-1} + \phi_2 u_{t-2} + \ldots + \phi_p u_{t-p} + \epsilon_t$$
II. Definimos o vetor de estado $x_t$ como:
    $$x_t = \begin{bmatrix} u_t \\ u_{t-1} \\ \vdots \\ u_{t-p+1} \end{bmatrix}$$
III. O modelo em espa√ßo de estados pode ser expresso como:
    $$x_t = Ax_{t-1} + B\epsilon_t$$
    onde $A$ e $B$ s√£o definidos como:
     $$
    A = \begin{bmatrix}
    \phi_1 & \phi_2 & \cdots & \phi_{p-1} & \phi_p \\
    1 & 0 & \cdots & 0 & 0 \\
    0 & 1 & \cdots & 0 & 0 \\
    \vdots & \vdots & \ddots & \vdots & \vdots \\
    0 & 0 & \cdots & 1 & 0
    \end{bmatrix}, \quad
    B = \begin{bmatrix}
    1 \\ 0 \\ 0 \\ \vdots \\ 0
    \end{bmatrix}
    $$
IV. O polin√¥mio caracter√≠stico da matriz $A$ √© obtido por $\text{det}(A-\lambda I)=0$, onde $I$ √© a matriz identidade.
V. Calculando o determinante, temos:
     $$\text{det}(A - \lambda I) = \begin{vmatrix}
    \phi_1-\lambda & \phi_2 & \cdots & \phi_{p-1} & \phi_p \\
    1 & -\lambda & \cdots & 0 & 0 \\
    0 & 1 & \cdots & 0 & 0 \\
    \vdots & \vdots & \ddots & \vdots & \vdots \\
    0 & 0 & \cdots & 1 & -\lambda
    \end{vmatrix} = 0$$
VI. O determinante da matriz $A - \lambda I$ √© equivalente ao polin√¥mio:
$$(-\lambda)^p + \phi_1 (-\lambda)^{p-1} + \phi_2 (-\lambda)^{p-2} + \cdots + \phi_p = 0$$
VII. Multiplicando por $(-1)^p$ e substituindo $\lambda$ por $z^{-1}$, obtemos:
$$1 - \phi_1 z - \phi_2 z^2 - \cdots - \phi_p z^p = 0$$
VIII. Este √© o polin√¥mio caracter√≠stico do operador AR, onde as ra√≠zes s√£o os autovalores da matriz A, completando a prova. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere um modelo AR(2) com $\phi_1 = 0.5$ e $\phi_2 = 0.3$. O modelo √© dado por $u_t = 0.5u_{t-1} + 0.3u_{t-2} + \epsilon_t$.  Em espa√ßo de estados, temos:
>
> $$x_t = \begin{bmatrix} u_t \\ u_{t-1} \end{bmatrix}, \quad A = \begin{bmatrix} 0.5 & 0.3 \\ 1 & 0 \end{bmatrix}, \quad B = \begin{bmatrix} 1 \\ 0 \end{bmatrix}$$
>
> Para encontrar os autovalores de A, resolvemos  $\text{det}(A - \lambda I) = 0$:
>
> $$\begin{vmatrix} 0.5 - \lambda & 0.3 \\ 1 & - \lambda \end{vmatrix} = (0.5 - \lambda)(-\lambda) - (0.3)(1) = \lambda^2 - 0.5\lambda - 0.3 = 0$$
>
> As ra√≠zes do polin√¥mio caracter√≠stico s√£o encontradas atrav√©s da f√≥rmula quadr√°tica, que neste caso s√£o aproximadamente $\lambda_1 \approx 0.927$ e $\lambda_2 \approx -0.427$. Dado que $|\lambda_1| < 1$ e $|\lambda_2| < 1$, as ra√≠zes do polin√¥mio $1 - 0.5L - 0.3L^2 = 0$ s√£o tais que $|1/\lambda_i|>1$ e o processo √© estacion√°rio.

A import√¢ncia da fatora√ß√£o do operador AR √© que ela nos permite entender o comportamento do processo ao longo do tempo, especialmente em rela√ß√£o √† sua converg√™ncia ou diverg√™ncia em rela√ß√£o a um valor m√©dio [^1].
A decomposi√ß√£o do operador AR tamb√©m destaca a diferen√ßa entre um processo *trend-stationary* e um processo com raiz unit√°ria. Em um processo *trend-stationary*, a influ√™ncia de choques passados sobre o n√≠vel da s√©rie temporal desaparece ao longo do tempo, enquanto em um processo com raiz unit√°ria, choques passados t√™m um efeito permanente sobre o n√≠vel da s√©rie [^1].

**Teorema 1.1** (Condi√ß√£o de Estacionariedade para AR(p))
Um processo autoregressivo AR(p) definido por  $\phi(L)u_t = \epsilon_t$ √© estacion√°rio se, e somente se, todas as ra√≠zes do polin√¥mio caracter√≠stico $\phi(z) = 1 - \phi_1 z - \phi_2 z^2 - \ldots - \phi_p z^p = 0$ estiverem fora do c√≠rculo unit√°rio, i.e., $|\lambda_i| > 1$ para todo $i = 1, 2, \ldots, p$. Equivalentemente, todas as ra√≠zes do polin√¥mio inverso $\phi(L^{-1}) = 1 - \phi_1 L^{-1} - \phi_2 L^{-2} - \ldots - \phi_p L^{-p} = 0$ devem estar dentro do c√≠rculo unit√°rio, i.e., $|\lambda_i^{-1}| < 1$.
    *Demonstra√ß√£o:*
    I. A estacionariedade de um processo AR(p) implica que a solu√ß√£o do processo, $u_t$, pode ser expressa como uma combina√ß√£o linear de ru√≠dos brancos passados, convergindo para um valor finito.
    II. Isto s√≥ √© poss√≠vel se a influ√™ncia dos choques passados decresce ao longo do tempo.
    III. A fatora√ß√£o do operador autoregressivo $\phi(L)$ em $(1 - \lambda_1 L)(1 - \lambda_2 L)\ldots(1 - \lambda_p L)$ permite escrever a solu√ß√£o como uma combina√ß√£o linear de termos do tipo $\sum_{j=0}^{\infty} \lambda_i^j \epsilon_{t-j}$.
    IV. Para que esta soma convirja, √© necess√°rio que $|\lambda_i|<1$.
    V. Dado que as ra√≠zes que obtivemos s√£o do tipo $1/\lambda_i$, ent√£o a condi√ß√£o para que a s√©rie convirja √© que as ra√≠zes $\lambda_i$ do operador estejam fora do c√≠rculo unit√°rio, ou seja $|\lambda_i| > 1$.
    VI. No caso do polin√¥mio inverso, as ra√≠zes passam a ser $1/\lambda_i$, e para converg√™ncia, √© necess√°rio que $|1/\lambda_i| < 1$. ‚ñ†
    
> üí° **Exemplo Num√©rico:** Suponha que temos um modelo AR(1) $u_t = 0.8u_{t-1} + \epsilon_t$. O polin√¥mio caracter√≠stico √© $1 - 0.8L = 0$.  A raiz √© $L = 1/0.8 = 1.25$, que est√° fora do c√≠rculo unit√°rio ($|1.25| > 1$). Em termos do polin√¥mio inverso, $1 - 0.8L^{-1}=0$ e $L^{-1} = 0.8$ que est√° dentro do c√≠rculo unit√°rio ($|0.8| < 1$).  Logo o processo √© estacion√°rio.  Se tiv√©ssemos $u_t = 1.1u_{t-1} + \epsilon_t$,  o polin√¥mio caracter√≠stico seria $1-1.1L = 0$, com raiz $L = 1/1.1 \approx 0.91$ que est√° dentro do c√≠rculo unit√°rio e o processo √© n√£o estacion√°rio. Note que para este caso o polin√¥mio inverso $1-1.1L^{-1}=0$ resulta em $L^{-1} = 1.1$, que est√° fora do c√≠rculo unit√°rio.
    

### Conclus√£o
A decomposi√ß√£o do operador auto-regressivo em fatores lineares e a an√°lise das ra√≠zes do polin√¥mio caracter√≠stico s√£o ferramentas poderosas para entender a estacionariedade e a n√£o estacionariedade em modelos de s√©ries temporais. Ra√≠zes dentro do c√≠rculo unit√°rio levam a processos estacion√°rios, enquanto ra√≠zes iguais a um implicam n√£o estacionariedade e, consequentemente, a necessidade de aplicar diferencia√ß√£o para obter um processo estacion√°rio. Essa an√°lise √© essencial para escolher modelos apropriados para s√©ries temporais com tend√™ncias ou comportamento n√£o estacion√°rio, que s√£o comuns em dados econ√¥micos e financeiros. O estudo das ra√≠zes do polin√¥mio AR auxilia na compreens√£o do impacto de choques, persist√™ncia e comportamento assint√≥tico, permitindo melhor modelagem e previs√£o de s√©ries temporais.

### Refer√™ncias
[^1]: Modelos de S√©ries Temporais N√£o Estacion√°rias. *[Cap√≠tulo 15 do livro]*
<!-- END -->
