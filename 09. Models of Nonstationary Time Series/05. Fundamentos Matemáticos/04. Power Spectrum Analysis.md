## O Espectro de PotÃªncia e a DistinÃ§Ã£o entre Processos EstacionÃ¡rios e NÃ£o EstacionÃ¡rios

### IntroduÃ§Ã£o
Este capÃ­tulo aprofunda nossa anÃ¡lise de sÃ©ries temporais nÃ£o estacionÃ¡rias, focando no espectro de potÃªncia, uma ferramenta essencial na anÃ¡lise da frequÃªncia dos componentes de uma sÃ©rie temporal. Conforme discutido em capÃ­tulos anteriores, sÃ©ries temporais podem ser representadas como elementos de um espaÃ§o vetorial, e conceitos como autocovariÃ¢ncia e convergÃªncia em mÃ©dia quadrÃ¡tica (CMQ) sÃ£o fundamentais para a modelagem e previsÃ£o [^1, ^2, ^3]. Aqui, exploraremos como o espectro de potÃªncia, que Ã© a transformada de Fourier da funÃ§Ã£o de autocovariÃ¢ncia, revela propriedades distintas de processos estacionÃ¡rios e nÃ£o estacionÃ¡rios, especialmente aqueles com raiz unitÃ¡ria. Vamos investigar como o comportamento do espectro de potÃªncia na frequÃªncia zero nos ajuda a diferenciar esses dois tipos de processos e como isso se relaciona com a persistÃªncia de choques e a nÃ£o estacionariedade.

### Conceitos Fundamentais
O **espectro de potÃªncia** de uma sÃ©rie temporal Ã© uma funÃ§Ã£o que descreve como a potÃªncia (ou variÃ¢ncia) da sÃ©rie Ã© distribuÃ­da em diferentes frequÃªncias. Ele Ã© uma ferramenta fundamental para analisar os padrÃµes de frequÃªncia de uma sÃ©rie e identificar ciclos, tendÃªncias e outros componentes periÃ³dicos. O espectro de potÃªncia, ou densidade espectral de potÃªncia (PSD), Ã© a transformada de Fourier da funÃ§Ã£o de autocovariÃ¢ncia.

Para uma sÃ©rie temporal discreta $x_t$ com funÃ§Ã£o de autocovariÃ¢ncia $\gamma_k = Cov(x_t, x_{t-k})$, o espectro de potÃªncia $S(\omega)$ Ã© definido como:

$$S(\omega) = \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} \gamma_k e^{-i\omega k}$$

onde $\omega$ representa a frequÃªncia angular, e $i$ Ã© a unidade imaginÃ¡ria. O espectro de potÃªncia Ã© uma funÃ§Ã£o real e nÃ£o negativa, pois representa a distribuiÃ§Ã£o da potÃªncia da sÃ©rie em diferentes frequÃªncias.

A relaÃ§Ã£o entre o espectro de potÃªncia e a funÃ§Ã£o geradora de autocovariÃ¢ncia $g(z)$ pode ser expressa como:
$$ S(\omega) = \frac{1}{2\pi} g(e^{-i\omega}) $$
onde $g(z) = \sum_{k=-\infty}^\infty \gamma_k z^k$.

No contexto de sÃ©ries temporais, o espectro de potÃªncia Ã© uma ferramenta poderosa para:

1.  **Identificar ciclos:** Componentes periÃ³dicos na sÃ©rie se manifestam como picos no espectro em frequÃªncias correspondentes.
2.  **Analisar a persistÃªncia de choques:** O comportamento do espectro em frequÃªncias baixas estÃ¡ relacionado Ã  persistÃªncia dos choques.
3.  **Distinguir entre processos estacionÃ¡rios e nÃ£o estacionÃ¡rios:** O espectro de potÃªncia exibe propriedades distintas para esses dois tipos de processos.

**ObservaÃ§Ã£o:** O espectro de potÃªncia Ã© frequentemente calculado usando a transformada de Fourier discreta (DFT) em amostras finitas de sÃ©ries temporais. Isso resulta em uma estimativa do espectro que pode ser usada para anÃ¡lise prÃ¡tica.

#### O Espectro de PotÃªncia em Processos EstacionÃ¡rios
Para processos estacionÃ¡rios, o espectro de potÃªncia Ã© uma funÃ§Ã£o bem definida, nÃ£o negativa e finita. Uma propriedade fundamental Ã© que, para um processo estacionÃ¡rio com mÃ©dia zero, a integral do espectro de potÃªncia sobre todas as frequÃªncias Ã© igual Ã  variÃ¢ncia da sÃ©rie:
$$\int_{-\pi}^{\pi} S(\omega) \, d\omega = \gamma_0 = Var(x_t)$$
onde $\gamma_0$ Ã© a autocovariÃ¢ncia no lag zero.

> ğŸ’¡ **Exemplo NumÃ©rico:**
>
> Considere um processo AR(1) estacionÃ¡rio dado por $x_t = \phi x_{t-1} + \epsilon_t$, onde $|\phi| < 1$ e $\epsilon_t$ Ã© um ruÃ­do branco com variÃ¢ncia $\sigma^2$. A funÃ§Ã£o de autocovariÃ¢ncia desse processo Ã© $\gamma_k = \frac{\sigma^2}{1 - \phi^2} \phi^{|k|}$. O espectro de potÃªncia correspondente Ã©:
>
> $$ S(\omega) = \frac{\sigma^2}{2\pi} \frac{1}{1 - 2\phi \cos(\omega) + \phi^2}$$
>
> Para um processo AR(1) estacionÃ¡rio com $\phi=0.7$ e $\sigma^2 = 0.5$, o espectro Ã© dado por:
>
> $$ S(\omega) = \frac{0.5}{2\pi} \frac{1}{1 - 1.4\cos(\omega) + 0.49}$$
>
> Observe que esse espectro Ã© bem definido, nÃ£o negativo e finito. A integral do espectro sobre todas as frequÃªncias resulta na variÃ¢ncia da sÃ©rie, $\frac{\sigma^2}{1 - \phi^2} = \frac{0.5}{1 - 0.7^2} \approx 0.98$.
>
> Vamos simular esse processo e plotar seu espectro:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> def autocovariance(x, k):
>    n = len(x)
>    if k >= n:
>        return 0
>    x_mean = np.mean(x)
>    cov = np.mean((x[:n-k] - x_mean) * (x[k:] - x_mean))
>    return cov
>
> def calculate_spectrum(x, lags):
>   gamma_k = np.array([autocovariance(x, k) for k in lags])
>   omega = np.linspace(-np.pi, np.pi, 100)
>   spectrum = np.zeros_like(omega, dtype=complex)
>   for k, gamma in zip(lags, gamma_k):
>        spectrum += gamma * np.exp(-1j * omega * k)
>   spectrum /= (2*np.pi)
>   return omega, spectrum
>
> np.random.seed(42)
> T = 500
> phi = 0.7
> sigma = np.sqrt(0.5) # Standard deviation
> epsilon = np.random.normal(0, sigma, T)
> x = np.zeros(T)
> for t in range(1, T):
>   x[t] = phi*x[t-1] + epsilon[t]
>
> lags = np.arange(-20, 21)
> omega, spectrum = calculate_spectrum(x, lags)
>
> plt.figure(figsize=(8, 6))
> plt.plot(omega, np.abs(spectrum))
> plt.title("Espectro de PotÃªncia de um Processo AR(1)")
> plt.xlabel("FrequÃªncia ($\\omega$)")
> plt.ylabel("Densidade Espectral")
> plt.grid(True)
> plt.show()
> ```
>
> Este grÃ¡fico demonstrarÃ¡ um espectro bem definido, nÃ£o negativo e finito para todas as frequÃªncias, com um pico em torno da frequÃªncia zero, mas sem apresentar uma divergÃªncia.

#### O Espectro de PotÃªncia em Processos com Raiz UnitÃ¡ria

Em contraste com os processos estacionÃ¡rios, o espectro de potÃªncia para processos com raiz unitÃ¡ria apresenta um comportamento singular. Para um processo com raiz unitÃ¡ria, a funÃ§Ã£o de autocovariÃ¢ncia nÃ£o Ã© absolutamente somÃ¡vel, o que implica que o espectro de potÃªncia Ã© indefinido na frequÃªncia zero.

Considere o processo com raiz unitÃ¡ria:
$$(1-L)y_t = \delta + \psi(L)\epsilon_t$$
Definindo $x_t = (1-L)y_t$, temos que $x_t$ Ã© um processo estacionÃ¡rio, com espectro de potÃªncia bem definido $S_x(\omega)$. A funÃ§Ã£o geradora de autocovariÃ¢ncia de $(1-L)y_t$ Ã© dada por:

$$g_{\Delta y}(z) = \psi(z)\sigma^2\psi(z^{-1})$$

O espectro de potÃªncia do processo $\Delta y_t$ Ã© dado por
$$S_{\Delta y}(\omega) = \frac{1}{2\pi} \psi(e^{-i\omega})\sigma^2\psi(e^{i\omega})$$
Quando avaliamos em $\omega = 0$ (ou z=1), obtemos:
$$S_{\Delta y}(0) = \frac{1}{2\pi} [\psi(1)]^2\sigma^2$$
Se $\psi(1) \neq 0$, entÃ£o $S_{\Delta y}(0)$ Ã© positivo, indicando uma concentraÃ§Ã£o de potÃªncia em frequÃªncias baixas. Isso reflete a persistÃªncia de choques na sÃ©rie original $y_t$, conforme discutido em capÃ­tulos anteriores [^1, ^2].

O espectro de potÃªncia de $y_t$ pode ser formalmente expresso em termos de $S_{\Delta y}(\omega)$:

$$ S_y(\omega) = \frac{S_{\Delta y}(\omega)}{|1-e^{-i\omega}|^2}$$
A presenÃ§a do termo $|1-e^{-i\omega}|^2$ no denominador implica que quando $\omega \to 0$ o denominador tende a zero, fazendo com que $S_y(0)$ seja indefinido. Esse resultado indica que para processos com raiz unitÃ¡ria, a potÃªncia em frequÃªncias prÃ³ximas a zero tende ao infinito. Em outras palavras, a sÃ©rie nÃ£o tem um espectro de potÃªncia bem definido na frequÃªncia zero.

> ğŸ’¡ **Exemplo NumÃ©rico:**
>
> Considere o processo random walk $\Delta y_t = \epsilon_t$, onde $\psi(L) = 1$. Nesse caso, $S_{\Delta y}(\omega) = \frac{\sigma^2}{2\pi}$. O espectro de potÃªncia do random walk, $y_t$, Ã©:
>
> $$ S_y(\omega) = \frac{\sigma^2}{2\pi |1 - e^{-i\omega}|^2} = \frac{\sigma^2}{4\pi \sin^2(\omega/2)} $$
>
> Quando $\omega \to 0$, $S_y(\omega)$ tende a infinito. Isso Ã© consistente com a ideia de que processos com raiz unitÃ¡ria tÃªm variÃ¢ncia nÃ£o limitada no longo prazo.
>
> Considere tambÃ©m o processo $(1-L)y_t = 0.1 + (1 + 0.5L)\epsilon_t$. O espectro de potÃªncia de $\Delta y_t$ Ã© $S_{\Delta y}(\omega) = \frac{\sigma^2}{2\pi} |1 + 0.5e^{-i\omega}|^2$. Avaliando em $\omega=0$, obtemos $S_{\Delta y}(0) = \frac{1}{2\pi}(1.5)^2\sigma^2 = \frac{2.25\sigma^2}{2\pi}$. O espectro de $y_t$ Ã© $S_y(\omega) =  \frac{2.25\sigma^2}{2\pi|1 - e^{-i\omega}|^2}$  que diverge em $\omega=0$, novamente indicando um pico na frequÃªncia zero e persistÃªncia dos choques.
>
> Vamos simular o random walk e o processo com raiz unitÃ¡ria e exibir seus espectros estimados:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> def autocovariance(x, k):
>    n = len(x)
>    if k >= n:
>        return 0
>    x_mean = np.mean(x)
>    cov = np.mean((x[:n-k] - x_mean) * (x[k:] - x_mean))
>    return cov
>
> def calculate_spectrum(x, lags):
>   gamma_k = np.array([autocovariance(x, k) for k in lags])
>   omega = np.linspace(-np.pi, np.pi, 100)
>   spectrum = np.zeros_like(omega, dtype=complex)
>   for k, gamma in zip(lags, gamma_k):
>        spectrum += gamma * np.exp(-1j * omega * k)
>   spectrum /= (2*np.pi)
>   return omega, spectrum
>
> # SimulaÃ§Ã£o do Random Walk
> np.random.seed(42)
> T = 500
> sigma = np.sqrt(1) # Standard deviation
> epsilon = np.random.normal(0, sigma, T)
> y_rw = np.cumsum(epsilon)
> lags = np.arange(-20, 21)
> omega_rw, spectrum_rw = calculate_spectrum(y_rw, lags)
>
> # SimulaÃ§Ã£o do processo com raiz unitÃ¡ria
> np.random.seed(42)
> T = 500
> sigma = np.sqrt(1) # Standard deviation
> delta = 0.1
> psi1 = 0.5
> epsilon = np.random.normal(0, sigma, T)
> y_ur = np.zeros(T)
> for t in range(1, T):
>    y_ur[t] = y_ur[t-1] + delta + epsilon[t] + psi1*epsilon[t-1]
>
> omega_ur, spectrum_ur = calculate_spectrum(y_ur, lags)
>
>
> plt.figure(figsize=(12, 6))
> plt.subplot(1, 2, 1)
> plt.plot(omega_rw, np.abs(spectrum_rw))
> plt.title("Espectro de PotÃªncia do Random Walk")
> plt.xlabel("FrequÃªncia ($\\omega$)")
> plt.ylabel("Densidade Espectral")
> plt.grid(True)
>
>
> plt.subplot(1, 2, 2)
> plt.plot(omega_ur, np.abs(spectrum_ur))
> plt.title("Espectro de PotÃªncia de Processo com Raiz UnitÃ¡ria")
> plt.xlabel("FrequÃªncia ($\\omega$)")
> plt.ylabel("Densidade Espectral")
> plt.grid(True)
>
> plt.tight_layout()
> plt.show()
>
> ```
>
> O grÃ¡fico demonstrarÃ¡ que, para o random walk, o espectro de potÃªncia tende a infinito quando a frequÃªncia se aproxima de zero, enquanto o espectro do processo com raiz unitÃ¡ria tambÃ©m apresentarÃ¡ um pico pronunciado nas frequÃªncias prÃ³ximas a zero, indicando a forte persistÃªncia dos choques, e em ambos os casos o espectro serÃ¡ indefinido no zero.

**Lema 1:** _Para um processo estacionÃ¡rio $x_t$ com funÃ§Ã£o de autocovariÃ¢ncia $\gamma_k$, o espectro de potÃªncia $S(\omega)$ Ã© nÃ£o negativo e finito para todas as frequÃªncias $\omega$._

*Prova:*
I. Sabemos que o espectro de potÃªncia Ã© dado por $S(\omega) = \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} \gamma_k e^{-i\omega k}$.
II.  Para um processo estacionÃ¡rio, a funÃ§Ã£o de autocovariÃ¢ncia Ã© absolutamente somÃ¡vel, ou seja, $\sum_{k=-\infty}^{\infty} |\gamma_k| < \infty$.
III. Portanto, a soma na definiÃ§Ã£o do espectro de potÃªncia converge absolutamente, o que garante que $S(\omega)$ Ã© finito para todas as frequÃªncias.
IV. AlÃ©m disso, $S(\omega)$ Ã© nÃ£o negativo, pois a funÃ§Ã£o geradora de autocovariÃ¢ncia Ã© real e nÃ£o negativa quando avaliada em $z=e^{-i\omega}$.  Portanto, o espectro de potÃªncia de um processo estacionÃ¡rio Ã© nÃ£o negativo e finito.  $\blacksquare$

**Teorema 1:** _Se $y_t$ Ã© um processo com raiz unitÃ¡ria dado por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, onde $\psi(L)$ satisfaz $\sum_{j=0}^\infty |\psi_j| < \infty$ e $\psi(1) \neq 0$, entÃ£o o espectro de potÃªncia de $y_t$, $S_y(\omega)$, Ã© indefinido na frequÃªncia zero._

*Prova:*
I.  Sabemos que a funÃ§Ã£o geradora de autocovariÃ¢ncia de $\Delta y_t$ Ã© $g_{\Delta y}(z) = \psi(z)\sigma^2\psi(z^{-1})$.
II.  O espectro de potÃªncia de $\Delta y_t$ Ã© dado por $S_{\Delta y}(\omega) = \frac{1}{2\pi} g_{\Delta y}(e^{-i\omega}) = \frac{1}{2\pi} \psi(e^{-i\omega})\sigma^2\psi(e^{i\omega})$.
III. O espectro de potÃªncia do processo original $y_t$ Ã© dado por $S_y(\omega) = \frac{S_{\Delta y}(\omega)}{|1 - e^{-i\omega}|^2}$.
IV. Avaliando o espectro de $\Delta y_t$ na frequÃªncia zero, temos $S_{\Delta y}(0) = \frac{1}{2\pi} [\psi(1)]^2 \sigma^2$. Como $\psi(1) \neq 0$, entÃ£o $S_{\Delta y}(0) \neq 0$.
V. No denominador, quando $\omega \to 0$, $|1 - e^{-i\omega}|^2 \to 0$. Assim, o espectro de potÃªncia de $y_t$ na frequÃªncia zero Ã© dado por:
 $$ S_y(0) = \lim_{\omega \to 0} \frac{S_{\Delta y}(\omega)}{|1-e^{-i\omega}|^2} = \lim_{\omega \to 0} \frac{S_{\Delta y}(0)}{|1-e^{-i\omega}|^2}$$
VI. Como o denominador tende a zero e o numerador Ã© diferente de zero, o limite de $S_y(\omega)$ quando $\omega \to 0$ tende a infinito. Portanto, o espectro de potÃªncia do processo com raiz unitÃ¡ria Ã© indefinido na frequÃªncia zero. $\blacksquare$

**Teorema 1.1:** *Se $y_t$ Ã© um processo com raiz unitÃ¡ria tal que $\Delta y_t$ Ã© um processo ARMA(p,q), o espectro de potÃªncia de $y_t$, $S_y(\omega)$, tem um pÃ³lo em $\omega=0$, ou seja, $S_y(\omega)$ diverge quando $\omega \rightarrow 0$.*

*Prova:*
I. Se $\Delta y_t$ Ã© um processo ARMA(p,q), entÃ£o podemos representar seu espectro de potÃªncia como $S_{\Delta y}(\omega) = \frac{\sigma^2}{2\pi} \frac{|\theta(e^{-i\omega})|^2}{|\phi(e^{-i\omega})|^2}$ onde $\theta(z)$ e $\phi(z)$ sÃ£o os polinÃ´mios dos termos MA e AR respectivamente.
II.  Como $\Delta y_t$ Ã© estacionÃ¡rio, $S_{\Delta y}(0) = \frac{\sigma^2}{2\pi} \frac{|\theta(1)|^2}{|\phi(1)|^2}$ Ã© nÃ£o nulo e finito, pois todos os polos estÃ£o fora do cÃ­rculo unitÃ¡rio.
III. O espectro de potÃªncia de $y_t$ Ã© $S_y(\omega) = \frac{S_{\Delta y}(\omega)}{|1-e^{-i\omega}|^2}$.
IV.  Quando $\omega \rightarrow 0$, o termo $|1-e^{-i\omega}|^2 \rightarrow 0$.
V.  Portanto, o espectro $S_y(\omega)$ diverge quando $\omega \rightarrow 0$, possuindo um pÃ³lo em $\omega=0$. $\blacksquare$

**CorolÃ¡rio 1.1:** *Se a sÃ©rie temporal $y_t$ Ã© um processo integrado de ordem 1, I(1), entÃ£o seu espectro de potÃªncia $S_y(\omega)$ diverge quando $\omega \rightarrow 0$.*

*Prova:* Um processo integrado de ordem 1, I(1), significa que a primeira diferenÃ§a de $y_t$, isto Ã©, $\Delta y_t$, Ã© um processo estacionÃ¡rio. Portanto, segue diretamente do Teorema 1.1 que o espectro de potÃªncia de $y_t$ diverge em $\omega=0$. $\blacksquare$

### ImplicaÃ§Ãµes para a AnÃ¡lise de SÃ©ries Temporais

A diferenÃ§a no comportamento do espectro de potÃªncia entre processos estacionÃ¡rios e nÃ£o estacionÃ¡rios tem importantes implicaÃ§Ãµes para a anÃ¡lise de sÃ©ries temporais:

1.  **Teste de raiz unitÃ¡ria:** A propriedade do espectro de potÃªncia ser indefinido na frequÃªncia zero para processos com raiz unitÃ¡ria Ã© a base para testes de raiz unitÃ¡ria. Esses testes procuram identificar se o espectro de potÃªncia se comporta de forma compatÃ­vel com um processo com raiz unitÃ¡ria, ou seja, se existe uma concentraÃ§Ã£o de potÃªncia em frequÃªncias baixas.
2.  **InterpretaÃ§Ã£o da persistÃªncia:** O comportamento do espectro em frequÃªncias baixas revela a persistÃªncia dos choques. Em processos com raiz unitÃ¡ria, a concentraÃ§Ã£o de potÃªncia em frequÃªncias baixas indica que os choques tÃªm um efeito duradouro e impactam o nÃ­vel da sÃ©rie no longo prazo. Em contraste, em processos estacionÃ¡rios, a potÃªncia estÃ¡ mais distribuÃ­da em diferentes frequÃªncias, refletindo uma perda de memÃ³ria do processo ao longo do tempo.
3.  **Escolha do modelo:** A anÃ¡lise do espectro de potÃªncia pode ajudar na escolha de um modelo apropriado para uma sÃ©rie temporal. Se o espectro indica um comportamento de processo com raiz unitÃ¡ria, pode ser necessÃ¡rio utilizar transformaÃ§Ãµes, como diferenciaÃ§Ã£o, para tornar a sÃ©rie estacionÃ¡ria e permitir uma modelagem mais precisa.
4. **Entendimento da Variabilidade:** O espectro de potÃªncia oferece um entendimento da variabilidade da sÃ©rie em diferentes frequÃªncias. Em processos com raiz unitÃ¡ria a maior parte da variabilidade estÃ¡ concentrada em baixas frequÃªncias.

**ObservaÃ§Ã£o:** Para a estimativa do espectro de potÃªncia em amostras finitas, frequentemente utiliza-se o periodograma, que Ã© o quadrado da transformada discreta de Fourier da sÃ©rie temporal observada. O periodograma Ã© um estimador consistente mas nÃ£o enviesado do espectro de potÃªncia. Para obter estimativas mais suaves e com menor variÃ¢ncia, o periodograma pode ser suavizado com janelas espectrais ou mÃ©todos nÃ£o paramÃ©tricos.

### ConclusÃ£o

Neste capÃ­tulo, exploramos o conceito de espectro de potÃªncia e sua importÃ¢ncia na anÃ¡lise de sÃ©ries temporais. Vimos que o espectro de potÃªncia Ã© uma ferramenta poderosa para analisar padrÃµes de frequÃªncia e distinguir entre processos estacionÃ¡rios e nÃ£o estacionÃ¡rios. Em processos estacionÃ¡rios, o espectro Ã© bem definido, nÃ£o negativo e finito. Em contraste, em processos com raiz unitÃ¡ria, o espectro de potÃªncia Ã© indefinido na frequÃªncia zero, indicando uma concentraÃ§Ã£o de potÃªncia em frequÃªncias baixas e a persistÃªncia dos choques. Essa distinÃ§Ã£o Ã© fundamental para a modelagem e anÃ¡lise de sÃ©ries temporais e Ã© a base para a aplicaÃ§Ã£o de testes de raiz unitÃ¡ria, e fornece uma visÃ£o complementar das propriedades de persistÃªncia e nÃ£o estacionariedade vistas em capÃ­tulos anteriores [^1, ^2, ^3]. O entendimento do espectro de potÃªncia permite uma modelagem mais apropriada das sÃ©ries temporais e uma anÃ¡lise mais precisa das implicaÃ§Ãµes de longo prazo dos choques nas sÃ©ries econÃ´micas e financeiras.

### ReferÃªncias
[^1]: 15.1. Introduction
[^2]: 15.3. Comparison of Trend-Stationary and Unit Root Processes
[^3]: 15.2. Why Linear Time Trends and Unit Roots?
<!-- END -->
