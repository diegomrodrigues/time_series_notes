## O Espectro de Pot√™ncia e a Distin√ß√£o entre Processos Estacion√°rios e N√£o Estacion√°rios

### Introdu√ß√£o
Este cap√≠tulo aprofunda nossa an√°lise de s√©ries temporais n√£o estacion√°rias, focando no espectro de pot√™ncia, uma ferramenta essencial na an√°lise da frequ√™ncia dos componentes de uma s√©rie temporal. Conforme discutido em cap√≠tulos anteriores, s√©ries temporais podem ser representadas como elementos de um espa√ßo vetorial, e conceitos como autocovari√¢ncia e converg√™ncia em m√©dia quadr√°tica (CMQ) s√£o fundamentais para a modelagem e previs√£o [^1, ^2, ^3]. Aqui, exploraremos como o espectro de pot√™ncia, que √© a transformada de Fourier da fun√ß√£o de autocovari√¢ncia, revela propriedades distintas de processos estacion√°rios e n√£o estacion√°rios, especialmente aqueles com raiz unit√°ria. Vamos investigar como o comportamento do espectro de pot√™ncia na frequ√™ncia zero nos ajuda a diferenciar esses dois tipos de processos e como isso se relaciona com a persist√™ncia de choques e a n√£o estacionariedade.

### Conceitos Fundamentais
O **espectro de pot√™ncia** de uma s√©rie temporal √© uma fun√ß√£o que descreve como a pot√™ncia (ou vari√¢ncia) da s√©rie √© distribu√≠da em diferentes frequ√™ncias. Ele √© uma ferramenta fundamental para analisar os padr√µes de frequ√™ncia de uma s√©rie e identificar ciclos, tend√™ncias e outros componentes peri√≥dicos. O espectro de pot√™ncia, ou densidade espectral de pot√™ncia (PSD), √© a transformada de Fourier da fun√ß√£o de autocovari√¢ncia.

Para uma s√©rie temporal discreta $x_t$ com fun√ß√£o de autocovari√¢ncia $\gamma_k = Cov(x_t, x_{t-k})$, o espectro de pot√™ncia $S(\omega)$ √© definido como:

$$S(\omega) = \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} \gamma_k e^{-i\omega k}$$

onde $\omega$ representa a frequ√™ncia angular, e $i$ √© a unidade imagin√°ria. O espectro de pot√™ncia √© uma fun√ß√£o real e n√£o negativa, pois representa a distribui√ß√£o da pot√™ncia da s√©rie em diferentes frequ√™ncias.

A rela√ß√£o entre o espectro de pot√™ncia e a fun√ß√£o geradora de autocovari√¢ncia $g(z)$ pode ser expressa como:
$$ S(\omega) = \frac{1}{2\pi} g(e^{-i\omega}) $$
onde $g(z) = \sum_{k=-\infty}^\infty \gamma_k z^k$.

No contexto de s√©ries temporais, o espectro de pot√™ncia √© uma ferramenta poderosa para:

1.  **Identificar ciclos:** Componentes peri√≥dicos na s√©rie se manifestam como picos no espectro em frequ√™ncias correspondentes.
2.  **Analisar a persist√™ncia de choques:** O comportamento do espectro em frequ√™ncias baixas est√° relacionado √† persist√™ncia dos choques.
3.  **Distinguir entre processos estacion√°rios e n√£o estacion√°rios:** O espectro de pot√™ncia exibe propriedades distintas para esses dois tipos de processos.

**Observa√ß√£o:** O espectro de pot√™ncia √© frequentemente calculado usando a transformada de Fourier discreta (DFT) em amostras finitas de s√©ries temporais. Isso resulta em uma estimativa do espectro que pode ser usada para an√°lise pr√°tica.

#### O Espectro de Pot√™ncia em Processos Estacion√°rios
Para processos estacion√°rios, o espectro de pot√™ncia √© uma fun√ß√£o bem definida, n√£o negativa e finita. Uma propriedade fundamental √© que, para um processo estacion√°rio com m√©dia zero, a integral do espectro de pot√™ncia sobre todas as frequ√™ncias √© igual √† vari√¢ncia da s√©rie:
$$\int_{-\pi}^{\pi} S(\omega) \, d\omega = \gamma_0 = Var(x_t)$$
onde $\gamma_0$ √© a autocovari√¢ncia no lag zero.

> üí° **Exemplo Num√©rico:**
>
> Considere um processo AR(1) estacion√°rio dado por $x_t = \phi x_{t-1} + \epsilon_t$, onde $|\phi| < 1$ e $\epsilon_t$ √© um ru√≠do branco com vari√¢ncia $\sigma^2$. A fun√ß√£o de autocovari√¢ncia desse processo √© $\gamma_k = \frac{\sigma^2}{1 - \phi^2} \phi^{|k|}$. O espectro de pot√™ncia correspondente √©:
>
> $$ S(\omega) = \frac{\sigma^2}{2\pi} \frac{1}{1 - 2\phi \cos(\omega) + \phi^2}$$
>
> Para um processo AR(1) estacion√°rio com $\phi=0.7$ e $\sigma^2 = 0.5$, o espectro √© dado por:
>
> $$ S(\omega) = \frac{0.5}{2\pi} \frac{1}{1 - 1.4\cos(\omega) + 0.49}$$
>
> Observe que esse espectro √© bem definido, n√£o negativo e finito. A integral do espectro sobre todas as frequ√™ncias resulta na vari√¢ncia da s√©rie, $\frac{\sigma^2}{1 - \phi^2} = \frac{0.5}{1 - 0.7^2} \approx 0.98$.
>
> Vamos simular esse processo e plotar seu espectro:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> def autocovariance(x, k):
>    n = len(x)
>    if k >= n:
>        return 0
>    x_mean = np.mean(x)
>    cov = np.mean((x[:n-k] - x_mean) * (x[k:] - x_mean))
>    return cov
>
> def calculate_spectrum(x, lags):
>   gamma_k = np.array([autocovariance(x, k) for k in lags])
>   omega = np.linspace(-np.pi, np.pi, 100)
>   spectrum = np.zeros_like(omega, dtype=complex)
>   for k, gamma in zip(lags, gamma_k):
>        spectrum += gamma * np.exp(-1j * omega * k)
>   spectrum /= (2*np.pi)
>   return omega, spectrum
>
> np.random.seed(42)
> T = 500
> phi = 0.7
> sigma = np.sqrt(0.5) # Standard deviation
> epsilon = np.random.normal(0, sigma, T)
> x = np.zeros(T)
> for t in range(1, T):
>   x[t] = phi*x[t-1] + epsilon[t]
>
> lags = np.arange(-20, 21)
> omega, spectrum = calculate_spectrum(x, lags)
>
> plt.figure(figsize=(8, 6))
> plt.plot(omega, np.abs(spectrum))
> plt.title("Espectro de Pot√™ncia de um Processo AR(1)")
> plt.xlabel("Frequ√™ncia ($\\omega$)")
> plt.ylabel("Densidade Espectral")
> plt.grid(True)
> plt.show()
> ```
>
> Este gr√°fico demonstrar√° um espectro bem definido, n√£o negativo e finito para todas as frequ√™ncias, com um pico em torno da frequ√™ncia zero, mas sem apresentar uma diverg√™ncia.

#### O Espectro de Pot√™ncia em Processos com Raiz Unit√°ria

Em contraste com os processos estacion√°rios, o espectro de pot√™ncia para processos com raiz unit√°ria apresenta um comportamento singular. Para um processo com raiz unit√°ria, a fun√ß√£o de autocovari√¢ncia n√£o √© absolutamente som√°vel, o que implica que o espectro de pot√™ncia √© indefinido na frequ√™ncia zero.

Considere o processo com raiz unit√°ria:
$$(1-L)y_t = \delta + \psi(L)\epsilon_t$$
Definindo $x_t = (1-L)y_t$, temos que $x_t$ √© um processo estacion√°rio, com espectro de pot√™ncia bem definido $S_x(\omega)$. A fun√ß√£o geradora de autocovari√¢ncia de $(1-L)y_t$ √© dada por:

$$g_{\Delta y}(z) = \psi(z)\sigma^2\psi(z^{-1})$$

O espectro de pot√™ncia do processo $\Delta y_t$ √© dado por
$$S_{\Delta y}(\omega) = \frac{1}{2\pi} \psi(e^{-i\omega})\sigma^2\psi(e^{i\omega})$$
Quando avaliamos em $\omega = 0$ (ou z=1), obtemos:
$$S_{\Delta y}(0) = \frac{1}{2\pi} [\psi(1)]^2\sigma^2$$
Se $\psi(1) \neq 0$, ent√£o $S_{\Delta y}(0)$ √© positivo, indicando uma concentra√ß√£o de pot√™ncia em frequ√™ncias baixas. Isso reflete a persist√™ncia de choques na s√©rie original $y_t$, conforme discutido em cap√≠tulos anteriores [^1, ^2].

O espectro de pot√™ncia de $y_t$ pode ser formalmente expresso em termos de $S_{\Delta y}(\omega)$:

$$ S_y(\omega) = \frac{S_{\Delta y}(\omega)}{|1-e^{-i\omega}|^2}$$
A presen√ßa do termo $|1-e^{-i\omega}|^2$ no denominador implica que quando $\omega \to 0$ o denominador tende a zero, fazendo com que $S_y(0)$ seja indefinido. Esse resultado indica que para processos com raiz unit√°ria, a pot√™ncia em frequ√™ncias pr√≥ximas a zero tende ao infinito. Em outras palavras, a s√©rie n√£o tem um espectro de pot√™ncia bem definido na frequ√™ncia zero.

> üí° **Exemplo Num√©rico:**
>
> Considere o processo random walk $\Delta y_t = \epsilon_t$, onde $\psi(L) = 1$. Nesse caso, $S_{\Delta y}(\omega) = \frac{\sigma^2}{2\pi}$. O espectro de pot√™ncia do random walk, $y_t$, √©:
>
> $$ S_y(\omega) = \frac{\sigma^2}{2\pi |1 - e^{-i\omega}|^2} = \frac{\sigma^2}{4\pi \sin^2(\omega/2)} $$
>
> Quando $\omega \to 0$, $S_y(\omega)$ tende a infinito. Isso √© consistente com a ideia de que processos com raiz unit√°ria t√™m vari√¢ncia n√£o limitada no longo prazo.
>
> Considere tamb√©m o processo $(1-L)y_t = 0.1 + (1 + 0.5L)\epsilon_t$. O espectro de pot√™ncia de $\Delta y_t$ √© $S_{\Delta y}(\omega) = \frac{\sigma^2}{2\pi} |1 + 0.5e^{-i\omega}|^2$. Avaliando em $\omega=0$, obtemos $S_{\Delta y}(0) = \frac{1}{2\pi}(1.5)^2\sigma^2 = \frac{2.25\sigma^2}{2\pi}$. O espectro de $y_t$ √© $S_y(\omega) =  \frac{2.25\sigma^2}{2\pi|1 - e^{-i\omega}|^2}$  que diverge em $\omega=0$, novamente indicando um pico na frequ√™ncia zero e persist√™ncia dos choques.
>
> Vamos simular o random walk e o processo com raiz unit√°ria e exibir seus espectros estimados:
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> def autocovariance(x, k):
>    n = len(x)
>    if k >= n:
>        return 0
>    x_mean = np.mean(x)
>    cov = np.mean((x[:n-k] - x_mean) * (x[k:] - x_mean))
>    return cov
>
> def calculate_spectrum(x, lags):
>   gamma_k = np.array([autocovariance(x, k) for k in lags])
>   omega = np.linspace(-np.pi, np.pi, 100)
>   spectrum = np.zeros_like(omega, dtype=complex)
>   for k, gamma in zip(lags, gamma_k):
>        spectrum += gamma * np.exp(-1j * omega * k)
>   spectrum /= (2*np.pi)
>   return omega, spectrum
>
> # Simula√ß√£o do Random Walk
> np.random.seed(42)
> T = 500
> sigma = np.sqrt(1) # Standard deviation
> epsilon = np.random.normal(0, sigma, T)
> y_rw = np.cumsum(epsilon)
> lags = np.arange(-20, 21)
> omega_rw, spectrum_rw = calculate_spectrum(y_rw, lags)
>
> # Simula√ß√£o do processo com raiz unit√°ria
> np.random.seed(42)
> T = 500
> sigma = np.sqrt(1) # Standard deviation
> delta = 0.1
> psi1 = 0.5
> epsilon = np.random.normal(0, sigma, T)
> y_ur = np.zeros(T)
> for t in range(1, T):
>    y_ur[t] = y_ur[t-1] + delta + epsilon[t] + psi1*epsilon[t-1]
>
> omega_ur, spectrum_ur = calculate_spectrum(y_ur, lags)
>
>
> plt.figure(figsize=(12, 6))
> plt.subplot(1, 2, 1)
> plt.plot(omega_rw, np.abs(spectrum_rw))
> plt.title("Espectro de Pot√™ncia do Random Walk")
> plt.xlabel("Frequ√™ncia ($\\omega$)")
> plt.ylabel("Densidade Espectral")
> plt.grid(True)
>
>
> plt.subplot(1, 2, 2)
> plt.plot(omega_ur, np.abs(spectrum_ur))
> plt.title("Espectro de Pot√™ncia de Processo com Raiz Unit√°ria")
> plt.xlabel("Frequ√™ncia ($\\omega$)")
> plt.ylabel("Densidade Espectral")
> plt.grid(True)
>
> plt.tight_layout()
> plt.show()
>
> ```
>
> O gr√°fico demonstrar√° que, para o random walk, o espectro de pot√™ncia tende a infinito quando a frequ√™ncia se aproxima de zero, enquanto o espectro do processo com raiz unit√°ria tamb√©m apresentar√° um pico pronunciado nas frequ√™ncias pr√≥ximas a zero, indicando a forte persist√™ncia dos choques, e em ambos os casos o espectro ser√° indefinido no zero.

**Lema 1:** _Para um processo estacion√°rio $x_t$ com fun√ß√£o de autocovari√¢ncia $\gamma_k$, o espectro de pot√™ncia $S(\omega)$ √© n√£o negativo e finito para todas as frequ√™ncias $\omega$._

*Prova:*
I. Sabemos que o espectro de pot√™ncia √© dado por $S(\omega) = \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} \gamma_k e^{-i\omega k}$.
II.  Para um processo estacion√°rio, a fun√ß√£o de autocovari√¢ncia √© absolutamente som√°vel, ou seja, $\sum_{k=-\infty}^{\infty} |\gamma_k| < \infty$.
III. Portanto, a soma na defini√ß√£o do espectro de pot√™ncia converge absolutamente, o que garante que $S(\omega)$ √© finito para todas as frequ√™ncias.
IV. Al√©m disso, $S(\omega)$ √© n√£o negativo, pois a fun√ß√£o geradora de autocovari√¢ncia √© real e n√£o negativa quando avaliada em $z=e^{-i\omega}$.  Portanto, o espectro de pot√™ncia de um processo estacion√°rio √© n√£o negativo e finito.  $\blacksquare$

**Teorema 1:** _Se $y_t$ √© um processo com raiz unit√°ria dado por $(1-L)y_t = \delta + \psi(L)\epsilon_t$, onde $\psi(L)$ satisfaz $\sum_{j=0}^\infty |\psi_j| < \infty$ e $\psi(1) \neq 0$, ent√£o o espectro de pot√™ncia de $y_t$, $S_y(\omega)$, √© indefinido na frequ√™ncia zero._

*Prova:*
I.  Sabemos que a fun√ß√£o geradora de autocovari√¢ncia de $\Delta y_t$ √© $g_{\Delta y}(z) = \psi(z)\sigma^2\psi(z^{-1})$.
II.  O espectro de pot√™ncia de $\Delta y_t$ √© dado por $S_{\Delta y}(\omega) = \frac{1}{2\pi} g_{\Delta y}(e^{-i\omega}) = \frac{1}{2\pi} \psi(e^{-i\omega})\sigma^2\psi(e^{i\omega})$.
III. O espectro de pot√™ncia do processo original $y_t$ √© dado por $S_y(\omega) = \frac{S_{\Delta y}(\omega)}{|1 - e^{-i\omega}|^2}$.
IV. Avaliando o espectro de $\Delta y_t$ na frequ√™ncia zero, temos $S_{\Delta y}(0) = \frac{1}{2\pi} [\psi(1)]^2 \sigma^2$. Como $\psi(1) \neq 0$, ent√£o $S_{\Delta y}(0) \neq 0$.
V. No denominador, quando $\omega \to 0$, $|1 - e^{-i\omega}|^2 \to 0$. Assim, o espectro de pot√™ncia de $y_t$ na frequ√™ncia zero √© dado por:
 $$ S_y(0) = \lim_{\omega \to 0} \frac{S_{\Delta y}(\omega)}{|1-e^{-i\omega}|^2} = \lim_{\omega \to 0} \frac{S_{\Delta y}(0)}{|1-e^{-i\omega}|^2}$$
VI. Como o denominador tende a zero e o numerador √© diferente de zero, o limite de $S_y(\omega)$ quando $\omega \to 0$ tende a infinito. Portanto, o espectro de pot√™ncia do processo com raiz unit√°ria √© indefinido na frequ√™ncia zero. $\blacksquare$

**Teorema 1.1:** *Se $y_t$ √© um processo com raiz unit√°ria tal que $\Delta y_t$ √© um processo ARMA(p,q), o espectro de pot√™ncia de $y_t$, $S_y(\omega)$, tem um p√≥lo em $\omega=0$, ou seja, $S_y(\omega)$ diverge quando $\omega \rightarrow 0$.*

*Prova:*
I. Se $\Delta y_t$ √© um processo ARMA(p,q), ent√£o podemos representar seu espectro de pot√™ncia como $S_{\Delta y}(\omega) = \frac{\sigma^2}{2\pi} \frac{|\theta(e^{-i\omega})|^2}{|\phi(e^{-i\omega})|^2}$ onde $\theta(z)$ e $\phi(z)$ s√£o os polin√¥mios dos termos MA e AR respectivamente.
II.  Como $\Delta y_t$ √© estacion√°rio, $S_{\Delta y}(0) = \frac{\sigma^2}{2\pi} \frac{|\theta(1)|^2}{|\phi(1)|^2}$ √© n√£o nulo e finito, pois todos os polos est√£o fora do c√≠rculo unit√°rio.
III. O espectro de pot√™ncia de $y_t$ √© $S_y(\omega) = \frac{S_{\Delta y}(\omega)}{|1-e^{-i\omega}|^2}$.
IV.  Quando $\omega \rightarrow 0$, o termo $|1-e^{-i\omega}|^2 \rightarrow 0$.
V.  Portanto, o espectro $S_y(\omega)$ diverge quando $\omega \rightarrow 0$, possuindo um p√≥lo em $\omega=0$. $\blacksquare$

**Corol√°rio 1.1:** *Se a s√©rie temporal $y_t$ √© um processo integrado de ordem 1, I(1), ent√£o seu espectro de pot√™ncia $S_y(\omega)$ diverge quando $\omega \rightarrow 0$.*

*Prova:* Um processo integrado de ordem 1, I(1), significa que a primeira diferen√ßa de $y_t$, isto √©, $\Delta y_t$, √© um processo estacion√°rio. Portanto, segue diretamente do Teorema 1.1 que o espectro de pot√™ncia de $y_t$ diverge em $\omega=0$. $\blacksquare$

### Implica√ß√µes para a An√°lise de S√©ries Temporais

A diferen√ßa no comportamento do espectro de pot√™ncia entre processos estacion√°rios e n√£o estacion√°rios tem importantes implica√ß√µes para a an√°lise de s√©ries temporais:

1.  **Teste de raiz unit√°ria:** A propriedade do espectro de pot√™ncia ser indefinido na frequ√™ncia zero para processos com raiz unit√°ria √© a base para testes de raiz unit√°ria. Esses testes procuram identificar se o espectro de pot√™ncia se comporta de forma compat√≠vel com um processo com raiz unit√°ria, ou seja, se existe uma concentra√ß√£o de pot√™ncia em frequ√™ncias baixas.
2.  **Interpreta√ß√£o da persist√™ncia:** O comportamento do espectro em frequ√™ncias baixas revela a persist√™ncia dos choques. Em processos com raiz unit√°ria, a concentra√ß√£o de pot√™ncia em frequ√™ncias baixas indica que os choques t√™m um efeito duradouro e impactam o n√≠vel da s√©rie no longo prazo. Em contraste, em processos estacion√°rios, a pot√™ncia est√° mais distribu√≠da em diferentes frequ√™ncias, refletindo uma perda de mem√≥ria do processo ao longo do tempo.
3.  **Escolha do modelo:** A an√°lise do espectro de pot√™ncia pode ajudar na escolha de um modelo apropriado para uma s√©rie temporal. Se o espectro indica um comportamento de processo com raiz unit√°ria, pode ser necess√°rio utilizar transforma√ß√µes, como diferencia√ß√£o, para tornar a s√©rie estacion√°ria e permitir uma modelagem mais precisa.
4. **Entendimento da Variabilidade:** O espectro de pot√™ncia oferece um entendimento da variabilidade da s√©rie em diferentes frequ√™ncias. Em processos com raiz unit√°ria a maior parte da variabilidade est√° concentrada em baixas frequ√™ncias.

**Observa√ß√£o:** Para a estimativa do espectro de pot√™ncia em amostras finitas, frequentemente utiliza-se o periodograma, que √© o quadrado da transformada discreta de Fourier da s√©rie temporal observada. O periodograma √© um estimador consistente mas n√£o enviesado do espectro de pot√™ncia. Para obter estimativas mais suaves e com menor vari√¢ncia, o periodograma pode ser suavizado com janelas espectrais ou m√©todos n√£o param√©tricos.

### Conclus√£o

Neste cap√≠tulo, exploramos o conceito de espectro de pot√™ncia e sua import√¢ncia na an√°lise de s√©ries temporais. Vimos que o espectro de pot√™ncia √© uma ferramenta poderosa para analisar padr√µes de frequ√™ncia e distinguir entre processos estacion√°rios e n√£o estacion√°rios. Em processos estacion√°rios, o espectro √© bem definido, n√£o negativo e finito. Em contraste, em processos com raiz unit√°ria, o espectro de pot√™ncia √© indefinido na frequ√™ncia zero, indicando uma concentra√ß√£o de pot√™ncia em frequ√™ncias baixas e a persist√™ncia dos choques. Essa distin√ß√£o √© fundamental para a modelagem e an√°lise de s√©ries temporais e √© a base para a aplica√ß√£o de testes de raiz unit√°ria, e fornece uma vis√£o complementar das propriedades de persist√™ncia e n√£o estacionariedade vistas em cap√≠tulos anteriores [^1, ^2, ^3]. O entendimento do espectro de pot√™ncia permite uma modelagem mais apropriada das s√©ries temporais e uma an√°lise mais precisa das implica√ß√µes de longo prazo dos choques nas s√©ries econ√¥micas e financeiras.

### Refer√™ncias
[^1]: 15.1. Introduction
[^2]: 15.3. Comparison of Trend-Stationary and Unit Root Processes
[^3]: 15.2. Why Linear Time Trends and Unit Roots?
<!-- END -->
