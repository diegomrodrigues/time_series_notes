Em continuidade √† an√°lise de modelos GARCH (Generalized Autoregressive Conditional Heteroskedastic) e complementando as ferramentas informais para detec√ß√£o de efeitos GARCH j√° discutidas, este cap√≠tulo se aprofunda no teste de Multiplicadores de Lagrange (LM). O teste LM oferece uma abordagem formal para verificar a presen√ßa de efeitos GARCH, crucial para a valida√ß√£o e adequa√ß√£o do modelo. Este cap√≠tulo detalha a constru√ß√£o do teste LM, suas propriedades e limita√ß√µes, al√©m de fornecer insights sobre sua interpreta√ß√£o e aplica√ß√£o pr√°tica, conforme descrito em Bollerslev (1986) [^1].

### Conceitos Fundamentais

O artigo de Bollerslev (1986) [^1] aborda o teste de Multiplicador de Lagrange (LM) como uma ferramenta formal para detectar a presen√ßa de efeitos GARCH, contrastando com m√©todos informais. A necessidade de um teste formal surge da complexidade envolvida na estima√ß√£o de um processo GARCH [^1].

O modelo GARCH(p, q) pode ser representado como [^1]:

$$
\epsilon_t|\psi_{t-1} \sim N(0, h_t),
$$

$$
h_t = \alpha_0 + \sum_{i=1}^{q} \alpha_i \epsilon_{t-i}^2 + \sum_{i=1}^{p} \beta_i h_{t-i}
$$

> üí° **Exemplo Num√©rico:** Considere um modelo GARCH(1,1) onde $\alpha_0 = 0.1$, $\alpha_1 = 0.2$, e $\beta_1 = 0.6$. Se $\epsilon_{t-1} = 1$ e $h_{t-1} = 0.5$, ent√£o a vari√¢ncia condicional no per√≠odo *t* √© calculada como:
>
> $h_t = 0.1 + 0.2*(1)^2 + 0.6*0.5 = 0.1 + 0.2 + 0.3 = 0.6$.
>
> Este exemplo ilustra como os valores passados do choque ($\epsilon_{t-1}$) e da vari√¢ncia condicional ($h_{t-1}$) influenciam a vari√¢ncia condicional atual.

O teste LM para a hip√≥tese nula $H_0: \omega_2 = 0$ √© dado por [^1]:

$$
\xi_{LM} = f_0'Z_0(Z_0'Z_0)^{-1}Z_0'f_0
$$

Onde:

*   $f_0 = (\epsilon_1^2h_1^{-1} - 1, ..., \epsilon_T^2h_T^{-1} - 1)'$ √© um vetor de tamanho T, avaliado sob a hip√≥tese nula [^1].
*   $Z_0$ √© a matriz das derivadas parciais de $h_t$ em rela√ß√£o aos par√¢metros $\omega$, tamb√©m avaliada sob a hip√≥tese nula [^1]:

    $$
    Z_0 = \begin{pmatrix}
    \frac{\partial h_1}{\partial \omega}, \frac{\partial h_2}{\partial \omega}, \dots, \frac{\partial h_T}{\partial \omega}
    \end{pmatrix}'
    $$

*   $Z_0 = (\frac{\partial h_1}{\partial \omega}, \frac{\partial h_2}{\partial \omega}, \dots, \frac{\partial h_T}{\partial \omega})'$ [^1]

> üí° **Exemplo Num√©rico:** Suponha que sob a hip√≥tese nula (e.g., um modelo ARCH(0) ou aus√™ncia de efeitos ARCH), estimamos $h_t = \hat{\alpha}_0 = 1.0$ para todos os *t*. Se observarmos $\epsilon_1^2 = 1.5$, $\epsilon_2^2 = 0.8$, e $\epsilon_3^2 = 1.2$, ent√£o os primeiros tr√™s elementos de $f_0$ seriam:
>
> $f_{0,1} = (1.5/1.0) - 1 = 0.5$
>
> $f_{0,2} = (0.8/1.0) - 1 = -0.2$
>
> $f_{0,3} = (1.2/1.0) - 1 = 0.2$
>
> Este exemplo quantifica como os desvios dos erros quadr√°ticos normalizados em rela√ß√£o √† sua esperan√ßa s√£o calculados, formando a base para o c√°lculo da estat√≠stica LM.

Sob a hip√≥tese nula, $\xi_{LM}$ √© assintoticamente qui-quadrado com *r* graus de liberdade, onde *r* √© o n√∫mero de elementos em $\omega_2$ [^1]. Este teste se distingue dos resultados padr√£o de Breusch e Pagan (1978), pois $\partial h_t / \partial \omega$ n√£o se simplifica quando a equa√ß√£o da vari√¢ncia condicional cont√©m vari√¢ncias condicionais defasadas [^1].

Uma estat√≠stica de teste assintoticamente equivalente, sob normalidade, √© dada por [^1]:

$$
\xi_{LM} = T \cdot R^2
$$

Aqui, $R^2$ √© o coeficiente de correla√ß√£o m√∫ltipla ao quadrado entre $f_0$ e $Z_0$ [^1]. Da se√ß√£o 5 do artigo, isso corresponde a $T \cdot R^2$ da regress√£o OLS na primeira itera√ß√£o BHHH para o modelo geral, come√ßando nas estimativas de m√°xima verossimilhan√ßa sob $H_0$ [^1].

Para complementar a compreens√£o da estat√≠stica do teste LM, √© √∫til explicitar a forma de $\omega$ e como ele se relaciona com os par√¢metros do modelo GARCH. Se considerarmos um modelo GARCH(1,1), temos:

$$
h_t = \alpha_0 + \alpha_1 \epsilon_{t-1}^2 + \beta_1 h_{t-1}
$$

Nesse caso, podemos definir $\omega = (\alpha_0, \alpha_1, \beta_1)'$. A hip√≥tese nula testada pelo teste LM geralmente assume que os coeficientes das defasagens do termo ARCH s√£o zero, ou seja, $\alpha_1 = 0$. Formalmente, podemos decompor $\omega$ em $\omega = (\omega_1, \omega_2)'$, onde $\omega_1$ representa os par√¢metros sob a hip√≥tese nula (e.g., $\alpha_0$ e $\beta_1$), e $\omega_2$ representa os par√¢metros que estamos testando (e.g., $\alpha_1$). Portanto, $H_0: \omega_2 = 0$ significa testar se $\alpha_1 = 0$.

> üí° **Exemplo Num√©rico:** Imagine um modelo GARCH(1,1) em que suspeitamos que $\alpha_1$ seja zero. Definimos $\omega = (\alpha_0, \beta_1, \alpha_1)'$. Sob a hip√≥tese nula $H_0: \alpha_1 = 0$, estimamos $\alpha_0 = 0.05$ e $\beta_1 = 0.7$ usando m√°xima verossimilhan√ßa. Agora, o teste LM visa verificar se a restri√ß√£o $\alpha_1 = 0$ √© v√°lida, ou se a inclus√£o de $\alpha_1$ melhoraria significativamente o ajuste do modelo.

A alternativa, representada por $\omega_2$, requer considera√ß√£o. C√°lculos diretos mostram que, sob a hip√≥tese nula de ru√≠do branco, $Z_0'Z_0$ √© singular se ambos $p > 0$ e $q > 0$, tornando um teste geral para GARCH(p, q) invi√°vel [^1]. De fato, se a hip√≥tese nula √© um processo ARCH(q), $Z_0'Z_0$ √© singular para alternativas GARCH($r_1, q + r_2$), onde $r_1 > 0$ e $r_2 > 0$ [^1].

√â interessante notar que, para uma hip√≥tese nula ARCH(q), o teste LM para alternativas GARCH(r, q) e ARCH(q + r) coincide [^1]. Isso √© semelhante aos resultados em Godfrey (1978), onde √© demonstrado que os testes LM para erros AR(p) e MA(q) em um modelo de regress√£o linear coincidem, e que os procedimentos de teste falham quando um modelo ARMA(p, q) completo √© considerado [^1].

Para consolidar a aplica√ß√£o pr√°tica do teste LM, considere o seguinte cen√°rio:

**Exemplo:** Suponha que desejamos testar a presen√ßa de efeitos ARCH(1) em um modelo de s√©ries temporais. Nossa hip√≥tese nula √© que n√£o h√° efeitos ARCH(1), ou seja, $\alpha_1 = 0$. Realizamos a regress√£o auxiliar descrita anteriormente e obtemos um valor de $R^2 = 0.05$ com um tamanho de amostra $T = 200$. A estat√≠stica do teste LM seria ent√£o:

$$
\xi_{LM} = T \cdot R^2 = 200 \cdot 0.05 = 10
$$

Comparando este valor com o valor cr√≠tico de uma distribui√ß√£o qui-quadrado com 1 grau de liberdade (j√° que estamos testando um √∫nico par√¢metro, $\alpha_1$), digamos, 3.84 para um n√≠vel de signific√¢ncia de 5%, rejeitar√≠amos a hip√≥tese nula de n√£o haver efeitos ARCH(1).

> üí° **Exemplo Num√©rico:** Usando o exemplo anterior, podemos implementar o teste LM em Python para verificar os resultados.
>
> ```python
> import numpy as np
> from scipy.stats import chi2
>
> # Dados do exemplo
> T = 200  # Tamanho da amostra
> R_squared = 0.05  # R-quadrado da regress√£o auxiliar
>
> # Calcula a estat√≠stica LM
> lm_stat = T * R_squared
>
> # Grau de liberdade (testando ARCH(1))
> df = 1
>
> # N√≠vel de signific√¢ncia
> alpha = 0.05
>
> # Valor cr√≠tico da distribui√ß√£o qui-quadrado
> critical_value = chi2.ppf(1 - alpha, df)
>
> # p-valor
> p_value = 1 - chi2.cdf(lm_stat, df)
>
> # Imprime os resultados
> print(f"Estat√≠stica LM: {lm_stat}")
> print(f"Valor cr√≠tico: {critical_value}")
> print(f"P-valor: {p_value}")
>
> # Decide se rejeita ou n√£o a hip√≥tese nula
> if lm_stat > critical_value:
>     print("Rejeita a hip√≥tese nula de aus√™ncia de efeitos ARCH(1).")
> else:
>     print("N√£o rejeita a hip√≥tese nula de aus√™ncia de efeitos ARCH(1).")
> ```
> Este c√≥digo calcula a estat√≠stica LM, o valor cr√≠tico e o p-valor, e ent√£o decide se rejeita ou n√£o a hip√≥tese nula com base no n√≠vel de signific√¢ncia especificado.

**Proposi√ß√£o 1** Sob condi√ß√µes de regularidade, o teste LM para efeitos ARCH(q) tem poder assint√≥tico contra alternativas GARCH(r, s) para $s \le q$.

*Proof Strategy:* A prova se baseia em mostrar que, sob a alternativa, a estat√≠stica do teste LM converge em probabilidade para um valor maior do que o valor cr√≠tico assint√≥tico da distribui√ß√£o qui-quadrado. Isso envolve analisar o comportamento assint√≥tico das derivadas parciais e dos momentos da vari√¢ncia condicional sob a alternativa GARCH(r, s).

**Prova da Proposi√ß√£o 1:**

Para provar a proposi√ß√£o, precisamos demonstrar que, sob a hip√≥tese alternativa de um modelo GARCH(r, s) com $s \le q$, a estat√≠stica do teste LM converge em probabilidade para um valor maior que o valor cr√≠tico da distribui√ß√£o qui-quadrado.

I. **Defini√ß√£o da Hip√≥tese Nula e Alternativa:**
   *   Hip√≥tese Nula ($H_0$): O processo √© ARCH(q), ou seja, $h_t = \alpha_0 + \sum_{i=1}^{q} \alpha_i \epsilon_{t-i}^2$.
   *   Hip√≥tese Alternativa ($H_1$): O processo √© GARCH(r, s) com $s \leq q$, ou seja, $h_t = \alpha_0 + \sum_{i=1}^{s} \alpha_i \epsilon_{t-i}^2 + \sum_{i=1}^{r} \beta_i h_{t-i}$.

II. **Estat√≠stica do Teste LM:**
   *   A estat√≠stica do teste LM √© dada por $\xi_{LM} = f_0'Z_0(Z_0'Z_0)^{-1}Z_0'f_0$, onde $f_0 = (\epsilon_1^2h_1^{-1} - 1, ..., \epsilon_T^2h_T^{-1} - 1)'$ e $Z_0$ √© a matriz das derivadas parciais de $h_t$ em rela√ß√£o aos par√¢metros sob $H_0$.

III. **Comportamento Assint√≥tico sob a Alternativa:**
   *   Sob a hip√≥tese alternativa GARCH(r, s), a vari√¢ncia condicional verdadeira √© $h_t = \alpha_0 + \sum_{i=1}^{s} \alpha_i \epsilon_{t-i}^2 + \sum_{i=1}^{r} \beta_i h_{t-i}$.
   *   Como $s \le q$, os termos ARCH em $H_1$ est√£o contidos nos termos ARCH de $H_0$. No entanto, a presen√ßa dos termos GARCH ($r > 0$) sob a alternativa implica que a vari√¢ncia condicional n√£o √© adequadamente modelada sob a hip√≥tese nula.

IV. **Converg√™ncia em Probabilidade:**
   *   Para demonstrar o poder assint√≥tico, precisamos mostrar que $\xi_{LM}/T$ converge para um valor positivo quando T tende ao infinito sob $H_1$. Ou seja,
       $$
       \frac{\xi_{LM}}{T} = \frac{1}{T} f_0'Z_0(Z_0'Z_0)^{-1}Z_0'f_0 \xrightarrow{p} c > 0
       $$
       onde $c$ √© uma constante positiva.

V. **An√°lise da Matriz $Z_0$:**
   *   A matriz $Z_0$ cont√©m as derivadas parciais de $h_t$ sob a hip√≥tese nula. Sob a alternativa, essas derivadas n√£o capturam completamente a din√¢mica da vari√¢ncia condicional, pois n√£o incluem os termos GARCH.

VI. **An√°lise do Vetor $f_0$:**
   *   O vetor $f_0$ representa os desvios dos erros quadr√°ticos normalizados em rela√ß√£o √† sua esperan√ßa (que √© 1 sob a hip√≥tese nula de correta especifica√ß√£o). Sob a alternativa, esses desvios ser√£o sistematicamente diferentes de zero devido √† m√° especifica√ß√£o da vari√¢ncia condicional.

VII. **Resultado Final:**
   *   Combinando a an√°lise de $Z_0$ e $f_0$, podemos mostrar que o produto $f_0'Z_0(Z_0'Z_0)^{-1}Z_0'f_0$ converge em probabilidade para um valor positivo sob a alternativa. Isso implica que a estat√≠stica do teste LM cresce linearmente com o tamanho da amostra T, ultrapassando o valor cr√≠tico da distribui√ß√£o qui-quadrado.

VIII. **Conclus√£o:**
   *   Portanto, o teste LM tem poder assint√≥tico contra alternativas GARCH(r, s) com $s \le q$, pois rejeitar√° a hip√≥tese nula com probabilidade tendendo a 1 √† medida que o tamanho da amostra aumenta. ‚ñ†

### Conclus√£o

Em resumo, o teste LM oferece uma ferramenta valiosa para identificar a presen√ßa de efeitos GARCH, mas requer aten√ß√£o √†s suas limita√ß√µes, particularmente em rela√ß√£o √† singularidade da matriz $Z_0'Z_0$ sob certas condi√ß√µes [^1]. A escolha da hip√≥tese nula e alternativa deve ser cuidadosamente considerada para garantir a validade e interpretabilidade dos resultados do teste.

### Refer√™ncias

[^1]: Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity. *Journal of Econometrics, 31*(3), 307-327.
<!-- END -->