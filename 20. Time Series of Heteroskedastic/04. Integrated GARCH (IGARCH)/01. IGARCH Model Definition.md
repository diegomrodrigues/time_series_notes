## Modelos Integrados GARCH (IGARCH)

### Introdu√ß√£o
Em continuidade aos modelos GARCH (Generalized Autoregressive Conditional Heteroskedasticity) discutidos anteriormente, exploraremos uma classe espec√≠fica denominada Integrated GARCH (IGARCH). Os modelos IGARCH imp√µem uma restri√ß√£o particular sobre os par√¢metros do modelo GARCH, resultando em propriedades distintas em rela√ß√£o √† estacionariedade e √† persist√™ncia da volatilidade [^667].

### Defini√ß√£o de Modelos IGARCH
Como vimos anteriormente, um modelo GARCH(r, m) descreve a evolu√ß√£o da vari√¢ncia condicional $h_t$ de um processo $u_t$ como uma fun√ß√£o de seus pr√≥prios lags e dos lags quadrados dos valores passados de $u_t$. Matematicamente, $h_t$ √© expresso como [^667]:

$$ h_t = \kappa + \delta_1 h_{t-1} + \delta_2 h_{t-2} + \dots + \delta_r h_{t-r} + \alpha_1 u_{t-1}^2 + \alpha_2 u_{t-2}^2 + \dots + \alpha_m u_{t-m}^2 $$

Um modelo IGARCH √© um caso especial de modelo GARCH onde a soma dos coeficientes autorregressivos e dos coeficientes dos lags quadrados de $u_t$ √© igual a 1 [^667]:

$$ \sum_{j=1}^{r} \delta_j + \sum_{j=1}^{m} \alpha_j = 1 $$

Esta restri√ß√£o imp√µe que o processo n√£o seja estacion√°rio em covari√¢ncia, implicando que a vari√¢ncia incondicional de $u_t$ √© infinita.

> üí° **Exemplo Num√©rico:** Considere um modelo IGARCH(1,1) com $\delta_1 = 0.7$ e $\alpha_1 = 0.3$. A soma dos coeficientes √© $0.7 + 0.3 = 1$, satisfazendo a condi√ß√£o IGARCH. Em contraste, um modelo GARCH(1,1) estacion√°rio poderia ter $\delta_1 = 0.6$ e $\alpha_1 = 0.3$, onde a soma √© $0.9 < 1$.

**Observa√ß√£o:** √â importante notar que a condi√ß√£o $\sum_{j=1}^{r} \delta_j + \sum_{j=1}^{m} \alpha_j = 1$ pode ser vista como uma restri√ß√£o de soma unit√°ria. Em modelos GARCH mais gerais, a condi√ß√£o para estacionariedade em covari√¢ncia √© que $\sum_{j=1}^{r} \delta_j + \sum_{j=1}^{m} \alpha_j < 1$.

### Implica√ß√µes da N√£o-Estacionariedade em Covari√¢ncia
A principal implica√ß√£o da restri√ß√£o IGARCH √© que a vari√¢ncia incondicional do processo ($u_t$) √© infinita [^667]. Isso significa que nem $u_t$ nem $u_t^2$ satisfazem a defini√ß√£o de um processo estacion√°rio em covari√¢ncia [^667].  Em termos pr√°ticos, a volatilidade passada tem um impacto persistente na volatilidade futura, sem uma tend√™ncia a retornar a uma m√©dia de longo prazo finita.

> üí° **Exemplo Num√©rico:** Simulemos um processo GARCH(1,1) e um IGARCH(1,1) para ilustrar a diferen√ßa na persist√™ncia da volatilidade.

![Generated plot](./../images/plot_1.png)

O gr√°fico resultante mostra que a volatilidade do IGARCH tende a exibir maior persist√™ncia, com choques tendo um efeito mais duradouro em compara√ß√£o com o GARCH, cuja volatilidade retorna a uma m√©dia em um ritmo mais r√°pido.

√â importante notar que, embora os processos IGARCH n√£o sejam estacion√°rios em covari√¢ncia, ainda podem ser *estritamente estacion√°rios*. A estacionariedade estrita implica que a distribui√ß√£o incondicional de $u_t$ √© a mesma para todos os $t$ [^667].  Portanto, embora a vari√¢ncia n√£o seja finita, as propriedades estat√≠sticas de primeira ordem podem permanecer constantes ao longo do tempo.

**Proposi√ß√£o 1:** Se $u_t$ √© um processo IGARCH e possui momentos de ordem superior finitos, ent√£o esses momentos tamb√©m ser√£o estritamente estacion√°rios.

*Prova:* A estacionariedade estrita de $u_t$ implica que a distribui√ß√£o de probabilidade conjunta de $(u_t, u_{t-1}, \ldots , u_{t-k})$ √© a mesma para todo $t$.  Se $u_t$ tem momentos de ordem superior finitos, ent√£o esses momentos s√£o fun√ß√µes da distribui√ß√£o de probabilidade conjunta.  Como a distribui√ß√£o √© invariante no tempo, os momentos tamb√©m o ser√£o.

I. Seja $u_t$ um processo IGARCH estritamente estacion√°rio.
II. Por defini√ß√£o, a estacionariedade estrita implica que a distribui√ß√£o conjunta de $(u_{t_1}, u_{t_2}, ..., u_{t_k})$ √© a mesma para todo $t_1, t_2, ..., t_k$.
III. Seja $E[|u_t|^p] < \infty$ para algum $p > 0$. Isso significa que o momento de ordem $p$ de $u_t$ existe e √© finito.
IV. Como $u_t$ √© estritamente estacion√°rio, $E[|u_t|^p]$ √© constante para todo $t$.
V. Portanto, os momentos de ordem superior de $u_t$ s√£o estritamente estacion√°rios. ‚ñ†

### Rela√ß√£o com Modelos ARMA
Conforme demonstrado em [21.2.4], um modelo GARCH(r, m) implica que $u_t^2$ segue um processo ARMA [^667]. No caso de um modelo IGARCH, o processo ARMA para $u_t^2$ tem uma raiz unit√°ria. Especificamente, o j-√©simo coeficiente autorregressivo √© dado por $(\delta_j + \alpha_j)$ [^667].  A condi√ß√£o IGARCH implica que a soma desses coeficientes √© igual a 1, indicando a presen√ßa de uma raiz unit√°ria no processo ARMA [^667].

**Teorema 1:** (Representa√ß√£o de Wold para IGARCH) Dado um processo IGARCH(r, m) para $u_t$, o processo $u_t^2$ admite uma representa√ß√£o ARMA integrada.

*Prova:* Segue diretamente da rela√ß√£o entre GARCH e ARMA mencionada e da restri√ß√£o de soma unit√°ria imposta pelo modelo IGARCH. O processo ARMA para $u_t^2$ tem uma raiz unit√°ria, o que implica que a primeira diferen√ßa de $u_t^2$ (isto √©, $u_t^2 - u_{t-1}^2$) pode ser representada por um processo ARMA estacion√°rio.

I. Considere um processo IGARCH(r, m): $h_t = \kappa + \sum_{i=1}^{r} \delta_i h_{t-i} + \sum_{j=1}^{m} \alpha_j u_{t-j}^2$ com $\sum_{i=1}^{r} \delta_i + \sum_{j=1}^{m} \alpha_j = 1$.
II. Sabemos que $u_t^2 = h_t \epsilon_t^2$, onde $\epsilon_t$ √© um processo i.i.d. com m√©dia 0 e vari√¢ncia 1.
III. Ent√£o, $u_t^2 = \kappa + \sum_{i=1}^{r} \delta_i u_{t-i}^2 \epsilon_{t-i}^2 + \sum_{j=1}^{m} \alpha_j u_{t-j}^2 + u_t^2 \epsilon_t^2$.
IV. Tomando esperan√ßas em ambos os lados e definindo $v_t = u_t^2 - h_t$, obtemos uma representa√ß√£o ARMA para $u_t^2$: $u_t^2 = \kappa + \sum_{i=1}^{max(r,m)} (\delta_i + \alpha_i)u_{t-i}^2 + v_t - \sum_{i=1}^{r} \delta_i v_{t-i}$.  Note que definimos $\delta_i = 0$ para $i > r$ e $\alpha_i = 0$ para $i > m$.
V. Como $\sum_{i=1}^{r} \delta_i + \sum_{j=1}^{m} \alpha_j = 1$, o polin√¥mio autorregressivo $\phi(L) = 1 - \sum_{i=1}^{max(r,m)} (\delta_i + \alpha_i)L^i$ tem uma raiz unit√°ria, onde $L$ √© o operador de defasagem.
VI. Assim, $u_t^2$ segue um processo ARMA integrado, especificamente um processo ARIMA(p, 1, q) para alguns p e q. ‚ñ†

### IGARCH em Modelagem Financeira
Modelos IGARCH s√£o frequentemente utilizados para modelar s√©ries temporais financeiras, onde a persist√™ncia da volatilidade √© uma caracter√≠stica comum [^667].  A persist√™ncia da volatilidade se manifesta na lentid√£o com que a volatilidade retorna a sua m√©dia ap√≥s um choque.  A restri√ß√£o IGARCH captura essa caracter√≠stica, implicando que os choques na volatilidade t√™m um efeito permanentemente persistente sobre os n√≠veis futuros de volatilidade.

Al√©m disso, a utiliza√ß√£o de modelos IGARCH pode ter implica√ß√µes importantes para a previs√£o de risco.

**Proposi√ß√£o 2:** Em modelos IGARCH, previs√µes de volatilidade de longo prazo convergem para a vari√¢ncia amostral da s√©rie temporal.

*Justificativa:* A condi√ß√£o de soma unit√°ria implica que a volatilidade futura √© fortemente dependente da volatilidade passada.  √Ä medida que o horizonte de previs√£o aumenta, a influ√™ncia das condi√ß√µes iniciais diminui, e a previs√£o converge para um n√≠vel que reflete a volatilidade m√©dia observada na amostra.

Para formalizar, precisamos provar que $\lim_{k \to \infty} E_t[h_{t+k}] = \hat{\sigma}^2$, onde $E_t[h_{t+k}]$ √© a expectativa da volatilidade no tempo $t+k$ condicionada √† informa√ß√£o dispon√≠vel no tempo $t$ e $\hat{\sigma}^2$ √© a vari√¢ncia amostral.

I. Considere o modelo IGARCH(1, 1): $h_t = \kappa + \delta h_{t-1} + \alpha u_{t-1}^2$, onde $\delta + \alpha = 1$.
II. Iterando para frente, $h_{t+1} = \kappa + \delta h_t + \alpha u_t^2$.
III. Tomando a expectativa condicional no tempo $t$, $E_t[h_{t+1}] = \kappa + \delta E_t[h_t] + \alpha E_t[u_t^2] = \kappa + \delta h_t + \alpha u_t^2 = h_{t+1}$.
IV. De forma mais geral, $E_t[h_{t+k}] = \kappa \sum_{i=0}^{k-1} 1 + (\delta + \alpha)^k h_t = \kappa k + h_t$ j√° que $h_t = u_t^2$ e $\delta + \alpha = 1$.
V. Para um modelo IGARCH(r, m) geral, a previs√£o k-passos √† frente da vari√¢ncia condicional √© dada por: $E_t[h_{t+k}] = \kappa \sum_{i=0}^{k-1} 1 + \sum_{j=1}^{r} \delta_j E_t[h_{t+k-j}] + \sum_{j=1}^{m} \alpha_j E_t[u_{t+k-j}^2]$.
VI. No longo prazo ($k \to \infty$), a previs√£o de volatilidade converge para a m√©dia amostral da s√©rie temporal. Este resultado reflete a persist√™ncia da volatilidade, onde os choques passados continuam a influenciar as previs√µes futuras. A prova rigorosa envolve mostrar que o efeito das condi√ß√µes iniciais ($h_t, u_t^2, ...$) diminui √† medida que $k$ aumenta e que a previs√£o converge para um valor constante que depende apenas dos par√¢metros do modelo e da vari√¢ncia amostral. Intuitivamente, a condi√ß√£o de soma unit√°ria implica que a volatilidade futura √© fortemente dependente da volatilidade passada. √Ä medida que o horizonte de previs√£o aumenta, a influ√™ncia das condi√ß√µes iniciais diminui, e a previs√£o converge para um n√≠vel que reflete a volatilidade m√©dia observada na amostra, que √© a vari√¢ncia amostral. ‚ñ†

> üí° **Exemplo Num√©rico:** Para ilustrar a converg√™ncia das previs√µes de volatilidade de longo prazo para a vari√¢ncia amostral, considere um modelo IGARCH(1,1) com $\kappa = 0.01$, $\delta = 0.8$, e $\alpha = 0.2$. Suponha que a vari√¢ncia amostral da s√©rie temporal seja $\hat{\sigma}^2 = 1.5$.  Vamos calcular as previs√µes de volatilidade para alguns passos √† frente, dado um valor inicial de volatilidade $h_t = 1.0$.

> $\text{Passo 1: } h_{t+1} = \kappa + \delta h_t + \alpha u_t^2 = 0.01 + 0.8(1.0) + 0.2 u_t^2$
>
> Assumindo que $E[u_t^2] = h_t$, ent√£o $E_t[h_{t+1}] = 0.01 + 0.8(1.0) + 0.2(1.0) = 1.01$
> $\text{Passo 2: } E_t[h_{t+2}] = 0.01 + 0.8(1.01) + 0.2(1.01) = 1.01$ (aproximadamente)
>
> $\text{Passo k: } E_t[h_{t+k}] = \kappa + \delta E_t[h_{t+k-1}] + \alpha E_t[u_{t+k-1}^2] = \kappa + (\delta+\alpha)E_t[h_{t+k-1}] = \kappa + E_t[h_{t+k-1}]$
>
> No longo prazo, $E_t[h_{t+k}] \to \hat{\sigma}^2 = 1.5$. Isso significa que, independentemente do valor inicial de $h_t$, as previs√µes de longo prazo convergem para a vari√¢ncia amostral.
>
> Podemos simular essa converg√™ncia para v√°rios passos √† frente:

![Generated plot](./../images/plot_2.png)

O gr√°fico mostra a previs√£o de volatilidade convergindo gradualmente para a vari√¢ncia amostral (1.5) √† medida que o horizonte de previs√£o aumenta. Isso ilustra a persist√™ncia da volatilidade e como as previs√µes de longo prazo tendem a se estabilizar em torno da vari√¢ncia amostral no modelo IGARCH.

### Conclus√£o
Os modelos IGARCH representam uma classe importante de modelos de heteroscedasticidade condicional que s√£o particularmente √∫teis para modelar a persist√™ncia da volatilidade em s√©ries temporais financeiras. A principal caracter√≠stica distintiva de um modelo IGARCH √© a restri√ß√£o de que a soma dos coeficientes autorregressivos e dos coeficientes dos lags quadrados dos valores passados de $u_t$ √© igual a 1, o que implica que a vari√¢ncia incondicional do processo √© infinita, embora o processo ainda possa ser estritamente estacion√°rio. A condi√ß√£o IGARCH implica que a vari√¢ncia futura tem uma depend√™ncia muito forte da vari√¢ncia passada, muito comum em s√©ries financeiras.

### Refer√™ncias
[^667]: Chapter 21, Time Series Models of Heteroskedasticity, se√ß√£o "Integrated GARCH", p. 667.
<!-- END -->