## Estacionariedade em Covari√¢ncia de Processos AR(p)

### Introdu√ß√£o

Este cap√≠tulo aprofunda a discuss√£o sobre os **processos autoregressivos de ordem *p* (AR(*p*))**, focando especificamente na condi√ß√£o de **estacionariedade em covari√¢ncia** [^1]. A estacionariedade √© uma propriedade crucial para a an√°lise e modelagem de s√©ries temporais, garantindo que as caracter√≠sticas estat√≠sticas do processo se mantenham constantes ao longo do tempo. Aqui, exploraremos em detalhe a condi√ß√£o para estacionariedade em covari√¢ncia, expressa em termos das ra√≠zes da equa√ß√£o polinomial caracter√≠stica do processo AR(*p*), e suas implica√ß√µes pr√°ticas. Este cap√≠tulo complementa a discuss√£o anterior sobre modelos AR(*p*) e previs√£o linear √≥tima, estabelecendo as bases para an√°lises mais avan√ßadas de s√©ries temporais heterosced√°sticas.

### Condi√ß√£o de Estacionariedade em Covari√¢ncia Detalhada

Conforme introduzido no cap√≠tulo anterior, um processo AR(*p*) √© definido como [^1]:

$$ y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + u_t $$

Para garantir que este processo seja **estacion√°rio em covari√¢ncia**, impomos uma restri√ß√£o espec√≠fica sobre os coeficientes $\phi_1, \phi_2, \dots, \phi_p$. A condi√ß√£o fundamental √© que as ra√≠zes da **equa√ß√£o polinomial caracter√≠stica** associada ao processo devem estar fora do c√≠rculo unit√°rio no plano complexo [^1]. A equa√ß√£o polinomial caracter√≠stica √© dada por:

$$ 1 - \phi_1 z - \phi_2 z^2 - \dots - \phi_p z^p = 0 $$

onde *z* √© uma vari√°vel complexa.

A interpreta√ß√£o desta condi√ß√£o √© crucial. No plano complexo, o **c√≠rculo unit√°rio** √© um c√≠rculo com raio 1 centrado na origem.  A condi√ß√£o de estacionariedade exige que todas as *p* ra√≠zes (possivelmente complexas) da equa√ß√£o polinomial caracter√≠stica tenham um m√≥dulo (dist√¢ncia da origem) maior que 1. Se qualquer uma das ra√≠zes estiver dentro do c√≠rculo unit√°rio, o processo AR(*p*) n√£o ser√° estacion√°rio em covari√¢ncia.

> üí° **Exemplo Num√©rico:** Considere um processo AR(2) com $\phi_1 = 0.5$ e $\phi_2 = 0.3$. A equa√ß√£o polinomial caracter√≠stica √© $1 - 0.5z - 0.3z^2 = 0$. Resolvendo esta equa√ß√£o quadr√°tica, obtemos duas ra√≠zes complexas. Se ambas as ra√≠zes tiverem um m√≥dulo maior que 1, o processo √© estacion√°rio. Caso contr√°rio, n√£o √© estacion√°rio.
>
> $\text{Resolvendo } 1 - 0.5z - 0.3z^2 = 0 \text{ usando a f√≥rmula quadr√°tica:}$
>
> $$z = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a} = \frac{0.5 \pm \sqrt{(-0.5)^2 - 4(-0.3)(1)}}{2(-0.3)} = \frac{0.5 \pm \sqrt{0.25 + 1.2}}{-0.6} = \frac{0.5 \pm \sqrt{1.45}}{-0.6}$$
>
> $z_1 = \frac{0.5 + \sqrt{1.45}}{-0.6} \approx -2.84$
>
> $z_2 = \frac{0.5 - \sqrt{1.45}}{-0.6} \approx 0.84$
>
> J√° que $|z_1| \approx 2.84 > 1$ e $|z_2| \approx 0.84 < 1$, este processo AR(2) *n√£o* √© estacion√°rio, pois uma das ra√≠zes est√° dentro do c√≠rculo unit√°rio.

**Teorema 3** (Rela√ß√£o entre Ra√≠zes e Estacionariedade): Um processo AR(p) √© estacion√°rio em covari√¢ncia se, e somente se, as ra√≠zes $z_1, z_2, ..., z_p$ da equa√ß√£o polinomial caracter√≠stica satisfazem $|z_i| > 1$ para todo $i = 1, 2, ..., p$.

**Prova:**
Para provar este teorema, recorremos √† representa√ß√£o do processo AR(*p*) como um processo de m√©dias m√≥veis de ordem infinita (MA($\infty$)). Um processo AR(*p*) estacion√°rio pode ser expresso como:

$$ y_t = \mu + \sum_{j=0}^{\infty} \psi_j u_{t-j} $$

onde $\mu = E(y_t)$ √© a m√©dia incondicional do processo e os coeficientes $\psi_j$ satisfazem $\sum_{j=0}^{\infty} |\psi_j| < \infty$. Esta condi√ß√£o garante que a vari√¢ncia de $y_t$ seja finita e que o processo seja bem definido.

A rela√ß√£o entre os coeficientes $\phi_i$ do AR(*p*) e os coeficientes $\psi_j$ do MA($\infty$) √© dada pela expans√£o em s√©rie de:

$$ \frac{1}{1 - \phi_1 L - \phi_2 L^2 - \dots - \phi_p L^p} = \sum_{j=0}^{\infty} \psi_j L^j $$

onde *L* √© o operador de defasagem (lag operator).

A converg√™ncia desta s√©rie (e, portanto, a exist√™ncia da representa√ß√£o MA($\infty$)) √© garantida se e somente se as ra√≠zes da equa√ß√£o polinomial caracter√≠stica estiverem fora do c√≠rculo unit√°rio. Formalmente, se $z_1, z_2, ..., z_p$ s√£o as ra√≠zes da equa√ß√£o $1 - \phi_1 z - \phi_2 z^2 - \dots - \phi_p z^p = 0$, ent√£o a condi√ß√£o de estacionariedade √© equivalente a $|z_i| > 1$ para todo $i = 1, 2, ..., p$.

Portanto, a estacionariedade em covari√¢ncia de um processo AR(*p*) √© diretamente ligada √† converg√™ncia da representa√ß√£o MA($\infty$), que por sua vez √© garantida pela condi√ß√£o sobre as ra√≠zes da equa√ß√£o polinomial caracter√≠stica. $\blacksquare$

**Corol√°rio 3.1**: Para um processo AR(1), $y_t = c + \phi_1 y_{t-1} + u_t$, a condi√ß√£o de estacionariedade √© simplesmente $|\phi_1| < 1$.

**Prova:** A equa√ß√£o polinomial caracter√≠stica √© $1 - \phi_1 z = 0$, que tem a raiz $z = 1/\phi_1$. Para que a raiz esteja fora do c√≠rculo unit√°rio, devemos ter $|1/\phi_1| > 1$, o que √© equivalente a $|\phi_1| < 1$.

> I. Dado o processo AR(1): $y_t = c + \phi_1 y_{t-1} + u_t$
>
> II. A equa√ß√£o caracter√≠stica √©: $1 - \phi_1 z = 0$
>
> III. Resolvendo para $z$, obtemos a raiz: $z = \frac{1}{\phi_1}$
>
> IV. Para estacionariedade, a raiz deve estar fora do c√≠rculo unit√°rio: $|z| > 1$
>
> V. Substituindo $z$: $\left|\frac{1}{\phi_1}\right| > 1$
>
> VI. Portanto: $|\phi_1| < 1$ ‚ñ†

> üí° **Exemplo Num√©rico:** Se $\phi_1 = 0.8$, o processo AR(1) √© estacion√°rio. Se $\phi_1 = -0.9$, tamb√©m √© estacion√°rio. Mas se $\phi_1 = 1.1$, o processo n√£o √© estacion√°rio.
>
> Para $\phi_1 = 0.8$, $|0.8| < 1$, logo estacion√°rio.
>
> Para $\phi_1 = -0.9$, $|-0.9| < 1$, logo estacion√°rio.
>
> Para $\phi_1 = 1.1$, $|1.1| > 1$, logo n√£o estacion√°rio.

**Corol√°rio 3.2**: Para um processo AR(2), $y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + u_t$, a condi√ß√£o de estacionariedade √© dada por as seguintes tr√™s condi√ß√µes:
1. $\phi_1 + \phi_2 < 1$
2. $\phi_2 - \phi_1 < 1$
3. $|\phi_2| < 1$

**Prova:** As ra√≠zes da equa√ß√£o caracter√≠stica $1 - \phi_1 z - \phi_2 z^2 = 0$ s√£o dadas por
$$ z_{1,2} = \frac{-\phi_1 \pm \sqrt{\phi_1^2 + 4\phi_2}}{-2\phi_2} = \frac{\phi_1 \pm \sqrt{\phi_1^2 + 4\phi_2}}{2\phi_2} $$
Se $\phi_1^2 + 4\phi_2 \geq 0$, as ra√≠zes s√£o reais. A condi√ß√£o para que ambas as ra√≠zes tenham m√≥dulo maior que 1 pode ser expressa como as condi√ß√µes enunciadas. Se $\phi_1^2 + 4\phi_2 < 0$, as ra√≠zes s√£o complexas conjugadas. Neste caso, $z_1 = \overline{z_2}$ e $|z_1|^2 = z_1 \overline{z_1} = z_1 z_2 = \frac{1}{\phi_2}$. Ent√£o, $|z_1| > 1$ se e somente se $|\phi_2| < 1$. As condi√ß√µes enunciadas garantem que as ra√≠zes, sejam reais ou complexas, estejam fora do c√≠rculo unit√°rio. $\blacksquare$

> üí° **Exemplo Num√©rico:** Vamos testar a estacionariedade de um processo AR(2) com $\phi_1 = 0.5$ e $\phi_2 = 0.3$ usando as condi√ß√µes do Corol√°rio 3.2.
>
> 1.  $\phi_1 + \phi_2 = 0.5 + 0.3 = 0.8 < 1$ (Atende √† primeira condi√ß√£o)
> 2.  $\phi_2 - \phi_1 = 0.3 - 0.5 = -0.2 < 1$ (Atende √† segunda condi√ß√£o)
> 3.  $|\phi_2| = |0.3| = 0.3 < 1$ (Atende √† terceira condi√ß√£o)
>
> No entanto, como demonstrado no exemplo anterior, este processo *n√£o* √© estacion√°rio, pois ao calcular as ra√≠zes da equa√ß√£o caracter√≠stica diretamente, uma delas est√° dentro do c√≠rculo unit√°rio. Isso ilustra que as condi√ß√µes do Corol√°rio 3.2 s√£o *necess√°rias* para estacionariedade, mas podem n√£o ser *suficientes* em todos os casos devido a arredondamentos ou outros fatores num√©ricos.
>
> Agora, considere um processo AR(2) com $\phi_1 = 0.2$ e $\phi_2 = 0.5$:
>
> 1.  $\phi_1 + \phi_2 = 0.2 + 0.5 = 0.7 < 1$ (Atende √† primeira condi√ß√£o)
> 2.  $\phi_2 - \phi_1 = 0.5 - 0.2 = 0.3 < 1$ (Atende √† segunda condi√ß√£o)
> 3.  $|\phi_2| = |0.5| = 0.5 < 1$ (Atende √† terceira condi√ß√£o)
>
> Neste caso, todas as condi√ß√µes s√£o satisfeitas. Resolvendo a equa√ß√£o caracter√≠stica $1 - 0.2z - 0.5z^2 = 0$, obtemos:
>
> $$z = \frac{0.2 \pm \sqrt{(-0.2)^2 - 4(-0.5)(1)}}{2(-0.5)} = \frac{0.2 \pm \sqrt{0.04 + 2}}{-1} = \frac{0.2 \pm \sqrt{2.04}}{-1}$$
>
> $z_1 = \frac{0.2 + \sqrt{2.04}}{-1} \approx -1.63$
>
> $z_2 = \frac{0.2 - \sqrt{2.04}}{-1} \approx 1.23$
>
> Como $|z_1| \approx 1.63 > 1$ e $|z_2| \approx 1.23 > 1$, este processo AR(2) √© estacion√°rio.

### Implica√ß√µes da Estacionariedade

A estacionariedade em covari√¢ncia tem v√°rias implica√ß√µes importantes para a an√°lise e modelagem de s√©ries temporais:

1.  **M√©dia e Vari√¢ncia Constantes:** Garante que a m√©dia e a vari√¢ncia do processo permane√ßam constantes ao longo do tempo [^1]. Isto permite que usemos estas estat√≠sticas para descrever e comparar o processo em diferentes per√≠odos.

2.  **Fun√ß√£o de Autocorrela√ß√£o (ACF) Bem Definida:** Permite que a fun√ß√£o de autocorrela√ß√£o (ACF) seja bem definida e interpretaba. A ACF descreve a correla√ß√£o entre os valores da s√©rie em diferentes defasagens e √© uma ferramenta crucial para identificar a ordem *p* do processo AR(*p*) e para diagnosticar a adequa√ß√£o do modelo.

3.  **Previs√£o Est√°vel:** Garante que a previs√£o linear √≥tima seja est√°vel e convirja para a m√©dia incondicional do processo √† medida que o horizonte de previs√£o aumenta.

4.  **Infer√™ncia Estat√≠stica V√°lida:** Permite que a infer√™ncia estat√≠stica (testes de hip√≥teses, intervalos de confian√ßa) seja v√°lida. A estacionariedade √© uma das condi√ß√µes para que os estimadores dos par√¢metros do modelo AR(*p*) sejam consistentes e assintoticamente normais.

5.  **Representa√ß√£o MA($\infty$):** A estacionariedade √© uma condi√ß√£o para que o processo AR(*p*) tenha uma representa√ß√£o equivalente como um processo de m√©dias m√≥veis de ordem infinita (MA($\infty$)).

> üí° **Exemplo Num√©rico:** Considere uma s√©rie temporal n√£o estacion√°ria. Se voc√™ calcular a m√©dia desta s√©rie em diferentes per√≠odos de tempo, notar√° que a m√©dia varia significativamente. Al√©m disso, a ACF n√£o decair√° para zero, indicando que as correla√ß√µes entre os valores da s√©rie em diferentes defasagens permanecem fortes mesmo em defasagens longas. Isto torna a previs√£o dif√≠cil e a infer√™ncia estat√≠stica n√£o confi√°vel.
>
> Imagine uma s√©rie temporal representando o pre√ßo de uma a√ß√£o que est√° em tend√™ncia de alta ao longo do tempo (n√£o estacion√°ria).  Calcular a m√©dia dos pre√ßos em diferentes anos mostrar√° m√©dias crescentes. A ACF mostrar√° uma correla√ß√£o alta mesmo com defasagens longas, indicando que o pre√ßo de hoje est√° fortemente relacionado com os pre√ßos de muitos dias/meses atr√°s.  Se aplicarmos um modelo AR diretamente, as previs√µes podem ser enganosas, pois o modelo n√£o captura a tend√™ncia de alta.

### Considera√ß√µes Pr√°ticas

Na pr√°tica, a verifica√ß√£o da estacionariedade de um processo AR(*p*) envolve estimar os coeficientes $\phi_i$ e calcular as ra√≠zes da equa√ß√£o polinomial caracter√≠stica. Existem v√°rios testes estat√≠sticos dispon√≠veis para verificar a estacionariedade, como o teste de Dickey-Fuller aumentado (ADF) e o teste de Phillips-Perron. Estes testes verificam a presen√ßa de uma raiz unit√°ria (raiz igual a 1) na equa√ß√£o polinomial caracter√≠stica, o que indicaria n√£o estacionariedade.

> üí° **Exemplo:** Se voc√™ estiver trabalhando com dados financeiros, como retornos de a√ß√µes, √© importante verificar se a s√©rie temporal √© estacion√°ria antes de ajustar um modelo AR(*p*). Se a s√©rie n√£o for estacion√°ria, pode ser necess√°rio aplicar transforma√ß√µes, como diferencia√ß√£o, para torn√°-la estacion√°ria.
>
> Os retornos de a√ß√µes (a varia√ß√£o percentual no pre√ßo) s√£o geralmente mais estacion√°rios do que os pre√ßos das a√ß√µes. Se os pre√ßos das a√ß√µes n√£o s√£o estacion√°rios, podemos calcular os retornos ( $r_t = \frac{P_t - P_{t-1}}{P_{t-1}}$ ) e ent√£o verificar a estacionariedade dos retornos usando o teste ADF. Se os retornos forem estacion√°rios, podemos usar um modelo AR para modelar e prever os retornos, e ent√£o usar esses retornos previstos para fazer infer√™ncias sobre os pre√ßos das a√ß√µes.
>
> ```python
> import numpy as np
> import pandas as pd
> from statsmodels.tsa.stattools import adfuller
> import matplotlib.pyplot as plt
>
> # Generate a sample non-stationary price series (random walk)
> np.random.seed(42)
> n = 200
> prices = np.cumsum(np.random.randn(n)) + 100  # Start at 100
>
> # Calculate returns
> returns = pd.Series(prices).pct_change().dropna()
>
> # Perform ADF test on prices
> adf_prices = adfuller(prices)
> print("ADF test on prices:", adf_prices)
>
> # Perform ADF test on returns
> adf_returns = adfuller(returns)
> print("ADF test on returns:", adf_returns)
>
> # Visualize the price series and returns
> plt.figure(figsize=(12, 6))
> plt.subplot(2, 1, 1)
> plt.plot(prices)
> plt.title("Non-Stationary Price Series")
> plt.xlabel("Time")
> plt.ylabel("Price")
>
> plt.subplot(2, 1, 2)
> plt.plot(returns)
> plt.title("Returns Series")
> plt.xlabel("Time")
> plt.ylabel("Return")
>
> plt.tight_layout()
> plt.show()
> ```

Se as ra√≠zes estiverem pr√≥ximas do c√≠rculo unit√°rio, o processo AR(*p*) ser√° **quase n√£o estacion√°rio** ou **altamente persistente**. Neste caso, as estima√ß√µes dos par√¢metros podem ser imprecisas e a previs√£o pode ser inst√°vel. Modelos com ra√≠zes pr√≥ximas ao c√≠rculo unit√°rio requerem tratamento especial e podem se beneficiar de t√©cnicas de regulariza√ß√£o ou de modelos que imp√µem explicitamente a estacionariedade.

**Proposi√ß√£o 4:** Se um processo AR(p) √© estacion√°rio, ent√£o a sua fun√ß√£o de autocorrela√ß√£o $\rho(h)$ decai para zero quando $h \rightarrow \infty$.

**Prova:** Como o processo AR(p) √© estacion√°rio, ele tem uma representa√ß√£o MA($\infty$):
$y_t = \mu + \sum_{j=0}^{\infty} \psi_j u_{t-j}$, onde $\sum_{j=0}^{\infty} |\psi_j| < \infty$.
A fun√ß√£o de autocorrela√ß√£o √© dada por:
$\rho(h) = \frac{Cov(y_t, y_{t-h})}{Var(y_t)}$.

I. Dado um processo AR(p) estacion√°rio, ele pode ser representado como MA($\infty$): $y_t = \mu + \sum_{j=0}^{\infty} \psi_j u_{t-j}$, onde $\sum_{j=0}^{\infty} |\psi_j| < \infty$.

II. A autocovari√¢ncia entre $y_t$ e $y_{t-h}$ √© definida como: $Cov(y_t, y_{t-h}) = E[(y_t - \mu)(y_{t-h} - \mu)]$

III. Substituindo a representa√ß√£o MA($\infty$):
$Cov(y_t, y_{t-h}) = E\left[\left(\sum_{j=0}^{\infty} \psi_j u_{t-j}\right)\left(\sum_{k=0}^{\infty} \psi_k u_{t-h-k}\right)\right]$

IV. Usando a propriedade de que $E[u_t u_s] = \sigma_u^2$ se $t=s$ e 0 caso contr√°rio:
$Cov(y_t, y_{t-h}) = \sigma_u^2 \sum_{j=h}^{\infty} \psi_j \psi_{j-h}$

V. A vari√¢ncia de $y_t$ √©: $Var(y_t) = E[(y_t - \mu)^2] = E\left[\left(\sum_{j=0}^{\infty} \psi_j u_{t-j}\right)^2\right] = \sigma_u^2 \sum_{j=0}^{\infty} \psi_j^2$

VI. A fun√ß√£o de autocorrela√ß√£o √© ent√£o: $\rho(h) = \frac{Cov(y_t, y_{t-h})}{Var(y_t)} = \frac{\sum_{j=h}^{\infty} \psi_j \psi_{j-h}}{\sum_{j=0}^{\infty} \psi_j^2}$

VII. Como o processo √© estacion√°rio, $\sum_{j=0}^{\infty} |\psi_j| < \infty$, o que implica que $\psi_j \rightarrow 0$ quando $j \rightarrow \infty$.

VIII. Portanto, quando $h \rightarrow \infty$, $\sum_{j=h}^{\infty} \psi_j \psi_{j-h} \rightarrow 0$, e assim $\rho(h) \rightarrow 0$.

Assim, $\rho(h) \rightarrow 0$ quando $h \rightarrow \infty$. $\blacksquare$

> üí° **Exemplo Num√©rico:** Considere um processo AR(1) estacion√°rio com $\phi_1 = 0.5$ e ru√≠do branco com vari√¢ncia $\sigma_u^2 = 1$. Podemos simular este processo e calcular sua ACF para diferentes defasagens. A ACF deve decair para zero √† medida que a defasagem aumenta.
>
> ```python
> import numpy as np
> import statsmodels.api as sm
> from statsmodels.tsa.arima_process import ArmaProcess
> import matplotlib.pyplot as plt
>
> # Set parameters
> phi = np.array([1, -0.5])  # AR parameter (note the sign convention in ArmaProcess)
> sigma_u = 1
> n = 100
> lags = 20
>
> # Simulate the AR(1) process
> ar_process = ArmaProcess(phi, [1])
> y = ar_process.simulate_sample(n)
>
> # Calculate ACF
> acf = sm.tsa.acf(y, nlags=lags)
>
> # Plot ACF
> plt.figure(figsize=(10, 6))
> plt.stem(range(lags + 1), acf, use_line_collection=True) # Explicitly use line collection
> plt.title("Autocorrelation Function (ACF) of AR(1) Process")
> plt.xlabel("Lag")
> plt.ylabel("Autocorrelation")
> plt.grid(True)
> plt.show()
> ```
>
> Neste exemplo, o gr√°fico da ACF mostrar√° um decaimento exponencial √† medida que a defasagem aumenta, confirmando que para um processo AR(1) estacion√°rio, a ACF tende a zero com o aumento da defasagem.

### Conclus√£o

Neste cap√≠tulo, exploramos em detalhe a condi√ß√£o de estacionariedade em covari√¢ncia para processos AR(*p*), enfatizando a import√¢ncia das ra√≠zes da equa√ß√£o polinomial caracter√≠stica. A estacionariedade √© fundamental para garantir a validade e a interpretabilidade da an√°lise e modelagem de s√©ries temporais. A compreens√£o desta condi√ß√£o √© essencial para a aplica√ß√£o correta dos modelos AR(*p*) e para a obten√ß√£o de previs√µes confi√°veis. Nos cap√≠tulos subsequentes, exploraremos modelos mais complexos que relaxam a restri√ß√£o de vari√¢ncia constante do termo de erro (heteroscedasticidade) e como a estacionariedade se manifesta neste contexto.

### Refer√™ncias
[^1]: P√°gina 657.
<!-- END -->