## Solu√ß√£o da Equa√ß√£o de Diferen√ßa de Primeira Ordem via Operador Inverso

### Introdu√ß√£o
No cap√≠tulo anterior, introduzimos a equa√ß√£o de diferen√ßa de primeira ordem e sua representa√ß√£o compacta usando o operador de atraso. Vimos que a equa√ß√£o $y_t = \phi y_{t-1} + w_t$ pode ser expressa como $(1 - \phi L)y_t = w_t$ [^2.2.2]. Agora, vamos nos aprofundar na solu√ß√£o desta equa√ß√£o utilizando o operador inverso $(1 - \phi L)^{-1}$. Esta abordagem nos permitir√° expressar $y_t$ em termos de uma s√©rie infinita de valores passados de $w_t$, mostrando como a din√¢mica do sistema √© influenciada pelo hist√≥rico de ru√≠dos.

### Conceitos Fundamentais
A solu√ß√£o para a equa√ß√£o $(1 - \phi L)y_t = w_t$ envolve encontrar um operador que "desfa√ßa" o efeito de $(1 - \phi L)$. Este operador √© conhecido como o inverso de $(1 - \phi L)$, denotado por $(1 - \phi L)^{-1}$. Multiplicando ambos os lados da equa√ß√£o por $(1 - \phi L)^{-1}$, obtemos:

$$(1 - \phi L)^{-1}(1 - \phi L)y_t = (1 - \phi L)^{-1}w_t$$

Como $(1 - \phi L)^{-1}(1 - \phi L) = 1$, onde 1 representa o operador identidade, temos:

$$y_t = (1 - \phi L)^{-1}w_t$$

Para $|\phi| < 1$, o operador inverso $(1 - \phi L)^{-1}$ pode ser expresso como uma s√©rie geom√©trica:

$$(1 - \phi L)^{-1} = 1 + \phi L + \phi^2 L^2 + \phi^3 L^3 + \ldots = \sum_{k=0}^{\infty} \phi^k L^k$$ [^2.2.8]

Substituindo essa express√£o na equa√ß√£o acima, obtemos:

$$y_t = (1 + \phi L + \phi^2 L^2 + \phi^3 L^3 + \ldots)w_t$$

Aplicando o operador de atraso na sequ√™ncia $w_t$, expandimos a equa√ß√£o para:

$$y_t = w_t + \phi w_{t-1} + \phi^2 w_{t-2} + \phi^3 w_{t-3} + \ldots$$ [^2.2.9]

Essa representa√ß√£o mostra que o valor atual de $y_t$ √© uma combina√ß√£o ponderada de todos os valores passados de $w_t$, onde os pesos s√£o dados pelas pot√™ncias de $\phi$. O par√¢metro $\phi$ controla a influ√™ncia dos valores passados de $w_t$ sobre o valor atual de $y_t$. A condi√ß√£o $|\phi| < 1$ √© crucial para a converg√™ncia da s√©rie, garantindo que os valores passados de $w_t$ tenham influ√™ncia decrescente sobre o valor atual de $y_t$ [^Teorema 1].

> üí° **Exemplo Num√©rico:**
> Considere a equa√ß√£o $(1 - 0.7L)y_t = w_t$. Para encontrar a solu√ß√£o, podemos usar o operador inverso:
> $y_t = (1 - 0.7L)^{-1}w_t = (1 + 0.7L + (0.7)^2 L^2 + (0.7)^3 L^3 + \ldots)w_t$
> Expandindo:
> $y_t = w_t + 0.7w_{t-1} + 0.49w_{t-2} + 0.343w_{t-3} + \ldots$
> Se $w_t$ √© uma sequ√™ncia de ru√≠do branco com vari√¢ncia $\sigma^2=1$, e, por exemplo, $w_t = [1, -0.5, 0.2, -0.1, 0.05, \ldots]$, os primeiros valores de $y_t$ seriam:
>
> $y_1 = w_1 = 1$
> $y_2 = w_2 + 0.7w_1 = -0.5 + 0.7(1) = 0.2$
> $y_3 = w_3 + 0.7w_2 + 0.49w_1 = 0.2 + 0.7(-0.5) + 0.49(1) = 0.2 + (-0.35) + 0.49 = 0.34$
> $y_4 = w_4 + 0.7w_3 + 0.49w_2 + 0.343w_1 = -0.1 + 0.7(0.2) + 0.49(-0.5) + 0.343(1) = -0.1 + 0.14 - 0.245 + 0.343 = 0.138$
>
>  Esta s√©rie $y_t$ √© uma combina√ß√£o dos ru√≠dos passados, com pesos que diminuem exponencialmente. O valor de $y_t$ em qualquer tempo $t$ √© influenciado mais fortemente pelos valores recentes de $w$ do que pelos valores mais distantes no passado, devido ao fator de decaimento de 0.7.

*Propriedades da Solu√ß√£o*

Como vimos, a solu√ß√£o para a equa√ß√£o de diferen√ßa de primeira ordem pode ser escrita como uma s√©rie infinita de valores passados de $w_t$:
$y_t = w_t + \phi w_{t-1} + \phi^2 w_{t-2} + \phi^3 w_{t-3} + \ldots = \sum_{k=0}^{\infty} \phi^k w_{t-k}$.
Esta forma da solu√ß√£o nos permite analisar as propriedades estat√≠sticas de $y_t$ com base nas propriedades estat√≠sticas de $w_t$.

*   **M√©dia:** Se $E[w_t] = 0$, ent√£o $E[y_t] = 0$ [^Teorema 1.3].
*   **Vari√¢ncia:** Se $Var(w_t) = \sigma^2$, ent√£o $Var(y_t) = \frac{\sigma^2}{1 - \phi^2}$ [^Teorema 1.3].
*   **Converg√™ncia:** Se $|\phi| < 1$, a s√©rie converge e a solu√ß√£o $y_t$ √© bem definida e limitada, desde que $w_t$ tamb√©m o seja [^Teorema 1.1].
*  **Converg√™ncia para zero:** Se $|\phi| < 1$ e $w_t$ converge para zero, ent√£o $y_t$ tamb√©m converge para zero [^Teorema 1.2].

A condi√ß√£o $|\phi| < 1$ garante a estabilidade do sistema, evitando que as perturba√ß√µes passadas causem efeitos cada vez maiores na vari√°vel $y_t$ ao longo do tempo.

*Operador Inverso e Unicidade da Solu√ß√£o*

O operador inverso $(1-\phi L)^{-1}$ √© fundamental para garantir a unicidade da solu√ß√£o da equa√ß√£o de diferen√ßa.  No entanto, √© crucial notar que esta propriedade de inversibilidade s√≥ √© v√°lida se $|\phi| < 1$ [^Proposi√ß√£o 1].

Se $|\phi| \ge 1$, o operador $(1-\phi L)^{-1}$ n√£o pode ser definido como uma s√©rie geom√©trica convergente, e a solu√ß√£o apresentada n√£o seria v√°lida. Al√©m disso, se n√£o restringirmos a an√°lise apenas a sequ√™ncias limitadas ou processos estacion√°rios, outras solu√ß√µes poderiam satisfazer a equa√ß√£o original, tornando a solu√ß√£o n√£o √∫nica [^2.2.10]. O operador $(1-\phi L)^{-1}$ mapeia uma sequ√™ncia limitada $\{w_t\}$ em uma sequ√™ncia tamb√©m limitada $\{y_t\}$ e √© a √∫nica forma de obter tal resultado [^2.2.8].

> üí° **Exemplo Num√©rico:**
> Para a equa√ß√£o $(1 - 0.5L)y_t = w_t$, a solu√ß√£o √∫nica √© dada por $y_t = (1 - 0.5L)^{-1}w_t = w_t + 0.5w_{t-1} + 0.25w_{t-2} + \ldots$ .
> Para a equa√ß√£o $(1 - 1.5L)y_t = w_t$, o operador inverso, $(1 - 1.5L)^{-1}$, n√£o pode ser definido como uma s√©rie geom√©trica convergente, e a solu√ß√£o anterior n√£o √© v√°lida. Nesse caso, a s√©rie diverge e a influ√™ncia de $w_t$ passado n√£o decai, tornando o sistema inst√°vel.
> Por exemplo, com $\phi = 1.5$, a solu√ß√£o $y_t = w_t + 1.5w_{t-1} + 2.25w_{t-2} + \ldots$ amplifica o ru√≠do passado, n√£o convergindo para uma solu√ß√£o est√°vel para uma sequ√™ncia de ru√≠do branco, por exemplo.
>
> Considere um cen√°rio onde temos $w_t = [1, 2, 1, 2, 1, 2,...]$ para os 6 primeiros termos, ent√£o, para $\phi = 0.5$, os primeiros valores de $y_t$ seriam:
> $y_1 = 1$
> $y_2 = 2 + 0.5(1) = 2.5$
> $y_3 = 1 + 0.5(2) + 0.25(1) = 2.25$
> $y_4 = 2 + 0.5(1) + 0.25(2) + 0.125(1) = 3.625$
>
> E, para $\phi = 1.5$, os primeiros valores de $y_t$ seriam:
> $y_1 = 1$
> $y_2 = 2 + 1.5(1) = 3.5$
> $y_3 = 1 + 1.5(2) + 2.25(1) = 5.25$
> $y_4 = 2 + 1.5(1) + 2.25(2) + 3.375(1) = 10.125$
>
> Note como a s√©rie com $\phi=0.5$ apresenta comportamento est√°vel, ao passo que a s√©rie com $\phi=1.5$ cresce a cada termo.

**Lema 1**
Se $|\phi|<1$, ent√£o o operador $(1-\phi L)$ √© invert√≠vel e sua inversa √© dada por $\sum_{k=0}^{\infty} \phi^k L^k$.

*Proof:*
I. O operador $(1-\phi L)$  multiplicado pelo operador $\sum_{k=0}^{\infty} \phi^k L^k$  resulta em:
  $$(1-\phi L)\sum_{k=0}^{\infty} \phi^k L^k = \sum_{k=0}^{\infty} \phi^k L^k - \phi L \sum_{k=0}^{\infty} \phi^k L^k  = \sum_{k=0}^{\infty} \phi^k L^k -  \sum_{k=0}^{\infty} \phi^{k+1} L^{k+1}$$
II. Mudando o √≠ndice da segunda soma para $j=k+1$, obtemos:
  $$\sum_{k=0}^{\infty} \phi^k L^k -  \sum_{j=1}^{\infty} \phi^{j} L^{j} = \phi^0 L^0 +  \sum_{k=1}^{\infty} \phi^k L^k -  \sum_{j=1}^{\infty} \phi^{j} L^{j} = 1 + \sum_{k=1}^{\infty} \phi^k L^k -  \sum_{k=1}^{\infty} \phi^{k} L^{k} = 1 $$
III. Dado que o resultado √© o operador identidade, $\sum_{k=0}^{\infty} \phi^k L^k$ √© de fato o inverso de $(1-\phi L)$.‚ñ†

**Lema 2**
Se $|\phi|<1$ ent√£o $\sum_{k=0}^{\infty} |\phi^k| < \infty$

*Proof:*
I. A s√©rie $\sum_{k=0}^{\infty} \phi^k$ √© uma s√©rie geom√©trica com raz√£o $\phi$.
II. Se $|\phi|<1$, ent√£o sabemos que a s√©rie converge para $\frac{1}{1 - |\phi|}$ (ver Teorema 1.1)
III. Em particular,  $\frac{1}{1 - |\phi|}$ √© finito, ou seja, a s√©rie √© absolutamente convergente.‚ñ†

**Lema 2.1**
Se $|\phi|<1$ e $w_t$ √© limitado, ent√£o $\sum_{k=0}^{\infty} |\phi|^k |w_{t-k}|$ √© finito para todo $t$.

*Proof:*
I. Se $w_t$ √© limitado, existe uma constante $M$ tal que $|w_t| \leq M$ para todo $t$.
II. Assim, $\sum_{k=0}^{\infty} |\phi|^k |w_{t-k}| \leq \sum_{k=0}^{\infty} |\phi|^k M = M \sum_{k=0}^{\infty} |\phi|^k$
III. Usando o Lema 2,  $\sum_{k=0}^{\infty} |\phi|^k < \infty$
IV. Portanto $\sum_{k=0}^{\infty} |\phi|^k |w_{t-k}| < \infty$. ‚ñ†

**Proposi√ß√£o 1.1**
Se $|\phi| < 1$, a solu√ß√£o $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$ √© a √∫nica solu√ß√£o limitada para a equa√ß√£o $(1 - \phi L)y_t = w_t$

*Proof:*
I. J√° sabemos que $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$ √© uma solu√ß√£o.
II. Suponha que exista outra solu√ß√£o limitada $z_t$ tal que $(1 - \phi L)z_t = w_t$. Ent√£o, $(1 - \phi L)(y_t - z_t) = w_t - w_t = 0$.
III. Seja $x_t = y_t - z_t$. Ent√£o $(1 - \phi L)x_t = 0$, ou seja, $x_t = \phi x_{t-1}$.
IV. Expandindo, temos que $x_t = \phi^n x_{t-n}$ para qualquer $n$.
V. Dado que $y_t$ e $z_t$ s√£o limitados, ent√£o $x_t$ √© limitado, o que implica que existe $M$ tal que $|x_t|<M$ para todo $t$.
VI. Assim $|x_t| = |\phi^n x_{t-n}| = |\phi|^n |x_{t-n}| \leq |\phi|^n M$.
VII. Como $|\phi| < 1$, temos que $\lim_{n \to \infty} |\phi|^n = 0$, logo, $\lim_{n \to \infty} x_t = 0$. Mas isso s√≥ √© poss√≠vel se $x_t = 0$ para todo $t$, implicando que $y_t = z_t$.
VIII. Portanto, a solu√ß√£o √© √∫nica dentro do conjunto de solu√ß√µes limitadas.‚ñ†

**Teorema 1.4**
Se $|\phi| < 1$ e $w_t$ √© um processo de ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$, ent√£o $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$ √© um processo estacion√°rio.

*Proof:*
I. J√° mostramos que a m√©dia de $y_t$ √© zero e sua vari√¢ncia √© $\frac{\sigma^2}{1 - \phi^2}$, que s√£o constantes independentes de $t$.
II. Para mostrar a estacionariedade, precisamos verificar se a covari√¢ncia $\text{Cov}(y_t, y_{t-h})$ depende apenas de $h$.
III. Temos que $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$ e $y_{t-h} = \sum_{j=0}^{\infty} \phi^j w_{t-h-j}$.
IV.  Assim, $\text{Cov}(y_t, y_{t-h}) = \text{Cov}\left(\sum_{k=0}^{\infty} \phi^k w_{t-k}, \sum_{j=0}^{\infty} \phi^j w_{t-h-j}\right) = \sum_{k=0}^{\infty} \sum_{j=0}^{\infty} \phi^{k+j} \text{Cov}(w_{t-k}, w_{t-h-j})$.
V. Como $w_t$ √© ru√≠do branco,  $\text{Cov}(w_{t-k}, w_{t-h-j}) = 0$ se $t-k \neq t-h-j$, e  $\text{Cov}(w_{t-k}, w_{t-h-j}) = \sigma^2$ se $t-k = t-h-j$. Isso implica que $k=h+j$.
VI. Portanto, $\text{Cov}(y_t, y_{t-h}) = \sum_{j=0}^{\infty} \phi^{h+2j} \sigma^2 = \sigma^2 \phi^h \sum_{j=0}^{\infty} (\phi^2)^j = \frac{\sigma^2 \phi^h}{1 - \phi^2}$.
VII. Como a covari√¢ncia depende apenas de $h$ e n√£o de $t$, $y_t$ √© estacion√°rio.‚ñ†

**Teorema 1.5**
Se $|\phi| < 1$ e $w_t$ √© um processo de ru√≠do branco com m√©dia zero e vari√¢ncia $\sigma^2$, ent√£o a fun√ß√£o de autocorrela√ß√£o de $y_t$, denotada por $\rho_h$, √© dada por $\rho_h = \phi^{|h|}$.

*Proof:*
I. A fun√ß√£o de autocorrela√ß√£o √© definida como $\rho_h = \frac{\text{Cov}(y_t, y_{t-h})}{\sqrt{\text{Var}(y_t) \text{Var}(y_{t-h})}}$.
II. Pelo Teorema 1.4, $\text{Cov}(y_t, y_{t-h}) = \frac{\sigma^2 \phi^h}{1 - \phi^2}$.
III. Tamb√©m sabemos que $\text{Var}(y_t) = \frac{\sigma^2}{1 - \phi^2}$.
IV. Assim, $\rho_h = \frac{\frac{\sigma^2 \phi^h}{1 - \phi^2}}{\sqrt{\frac{\sigma^2}{1 - \phi^2} \frac{\sigma^2}{1 - \phi^2}}} = \frac{\frac{\sigma^2 \phi^h}{1 - \phi^2}}{\frac{\sigma^2}{1 - \phi^2}} = \phi^h$ para $h \geq 0$.
V. Para $h < 0$, temos $\rho_h = \frac{\text{Cov}(y_t, y_{t-h})}{\text{Var}(y_t)} =  \frac{\text{Cov}(y_{t-h}, y_{t})}{\text{Var}(y_t)} = \frac{\frac{\sigma^2 \phi^{-h}}{1 - \phi^2}}{\frac{\sigma^2}{1 - \phi^2}} = \phi^{-h}$.
VI. Combinando os dois casos, temos que $\rho_h = \phi^{|h|}$.‚ñ†

> üí° **Exemplo Num√©rico:**
> Se temos $\phi=0.8$ e $w_t$ √© um ru√≠do branco, ent√£o a fun√ß√£o de autocorrela√ß√£o em diferentes lags $h$ ser√°:
> $\rho_0 = 0.8^0 = 1$
> $\rho_1 = 0.8^1 = 0.8$
> $\rho_2 = 0.8^2 = 0.64$
> $\rho_3 = 0.8^3 = 0.512$
> $\rho_{-1} = 0.8^1 = 0.8$
> $\rho_{-2} = 0.8^2 = 0.64$
>
> Isso indica que a correla√ß√£o entre $y_t$ e $y_{t-h}$ decai exponencialmente com o aumento do lag $h$, e que a correla√ß√£o √© sim√©trica.

**Observa√ß√£o 1**
√â importante ressaltar que a condi√ß√£o $|\phi|<1$ √© crucial para a an√°lise de converg√™ncia e estacionaridade. Se $|\phi|\geq 1$, a s√©rie $\sum_{k=0}^{\infty} \phi^k w_{t-k}$ n√£o converge, e a solu√ß√£o n√£o √© bem definida. Nesse caso, o modelo autoregressivo de primeira ordem se torna inst√°vel.

### Conclus√£o
A solu√ß√£o da equa√ß√£o de diferen√ßa de primeira ordem utilizando o operador inverso revela que o valor atual da s√©rie temporal √© uma combina√ß√£o ponderada de todos os ru√≠dos passados, onde o peso de cada ru√≠do decai exponencialmente com o aumento do atraso. A aplica√ß√£o do operador inverso √© v√°lida apenas quando o par√¢metro $|\phi| < 1$. Essa condi√ß√£o √© essencial para garantir a converg√™ncia e a unicidade da solu√ß√£o, bem como a estabilidade do sistema. Os resultados discutidos aqui estabelecem um entendimento mais profundo sobre a influ√™ncia dos ru√≠dos passados na din√¢mica da vari√°vel $y_t$ e formam a base para a an√°lise de modelos mais complexos de s√©ries temporais que veremos nos pr√≥ximos cap√≠tulos.

### Refer√™ncias
[^2.2.2]:  "This equation, in turn, can be rearranged using standard algebra, yt ‚Äì œÜLyt = wt or (1 ‚Äì œÜL)yt = wt."
[^2.2.8]:  "(1 ‚Äì œÜL)-1 = lim (1 + œÜL + œÜ2L2 + œÜ3L3 + ... + œÜ/L/)."
[^2.2.9]: "y, = w, + œÜw,-1 + œÜ¬≤w,-2 + œÜ¬≥w,-3 +...."
[^Teorema 1]: "Se $|\phi| < 1$, a solu√ß√£o da equa√ß√£o de diferen√ßa $(1 - \phi L)y_t = w_t$ pode ser expressa como $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$, desde que a s√©rie convirja."
[^Teorema 1.1]: "Se $\vert \phi \vert < 1$ e $w_t$ √© uma sequ√™ncia limitada, ent√£o a solu√ß√£o $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$ √© tamb√©m uma sequ√™ncia limitada."
[^Teorema 1.2]: "Se $\vert \phi \vert < 1$ e $w_t$ converge para zero quando $t \to \infty$, ent√£o $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$ tamb√©m converge para zero quando $t \to \infty$."
[^Teorema 1.3]: "Se $|\phi| < 1$ e $w_t$ √© uma sequ√™ncia de vari√°veis aleat√≥rias com m√©dia zero e vari√¢ncia constante $\sigma^2$, ent√£o $y_t = \sum_{k=0}^{\infty} \phi^k w_{t-k}$ √© uma sequ√™ncia de vari√°veis aleat√≥rias com m√©dia zero e vari√¢ncia $\frac{\sigma^2}{1 - \phi^2}$."
[^Proposi√ß√£o 1]: "O operador $(1 - \phi L)$ √© invers√≠vel se e somente se $|\phi| < 1$."
[^2.2.10]: "y, = a + w + w + 2w-2 + 3W-3 +..., produces another series consistent with [2.2.1] for any constant a,."
<!-- END -->
