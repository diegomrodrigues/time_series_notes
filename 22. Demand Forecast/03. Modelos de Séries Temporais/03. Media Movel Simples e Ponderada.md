## Modelos de M√©dia M√≥vel: Simples e Ponderada em Detalhe

### Introdu√ß√£o
Este cap√≠tulo detalha os modelos de **m√©dia m√≥vel simples (SMA)** e **m√©dia m√≥vel ponderada (WMA)**, explorando suas nuances, adequa√ß√µes e t√©cnicas de ajuste [^6]. Como vimos anteriormente, esses modelos s√£o fundamentais para a previs√£o de s√©ries temporais, utilizando m√©dias de per√≠odos anteriores para projetar a demanda futura [^5]. Embora sejam relativamente simples em compara√ß√£o com abordagens mais avan√ßadas, a compreens√£o de suas caracter√≠sticas e limita√ß√µes √© crucial para a aplica√ß√£o eficaz em cen√°rios reais. Os modelos de m√©dia m√≥vel s√£o abordagens emp√≠ricas para previs√£o e s√£o particularmente √∫teis em aplica√ß√µes onde a demanda √© relativamente est√°vel e o objetivo √© suavizar o componente irregular ou ru√≠do [^6].

### Modelos de M√©dia M√≥vel Simples (SMA)

A **m√©dia m√≥vel simples (SMA)** √© uma t√©cnica de previs√£o que utiliza a m√©dia da demanda ao longo de um n√∫mero especificado de per√≠odos anteriores para prever a demanda para o pr√≥ximo per√≠odo [^6]. Como vimos, a f√≥rmula para a SMA no per√≠odo *t* √©:

$$SMA_t = \frac{A_{t-1} + A_{t-2} + \ldots + A_{t-n}}{n}$$

onde:
- $SMA_t$ √© a m√©dia m√≥vel simples para o per√≠odo *t*.
- $n$ √© o n√∫mero de per√≠odos inclu√≠dos na m√©dia.
- $A_{t-1}, A_{t-2}, \ldots, A_{t-n}$ s√£o as demandas reais nos per√≠odos anteriores [^7].

A escolha de *n*, o n√∫mero de per√≠odos, √© fundamental para o comportamento do modelo [^7]. Um valor menor de *n* torna o modelo mais responsivo, ou seja, mais sens√≠vel a mudan√ßas recentes na demanda, mas tamb√©m mais suscet√≠vel a flutua√ß√µes aleat√≥rias. Um valor maior de *n*, por outro lado, torna o modelo mais est√°vel, suavizando varia√ß√µes de curto prazo, mas menos responsivo a mudan√ßas na tend√™ncia [^7].

#### Adequa√ß√£o e Limita√ß√µes da SMA

A SMA √© mais adequada quando a demanda √© relativamente est√°vel e n√£o possui uma tend√™ncia ou sazonalidade clara [^6]. Em tais situa√ß√µes, a m√©dia m√≥vel simples ajuda a reduzir o impacto de varia√ß√µes aleat√≥rias e a destacar o padr√£o subjacente nos dados. No entanto, a SMA possui algumas limita√ß√µes importantes:

1.  **Defasagem em rela√ß√£o a tend√™ncias e ciclos:** Como a SMA √© baseada em uma m√©dia de dados passados, ela sempre estar√° defasada em rela√ß√£o a tend√™ncias crescentes ou decrescentes e ciclos [^7]. Um modelo de m√©dia m√≥vel n√£o √© um modelo preditivo de longo prazo, mas sim uma ferramenta para obter uma estimativa da demanda no pr√≥ximo per√≠odo baseado na m√©dia de um per√≠odo anterior [^7].
2.  **Tratamento igual de todos os per√≠odos:** A SMA trata todos os per√≠odos passados igualmente, dando o mesmo peso a dados recentes e mais antigos. Isso pode n√£o ser ideal se os dados mais recentes forem mais representativos da demanda futura.

**Observa√ß√£o:** Uma consequ√™ncia direta do tratamento igual de todos os per√≠odos √© que, se houver uma mudan√ßa abrupta na demanda, a SMA levar√° *n* per√≠odos para que a influ√™ncia dessa mudan√ßa se reflita completamente no valor da m√©dia m√≥vel. Este comportamento de resposta lenta √© uma limita√ß√£o em contextos com mudan√ßas din√¢micas.

#### T√©cnicas de Ajuste da SMA

A escolha do n√∫mero de per√≠odos *n* na SMA n√£o √© arbitr√°ria. T√©cnicas como a **autocorrela√ß√£o** e a **an√°lise da frequ√™ncia de resson√¢ncia** podem ser usadas para determinar o valor ideal de *n*.

1.  **Autocorrela√ß√£o:** A autocorrela√ß√£o mede a correla√ß√£o de uma s√©rie temporal com ela mesma, em diferentes defasagens. Analisando o correlograma (gr√°fico de autocorrela√ß√£o), podemos identificar padr√µes peri√≥dicos nos dados, tais como a presen√ßa de um ciclo de certo tamanho, e usar essas informa√ß√µes para escolher o n√∫mero de per√≠odos na m√©dia m√≥vel, de forma a suavizar o ru√≠do, mas capturar os padr√µes relevantes [^13].

2.  **An√°lise da Frequ√™ncia de Resson√¢ncia:** Por meio da transformada de Fourier, como vimos na se√ß√£o anterior, podemos identificar as frequ√™ncias de oscila√ß√£o dominantes nos dados [^11]. Em outras palavras, podemos encontrar o per√≠odo em que a demanda mais flutua. O valor de *n* pode ser selecionado de forma que ele n√£o capture as frequ√™ncias de ru√≠do, mas que seja apropriado para a frequ√™ncia de varia√ß√£o da demanda.

> üí° **Exemplo Num√©rico (Autocorrela√ß√£o):**
> Suponha que temos dados de vendas di√°rias de um produto, e suspeitamos de um ciclo semanal. Calculamos a autocorrela√ß√£o para algumas defasagens e encontramos um pico significativo em defasagens de 7 dias, o que confirma o padr√£o de ciclo semanal. Nesse caso, uma m√©dia m√≥vel de 7 per√≠odos (dias) seria apropriada para suavizar a demanda di√°ria, mantendo o componente semanal.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
> import statsmodels.api as sm
>
> np.random.seed(42)
>
> t = np.linspace(0, 50, 500)
> period = 7
> vendas_diarias = 100 + 20 * np.sin(2 * np.pi * t / period) + 5 * np.random.randn(500)
>
> acf = sm.tsa.acf(vendas_diarias, nlags=50)
>
> plt.figure(figsize=(10, 6))
> plt.stem(np.arange(len(acf)), acf)
> plt.title('Autocorrela√ß√£o das Vendas Di√°rias')
> plt.xlabel('Defasagem (dias)')
> plt.ylabel('Autocorrela√ß√£o')
> plt.grid(True)
> plt.show()
>
> ```
>
> No gr√°fico gerado pelo c√≥digo acima, √© poss√≠vel ver que h√° picos na autocorrela√ß√£o em intervalos de 7, o que confirma o padr√£o semanal.

> üí° **Exemplo Num√©rico (Frequ√™ncia de Resson√¢ncia):**
> Usando os mesmos dados do exemplo anterior de vendas di√°rias de um produto, e usando a transformada de Fourier, encontramos um pico significativo na frequ√™ncia de 1/7, que corresponde a um ciclo de 7 dias. Nesse caso, uma m√©dia m√≥vel de 7 per√≠odos seria apropriada.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> vendas_diarias = np.array([100, 110, 130, 145, 160, 150, 140, 125, 110, 120, 140, 160, 180, 200, 210, 200, 190, 170, 160, 180])
> N = len(vendas_diarias)
> fft_vendas = np.fft.fft(vendas_diarias)
> frequencies = np.fft.fftfreq(N, d=1)  # Frequ√™ncias correspondentes
>
> plt.figure(figsize=(10, 5))
> plt.plot(frequencies[1:N//2], np.abs(fft_vendas)[1:N//2])
> plt.title('Espectro de Frequ√™ncia das Vendas Di√°rias')
> plt.xlabel('Frequ√™ncia (ciclos por per√≠odo)')
> plt.ylabel('Amplitude')
> plt.grid(True)
> plt.show()
> ```
> O gr√°fico mostrar√° um pico nas frequ√™ncias correspondentes ao ciclo presente nos dados.

> üí° **Exemplo Num√©rico (SMA com dados concretos):**
> Vamos supor que temos as seguintes vendas de um produto nos √∫ltimos 5 dias: 120, 130, 145, 150, 160. Queremos calcular a SMA para o 6¬∫ dia usando uma janela de 3 dias (n=3).
>
> $\text{SMA}_6 = \frac{145 + 150 + 160}{3} = \frac{455}{3} \approx 151.67$
>
> Portanto, nossa previs√£o para o 6¬∫ dia usando a SMA √© aproximadamente 151.67.
>
> Agora, vamos calcular a SMA para o 7¬∫ dia. Assumindo que a venda do 6¬∫ dia foi de 165 unidades, temos:
>
> $\text{SMA}_7 = \frac{150 + 160 + 165}{3} = \frac{475}{3} \approx 158.33$
>
> A previs√£o para o 7¬∫ dia √© de aproximadamente 158.33. Observe como a SMA se ajusta ligeiramente √† medida que novos dados s√£o inclu√≠dos.

**Teorema 1:**  A SMA pode ser vista como um filtro de m√©dia, que suaviza as varia√ß√µes de alta frequ√™ncia em uma s√©rie temporal.

**Prova:**
I. A f√≥rmula da SMA √© dada por:
$$SMA_t = \frac{A_{t-1} + A_{t-2} + \ldots + A_{t-n}}{n}$$
II.  Esta f√≥rmula calcula a m√©dia aritm√©tica dos √∫ltimos *n* valores.
III.  Ao calcular a m√©dia, os valores que est√£o acima da m√©dia e os que est√£o abaixo da m√©dia tendem a se cancelar.
IV.  Componentes de alta frequ√™ncia, que mudam rapidamente, tendem a ser cancelados de forma mais eficaz, enquanto componentes de baixa frequ√™ncia, que mudam lentamente, persistem.
V.  Este efeito de cancelamento de varia√ß√µes de alta frequ√™ncia √© an√°logo ao de um filtro de m√©dia, que atenua frequ√™ncias mais altas e passa frequ√™ncias mais baixas.
VI. Portanto, a SMA suaviza as varia√ß√µes de alta frequ√™ncia, atuando como um filtro de m√©dia. $\blacksquare$

### Modelos de M√©dia M√≥vel Ponderada (WMA)

A **m√©dia m√≥vel ponderada (WMA)** √© uma varia√ß√£o da SMA que atribui pesos diferentes aos dados dos per√≠odos anteriores, dando maior √™nfase aos dados mais recentes [^7]. A f√≥rmula da WMA no per√≠odo *t* √©:

$$WMA_t = w_1A_{t-1} + w_2A_{t-2} + \ldots + w_nA_{t-n}$$

onde:
- $WMA_t$ √© a m√©dia m√≥vel ponderada para o per√≠odo *t*.
- $w_1, w_2, \ldots, w_n$ s√£o os pesos atribu√≠dos a cada per√≠odo, com $0 \leq w_i \leq 1$ e $\sum_{i=1}^n w_i = 1$
- $A_{t-1}, A_{t-2}, \ldots, A_{t-n}$ s√£o as demandas reais nos per√≠odos anteriores [^7].

A principal diferen√ßa entre a WMA e a SMA √© a atribui√ß√£o de pesos. Enquanto a SMA d√° o mesmo peso a todos os per√≠odos, a WMA d√° maior peso aos dados mais recentes, tornando a previs√£o mais responsiva a mudan√ßas recentes na demanda [^7]. Essa caracter√≠stica faz com que a WMA seja uma boa op√ß√£o quando a demanda n√£o √© totalmente est√°vel, pois d√° mais √™nfase a dados recentes.

#### Adequa√ß√£o e Limita√ß√µes da WMA

A WMA √© mais adequada quando a demanda apresenta mudan√ßas recentes que precisam ser levadas em considera√ß√£o. No entanto, assim como a SMA, a WMA tem algumas limita√ß√µes:

1.  **Subjetividade na escolha dos pesos:** A defini√ß√£o dos pesos √© subjetiva e pode envolver tentativa e erro. N√£o existe uma f√≥rmula universal para determinar os pesos √≥timos, e sua escolha pode depender do conhecimento e da intui√ß√£o do analista.
2.  **Defasagem em rela√ß√£o a padr√µes n√£o lineares:** Embora a WMA seja mais responsiva do que a SMA, ela ainda pode apresentar defasagem em rela√ß√£o a padr√µes de demanda n√£o lineares.
3.  **Necessidade de ajuste cont√≠nuo:** Os pesos podem precisar ser ajustados periodicamente para refletir mudan√ßas nas caracter√≠sticas da demanda.
4.  **Menos estabilidade:** Modelos WMA, quando comparados a SMA, podem apresentar menor estabilidade, devido ao peso dos dados mais recentes.

#### T√©cnicas de Ajuste da WMA

Embora a defini√ß√£o dos pesos seja subjetiva, algumas abordagens podem ser usadas para orientar essa escolha:

1.  **Pesos Lineares:** Os pesos podem ser atribu√≠dos de forma linear, dando maior peso aos dados mais recentes. Por exemplo, em uma WMA com 3 per√≠odos, os pesos poderiam ser 0.5, 0.33 e 0.17.
2.  **Pesos Exponenciais:** Os pesos podem ser definidos exponencialmente, atribuindo pesos cada vez menores para dados mais antigos. Por exemplo, pesos 0.5, 0.25, 0.125 para 3 per√≠odos, e assim por diante.
3.  **An√°lise do Per√≠odo de Relev√¢ncia:** A defini√ß√£o dos pesos pode ser orientada por uma an√°lise do per√≠odo em que os dados passados s√£o mais relevantes para a previs√£o.  Por exemplo, se os dados mais recentes (por exemplo, √∫ltimos 3 meses) forem mais importantes, podemos alocar mais peso para esses valores.

> üí° **Exemplo Num√©rico (WMA com pesos lineares):**
> Usando os mesmos dados de vendas dos √∫ltimos 5 dias (120, 130, 145, 150, 160) e considerando uma janela de 3 per√≠odos, vamos aplicar pesos lineares para calcular a WMA para o 6¬∫ dia. Usaremos os pesos 0.5, 0.33 e 0.17 para os per√≠odos mais recentes, respectivamente.
>
> $\text{WMA}_6 = (0.5 \times 160) + (0.33 \times 150) + (0.17 \times 145) = 80 + 49.5 + 24.65 = 154.15$
>
> A previs√£o para o 6¬∫ dia usando WMA √© de aproximadamente 154.15, mostrando uma maior import√¢ncia para o dado mais recente (160), comparado ao exemplo anterior com SMA.
>
> Agora, considerando que a venda do 6¬∫ dia foi de 165, vamos calcular a WMA para o 7¬∫ dia com os mesmos pesos:
>
> $\text{WMA}_7 = (0.5 \times 165) + (0.33 \times 160) + (0.17 \times 150) = 82.5 + 52.8 + 25.5 = 160.8$
>
> Observe que a WMA com pesos lineares responde mais rapidamente √†s mudan√ßas recentes (como o aumento da demanda no 6¬∫ dia), em compara√ß√£o com a SMA, que d√° pesos iguais a todos os dados passados.

> üí° **Exemplo Num√©rico (WMA com pesos exponenciais):**
> Novamente, usando a mesma s√©rie de dados (120, 130, 145, 150, 160), vamos utilizar pesos exponenciais, onde cada peso √© metade do anterior (0.5, 0.25, 0.125, ...) normalizados para somar 1. Para uma janela de 3 per√≠odos, os pesos normalizados seriam aproximadamente 0.57, 0.29 e 0.14.
>
> $\text{WMA}_6 = (0.57 \times 160) + (0.29 \times 150) + (0.14 \times 145) = 91.2 + 43.5 + 20.3 = 155$
>
> Comparado com o exemplo de pesos lineares, o uso de pesos exponenciais d√° ainda mais import√¢ncia para o dado mais recente, resultando em uma previs√£o de 155.

**Proposi√ß√£o 1.1:** A escolha dos pesos na WMA afeta diretamente a sensibilidade do modelo a mudan√ßas recentes. Pesos que decrescem rapidamente com o tempo tornam o modelo mais sens√≠vel a mudan√ßas recentes, enquanto pesos que decrescem lentamente resultam em um modelo mais est√°vel.
**Prova:**
I.  Seja $WMA_t = w_1A_{t-1} + w_2A_{t-2} + \ldots + w_nA_{t-n}$ a f√≥rmula para a WMA no per√≠odo t.
II.  Considere dois conjuntos de pesos: um em que os pesos decrescem rapidamente com o tempo (por exemplo, $w_1 >> w_2 > w_3 > ...$) e outro em que os pesos decrescem lentamente (por exemplo, $w_1 \approx w_2 \approx w_3 \approx ...$).
III.  No primeiro caso, o valor de $A_{t-1}$ tem um peso maior, e, portanto, uma mudan√ßa em $A_{t-1}$ ter√° um impacto maior na $WMA_t$. Isso indica maior sensibilidade a mudan√ßas recentes.
IV. No segundo caso, todos os valores de $A_{t-i}$ t√™m um peso similar, e, portanto, mudan√ßas em qualquer valor de $A_{t-i}$ ter√£o um impacto menor em $WMA_t$, resultando em maior estabilidade.
V. Portanto, a escolha dos pesos na WMA afeta diretamente a sensibilidade do modelo a mudan√ßas recentes. Pesos que decrescem rapidamente com o tempo tornam o modelo mais sens√≠vel a mudan√ßas recentes, enquanto pesos que decrescem lentamente resultam em um modelo mais est√°vel. $\blacksquare$

### Diagrama de Fluxo

```mermaid
graph LR
    A[S√©rie Temporal de Demanda] --> B(Definir n (SMA) ou n e pesos (WMA));
    B --> C{Calcular M√©dia M√≥vel (SMA ou WMA)};
    C --> D[Previs√£o da Demanda];
    D --> E{Avalia√ß√£o e Ajuste (opcional)};
```

### Compara√ß√£o entre SMA e WMA

A escolha entre SMA e WMA depende da natureza dos dados e dos objetivos da previs√£o. Em geral:

*   Use a SMA quando a demanda for relativamente est√°vel e o objetivo for suavizar o componente irregular.
*   Use a WMA quando a demanda apresentar mudan√ßas recentes que precisam ser levadas em considera√ß√£o e quando houver uma raz√£o para dar mais √™nfase a dados mais recentes.

### Conclus√£o

Os modelos de m√©dia m√≥vel, seja na forma simples ou ponderada, s√£o ferramentas importantes para a previs√£o de s√©ries temporais. Compreender suas caracter√≠sticas, limita√ß√µes e t√©cnicas de ajuste √© fundamental para a aplica√ß√£o eficaz em cen√°rios reais. SMA e WMA s√£o mais adequados para previs√µes de curto prazo, devido √† defasagem que estes apresentam quando a s√©rie temporal possui tend√™ncia. M√©todos mais avan√ßados s√£o necess√°rios para modelar tend√™ncias, sazonalidade e outros componentes que n√£o podem ser acomodados em modelos de m√©dias m√≥veis. T√©cnicas como autocorrela√ß√£o e transformada de Fourier podem auxiliar a identificar par√¢metros como o n√∫mero de per√≠odos ou per√≠odos de resson√¢ncia para que se possa selecionar valores adequados para os par√¢metros dos modelos de m√©dia m√≥vel.

### Refer√™ncias
[^6]: Cap√≠tulo 3, p. 60-61
[^7]: Cap√≠tulo 3, p. 61-62
[^11]: Cap√≠tulo 3, p. 73
[^13]: Cap√≠tulo 3, p. 75
[^14]: Cap√≠tulo 3, p. 76
<!-- END -->
