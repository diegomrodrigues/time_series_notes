## DecomposiÃ§Ã£o de SÃ©ries Temporais: TendÃªncia, Ciclo, Sazonalidade e Irregularidade

### IntroduÃ§Ã£o
Como vimos anteriormente, a previsÃ£o da demanda Ã© uma atividade crucial para qualquer organizaÃ§Ã£o, especialmente no setor de saÃºde, impactando decisÃµes em diversas Ã¡reas como finanÃ§as, marketing, recursos humanos e operaÃ§Ãµes [^1]. Um dos principais desafios em previsÃ£o Ã© a variabilidade da demanda, que dificulta sua prediÃ§Ã£o [^1]. Para lidar com essa complexidade, este capÃ­tulo explora mÃ©todos de previsÃ£o, dividindo-os em qualitativos e quantitativos [^1]. Ao lidarmos com dados sequenciais, tambÃ©m precisamos entender como esses dados podem ser analisados e como a componente temporal impacta os resultados das anÃ¡lises. Este tÃ³pico foca na decomposiÃ§Ã£o de sÃ©ries temporais, um passo essencial para aplicar mÃ©todos de previsÃ£o quantitativos eficazes.

### Conceitos Fundamentais
Uma sÃ©rie temporal Ã© definida como uma sequÃªncia de pontos de dados coletados em intervalos de tempo regulares [^3]. O objetivo principal da anÃ¡lise de sÃ©ries temporais Ã© identificar e modelar os padrÃµes subjacentes nos dados ao longo do tempo [^3]. Estes padrÃµes, que podem se manifestar de diversas formas, sÃ£o a chave para uma previsÃ£o eficaz. Segundo o texto, uma sÃ©rie temporal pode ser decomposta em quatro componentes fundamentais: tendÃªncia, ciclo, sazonalidade e irregularidade [^3].

1. **TendÃªncia:** A **tendÃªncia** representa o movimento de longo prazo, seja ascendente ou descendente, na demanda [^3]. Essa componente reflete alteraÃ§Ãµes duradouras na demanda, causadas por fatores como mudanÃ§as demogrÃ¡ficas, alteraÃ§Ãµes na concorrÃªncia ou transformaÃ§Ãµes sociais [^3]. Por exemplo, o aumento da populaÃ§Ã£o idosa gera uma tendÃªncia crescente na demanda por serviÃ§os geriÃ¡tricos [^3]. Ã‰ fundamental notar que essa tendÃªncia pode ser nÃ£o linear, exigindo modelos de previsÃ£o mais sofisticados do que aqueles que assumem uma tendÃªncia linear.

    **ProposiÃ§Ã£o 1.1** A identificaÃ§Ã£o da tendÃªncia pode ser realizada por meio de mÃ©todos como a regressÃ£o linear ou polinomial, dependendo da natureza da curva de tendÃªncia observada nos dados. MÃ©todos nÃ£o paramÃ©tricos, como o suavizamento por mÃ©dias mÃ³veis, tambÃ©m podem ser usados para capturar tendÃªncias nÃ£o lineares.
    
    **Prova da ProposiÃ§Ã£o 1.1:**
    I. A regressÃ£o linear Ã© um mÃ©todo que ajusta uma linha reta aos dados, Ãºtil quando a tendÃªncia Ã© aproximadamente linear. Matematicamente, a regressÃ£o linear modela a tendÃªncia como $T_t = a + bt$, onde $T_t$ Ã© a tendÃªncia no tempo $t$, e $a$ e $b$ sÃ£o os parÃ¢metros a serem estimados.
    II. A regressÃ£o polinomial ajusta um polinÃ´mio de grau $n$ aos dados, Ãºtil quando a tendÃªncia Ã© nÃ£o linear. Um exemplo Ã© modelar a tendÃªncia como $T_t = a + bt + ct^2$, onde $c$ Ã© o parÃ¢metro adicional para o termo quadrÃ¡tico, permitindo capturar curvas com aceleraÃ§Ã£o ou desaceleraÃ§Ã£o.
    III. O suavizamento por mÃ©dias mÃ³veis calcula a mÃ©dia de um nÃºmero fixo de pontos de dados adjacentes, suavizando flutuaÃ§Ãµes de curto prazo e destacando a tendÃªncia. Isso Ã© feito calculando a mÃ©dia de $k$ pontos de dados anteriores a $t$, como: $\hat{T}_t = \frac{1}{k} \sum_{i=t-k+1}^{t} Y_i$, onde $Y_i$ sÃ£o os valores da sÃ©rie temporal.
    IV. A escolha entre esses mÃ©todos dependerÃ¡ da forma visual da tendÃªncia. RegressÃ£o linear Ã© adequada para tendÃªncias aproximadamente lineares, enquanto regressÃ£o polinomial se ajusta melhor a curvas. O suavizamento por mÃ©dias mÃ³veis Ã© adequado para tendÃªncias nÃ£o lineares sem a necessidade de assumir uma forma funcional especÃ­fica para a tendÃªncia.
    V. Portanto, esses mÃ©todos oferecem diferentes abordagens para identificar a tendÃªncia em dados de sÃ©ries temporais, cada um com suas prÃ³prias vantagens dependendo da natureza da tendÃªncia observada. â– 

> ğŸ’¡ **Exemplo NumÃ©rico:** Suponha que temos dados mensais do nÃºmero de pacientes em um hospital durante um ano. Ao plotar os dados, notamos uma tendÃªncia de aumento ao longo do tempo. Para modelar essa tendÃªncia, podemos usar regressÃ£o linear. Os dados de exemplo sÃ£o:
>
> | MÃªs | Pacientes |
> |-----|-----------|
> | 1   | 100       |
> | 2   | 110       |
> | 3   | 125       |
> | 4   | 130       |
> | 5   | 145       |
> | 6   | 150       |
> | 7   | 165       |
> | 8   | 170       |
> | 9   | 180       |
> | 10  | 190       |
> | 11  | 200       |
> | 12  | 210       |
>
> Usando regressÃ£o linear, podemos encontrar a linha de melhor ajuste $T_t = a + bt$. Calculando os parÃ¢metros $a$ (intercepto) e $b$ (coeficiente angular) usando uma biblioteca Python como `numpy`:
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> meses = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12])
> pacientes = np.array([100, 110, 125, 130, 145, 150, 165, 170, 180, 190, 200, 210])
>
> # Ajustando uma regressÃ£o linear
> a, b = np.polyfit(meses, pacientes, 1)
>
> # Criando a linha de tendÃªncia
> trend = a * meses + b
>
> # Plotando os dados e a tendÃªncia
> plt.scatter(meses, pacientes, label='Dados Reais')
> plt.plot(meses, trend, color='red', label=f'TendÃªncia: T = {a:.2f}t + {b:.2f}')
> plt.xlabel('MÃªs')
> plt.ylabel('NÃºmero de Pacientes')
> plt.title('TendÃªncia Linear no NÃºmero de Pacientes')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> print(f"Intercepto (a): {b:.2f}")
> print(f"Coeficiente Angular (b): {a:.2f}")
> ```
> Isso resultaria em $a \approx 9.7$ e $b \approx 101.9$.  A tendÃªncia estimada Ã© entÃ£o  $T_t = 101.9 + 9.7t$. Isso significa que, em mÃ©dia, o nÃºmero de pacientes aumenta em aproximadamente 9.7 por mÃªs. Para fins de ilustraÃ§Ã£o, esse exemplo considera uma tendÃªncia aproximadamente linear; para um exemplo nÃ£o linear, seria necessÃ¡rio usar regressÃ£o polinomial ou mÃ©todos de suavizaÃ§Ã£o.

2. **Ciclo:** Um **ciclo** corresponde a um padrÃ£o que se repete em intervalos de vÃ¡rios anos [^3]. Esses ciclos sÃ£o influenciados por fatores macroeconÃ´micos, como recessÃµes, eleiÃ§Ãµes polÃ­ticas, guerras, etc. [^3]. O texto cita como exemplo a crise econÃ´mica de 2007, que levou Ã  reduÃ§Ã£o de consultas mÃ©dicas privadas e a um aumento da demanda por serviÃ§os de saÃºde comunitÃ¡rios [^3]. Ã‰ importante distinguir ciclos de tendÃªncias. Enquanto tendÃªncias sÃ£o de longa duraÃ§Ã£o e geralmente acompanham uma mudanÃ§a estrutural no mercado, ciclos sÃ£o variaÃ§Ãµes periÃ³dicas e podem ser mais difÃ­ceis de prever.

   **Lema 2.1** A anÃ¡lise de ciclos pode ser complexa devido Ã  sua natureza irregular e Ã  sua dependÃªncia de fatores externos. TÃ©cnicas de anÃ¡lise espectral e modelos de sÃ©ries temporais com componentes cÃ­clicos podem ser usados para identificar e modelar ciclos.

3. **Sazonalidade:** A **sazonalidade** Ã© um padrÃ£o que se repete dentro de um perÃ­odo especÃ­fico, que pode ser diÃ¡rio, semanal, mensal, trimestral ou anual [^4]. Essas flutuaÃ§Ãµes sÃ£o regulares e previsÃ­veis, como a baixa de pacientes em emergÃªncias no perÃ­odo entre a meia-noite e as 8h da manhÃ£ [^4]. O texto tambÃ©m menciona que o nÃºmero de fraturas de quadril atinge um pico nos meses de inverno [^4]. A sazonalidade Ã© crucial em muitas aplicaÃ§Ãµes no setor de saÃºde, pois permite adequar a capacidade de resposta de acordo com as necessidades especÃ­ficas em cada perÃ­odo.

    **Teorema 3.1** A modelagem da sazonalidade pode ser feita atravÃ©s de mÃ©todos como sÃ©ries de Fourier ou modelos ARIMA sazonais (SARIMA). A escolha do mÃ©todo dependerÃ¡ da complexidade e da periodicidade dos padrÃµes sazonais observados. Em particular, a representaÃ§Ã£o por sÃ©ries de Fourier permite capturar mÃºltiplas frequÃªncias sazonais simultaneamente, o que Ã© muito Ãºtil em sÃ©ries temporais complexas.

    **Prova do Teorema 3.1:**
    I. SÃ©ries de Fourier representam uma funÃ§Ã£o periÃ³dica como uma soma de funÃ§Ãµes seno e cosseno de diferentes frequÃªncias. Matematicamente, a componente sazonal $S_t$ pode ser modelada como:
       $$S_t = \frac{a_0}{2} + \sum_{n=1}^{N} \left[ a_n \cos \left( \frac{2 \pi n t}{T} \right) + b_n \sin \left( \frac{2 \pi n t}{T} \right) \right],$$
       onde $T$ Ã© o perÃ­odo da sazonalidade, e $a_n$ e $b_n$ sÃ£o coeficientes a serem estimados.
    II. Os modelos SARIMA (Seasonal Autoregressive Integrated Moving Average) sÃ£o extensÃµes dos modelos ARIMA que incluem termos para modelar a sazonalidade. Um modelo SARIMA Ã© denotado como ARIMA(p, d, q)(P, D, Q)s, onde (p, d, q) sÃ£o os termos nÃ£o sazonais, (P, D, Q) sÃ£o os termos sazonais e s Ã© o perÃ­odo da sazonalidade. Esses modelos usam os valores passados da sÃ©rie e os erros passados para prever os valores futuros.
    III. As sÃ©ries de Fourier sÃ£o Ãºteis quando se tem vÃ¡rios padrÃµes sazonais distintos que se repetem, pois permite capturar vÃ¡rias frequÃªncias simultaneamente. Por exemplo, uma sÃ©rie temporal com sazonalidade diÃ¡ria e anual pode ser modelada utilizando frequÃªncias correspondentes a um dia e um ano.
    IV. Os modelos SARIMA sÃ£o adequados para sÃ©ries temporais com padrÃµes sazonais mais complexos e autocorrelaÃ§Ã£o. Por exemplo, uma sÃ©rie temporal com uma sazonalidade mensal e que apresente um comportamento autocorelatado (ou seja, o valor corrente da sÃ©rie depende dos valores passados) pode ser modelada utilizando a componente AR (Autoregressiva) do modelo SARIMA.
    V. Assim, a escolha entre sÃ©ries de Fourier e SARIMA dependerÃ¡ da natureza da sazonalidade e da complexidade da sÃ©rie temporal. Enquanto sÃ©ries de Fourier sÃ£o mais adequadas para mÃºltiplas frequÃªncias sazonais, modelos SARIMA sÃ£o mais apropriados quando hÃ¡ autocorrelaÃ§Ã£o nos dados e padrÃµes sazonais complexos. â– 

> ğŸ’¡ **Exemplo NumÃ©rico:** Considere o nÃºmero de atendimentos em um pronto-socorro por dia da semana. Uma anÃ¡lise desses dados ao longo do tempo revela um padrÃ£o sazonal semanal, onde o nÃºmero de atendimentos Ã© maior nos fins de semana e menor durante a semana. Os dados de exemplo de uma semana sÃ£o:
>
> | Dia da Semana | Atendimentos |
> |--------------|-------------|
> | Domingo      | 300        |
> | Segunda      | 150        |
> | TerÃ§a        | 140        |
> | Quarta       | 160        |
> | Quinta       | 170        |
> | Sexta        | 220        |
> | SÃ¡bado       | 280        |
>
> Usando uma abordagem de mÃ©dias sazonais, podemos calcular a mÃ©dia de cada dia da semana ao longo de vÃ¡rias semanas (ou mesmo vÃ¡rios anos) para encontrar a sazonalidade. O componente sazonal de cada dia pode ser modelado como um desvio da mÃ©dia global. Por exemplo, suponha que a mÃ©dia de atendimentos diÃ¡rios em um dado mÃªs Ã© 200. O componente sazonal de cada dia da semana pode ser obtido pela diferenÃ§a entre o nÃºmero de atendimentos no dia e a mÃ©dia global. Se repetirmos o processo por vÃ¡rios meses, obteremos o componente sazonal por dia:
>
> | Dia da Semana | Atendimentos MÃ©dios | Componente Sazonal |
> |--------------|--------------------|--------------------|
> | Domingo      | 310                | 110                |
> | Segunda      | 160                | -40                |
> | TerÃ§a        | 150                | -50                |
> | Quarta       | 170                | -30                |
> | Quinta       | 180                | -20                |
> | Sexta        | 230                | 30                 |
> | SÃ¡bado       | 290                | 90                 |
>
> Esses componentes sazonais indicam o desvio em relaÃ§Ã£o Ã  mÃ©dia global de 200. Por exemplo, domingos tendem a ter 110 atendimentos a mais do que a mÃ©dia, enquanto segundas-feiras tendem a ter 40 atendimentos a menos do que a mÃ©dia. Este padrÃ£o sazonal pode ser usado em conjunto com um modelo de tendÃªncia para melhorar a precisÃ£o das previsÃµes.

   **CorolÃ¡rio 3.2** Em situaÃ§Ãµes onde a sÃ©rie temporal apresenta mÃºltiplas sazonalidades (por exemplo, sazonalidade diÃ¡ria e anual), a combinaÃ§Ã£o de mÃ©todos, como o uso de modelos SARIMA com termos adicionais que modelam diferentes frequÃªncias, pode gerar melhores resultados.

4. **Irregularidade:** O **movimento irregular** Ã© uma variaÃ§Ã£o aleatÃ³ria, nÃ£o previsÃ­vel, que ocorre por acaso [^4]. Essa componente Ã© essencialmente um ruÃ­do nos dados, sendo um fator limitador da precisÃ£o de qualquer previsÃ£o [^4]. O texto argumenta que a presenÃ§a da componente irregular Ã© o motivo pelo qual nunca teremos previsÃµes perfeitas [^4]. Ã‰ importante que os modelos de previsÃ£o nÃ£o reajam a essas flutuaÃ§Ãµes aleatÃ³rias, a fim de nÃ£o comprometer sua capacidade de resposta Ã s mudanÃ§as reais na demanda.

    **ProposiÃ§Ã£o 4.1** A irregularidade, ou ruÃ­do branco, Ã© comumente modelada como uma variÃ¡vel aleatÃ³ria com mÃ©dia zero e variÃ¢ncia constante. TÃ©cnicas de filtragem, como o filtro de Kalman, podem ser usadas para mitigar o efeito do ruÃ­do nos modelos de previsÃ£o.

    **Prova da ProposiÃ§Ã£o 4.1:**
    I. O ruÃ­do branco Ã© caracterizado como uma sequÃªncia de variÃ¡veis aleatÃ³rias nÃ£o correlacionadas com mÃ©dia zero e variÃ¢ncia constante $\sigma^2$. Ou seja, para o ruÃ­do branco $e_t$, temos $E[e_t] = 0$ e $Var[e_t] = \sigma^2$ para todo $t$, e $Cov(e_t, e_s) = 0$ para $t \neq s$.
    II.  O filtro de Kalman Ã© um algoritmo recursivo que estima o estado de um sistema dinÃ¢mico a partir de mediÃ§Ãµes ruidosas. Ele usa um modelo de estado e um modelo de observaÃ§Ã£o para combinar informaÃ§Ãµes passadas e presentes, reduzindo o impacto do ruÃ­do nas estimativas. Em essÃªncia, o filtro de Kalman minimiza a variÃ¢ncia do erro de estimaÃ§Ã£o ao fornecer uma estimativa Ã³tima do estado subjacente, incluindo a mitigaÃ§Ã£o da componente irregular.
    III. A modelagem do ruÃ­do como uma variÃ¡vel aleatÃ³ria com mÃ©dia zero implica que as variaÃ§Ãµes aleatÃ³rias nÃ£o tÃªm uma direÃ§Ã£o preferencial (nÃ£o sÃ£o sistematicamente positivas ou negativas). A variÃ¢ncia constante implica que a magnitude do ruÃ­do Ã© estÃ¡vel ao longo do tempo.
    IV. TÃ©cnicas de filtragem, como o filtro de Kalman, funcionam atravÃ©s da ponderaÃ§Ã£o entre as previsÃµes do modelo e as novas observaÃ§Ãµes de forma a reduzir o impacto da componente aleatÃ³ria. Isso melhora a precisÃ£o das previsÃµes porque o filtro de Kalman permite que o modelo de previsÃ£o nÃ£o reaja ao ruÃ­do presente nos dados, mas apenas ao sinal presente nos dados.
    V. Portanto, a modelagem do ruÃ­do como uma variÃ¡vel aleatÃ³ria com mÃ©dia zero e variÃ¢ncia constante, combinada com tÃ©cnicas de filtragem, ajuda a mitigar os efeitos da irregularidade nas previsÃµes, melhorando a acurÃ¡cia do modelo. â– 

> ğŸ’¡ **Exemplo NumÃ©rico:**  Suponha que temos uma sÃ©rie temporal que representa o nÃºmero de pacientes atendidos em um pronto-socorro diariamente. ApÃ³s modelar a tendÃªncia e a sazonalidade, ainda observamos flutuaÃ§Ãµes aleatÃ³rias nos dados. Por exemplo, em um dia especÃ­fico, o modelo prevÃª 250 atendimentos, mas observamos 265. Essa diferenÃ§a de 15 pacientes pode ser considerada como irregularidade. Se plotarmos os resÃ­duos (diferenÃ§a entre o valor observado e o valor previsto) ao longo do tempo, podemos ver que esses resÃ­duos se distribuem aleatoriamente em torno de zero, e sua variÃ¢ncia Ã© aproximadamente constante.
>
> Para verificar isso, podemos usar um exemplo simples com dados simulados, onde adicionamos ruÃ­do branco a uma sÃ©rie simulada. Abaixo, temos um trecho de cÃ³digo Python para simular esse processo:
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)  # para reprodutibilidade
>
> # SimulaÃ§Ã£o de uma sÃ©rie temporal com tendÃªncia e sazonalidade
> t = np.arange(100)
> trend = 5 + 0.2 * t # TendÃªncia Linear
> seasonal = 10*np.sin(2*np.pi*t/30)  # Sazonalidade
>
> # Adicionando ruÃ­do branco (irregularidade)
> noise = np.random.normal(0, 5, 100)
>
> time_series = trend + seasonal + noise
>
> # Plotando os dados simulados
> plt.plot(t, time_series, label='SÃ©rie Temporal com RuÃ­do')
> plt.plot(t, trend+seasonal, label='SÃ©rie Sem RuÃ­do')
> plt.xlabel('Tempo')
> plt.ylabel('Valor')
> plt.title('SimulaÃ§Ã£o de SÃ©rie Temporal com Irregularidade')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> # Plotando o ruÃ­do
> plt.plot(t, noise, label='RuÃ­do Branco (Irregularidade)')
> plt.axhline(0, color='r', linestyle='--', label='MÃ©dia Zero')
> plt.xlabel('Tempo')
> plt.ylabel('RuÃ­do')
> plt.title('RuÃ­do Branco (Irregularidade)')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> print(f"MÃ©dia do RuÃ­do: {np.mean(noise):.2f}")
> print(f"Desvio PadrÃ£o do RuÃ­do: {np.std(noise):.2f}")
> ```
>
> A mÃ©dia do ruÃ­do serÃ¡ prÃ³xima de zero, e seu desvio padrÃ£o serÃ¡ constante ao longo do tempo, o que exemplifica o conceito de irregularidade.

A figura 3.1 [^3] ilustra os componentes de uma sÃ©rie temporal, mostrando a sobreposiÃ§Ã£o entre a tendÃªncia, a sazonalidade, a mÃ©dia da demanda e a flutuaÃ§Ã£o aleatÃ³ria. Essa representaÃ§Ã£o visual facilita a compreensÃ£o de como essas componentes interagem e moldam o padrÃ£o de demanda observado. Em geral, a decomposiÃ§Ã£o de uma sÃ©rie temporal ajuda a isolar os diferentes componentes para uma melhor compreensÃ£o e modelagem da demanda [^3].

### ConclusÃ£o
A decomposiÃ§Ã£o de sÃ©ries temporais em tendÃªncia, ciclo, sazonalidade e irregularidade Ã© uma etapa fundamental na anÃ¡lise quantitativa de dados temporais [^3]. O entendimento de cada componente Ã© crucial para a escolha de modelos de previsÃ£o adequados, que possam gerar resultados mais precisos e confiÃ¡veis [^3]. Este conhecimento permite que os gestores no setor de saÃºde tomem decisÃµes mais informadas sobre alocaÃ§Ã£o de recursos, planejamento de capacidade e gestÃ£o de custos. Como veremos nos tÃ³picos seguintes, a decomposiÃ§Ã£o de sÃ©ries temporais Ã© um passo preliminar para a aplicaÃ§Ã£o de modelos quantitativos mais avanÃ§ados, como as mÃ©dias mÃ³veis e o suavizaÃ§Ã£o exponencial.

### ReferÃªncias
[^1]: ... *CapÃ­tulo 3: Forecasting Demand*
[^2]: ... *Box 3.1 OM in Practice!*
[^3]: ... *Componentes of a Time Series*
[^4]: ... *3. Seasonality.*
[^5]: ... *4. Irregular movement.*
<!-- END -->
