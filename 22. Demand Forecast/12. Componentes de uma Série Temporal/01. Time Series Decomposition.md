## Decomposi√ß√£o de S√©ries Temporais: Tend√™ncia, Ciclo, Sazonalidade e Irregularidade

### Introdu√ß√£o
Como vimos anteriormente, a previs√£o da demanda √© uma atividade crucial para qualquer organiza√ß√£o, especialmente no setor de sa√∫de, impactando decis√µes em diversas √°reas como finan√ßas, marketing, recursos humanos e opera√ß√µes [^1]. Um dos principais desafios em previs√£o √© a variabilidade da demanda, que dificulta sua predi√ß√£o [^1]. Para lidar com essa complexidade, este cap√≠tulo explora m√©todos de previs√£o, dividindo-os em qualitativos e quantitativos [^1]. Ao lidarmos com dados sequenciais, tamb√©m precisamos entender como esses dados podem ser analisados e como a componente temporal impacta os resultados das an√°lises. Este t√≥pico foca na decomposi√ß√£o de s√©ries temporais, um passo essencial para aplicar m√©todos de previs√£o quantitativos eficazes.

### Conceitos Fundamentais
Uma s√©rie temporal √© definida como uma sequ√™ncia de pontos de dados coletados em intervalos de tempo regulares [^3]. O objetivo principal da an√°lise de s√©ries temporais √© identificar e modelar os padr√µes subjacentes nos dados ao longo do tempo [^3]. Estes padr√µes, que podem se manifestar de diversas formas, s√£o a chave para uma previs√£o eficaz. Segundo o texto, uma s√©rie temporal pode ser decomposta em quatro componentes fundamentais: tend√™ncia, ciclo, sazonalidade e irregularidade [^3].

1. **Tend√™ncia:** A **tend√™ncia** representa o movimento de longo prazo, seja ascendente ou descendente, na demanda [^3]. Essa componente reflete altera√ß√µes duradouras na demanda, causadas por fatores como mudan√ßas demogr√°ficas, altera√ß√µes na concorr√™ncia ou transforma√ß√µes sociais [^3]. Por exemplo, o aumento da popula√ß√£o idosa gera uma tend√™ncia crescente na demanda por servi√ßos geri√°tricos [^3]. √â fundamental notar que essa tend√™ncia pode ser n√£o linear, exigindo modelos de previs√£o mais sofisticados do que aqueles que assumem uma tend√™ncia linear.

    **Proposi√ß√£o 1.1** A identifica√ß√£o da tend√™ncia pode ser realizada por meio de m√©todos como a regress√£o linear ou polinomial, dependendo da natureza da curva de tend√™ncia observada nos dados. M√©todos n√£o param√©tricos, como o suavizamento por m√©dias m√≥veis, tamb√©m podem ser usados para capturar tend√™ncias n√£o lineares.
    
    **Prova da Proposi√ß√£o 1.1:**
    I. A regress√£o linear √© um m√©todo que ajusta uma linha reta aos dados, √∫til quando a tend√™ncia √© aproximadamente linear. Matematicamente, a regress√£o linear modela a tend√™ncia como $T_t = a + bt$, onde $T_t$ √© a tend√™ncia no tempo $t$, e $a$ e $b$ s√£o os par√¢metros a serem estimados.
    II. A regress√£o polinomial ajusta um polin√¥mio de grau $n$ aos dados, √∫til quando a tend√™ncia √© n√£o linear. Um exemplo √© modelar a tend√™ncia como $T_t = a + bt + ct^2$, onde $c$ √© o par√¢metro adicional para o termo quadr√°tico, permitindo capturar curvas com acelera√ß√£o ou desacelera√ß√£o.
    III. O suavizamento por m√©dias m√≥veis calcula a m√©dia de um n√∫mero fixo de pontos de dados adjacentes, suavizando flutua√ß√µes de curto prazo e destacando a tend√™ncia. Isso √© feito calculando a m√©dia de $k$ pontos de dados anteriores a $t$, como: $\hat{T}_t = \frac{1}{k} \sum_{i=t-k+1}^{t} Y_i$, onde $Y_i$ s√£o os valores da s√©rie temporal.
    IV. A escolha entre esses m√©todos depender√° da forma visual da tend√™ncia. Regress√£o linear √© adequada para tend√™ncias aproximadamente lineares, enquanto regress√£o polinomial se ajusta melhor a curvas. O suavizamento por m√©dias m√≥veis √© adequado para tend√™ncias n√£o lineares sem a necessidade de assumir uma forma funcional espec√≠fica para a tend√™ncia.
    V. Portanto, esses m√©todos oferecem diferentes abordagens para identificar a tend√™ncia em dados de s√©ries temporais, cada um com suas pr√≥prias vantagens dependendo da natureza da tend√™ncia observada. ‚ñ†

> üí° **Exemplo Num√©rico:** Suponha que temos dados mensais do n√∫mero de pacientes em um hospital durante um ano. Ao plotar os dados, notamos uma tend√™ncia de aumento ao longo do tempo. Para modelar essa tend√™ncia, podemos usar regress√£o linear. Os dados de exemplo s√£o:
>
> | M√™s | Pacientes |
> |-----|-----------|
> | 1   | 100       |
> | 2   | 110       |
> | 3   | 125       |
> | 4   | 130       |
> | 5   | 145       |
> | 6   | 150       |
> | 7   | 165       |
> | 8   | 170       |
> | 9   | 180       |
> | 10  | 190       |
> | 11  | 200       |
> | 12  | 210       |
>
> Usando regress√£o linear, podemos encontrar a linha de melhor ajuste $T_t = a + bt$. Calculando os par√¢metros $a$ (intercepto) e $b$ (coeficiente angular) usando uma biblioteca Python como `numpy`:
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> meses = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12])
> pacientes = np.array([100, 110, 125, 130, 145, 150, 165, 170, 180, 190, 200, 210])
>
> # Ajustando uma regress√£o linear
> a, b = np.polyfit(meses, pacientes, 1)
>
> # Criando a linha de tend√™ncia
> trend = a * meses + b
>
> # Plotando os dados e a tend√™ncia
> plt.scatter(meses, pacientes, label='Dados Reais')
> plt.plot(meses, trend, color='red', label=f'Tend√™ncia: T = {a:.2f}t + {b:.2f}')
> plt.xlabel('M√™s')
> plt.ylabel('N√∫mero de Pacientes')
> plt.title('Tend√™ncia Linear no N√∫mero de Pacientes')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> print(f"Intercepto (a): {b:.2f}")
> print(f"Coeficiente Angular (b): {a:.2f}")
> ```
> Isso resultaria em $a \approx 9.7$ e $b \approx 101.9$.  A tend√™ncia estimada √© ent√£o  $T_t = 101.9 + 9.7t$. Isso significa que, em m√©dia, o n√∫mero de pacientes aumenta em aproximadamente 9.7 por m√™s. Para fins de ilustra√ß√£o, esse exemplo considera uma tend√™ncia aproximadamente linear; para um exemplo n√£o linear, seria necess√°rio usar regress√£o polinomial ou m√©todos de suaviza√ß√£o.

2. **Ciclo:** Um **ciclo** corresponde a um padr√£o que se repete em intervalos de v√°rios anos [^3]. Esses ciclos s√£o influenciados por fatores macroecon√¥micos, como recess√µes, elei√ß√µes pol√≠ticas, guerras, etc. [^3]. O texto cita como exemplo a crise econ√¥mica de 2007, que levou √† redu√ß√£o de consultas m√©dicas privadas e a um aumento da demanda por servi√ßos de sa√∫de comunit√°rios [^3]. √â importante distinguir ciclos de tend√™ncias. Enquanto tend√™ncias s√£o de longa dura√ß√£o e geralmente acompanham uma mudan√ßa estrutural no mercado, ciclos s√£o varia√ß√µes peri√≥dicas e podem ser mais dif√≠ceis de prever.

   **Lema 2.1** A an√°lise de ciclos pode ser complexa devido √† sua natureza irregular e √† sua depend√™ncia de fatores externos. T√©cnicas de an√°lise espectral e modelos de s√©ries temporais com componentes c√≠clicos podem ser usados para identificar e modelar ciclos.

3. **Sazonalidade:** A **sazonalidade** √© um padr√£o que se repete dentro de um per√≠odo espec√≠fico, que pode ser di√°rio, semanal, mensal, trimestral ou anual [^4]. Essas flutua√ß√µes s√£o regulares e previs√≠veis, como a baixa de pacientes em emerg√™ncias no per√≠odo entre a meia-noite e as 8h da manh√£ [^4]. O texto tamb√©m menciona que o n√∫mero de fraturas de quadril atinge um pico nos meses de inverno [^4]. A sazonalidade √© crucial em muitas aplica√ß√µes no setor de sa√∫de, pois permite adequar a capacidade de resposta de acordo com as necessidades espec√≠ficas em cada per√≠odo.

    **Teorema 3.1** A modelagem da sazonalidade pode ser feita atrav√©s de m√©todos como s√©ries de Fourier ou modelos ARIMA sazonais (SARIMA). A escolha do m√©todo depender√° da complexidade e da periodicidade dos padr√µes sazonais observados. Em particular, a representa√ß√£o por s√©ries de Fourier permite capturar m√∫ltiplas frequ√™ncias sazonais simultaneamente, o que √© muito √∫til em s√©ries temporais complexas.

    **Prova do Teorema 3.1:**
    I. S√©ries de Fourier representam uma fun√ß√£o peri√≥dica como uma soma de fun√ß√µes seno e cosseno de diferentes frequ√™ncias. Matematicamente, a componente sazonal $S_t$ pode ser modelada como:
       $$S_t = \frac{a_0}{2} + \sum_{n=1}^{N} \left[ a_n \cos \left( \frac{2 \pi n t}{T} \right) + b_n \sin \left( \frac{2 \pi n t}{T} \right) \right],$$
       onde $T$ √© o per√≠odo da sazonalidade, e $a_n$ e $b_n$ s√£o coeficientes a serem estimados.
    II. Os modelos SARIMA (Seasonal Autoregressive Integrated Moving Average) s√£o extens√µes dos modelos ARIMA que incluem termos para modelar a sazonalidade. Um modelo SARIMA √© denotado como ARIMA(p, d, q)(P, D, Q)s, onde (p, d, q) s√£o os termos n√£o sazonais, (P, D, Q) s√£o os termos sazonais e s √© o per√≠odo da sazonalidade. Esses modelos usam os valores passados da s√©rie e os erros passados para prever os valores futuros.
    III. As s√©ries de Fourier s√£o √∫teis quando se tem v√°rios padr√µes sazonais distintos que se repetem, pois permite capturar v√°rias frequ√™ncias simultaneamente. Por exemplo, uma s√©rie temporal com sazonalidade di√°ria e anual pode ser modelada utilizando frequ√™ncias correspondentes a um dia e um ano.
    IV. Os modelos SARIMA s√£o adequados para s√©ries temporais com padr√µes sazonais mais complexos e autocorrela√ß√£o. Por exemplo, uma s√©rie temporal com uma sazonalidade mensal e que apresente um comportamento autocorelatado (ou seja, o valor corrente da s√©rie depende dos valores passados) pode ser modelada utilizando a componente AR (Autoregressiva) do modelo SARIMA.
    V. Assim, a escolha entre s√©ries de Fourier e SARIMA depender√° da natureza da sazonalidade e da complexidade da s√©rie temporal. Enquanto s√©ries de Fourier s√£o mais adequadas para m√∫ltiplas frequ√™ncias sazonais, modelos SARIMA s√£o mais apropriados quando h√° autocorrela√ß√£o nos dados e padr√µes sazonais complexos. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere o n√∫mero de atendimentos em um pronto-socorro por dia da semana. Uma an√°lise desses dados ao longo do tempo revela um padr√£o sazonal semanal, onde o n√∫mero de atendimentos √© maior nos fins de semana e menor durante a semana. Os dados de exemplo de uma semana s√£o:
>
> | Dia da Semana | Atendimentos |
> |--------------|-------------|
> | Domingo      | 300        |
> | Segunda      | 150        |
> | Ter√ßa        | 140        |
> | Quarta       | 160        |
> | Quinta       | 170        |
> | Sexta        | 220        |
> | S√°bado       | 280        |
>
> Usando uma abordagem de m√©dias sazonais, podemos calcular a m√©dia de cada dia da semana ao longo de v√°rias semanas (ou mesmo v√°rios anos) para encontrar a sazonalidade. O componente sazonal de cada dia pode ser modelado como um desvio da m√©dia global. Por exemplo, suponha que a m√©dia de atendimentos di√°rios em um dado m√™s √© 200. O componente sazonal de cada dia da semana pode ser obtido pela diferen√ßa entre o n√∫mero de atendimentos no dia e a m√©dia global. Se repetirmos o processo por v√°rios meses, obteremos o componente sazonal por dia:
>
> | Dia da Semana | Atendimentos M√©dios | Componente Sazonal |
> |--------------|--------------------|--------------------|
> | Domingo      | 310                | 110                |
> | Segunda      | 160                | -40                |
> | Ter√ßa        | 150                | -50                |
> | Quarta       | 170                | -30                |
> | Quinta       | 180                | -20                |
> | Sexta        | 230                | 30                 |
> | S√°bado       | 290                | 90                 |
>
> Esses componentes sazonais indicam o desvio em rela√ß√£o √† m√©dia global de 200. Por exemplo, domingos tendem a ter 110 atendimentos a mais do que a m√©dia, enquanto segundas-feiras tendem a ter 40 atendimentos a menos do que a m√©dia. Este padr√£o sazonal pode ser usado em conjunto com um modelo de tend√™ncia para melhorar a precis√£o das previs√µes.

   **Corol√°rio 3.2** Em situa√ß√µes onde a s√©rie temporal apresenta m√∫ltiplas sazonalidades (por exemplo, sazonalidade di√°ria e anual), a combina√ß√£o de m√©todos, como o uso de modelos SARIMA com termos adicionais que modelam diferentes frequ√™ncias, pode gerar melhores resultados.

4. **Irregularidade:** O **movimento irregular** √© uma varia√ß√£o aleat√≥ria, n√£o previs√≠vel, que ocorre por acaso [^4]. Essa componente √© essencialmente um ru√≠do nos dados, sendo um fator limitador da precis√£o de qualquer previs√£o [^4]. O texto argumenta que a presen√ßa da componente irregular √© o motivo pelo qual nunca teremos previs√µes perfeitas [^4]. √â importante que os modelos de previs√£o n√£o reajam a essas flutua√ß√µes aleat√≥rias, a fim de n√£o comprometer sua capacidade de resposta √†s mudan√ßas reais na demanda.

    **Proposi√ß√£o 4.1** A irregularidade, ou ru√≠do branco, √© comumente modelada como uma vari√°vel aleat√≥ria com m√©dia zero e vari√¢ncia constante. T√©cnicas de filtragem, como o filtro de Kalman, podem ser usadas para mitigar o efeito do ru√≠do nos modelos de previs√£o.

    **Prova da Proposi√ß√£o 4.1:**
    I. O ru√≠do branco √© caracterizado como uma sequ√™ncia de vari√°veis aleat√≥rias n√£o correlacionadas com m√©dia zero e vari√¢ncia constante $\sigma^2$. Ou seja, para o ru√≠do branco $e_t$, temos $E[e_t] = 0$ e $Var[e_t] = \sigma^2$ para todo $t$, e $Cov(e_t, e_s) = 0$ para $t \neq s$.
    II.  O filtro de Kalman √© um algoritmo recursivo que estima o estado de um sistema din√¢mico a partir de medi√ß√µes ruidosas. Ele usa um modelo de estado e um modelo de observa√ß√£o para combinar informa√ß√µes passadas e presentes, reduzindo o impacto do ru√≠do nas estimativas. Em ess√™ncia, o filtro de Kalman minimiza a vari√¢ncia do erro de estima√ß√£o ao fornecer uma estimativa √≥tima do estado subjacente, incluindo a mitiga√ß√£o da componente irregular.
    III. A modelagem do ru√≠do como uma vari√°vel aleat√≥ria com m√©dia zero implica que as varia√ß√µes aleat√≥rias n√£o t√™m uma dire√ß√£o preferencial (n√£o s√£o sistematicamente positivas ou negativas). A vari√¢ncia constante implica que a magnitude do ru√≠do √© est√°vel ao longo do tempo.
    IV. T√©cnicas de filtragem, como o filtro de Kalman, funcionam atrav√©s da pondera√ß√£o entre as previs√µes do modelo e as novas observa√ß√µes de forma a reduzir o impacto da componente aleat√≥ria. Isso melhora a precis√£o das previs√µes porque o filtro de Kalman permite que o modelo de previs√£o n√£o reaja ao ru√≠do presente nos dados, mas apenas ao sinal presente nos dados.
    V. Portanto, a modelagem do ru√≠do como uma vari√°vel aleat√≥ria com m√©dia zero e vari√¢ncia constante, combinada com t√©cnicas de filtragem, ajuda a mitigar os efeitos da irregularidade nas previs√µes, melhorando a acur√°cia do modelo. ‚ñ†

> üí° **Exemplo Num√©rico:**  Suponha que temos uma s√©rie temporal que representa o n√∫mero de pacientes atendidos em um pronto-socorro diariamente. Ap√≥s modelar a tend√™ncia e a sazonalidade, ainda observamos flutua√ß√µes aleat√≥rias nos dados. Por exemplo, em um dia espec√≠fico, o modelo prev√™ 250 atendimentos, mas observamos 265. Essa diferen√ßa de 15 pacientes pode ser considerada como irregularidade. Se plotarmos os res√≠duos (diferen√ßa entre o valor observado e o valor previsto) ao longo do tempo, podemos ver que esses res√≠duos se distribuem aleatoriamente em torno de zero, e sua vari√¢ncia √© aproximadamente constante.
>
> Para verificar isso, podemos usar um exemplo simples com dados simulados, onde adicionamos ru√≠do branco a uma s√©rie simulada. Abaixo, temos um trecho de c√≥digo Python para simular esse processo:
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> np.random.seed(42)  # para reprodutibilidade
>
> # Simula√ß√£o de uma s√©rie temporal com tend√™ncia e sazonalidade
> t = np.arange(100)
> trend = 5 + 0.2 * t # Tend√™ncia Linear
> seasonal = 10*np.sin(2*np.pi*t/30)  # Sazonalidade
>
> # Adicionando ru√≠do branco (irregularidade)
> noise = np.random.normal(0, 5, 100)
>
> time_series = trend + seasonal + noise
>
> # Plotando os dados simulados
> plt.plot(t, time_series, label='S√©rie Temporal com Ru√≠do')
> plt.plot(t, trend+seasonal, label='S√©rie Sem Ru√≠do')
> plt.xlabel('Tempo')
> plt.ylabel('Valor')
> plt.title('Simula√ß√£o de S√©rie Temporal com Irregularidade')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> # Plotando o ru√≠do
> plt.plot(t, noise, label='Ru√≠do Branco (Irregularidade)')
> plt.axhline(0, color='r', linestyle='--', label='M√©dia Zero')
> plt.xlabel('Tempo')
> plt.ylabel('Ru√≠do')
> plt.title('Ru√≠do Branco (Irregularidade)')
> plt.legend()
> plt.grid(True)
> plt.show()
>
> print(f"M√©dia do Ru√≠do: {np.mean(noise):.2f}")
> print(f"Desvio Padr√£o do Ru√≠do: {np.std(noise):.2f}")
> ```
>
> A m√©dia do ru√≠do ser√° pr√≥xima de zero, e seu desvio padr√£o ser√° constante ao longo do tempo, o que exemplifica o conceito de irregularidade.

A figura 3.1 [^3] ilustra os componentes de uma s√©rie temporal, mostrando a sobreposi√ß√£o entre a tend√™ncia, a sazonalidade, a m√©dia da demanda e a flutua√ß√£o aleat√≥ria. Essa representa√ß√£o visual facilita a compreens√£o de como essas componentes interagem e moldam o padr√£o de demanda observado. Em geral, a decomposi√ß√£o de uma s√©rie temporal ajuda a isolar os diferentes componentes para uma melhor compreens√£o e modelagem da demanda [^3].

### Conclus√£o
A decomposi√ß√£o de s√©ries temporais em tend√™ncia, ciclo, sazonalidade e irregularidade √© uma etapa fundamental na an√°lise quantitativa de dados temporais [^3]. O entendimento de cada componente √© crucial para a escolha de modelos de previs√£o adequados, que possam gerar resultados mais precisos e confi√°veis [^3]. Este conhecimento permite que os gestores no setor de sa√∫de tomem decis√µes mais informadas sobre aloca√ß√£o de recursos, planejamento de capacidade e gest√£o de custos. Como veremos nos t√≥picos seguintes, a decomposi√ß√£o de s√©ries temporais √© um passo preliminar para a aplica√ß√£o de modelos quantitativos mais avan√ßados, como as m√©dias m√≥veis e o suaviza√ß√£o exponencial.

### Refer√™ncias
[^1]: ... *Cap√≠tulo 3: Forecasting Demand*
[^2]: ... *Box 3.1 OM in Practice!*
[^3]: ... *Componentes of a Time Series*
[^4]: ... *3. Seasonality.*
[^5]: ... *4. Irregular movement.*
<!-- END -->
