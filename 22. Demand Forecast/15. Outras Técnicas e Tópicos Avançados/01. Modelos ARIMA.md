## Modelos ARIMA: Uma An√°lise Detalhada

### Introdu√ß√£o

Em continuidade ao estudo de modelos de s√©ries temporais, este cap√≠tulo explora os **modelos ARIMA (Autoregressive Integrated Moving Average)**, que representam uma extens√£o sofisticada dos modelos AR e MA previamente abordados. Os modelos ARIMA s√£o capazes de modelar uma ampla gama de padr√µes em s√©ries temporais, combinando componentes autorregressivos (AR) e de m√©dias m√≥veis (MA) com um processo de *diferencia√ß√£o* para tornar a s√©rie estacion√°ria. O objetivo √© fornecer uma compreens√£o aprofundada dos fundamentos te√≥ricos, da deriva√ß√£o dos coeficientes e da avalia√ß√£o da estacionariedade em modelos ARIMA.

### Conceitos Fundamentais

Os **modelos ARIMA** s√£o denotados como ARIMA(p, d, q), onde:
- p: ordem do componente autorregressivo (AR)
- d: ordem da diferencia√ß√£o
- q: ordem do componente de m√©dias m√≥veis (MA)

**Componente Autorregressivo (AR):** Como discutido anteriormente, o modelo AR(p) utiliza valores passados da s√©rie temporal para prever os valores futuros. Em um modelo AR(p), o valor atual $Y_t$ √© uma combina√ß√£o linear dos $p$ valores passados:
$$Y_t = c + \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \ldots + \phi_p Y_{t-p} + \epsilon_t$$
onde $c$ √© uma constante, $\phi_i$ s√£o os coeficientes autorregressivos e $\epsilon_t$ √© o ru√≠do branco.

> üí° **Exemplo Num√©rico:** Suponha um modelo AR(2) com $c = 5$, $\phi_1 = 0.7$, e $\phi_2 = 0.2$. Se $Y_{t-1} = 20$ e $Y_{t-2} = 15$, e o ru√≠do branco $\epsilon_t = 1$, o valor previsto para $Y_t$ seria:
> $$Y_t = 5 + 0.7(20) + 0.2(15) + 1 = 5 + 14 + 3 + 1 = 23$$
> Este exemplo ilustra como os valores passados ponderados e o ru√≠do aleat√≥rio determinam o valor atual da s√©rie temporal.

**Componente de M√©dias M√≥veis (MA):** Semelhante ao modelo AR, o modelo MA(q) utiliza os erros de previs√£o (ru√≠dos brancos) passados para prever os valores atuais. Em um modelo MA(q), o valor atual $Y_t$ √© uma combina√ß√£o linear dos $q$ erros passados:
$$Y_t = \mu + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \ldots + \theta_q \epsilon_{t-q} + \epsilon_t$$
onde $\mu$ √© a m√©dia da s√©rie e $\theta_i$ s√£o os coeficientes de m√©dias m√≥veis.

> üí° **Exemplo Num√©rico:** Considere um modelo MA(2) com $\mu = 10$, $\theta_1 = 0.5$, e $\theta_2 = -0.3$. Se os erros passados forem $\epsilon_{t-1} = 2$ e $\epsilon_{t-2} = -1$, e o erro atual $\epsilon_t = 0.5$, o valor previsto para $Y_t$ √©:
> $$Y_t = 10 + 0.5(2) - 0.3(-1) + 0.5 = 10 + 1 + 0.3 + 0.5 = 11.8$$
> Este exemplo mostra como os erros de previs√£o anteriores influenciam o valor atual da s√©rie.

**Processo de Diferencia√ß√£o:** A diferencia√ß√£o √© um processo usado para tornar uma s√©rie temporal n√£o estacion√°ria em uma s√©rie estacion√°ria. Uma s√©rie temporal √© considerada estacion√°ria quando suas propriedades estat√≠sticas (m√©dia, vari√¢ncia) n√£o mudam ao longo do tempo. A diferencia√ß√£o de ordem $d$ envolve subtrair cada valor da s√©rie temporal do seu valor anterior $d$ vezes. Por exemplo, a diferencia√ß√£o de primeira ordem (d=1) √© dada por:
$$Y_t' = Y_t - Y_{t-1}$$
onde $Y_t'$ √© a s√©rie diferenciada.

> üí° **Exemplo Num√©rico:** Se tivermos uma s√©rie temporal $\{Y_t\} = [5, 7, 10, 12, 15]$, a s√©rie diferenciada de primeira ordem $\{Y_t'\}$ ser√°:
> $$Y_1' = 7 - 5 = 2$$
> $$Y_2' = 10 - 7 = 3$$
> $$Y_3' = 12 - 10 = 2$$
> $$Y_4' = 15 - 12 = 3$$
> Portanto, $\{Y_t'\} = [2, 3, 2, 3]$. Observa-se como a diferencia√ß√£o elimina a tend√™ncia crescente na s√©rie original, deixando os incrementos (mudan√ßas) na s√©rie.

**Modelo ARIMA(p, d, q):** Um modelo ARIMA combina esses tr√™s componentes:
$$Y_t' = c + \phi_1 Y_{t-1}' + \phi_2 Y_{t-2}' + \ldots + \phi_p Y_{t-p}' + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \ldots + \theta_q \epsilon_{t-q} + \epsilon_t$$
onde $Y_t'$ √© a s√©rie temporal diferenciada.

> üí° **Exemplo Num√©rico:** Considere um modelo ARIMA(1, 1, 1) onde  $c = 1$, $\phi_1 = 0.6$, $\theta_1 = 0.4$. Se $Y_{t-1}'=3$, $\epsilon_{t-1} = 1$, e $\epsilon_t = 0.5$, ent√£o:
> $$Y_t' = 1 + 0.6(3) + 0.4(1) + 0.5 = 1 + 1.8 + 0.4 + 0.5 = 3.7$$
> Aqui, $Y_t'$ representa o valor da s√©rie diferenciada, que foi calculada usando os valores passados da s√©rie diferenciada, os erros passados e o erro atual.

**Modelo SARIMA:** Em alguns casos, a s√©rie temporal pode apresentar padr√µes sazonais. Para modelar esses padr√µes, utilizamos os modelos **SARIMA (Seasonal Autoregressive Integrated Moving Average)**. Esses modelos estendem os modelos ARIMA, incluindo componentes autorregressivos e de m√©dias m√≥veis sazonais, que modelam a autocorrela√ß√£o sazonal na s√©rie. Um modelo SARIMA √© denotado como SARIMA(p, d, q)(P, D, Q)s, onde P, D, e Q s√£o as ordens dos componentes autorregressivo, de diferencia√ß√£o e de m√©dias m√≥veis sazonais, respectivamente, e 's' √© o per√≠odo da sazonalidade. Por exemplo, para dados mensais, s=12. A inclus√£o da componente sazonal permite ajustar os modelos a varia√ß√µes peri√≥dicas nos dados, como padr√µes anuais ou mensais. Este modelo captura a estrutura de depend√™ncia tanto nos atrasos regulares (n√£o-sazonais) quanto nos atrasos sazonais.

> üí° **Exemplo Num√©rico:** Um modelo SARIMA(1, 0, 1)(1, 1, 1)12 pode ser usado para modelar dados de vendas mensais com sazonalidade anual. O componente (1,0,1) modela a autocorrela√ß√£o n√£o sazonal, enquanto (1,1,1)12 modela a sazonalidade com per√≠odo 12 (mensal).

### Deriva√ß√£o dos Coeficientes do Modelo ARIMA

A deriva√ß√£o dos coeficientes $\phi_i$ (AR) e $\theta_i$ (MA) em modelos ARIMA envolve t√©cnicas de estima√ß√£o estat√≠stica, principalmente utilizando o m√©todo de *m√°xima verossimilhan√ßa*. Este m√©todo busca encontrar os valores dos par√¢metros que maximizam a probabilidade de observar os dados da s√©rie temporal. A fun√ß√£o de verossimilhan√ßa √© constru√≠da com base na distribui√ß√£o do ru√≠do branco $\epsilon_t$, geralmente assumido como sendo normal.

O processo de estima√ß√£o envolve passos iterativos e algoritmos de otimiza√ß√£o num√©rica. Dado que os modelos ARIMA s√£o n√£o-lineares nos par√¢metros, a solu√ß√£o anal√≠tica para os coeficientes n√£o √© direta. Portanto, os softwares estat√≠sticos utilizam algoritmos como o *algoritmo de Berndt-Hall-Hall-Hausman (BHHH)* ou *o algoritmo de Marquardt* para encontrar a solu√ß√£o num√©rica.

**Etapas da Deriva√ß√£o:**
1. **Identifica√ß√£o:** Determinar as ordens p, d e q do modelo ARIMA utilizando fun√ß√µes de autocorrela√ß√£o (ACF) e autocorrela√ß√£o parcial (PACF).
2. **Estima√ß√£o:** Estimar os par√¢metros $\phi_i$ e $\theta_i$ utilizando m√°xima verossimilhan√ßa.
3. **Diagn√≥stico:** Avaliar a adequa√ß√£o do modelo utilizando testes de res√≠duos (e.g., teste de Ljung-Box).
4. **Valida√ß√£o:** Validar o modelo utilizando novos dados ou valida√ß√£o cruzada.

**Sele√ß√£o de Modelos:**  Para identificar o melhor modelo ARIMA (ou SARIMA) entre um conjunto de candidatos, podemos utilizar crit√©rios de informa√ß√£o como o Crit√©rio de Informa√ß√£o de Akaike (AIC) e o Crit√©rio de Informa√ß√£o Bayesiano (BIC). O AIC e o BIC penalizam a complexidade do modelo e ajudam a evitar o *overfitting*, selecionando o modelo que melhor equilibra o ajuste aos dados com a simplicidade do modelo. O modelo com o menor AIC ou BIC √© geralmente preferido.

> üí° **Exemplo Num√©rico:** Ap√≥s testar diferentes modelos ARIMA para uma s√©rie temporal, os seguintes resultados foram obtidos:
>
> | Modelo      | AIC   | BIC   |
> |-------------|-------|-------|
> | ARIMA(1,1,0) | 150.2 | 155.1 |
> | ARIMA(0,1,1) | 148.5 | 153.4 |
> | ARIMA(1,1,1) | 147.0 | 154.3 |
> | ARIMA(2,1,1) | 148.8 | 157.2 |
>
> Neste caso, o modelo ARIMA(1,1,1) possui o menor AIC, sugerindo que ele √© o mais adequado para os dados, considerando o equil√≠brio entre complexidade e ajuste.

### Avalia√ß√£o da Estacionariedade

A estacionariedade √© uma condi√ß√£o crucial para a aplica√ß√£o de modelos ARIMA. Como mencionado, uma s√©rie temporal √© estacion√°ria quando suas propriedades estat√≠sticas (m√©dia e vari√¢ncia) n√£o variam ao longo do tempo. Se uma s√©rie n√£o for estacion√°ria, a aplica√ß√£o de um modelo ARIMA diretamente levar√° a resultados n√£o confi√°veis.

**Testes de Estacionariedade:**
1. **Teste de Dickey-Fuller Aumentado (ADF):** O teste ADF √© um dos mais populares para avaliar a estacionariedade. Ele testa a hip√≥tese nula de que a s√©rie temporal possui uma raiz unit√°ria (n√£o estacion√°ria). Um valor de p significativamente baixo (e.g., p<0.05) rejeita a hip√≥tese nula, indicando que a s√©rie √© estacion√°ria.
2. **Teste de Kwiatkowski-Phillips-Schmidt-Shin (KPSS):** O teste KPSS √© complementar ao ADF e testa a hip√≥tese nula de que a s√©rie temporal √© estacion√°ria. Um valor de p significativamente alto (e.g., p>0.05) rejeita a hip√≥tese nula, indicando que a s√©rie n√£o √© estacion√°ria.

> üí° **Exemplo Num√©rico:**
>
> Suponha que realizamos o teste ADF em uma s√©rie temporal, e obtemos um p-valor de 0.02. J√° o teste KPSS resultou em um p-valor de 0.10.
>
> *   **Interpreta√ß√£o:**
>     *   O teste ADF com um p-valor de 0.02 < 0.05 indica que a hip√≥tese nula (n√£o estacionariedade) pode ser rejeitada. Logo, a s√©rie √© estacion√°ria.
>     *   O teste KPSS com p-valor de 0.10 > 0.05 indica que n√£o podemos rejeitar a hip√≥tese nula (estacionariedade). Isso tamb√©m sugere que a s√©rie √© estacion√°ria.
>
> Portanto, ambos os testes (ADF e KPSS) apontam que a s√©rie temporal √© estacion√°ria.

**Como obter a Estacionariedade:**
1. **Diferencia√ß√£o:** A t√©cnica mais comum √© a diferencia√ß√£o, que remove a tend√™ncia presente na s√©rie temporal. O n√∫mero de diferencia√ß√µes necess√°rias, d, corresponde √† ordem do componente de diferencia√ß√£o do modelo ARIMA.
2. **Transforma√ß√µes:** Em alguns casos, transforma√ß√µes como a transforma√ß√£o logar√≠tmica podem estabilizar a vari√¢ncia da s√©rie.

**Avalia√ß√£o Gr√°fica:**
√â importante visualizar a s√©rie temporal para identificar a presen√ßa de tend√™ncias ou sazonalidades. A aus√™ncia visual desses padr√µes indica estacionariedade.

**Lema 1:** *Se uma s√©rie temporal $\{Y_t\}$ √© estacion√°ria, ent√£o a s√©rie diferenciada de primeira ordem $\{Y'_t\}$, onde $Y'_t = Y_t - Y_{t-1}$, tamb√©m √© estacion√°ria.*

*Prova:*
I.  Seja $\{Y_t\}$ uma s√©rie temporal estacion√°ria. Isso significa que a m√©dia $\mu_Y = E[Y_t]$ e a vari√¢ncia $\sigma^2_Y = Var(Y_t)$ s√£o constantes ao longo do tempo.

II. A s√©rie diferenciada de primeira ordem √© definida como $Y'_t = Y_t - Y_{t-1}$.

III. Calculamos a m√©dia da s√©rie diferenciada $Y'_t$:
    $E[Y'_t] = E[Y_t - Y_{t-1}] = E[Y_t] - E[Y_{t-1}] = \mu_Y - \mu_Y = 0$.
    Como $\mu_Y$ √© uma constante, a m√©dia de $Y'_t$ √© 0, que tamb√©m √© constante.

IV. Calculamos a vari√¢ncia da s√©rie diferenciada $Y'_t$:
    $Var(Y'_t) = Var(Y_t - Y_{t-1}) = Var(Y_t) + Var(Y_{t-1}) - 2Cov(Y_t, Y_{t-1})$.
    Como $\{Y_t\}$ √© estacion√°ria, $Var(Y_t) = Var(Y_{t-1}) = \sigma^2_Y$. 
    Al√©m disso, a covari√¢ncia $Cov(Y_t, Y_{t-1})$ √© constante para uma s√©rie estacion√°ria. Assim, temos:
    $Var(Y'_t) = \sigma^2_Y + \sigma^2_Y - 2Cov(Y_t, Y_{t-1}) = 2\sigma^2_Y - 2Cov(Y_t, Y_{t-1})$.

V.  Como $\sigma^2_Y$ e $Cov(Y_t, Y_{t-1})$ s√£o constantes, $Var(Y'_t)$ tamb√©m √© constante.

VI.  Como a m√©dia e a vari√¢ncia de $Y'_t$ s√£o constantes ao longo do tempo, conclu√≠mos que a s√©rie diferenciada $\{Y'_t\}$ tamb√©m √© estacion√°ria. $\blacksquare$

### Conclus√£o

Os modelos ARIMA representam uma ferramenta poderosa e flex√≠vel para modelagem de s√©ries temporais. Sua capacidade de combinar componentes autorregressivos, de m√©dias m√≥veis e de diferencia√ß√£o os torna adequados para uma variedade de dados. A deriva√ß√£o dos coeficientes do modelo ARIMA, realizada por meio de m√©todos de estima√ß√£o estat√≠stica, e a avalia√ß√£o da estacionariedade, crucial para a validade do modelo, s√£o passos essenciais na an√°lise de s√©ries temporais. A combina√ß√£o de rigor te√≥rico com a aplica√ß√£o de softwares estat√≠sticos possibilita aos acad√™micos a explora√ß√£o e a modelagem de dados temporais complexos com profundidade e precis√£o. Modelos SARIMA representam uma importante extens√£o para dados com padr√µes sazonais.

### Refer√™ncias

[^1]: ... *[Adicionar as refer√™ncias do contexto quando dispon√≠veis]*
<!-- END -->
