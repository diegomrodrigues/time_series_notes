## A Matem√°tica da Sazonalidade em S√©ries Temporais: Uma Perspectiva da An√°lise de Fourier e Wavelets

### Introdu√ß√£o
Em cap√≠tulos anteriores, exploramos a natureza da sazonalidade em s√©ries temporais e m√©todos para model√°-la atrav√©s de √≠ndices sazonais, *deseasonaliza√ß√£o* e modelos de regress√£o. Este cap√≠tulo adota uma perspectiva mais matem√°tica, examinando a sazonalidade sob a √≥tica da **an√°lise de Fourier** e **transformadas wavelet**. Estas ferramentas matem√°ticas avan√ßadas permitem decompor uma s√©rie temporal em seus componentes de frequ√™ncia, revelando a estrutura peri√≥dica da sazonalidade e oferecendo meios adicionais para modelar e prever a demanda. Ao entender a sazonalidade em termos de componentes de frequ√™ncia, podemos aplicar t√©cnicas de filtragem, decomposi√ß√£o e reconstru√ß√£o de s√©ries temporais que melhoram a an√°lise e a precis√£o da previs√£o.

### Sazonalidade e An√°lise de Fourier
A **an√°lise de Fourier** √© uma ferramenta matem√°tica que decomp√µe qualquer sinal peri√≥dico em uma soma de ondas senoidais e cossenos de diferentes frequ√™ncias, amplitudes e fases [^Fourier]. Em ess√™ncia, a an√°lise de Fourier transforma um sinal do dom√≠nio do tempo para o dom√≠nio da frequ√™ncia, revelando as componentes peri√≥dicas do sinal.

Na an√°lise de s√©ries temporais, a sazonalidade se manifesta como uma ou mais frequ√™ncias dominantes [^Fourier]. Por exemplo, em dados de vendas mensais, uma frequ√™ncia dominante seria correspondente a um ciclo anual (sazonalidade anual), onde a amplitude desta frequ√™ncia corresponde √† intensidade da sazonalidade anual. A an√°lise de Fourier pode ser aplicada para decompor uma s√©rie temporal em suas componentes de frequ√™ncia, incluindo aquelas relacionadas √† sazonalidade.

> üí° **Transformada de Fourier:** A transformada de Fourier (TF) de um sinal discreto $x[n]$, com $n=0,1,2,\dots,N-1$ √© definida como
$$X[k] = \sum_{n=0}^{N-1} x[n] e^{-j2\pi kn/N}$$
onde:
*   $X[k]$ representa a componente de frequ√™ncia na frequ√™ncia $k$.
*   $e^{-j2\pi kn/N}$ √© um n√∫mero complexo, conhecido como exponencial complexa.
*   $j$ √© a unidade imagin√°ria ($j^2=-1$).
A transformada de Fourier decomp√µe o sinal $x[n]$ em uma soma de senoides complexas, cada uma com sua pr√≥pria frequ√™ncia, amplitude e fase.

**Teorema 5** *Sinais peri√≥dicos, incluindo a sazonalidade, podem ser representados por uma soma de senoides complexas, cujas frequ√™ncias s√£o m√∫ltiplas inteiras da frequ√™ncia fundamental do sinal (s√©rie de Fourier).*
*Prova:*
I.  A an√°lise de Fourier estabelece que qualquer sinal peri√≥dico $x(t)$ com per√≠odo $T$ pode ser expresso como uma soma infinita de senoides e cossenos (ou, equivalentemente, exponenciais complexas) com frequ√™ncias que s√£o m√∫ltiplos inteiros da frequ√™ncia fundamental $f = 1/T$.
II. Uma s√©rie de Fourier √© expressa como: $x(t) = \sum_{k=-\infty}^{\infty} C_k e^{j2\pi kft}$, onde $C_k$ s√£o os coeficientes de Fourier que determinam a amplitude e a fase de cada componente de frequ√™ncia.
III. Se o sinal √© discreto, o somat√≥rio se transforma em um somat√≥rio discreto, e a transformada de Fourier Discreta √© utilizada para determinar os coeficientes de Fourier.
IV. Portanto, as s√©ries temporais que exibem sazonalidade, por serem peri√≥dicas em um determinado intervalo (semanal, mensal, trimestral, anual), podem ser expressas como uma combina√ß√£o de senoides, com o coeficiente de Fourier $C_k$ representando a intensidade da componente de frequ√™ncia $kf$.  $\blacksquare$

> üí° **Exemplo Num√©rico:** Suponha que uma s√©rie temporal de vendas mensais apresenta uma forte sazonalidade anual (pico de vendas em dezembro). Ap√≥s aplicar a transformada de Fourier, a s√©rie poder√° ser decomposta como uma componente de tend√™ncia, mais uma componente de frequ√™ncia correspondente ao per√≠odo anual (12 meses), com maior amplitude e outras componentes de frequ√™ncia de menor amplitude. Se o pico de vendas fosse bimensal, apareceria uma outra componente de frequ√™ncia dominante correspondente ao per√≠odo de 2 meses, com maior amplitude.
>
> Para ilustrar, vamos criar uma s√©rie temporal de vendas simulada com sazonalidade anual e aplicar a Transformada de Fourier Discreta (DFT) usando Python e `numpy`.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Define o n√∫mero de meses
> N = 36
>
> # Cria um array de tempo representando meses
> tempo = np.arange(N)
>
> # Simula uma tend√™ncia linear
> tendencia = 2 * tempo
>
> # Simula uma sazonalidade anual com um pico em dezembro (m√™s 11)
> sazonalidade = 10 * np.sin(2 * np.pi * tempo / 12)
>
> # Combina tend√™ncia e sazonalidade para criar a s√©rie temporal
> vendas = tendencia + sazonalidade + 5 * np.random.randn(N)
>
> # Aplica a Transformada de Fourier Discreta
> transformada_fourier = np.fft.fft(vendas)
>
> # Calcula as frequ√™ncias correspondentes
> frequencias = np.fft.fftfreq(N)
>
> # Calcula as amplitudes (m√≥dulo) da transformada
> amplitudes = np.abs(transformada_fourier)
>
> # Plot da s√©rie temporal
> plt.figure(figsize=(10, 6))
> plt.subplot(2, 1, 1)
> plt.plot(tempo, vendas, marker='o')
> plt.title('S√©rie Temporal de Vendas')
> plt.xlabel('Meses')
> plt.ylabel('Vendas')
>
> # Plot das amplitudes no dom√≠nio da frequ√™ncia
> plt.subplot(2, 1, 2)
> plt.stem(frequencias, amplitudes, use_line_collection=True)
> plt.title('Espectro de Frequ√™ncia (Transformada de Fourier)')
> plt.xlabel('Frequ√™ncia (Ciclos/M√™s)')
> plt.ylabel('Amplitude')
> plt.tight_layout()
> plt.show()
>
> # Encontra a frequ√™ncia dominante (excluindo a frequ√™ncia 0)
> indice_freq_dom = np.argmax(amplitudes[1:N//2]) + 1 # Excluindo a frequ√™ncia 0 e considerando o espelhamento
> freq_dom = frequencias[indice_freq_dom]
>
> print(f"Frequ√™ncia Dominante: {freq_dom:.3f} ciclos/m√™s")
> print(f"Per√≠odo Dominante: {1/freq_dom:.2f} meses")
> ```
>
> Nesta simula√ß√£o, criamos uma s√©rie temporal com uma tend√™ncia linear e uma sazonalidade anual. A aplica√ß√£o da DFT revela um pico de amplitude na frequ√™ncia correspondente a um ciclo por ano (1/12 ciclos por m√™s), o que confirma a presen√ßa da sazonalidade anual. O gr√°fico da s√©rie temporal mostra claramente a varia√ß√£o sazonal, e o gr√°fico do espectro de frequ√™ncia destaca a frequ√™ncia dominante relacionada ao ciclo anual. As demais frequ√™ncias podem representar ru√≠do ou componentes menos relevantes. O c√≥digo tamb√©m identifica a frequ√™ncia dominante e calcula seu per√≠odo, mostrando o valor de 12 meses, referente ao ciclo anual.

#### Componentes de Frequ√™ncia e Sazonalidade
A an√°lise de Fourier permite expressar qualquer sinal peri√≥dico como uma soma de senoides e cossenos de diferentes frequ√™ncias, amplitudes e fases [^Fourier]. No contexto da sazonalidade, as frequ√™ncias associadas aos ciclos sazonais se manifestam com amplitudes maiores.

*   **Frequ√™ncia Fundamental:** Em uma s√©rie temporal com sazonalidade anual, a frequ√™ncia fundamental corresponde a um ciclo por ano. Por exemplo, em dados mensais, a frequ√™ncia fundamental ser√° de 1/12 ciclos por m√™s (ou 1 ciclo por ano).
*   **Harm√¥nicos:** Al√©m da frequ√™ncia fundamental, a sazonalidade pode apresentar harm√¥nicos, que s√£o m√∫ltiplos inteiros da frequ√™ncia fundamental. Estes harm√¥nicos representam varia√ß√µes sazonais mais sutis ou complexas. Por exemplo, em dados mensais, pode existir um segundo harm√¥nico de frequ√™ncia 2/12 (um ciclo a cada seis meses).
*   **Amplitudes e Fases:** As amplitudes das componentes de frequ√™ncia indicam a intensidade da sazonalidade naquele per√≠odo. As fases indicam o deslocamento no tempo das componentes de frequ√™ncia.

**Lema 5.1** *A amplitude de uma componente de frequ√™ncia na transformada de Fourier de uma s√©rie temporal est√° diretamente relacionada √† intensidade da sazonalidade correspondente a essa frequ√™ncia.*
*Prova:*
I. A amplitude $A_k$ de uma componente de frequ√™ncia $k$ na representa√ß√£o da s√©rie temporal $x[n]$ atrav√©s da transformada de Fourier, $X[k]$, √© dada por $|X[k]|$. 
II.  Em outras palavras, $A_k = |X[k]| = |\sum_{n=0}^{N-1} x[n] e^{-j2\pi kn/N}|$. 
III. Se uma componente de frequ√™ncia $k$ corresponde a um padr√£o sazonal presente na s√©rie temporal, os valores de $x[n]$ para aquele padr√£o contribuir√£o construtivamente no somat√≥rio, resultando em uma amplitude $A_k$ maior.
IV. Por outro lado, se a componente de frequ√™ncia n√£o corresponde a um padr√£o sazonal, as contribui√ß√µes de $x[n]$ tendem a se cancelar, resultando em uma amplitude menor.
V. Portanto, a amplitude $A_k$ √© uma medida direta da intensidade do padr√£o sazonal correspondente √† frequ√™ncia $k$.  $\blacksquare$

> üí° **Exemplo Num√©rico:** Continuando o exemplo anterior, a amplitude da frequ√™ncia dominante (pr√≥xima a 1/12 ciclos/m√™s) no espectro da transformada de Fourier ser√° significativamente maior do que as amplitudes das outras frequ√™ncias. Esta amplitude √© uma medida da for√ßa da sazonalidade anual. Quanto maior a amplitude, maior a varia√ß√£o nas vendas em cada ano. Se tiv√©ssemos um pico sazonal menor, a amplitude dessa frequ√™ncia seria menor.

#### A Transformada R√°pida de Fourier (FFT)
A **Transformada R√°pida de Fourier** (FFT) √© um algoritmo eficiente para calcular a transformada de Fourier discreta, que √© a vers√£o digital da transformada de Fourier [^FFT]. Em termos pr√°ticos, a FFT permite que a an√°lise de Fourier seja aplicada a s√©ries temporais digitais, decompondo-as em suas componentes de frequ√™ncia de maneira eficiente.

> üí° **Algoritmo FFT:** A Transformada R√°pida de Fourier (FFT) √© um algoritmo de otimiza√ß√£o da Transformada Discreta de Fourier (DFT). Ao inv√©s de calcular diretamente a DFT que envolve uma complexidade computacional $O(N^2)$, a FFT reduz essa complexidade para $O(N \log N)$, utilizando uma t√©cnica de divis√£o e conquista.
>
>  As etapas b√°sicas da FFT incluem a decomposi√ß√£o do problema em problemas menores e a combina√ß√£o das solu√ß√µes desses problemas menores para obter a transformada de Fourier. O algoritmo FFT pode ser implementado utilizando m√©todos como o de Cooley-Tukey, que se baseiam na fatora√ß√£o da matriz da transformada DFT, e na observa√ß√£o de que a DFT de um sinal de comprimento $N$ pode ser calculada recursivamente a partir das DFTs de dois sinais de comprimento $N/2$. Este processo recursivo continua at√© chegarmos em transformadas DFT de sinais com comprimento 1, que s√£o triviais de se calcular.

#### An√°lise de Fourier e Modelagem da Sazonalidade
A an√°lise de Fourier possibilita diversas abordagens para modelar a sazonalidade em s√©ries temporais.

1.  **Filtragem de Frequ√™ncia:** Ap√≥s decompor a s√©rie temporal em componentes de frequ√™ncia atrav√©s da transformada de Fourier (ou FFT), as componentes relacionadas √† sazonalidade (frequ√™ncias dominantes e seus harm√¥nicos) podem ser isoladas ou removidas atrav√©s de filtros de frequ√™ncia.
    *   **Filtro Passa-Baixa:** Remove componentes de alta frequ√™ncia, mantendo a tend√™ncia e ciclos, √∫teis para isolar o componente de tend√™ncia.
    *   **Filtro Passa-Alta:** Remove componentes de baixa frequ√™ncia, mantendo a sazonalidade e componentes de alta frequ√™ncia, √∫til para isolar a sazonalidade.
    *   **Filtro Passa-Banda:** Seleciona apenas uma faixa de frequ√™ncias, permitindo isolar componentes sazonais espec√≠ficas (por exemplo, anual, trimestral ou mensal).
2. **Reconstru√ß√£o do Sinal:** Ap√≥s aplicar filtros de frequ√™ncia, a s√©rie temporal pode ser reconstru√≠da aplicando a transformada inversa de Fourier (IFFT), obtendo um novo sinal no dom√≠nio do tempo, sem as componentes de frequ√™ncia removidas pelos filtros. Este processo ajuda a projetar as vendas ap√≥s modelar a tend√™ncia, ou para analisar o comportamento da s√©rie ap√≥s a remo√ß√£o da sazonalidade.
3. **Modelagem da Sazonalidade:** As amplitudes e fases das componentes de frequ√™ncia relacionadas √† sazonalidade podem ser usadas diretamente para modelar o efeito sazonal. Isso pode ser feito, por exemplo, atrav√©s da inclus√£o de componentes senoidais e cossenoidais no modelo de regress√£o, usando suas frequ√™ncias como par√¢metros no modelo.

**Teorema 5.1** *A filtragem de frequ√™ncia baseada na an√°lise de Fourier pode ser usada para isolar ou remover componentes sazonais espec√≠ficas de uma s√©rie temporal, permitindo uma modelagem mais precisa da tend√™ncia e da sazonalidade.*
*Prova:*
I. A aplica√ß√£o da transformada de Fourier (ou FFT) decomp√µe a s√©rie temporal em suas componentes de frequ√™ncia, cada uma com sua amplitude e fase.
II. Atrav√©s do uso de filtros de frequ√™ncia como passa-baixa, passa-alta ou passa-banda, √© poss√≠vel selecionar ou rejeitar faixas espec√≠ficas de frequ√™ncias.
III. Um filtro passa-baixa, por exemplo, permite a passagem de baixas frequ√™ncias, que podem representar a tend√™ncia da s√©rie, enquanto um filtro passa-alta permite a passagem de altas frequ√™ncias, que podem representar a sazonalidade ou ru√≠do.
IV. Ao aplicar esses filtros no dom√≠nio da frequ√™ncia e realizar a transformada inversa de Fourier (IFFT), podemos obter uma nova s√©rie temporal sem as componentes de frequ√™ncia removidas, permitindo assim, analisar separadamente a tend√™ncia ou a sazonalidade.
V. A escolha apropriada do filtro depende do conhecimento pr√©vio das frequ√™ncias associadas √† tend√™ncia e √† sazonalidade, permitindo assim, uma modelagem mais precisa dos diferentes componentes. $\blacksquare$

> üí° **Exemplo Num√©rico:** Usando a s√©rie temporal de vendas criada anteriormente, vamos demonstrar a aplica√ß√£o de um filtro passa-baixa e a reconstru√ß√£o do sinal.
> ```python
> from scipy.fft import fft, ifft
> from scipy import signal
>
> # Definir a frequ√™ncia de corte para o filtro passa baixa
> #  Para isolar a tend√™ncia, a frequ√™ncia de corte deve ser menor que a frequ√™ncia sazonal
> freq_corte = 1/24 # frequ√™ncia de corte: um ciclo a cada 24 meses
>
> # Criar o filtro passa-baixa
> ordem_filtro = 3  # Ordem do filtro
> b, a = signal.butter(ordem_filtro, freq_corte, btype='lowpass', fs=1) # O par√¢metro fs=1 significa que os dados est√£o a um ciclo por m√™s
>
> # Aplicar o filtro no dom√≠nio do tempo
> vendas_filtradas = signal.filtfilt(b, a, vendas)
>
> # Plot da s√©rie original e da s√©rie filtrada
> plt.figure(figsize=(10, 6))
> plt.plot(tempo, vendas, label='S√©rie Original')
> plt.plot(tempo, vendas_filtradas, label='S√©rie Filtrada (Passa-Baixa)')
> plt.title('Filtragem Passa-Baixa da S√©rie Temporal')
> plt.xlabel('Meses')
> plt.ylabel('Vendas')
> plt.legend()
> plt.show()
>
> # Plot dos res√≠duos
> residuos = vendas - vendas_filtradas
> plt.figure(figsize=(10,6))
> plt.plot(tempo, residuos)
> plt.title("Res√≠duos Ap√≥s a Filtragem Passa-Baixa")
> plt.xlabel("Tempo")
> plt.ylabel("Res√≠duos")
> plt.show()
>
> ```
> Este exemplo demonstra como um filtro passa-baixa pode ser usado para isolar a componente de tend√™ncia da s√©rie temporal. O gr√°fico da s√©rie temporal original e filtrada mostra como o filtro suaviza as varia√ß√µes de alta frequ√™ncia, preservando a tend√™ncia da s√©rie. O gr√°fico de res√≠duos mostra o que foi retirado do sinal pela aplica√ß√£o do filtro. Uma an√°lise desses res√≠duos permitiria entender o comportamento da s√©rie ap√≥s a retirada da tend√™ncia. Poder√≠amos aplicar um filtro passa-alta para analisar o componente sazonal separadamente.

### Sazonalidade e Transformadas Wavelet
As **transformadas wavelet** s√£o uma ferramenta matem√°tica que decomp√µe um sinal em diferentes escalas e posi√ß√µes. Similar √† an√°lise de Fourier, as transformadas wavelet decomp√µem um sinal em componentes de frequ√™ncia, mas, em vez de usar senoides e cossenos, as wavelets utilizam fun√ß√µes de onda localizada no tempo e na frequ√™ncia.

Uma das vantagens das transformadas wavelet em rela√ß√£o √† an√°lise de Fourier √© sua capacidade de analisar sinais n√£o estacion√°rios, ou seja, sinais onde as caracter√≠sticas de frequ√™ncia variam ao longo do tempo. Esta capacidade torna as transformadas wavelet particularmente √∫teis para modelar a sazonalidade em s√©ries temporais que apresentam varia√ß√µes na intensidade ou no per√≠odo ao longo do tempo.

> üí° **Transformada Wavelet:** A transformada wavelet (TW) √© uma ferramenta matem√°tica que decomp√µe um sinal em diferentes escalas (frequ√™ncias) e posi√ß√µes (tempo), utilizando fun√ß√µes de onda, denominadas wavelets, que s√£o localizadas no tempo e na frequ√™ncia. A TW de um sinal $x(t)$ √© dada por:
$$W(a,b) = \int_{-\infty}^{\infty} x(t) \frac{1}{\sqrt{a}} \psi^* \left(\frac{t-b}{a}\right) dt$$
onde:
* $W(a,b)$ s√£o os coeficientes wavelet, que representam a amplitude da wavelet de escala $a$ e posi√ß√£o $b$.
* $\psi(t)$ √© a wavelet m√£e, que gera as outras wavelets.
*  $a$ √© a escala, que controla a compress√£o ou alongamento da wavelet e est√° relacionada √† frequ√™ncia.
*  $b$ √© a posi√ß√£o, que controla o deslocamento da wavelet ao longo do tempo.
* $\psi^*(t)$ √© o complexo conjugado da wavelet.
A transformada wavelet decomp√µe o sinal em diferentes escalas e posi√ß√µes, permitindo analisar os componentes de frequ√™ncia em fun√ß√£o do tempo.

#### Propriedades das Wavelets
As wavelets apresentam algumas propriedades importantes:
*   **Localiza√ß√£o no Tempo e na Frequ√™ncia:** Wavelets s√£o fun√ß√µes que possuem suporte limitado tanto no dom√≠nio do tempo quanto no dom√≠nio da frequ√™ncia, ao contr√°rio das senoides e cossenos da transformada de Fourier. Esta propriedade permite que as wavelets capturem as componentes de um sinal com maior precis√£o no tempo e na frequ√™ncia.
*   **Multirresolu√ß√£o:** Wavelets decomp√µem um sinal em diferentes n√≠veis de resolu√ß√£o, permitindo que detalhes finos e estruturas de grande escala sejam analisados de forma independente. Esta caracter√≠stica torna as wavelets particularmente adequadas para lidar com sinais n√£o estacion√°rios, como s√©ries temporais com sazonalidade vari√°vel.
*   **Escala e Posi√ß√£o:** Wavelets s√£o definidas por seus par√¢metros de escala e posi√ß√£o. A escala controla a largura da wavelet, enquanto a posi√ß√£o controla seu deslocamento ao longo do tempo. Variando a escala e a posi√ß√£o, wavelets podem ser adaptadas para capturar diferentes componentes do sinal.

#### Wavelets e Modelagem da Sazonalidade
Na modelagem da sazonalidade em s√©ries temporais, as transformadas wavelet oferecem uma abordagem flex√≠vel, com vantagens sobre as transformadas de Fourier para casos espec√≠ficos.

1. **Decomposi√ß√£o Multirresolu√ß√£o:** As transformadas wavelet decomp√µem a s√©rie em componentes de diferentes resolu√ß√µes, que podem ser associadas com tend√™ncias, ciclos e sazonalidade. Ao analisar cada componente separadamente, podemos modelar cada um de forma mais adequada.
2. **An√°lise Local:** A localiza√ß√£o tempo-frequ√™ncia das wavelets permite modelar a sazonalidade que varia ao longo do tempo. Por exemplo, se um per√≠odo sazonal se torna mais intenso em um determinado per√≠odo, as transformadas wavelet capturariam esse efeito na escala e posi√ß√£o correspondente.
3. **Filtragem Adaptativa:** Os componentes wavelet podem ser filtrados ou modificados com base em sua escala e posi√ß√£o, ajustando o modelo para a sazonalidade. Por exemplo, podemos aplicar um filtro a uma determinada escala para remover um componente espec√≠fico da sazonalidade.

**Lema 5.2** *A capacidade das transformadas wavelet de realizar uma an√°lise tempo-frequ√™ncia permite modelar a sazonalidade de forma adaptativa, especialmente em s√©ries temporais n√£o estacion√°rias.*
*Prova:*
I. A transformada wavelet decomp√µe um sinal em coeficientes $W(a,b)$, que indicam a amplitude da wavelet em diferentes escalas $a$ e posi√ß√µes $b$.
II. A escala $a$ est√° relacionada √† frequ√™ncia, enquanto a posi√ß√£o $b$ est√° relacionada ao tempo.
III. A localiza√ß√£o tempo-frequ√™ncia das wavelets possibilita a an√°lise de componentes de frequ√™ncia em diferentes momentos, permitindo que a transformada wavelet detecte e modele sazonalidades que variam ao longo do tempo.
IV. Por exemplo, se a intensidade de um ciclo sazonal aumenta em um determinado per√≠odo, os coeficientes wavelet correspondentes √†quela escala e posi√ß√£o apresentar√£o valores mais altos.
V. Isso permite que o modelo se ajuste a varia√ß√µes temporais na sazonalidade, tornando-o mais adaptativo e adequado para s√©ries temporais n√£o estacion√°rias. $\blacksquare$

> üí° **Exemplo Num√©rico:** Para demonstrar o uso de Wavelets, vamos usar a mesma s√©rie temporal de vendas e aplicar a transformada wavelet discreta (DWT). Usaremos a biblioteca `PyWavelets`.
>
> ```python
> import pywt
>
> # Escolhe a wavelet m√£e (Daubechies 4)
> wavelet = 'db4'
>
> # Aplica a transformada wavelet
> coeffs = pywt.wavedec(vendas, wavelet, level=3) # Decomposi√ß√£o em 3 n√≠veis
>
> # Cada elemento em coeffs √© um n√≠vel de detalhe ou aproxima√ß√£o
> # O primeiro √© a aproxima√ß√£o de baixa frequ√™ncia (tend√™ncia)
> aproximacao_nivel3 = coeffs[0]
> detalhe_nivel3 = coeffs[1]
> detalhe_nivel2 = coeffs[2]
> detalhe_nivel1 = coeffs[3]
>
>
> # Reconstruir a s√©rie usando a transformada wavelet inversa (IDWT)
> vendas_reconstruidas = pywt.waverec(coeffs, wavelet)
>
>
> # Plot da s√©rie original e reconstruida
> plt.figure(figsize=(12,6))
> plt.subplot(2,1,1)
> plt.plot(tempo, vendas, label="S√©rie Original")
> plt.plot(tempo, vendas_reconstruidas, '--', label='S√©rie Reconstruida')
> plt.legend()
> plt.title("S√©rie Temporal e Reconstru√ß√£o por Wavelet")
>
> # Plot dos detalhes da wavelet
> plt.subplot(2,1,2)
> plt.plot(detalhe_nivel1, label='Detalhe N√≠vel 1')
> plt.plot(detalhe_nivel2, label='Detalhe N√≠vel 2')
> plt.plot(detalhe_nivel3, label='Detalhe N√≠vel 3')
> plt.title("Detalhes da Wavelet")
> plt.xlabel("Tempo (Escala da Wavelet)")
> plt.legend()
> plt.tight_layout()
> plt.show()
>
>
> print("Comprimento da aproxima√ß√£o (n√≠vel 3):", len(aproximacao_nivel3))
> print("Comprimento dos detalhes (n√≠vel 1):", len(detalhe_nivel1))
> print("Comprimento dos detalhes (n√≠vel 2):", len(detalhe_nivel2))
> print("Comprimento dos detalhes (n√≠vel 3):", len(detalhe_nivel3))
>
> ```
> Este exemplo mostra como uma s√©rie temporal pode ser decomposta em componentes de diferentes n√≠veis de detalhe usando a transformada wavelet discreta (DWT). Podemos notar que a aproxima√ß√£o de n√≠vel 3 √© a vers√£o mais suavizada (tend√™ncia) da s√©rie. Os detalhes dos n√≠veis 1, 2 e 3 capturam varia√ß√µes em diferentes escalas, e a reconstru√ß√£o da s√©rie √© praticamente id√™ntica √† original. Dependendo da complexidade e das mudan√ßas de padr√£o da s√©rie, pode ser importante analisar e modelar os detalhes em diferentes n√≠veis, bem como a tend√™ncia (aproxima√ß√£o).

#### Compara√ß√£o entre An√°lise de Fourier e Transformadas Wavelet
Tanto a an√°lise de Fourier quanto as transformadas wavelet s√£o ferramentas valiosas para modelar a sazonalidade em s√©ries temporais. A escolha entre elas depende da natureza dos dados e do objetivo da modelagem.

*   A **an√°lise de Fourier** √© mais adequada para modelar sazonalidade em s√©ries temporais estacion√°rias, com componentes de frequ√™ncia bem definidas e amplitudes e fases constantes ao longo do tempo. As transformadas de Fourier s√£o mais eficientes computacionalmente para dados grandes.
*   As **transformadas wavelet** s√£o mais apropriadas para modelar sazonalidade em s√©ries temporais n√£o estacion√°rias, com componentes de frequ√™ncia que podem mudar com o tempo, apresentando amplitude e fases variantes, e para modelos que se beneficiam de an√°lise em m√∫ltiplas resolu√ß√µes. Wavelets tamb√©m s√£o mais adequadas para dados finitos, com tamanhos pequenos.

### Integra√ß√£o com Modelos de Regress√£o
Tanto as componentes de frequ√™ncia obtidas pela an√°lise de Fourier, quanto os componentes wavelet podem ser utilizados como vari√°veis explicativas em modelos de regress√£o. Por exemplo, os coeficientes das componentes de frequ√™ncia podem ser utilizados como vari√°veis no modelo de regress√£o [Teorema 2.1].

**Proposi√ß√£o 5.1** *Os coeficientes obtidos pela an√°lise de Fourier e pelas transformadas wavelet podem ser usados como vari√°veis explicativas em modelos de regress√£o, permitindo incorporar a sazonalidade na modelagem.*

*Prova:*
I. Os coeficientes de Fourier, $X[k]$, obtidos a partir da transformada de Fourier de uma s√©rie temporal, representam as amplitudes e fases das componentes de frequ√™ncia.
II. Da mesma forma, os coeficientes wavelet, $W(a,b)$, obtidos a partir da transformada wavelet, representam a amplitude das wavelets em diferentes escalas e posi√ß√µes.
III. Estes coeficientes podem ser utilizados como vari√°veis explicativas em modelos de regress√£o para capturar a influ√™ncia das componentes de frequ√™ncia ou escala na vari√°vel dependente.
IV. A inclus√£o dessas vari√°veis no modelo permite que a sazonalidade seja modelada de forma expl√≠cita, e que o modelo preditivo leve em considera√ß√£o tanto a tend√™ncia como as varia√ß√µes sazonais, podendo gerar previs√µes mais precisas. $\blacksquare$

> üí° **Exemplo Num√©rico:** Usando os dados das vendas da loja de eletr√¥nicos, e assumindo que j√° extra√≠mos os coeficientes de Fourier (ou wavelet) ap√≥s aplicar a transformada apropriada. Os coeficientes correspondentes √† sazonalidade poderiam ser usados como vari√°veis adicionais no modelo de regress√£o linear, juntamente com o tempo, para construir um modelo preditivo que incorpore a tend√™ncia e a sazonalidade.
>
> Para exemplificar, suponha que ap√≥s aplicar a FFT na s√©rie de vendas, identificamos a frequ√™ncia correspondente √† sazonalidade anual (1/12 ciclos por m√™s) com uma amplitude de 10 e fase de 0. Podemos criar um modelo de regress√£o linear com a seguinte forma:
>
> $Vendas_t = \beta_0 + \beta_1 \cdot t + \beta_2 \cdot \sin(2 \pi \cdot \frac{t}{12}) + \epsilon_t$
>
> Onde:
>
> *   $Vendas_t$ √© o valor das vendas no tempo *t*.
> *   $t$ √© o √≠ndice de tempo (1, 2, 3...).
> *   $\beta_0$ √© o intercepto do modelo.
> *   $\beta_1$ √© o coeficiente da tend√™ncia linear.
> *   $\beta_2$ √© o coeficiente da componente sazonal.
> *   $\epsilon_t$ √© o erro aleat√≥rio.
>
> Para obter os valores dos coeficientes $\beta_0$, $\beta_1$ e $\beta_2$, podemos utilizar a fun√ß√£o `LinearRegression` do `sklearn`.
>
> ```python
> from sklearn.linear_model import LinearRegression
> import pandas as pd
>
> # Cria um DataFrame com a s√©rie temporal
> df = pd.DataFrame({'tempo': tempo, 'vendas': vendas})
>
> # Cria as vari√°veis para o modelo de regress√£o
> df['seno_sazonal'] = np.sin(2 * np.pi * df['tempo'] / 12)
>
> # Cria a matriz de design (X)
> X = df[['tempo', 'seno_sazonal']]
>
> # Cria a vari√°vel resposta (y)
> y = df['vendas']
>
> # Instancia e ajusta o modelo de regress√£o linear
> modelo = LinearRegression()
> modelo.fit(X, y)
>
> # Obt√©m os coeficientes do modelo
> beta_0 = modelo.intercept_
> beta_1 = modelo.coef_[0]
> beta_2 = modelo.coef_[1]
>
> print(f"Intercepto (beta_0): {beta_0:.2f}")
> print(f"Coeficiente da Tend√™ncia (beta_1): {beta_1:.2f}")
> print(f"Coeficiente Sazonal (beta_2): {beta_2:.2f}")
>
> # Gera valores preditos
> vendas_preditas = modelo.predict(X)
>
> # Plota os resultados
> plt.figure(figsize=(10,6))
> plt.plot(tempo, vendas, label='S√©rie Real')
> plt.plot(tempo, vendas_preditas, label='S√©rie Predita')
> plt.xlabel('Tempo (Meses)')
> plt.ylabel('Vendas')
> plt.title("Regress√£o Linear com Componente Sazonal")
> plt.legend()
> plt.show()
>
> # Plot dos res√≠duos
> residuos_regressao = vendas - vendas_preditas
> plt.figure(figsize=(10,6))
> plt.plot(tempo, residuos_regressao)
> plt.title("Res√≠duos da Regress√£o")
> plt.xlabel("Tempo")
> plt.ylabel("Res√≠duos")
> plt.show()
> ```
> Este c√≥digo mostra como integrar os coeficientes de Fourier (neste exemplo, a frequ√™ncia anual) em um modelo de regress√£o linear. O modelo ajustado apresenta um intercepto, um coeficiente para a tend√™ncia linear e um coeficiente para a componente sazonal. A visualiza√ß√£o da s√©rie real versus a s√©rie predita mostra o ajuste do modelo aos dados, e a an√°lise dos res√≠duos ajuda a entender o que o modelo n√£o conseguiu capturar. Os resultados podem ser usados para prever os valores de vendas com melhor precis√£o do que modelos que n√£o consideram a sazonalidade.

### Conclus√£o
Este cap√≠tulo explorou a matem√°tica da sazonalidade em *s√©ries temporais* sob a perspectiva da an√°lise de Fourier e das transformadas wavelet. A an√°lise de Fourier permite a decomposi√ß√£o de s√©ries temporais em componentes de frequ√™ncia, revelando as caracter√≠sticas peri√≥dicas da sazonalidade. As transformadas wavelet, por sua vez, oferecem uma abordagem mais flex√≠vel para analisar s√©ries temporais n√£o estacion√°rias, permitindo capturar varia√ß√µes na sazonalidade ao longo do tempo. Ambas as ferramentas matem√°ticas oferecem meios poderosos para a modelagem e previs√£o de demanda, proporcionando uma compreens√£o mais profunda da estrutura dos dados e permitindo ajustar os modelos para diferentes cen√°rios de demanda. A escolha entre an√°lise de Fourier e wavelets depende da natureza da s√©rie temporal e do objetivo da modelagem. A combina√ß√£o desses m√©todos com modelos de regress√£o oferece uma abordagem robusta e flex√≠vel para modelar s√©ries temporais com componentes sazonais.

### Refer√™ncias
[^Fourier]: Oppenheim, A. V., & Schafer, R. W. (2014). Discrete-time signal processing. Pearson.
[^FFT]: Cooley, J. W., & Tukey, J. W. (1965). An algorithm for the machine calculation of complex Fourier series. Mathematics of computation, 19(90), 297-301.
[^5]: Chapter 3 - Forecasting Demand, p. 58
[^58]: Chapter 3 - Forecasting Demand, p. 59
[^59]: Chapter 3 - Forecasting Demand, p. 59
[^60]: Chapter 3 - Forecasting Demand, p. 60
[^74]: Chapter 3 - Forecasting Demand, p. 74
[^75]: Chapter 3 - Forecasting Demand, p. 75
[Lema 1.1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Lema 1.1.
[Lema 1.2]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Lema 1.2.
[Proposi√ß√£o 1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Proposi√ß√£o 1.
[Teorema 2.1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Teorema 2.1.
<!-- END -->
