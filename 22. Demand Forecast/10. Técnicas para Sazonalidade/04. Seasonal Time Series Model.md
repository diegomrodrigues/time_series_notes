## Modelagem de S√©ries Temporais com Ajuste Sazonal: Abordagens Aditiva e Multiplicativa

### Introdu√ß√£o
Este cap√≠tulo aprofunda a modelagem de s√©ries temporais, explorando as abordagens *aditiva* e *multiplicativa* para o ajuste sazonal, que foi introduzido em cap√≠tulos anteriores [^74]. Como explorado anteriormente, a sazonalidade √© um padr√£o recorrente que se manifesta em intervalos fixos e regulares, e a modelagem de uma s√©rie temporal que cont√©m sazonalidade requer uma abordagem que considere esse efeito [^58, 59]. O ajuste sazonal atrav√©s de *√≠ndices sazonais* √© crucial para gerar proje√ß√µes de demanda mais precisas, e este cap√≠tulo detalha os m√©todos aditivo e multiplicativo para realizar este ajuste, al√©m de explorar como estes modelos se integram com a modelagem da tend√™ncia.

### Ajuste Sazonal: Abordagens Aditiva e Multiplicativa
O ajuste sazonal √© o processo de incorporar a sazonalidade na modelagem de s√©ries temporais, ajustando os componentes (como a tend√™ncia) com os √≠ndices sazonais [^74]. O objetivo √© criar modelos que reflitam tanto o movimento de longo prazo (tend√™ncia) quanto as flutua√ß√µes regulares (sazonalidade) nos dados. Como j√° introduzido, existem duas abordagens principais para realizar o ajuste sazonal: a aditiva e a multiplicativa [^74, Lema 1.1, Lema 1.2]. A escolha entre essas abordagens depende da natureza da s√©rie temporal e do comportamento da sazonalidade.

#### Modelo Aditivo
Em um modelo *aditivo*, os √≠ndices sazonais representam um desvio constante (positivo ou negativo) que √© adicionado ou subtra√≠do da tend√™ncia ou m√©dia para cada per√≠odo sazonal [^74, Lema 1.1]. Este modelo assume que a magnitude da sazonalidade n√£o depende do n√≠vel da tend√™ncia [Lema 1.1]. Formalmente, um modelo aditivo pode ser expresso como:
$$ y_t = T_t + S_t + \epsilon_t $$
onde:
*   $y_t$ √© o valor observado no tempo $t$.
*   $T_t$ √© o componente de tend√™ncia no tempo $t$, que pode ser estimado por regress√£o por m√≠nimos quadrados ou outros m√©todos.
*   $S_t$ √© o componente sazonal no tempo $t$, expressos como um desvio da m√©dia.
*   $\epsilon_t$ √© o componente de erro aleat√≥rio no tempo $t$.

Para criar uma previs√£o que considera sazonalidade, primeiro, a tend√™ncia √© estimada, em seguida o efeito sazonal (o √≠ndice sazonal) √© somado ou subtra√≠do da previs√£o da tend√™ncia, representando o ajuste sazonal.

> üí° **Exemplo Num√©rico:** Suponha que a componente de tend√™ncia de uma s√©rie seja modelada como $T_t = 50 + 2t$ e que os √≠ndices sazonais sejam definidos para cada trimestre, sendo eles +10 para o primeiro trimestre, +5 para o segundo, -5 para o terceiro e -10 para o quarto. Para o quinto trimestre, a previs√£o sazonalmente ajustada seria $y_5 = 50 + 2(5) + 10 = 70$, onde +10 √© o √≠ndice sazonal para o primeiro trimestre. Para o sexto trimestre, a previs√£o seria $y_6 = 50 + 2(6) + 5 = 67$, onde +5 √© o √≠ndice sazonal para o segundo trimestre. Observe que os √≠ndices sazonais s√£o somados diretamente √† tend√™ncia.
>
> Vamos calcular a previs√£o para o trimestre 7: $y_7 = 50 + 2(7) - 5 = 59$, onde -5 √© o √≠ndice sazonal para o terceiro trimestre. Para o trimestre 8: $y_8 = 50 + 2(8) - 10 = 56$, onde -10 √© o √≠ndice sazonal para o quarto trimestre. Para o trimestre 9: $y_9 = 50 + 2(9) + 10 = 78$, onde voltamos a usar o √≠ndice sazonal do primeiro trimestre.

**Lema 1.3** *A soma dos √≠ndices sazonais em um modelo aditivo, ao longo de um ciclo sazonal completo, √© zero.*

*Prova:*
I. Em um modelo aditivo, os √≠ndices sazonais representam desvios da m√©dia da s√©rie.
II. A m√©dia da s√©rie, ao longo de um ciclo sazonal, j√° captura a tend√™ncia.
III. Os desvios sazonais devem, portanto, se cancelar ao longo de um ciclo completo para que a m√©dia da s√©rie n√£o seja alterada pela sazonalidade.
IV. Formalmente, se temos $n$ per√≠odos sazonais, a soma dos √≠ndices sazonais √© $\sum_{i=1}^{n} S_i = 0$. $\blacksquare$

> üí° **Exemplo Num√©rico:** No exemplo anterior, temos quatro √≠ndices sazonais: 10, 5, -5 e -10. A soma desses √≠ndices √© $10 + 5 - 5 - 10 = 0$, conforme o Lema 1.3.

#### Modelo Multiplicativo
Em um modelo *multiplicativo*, a sazonalidade √© expressa como um percentual da tend√™ncia ou m√©dia, o que significa que as flutua√ß√µes sazonais se tornam maiores √† medida que a tend√™ncia aumenta [^74, Lema 1.2]. O valor observado, neste caso, √© obtido multiplicando a tend√™ncia pelo √≠ndice sazonal. Um modelo multiplicativo pode ser expresso como:
$$ y_t = T_t \times S_t \times \epsilon_t$$
onde:
*   $y_t$ √© o valor observado no tempo $t$.
*   $T_t$ √© a componente de tend√™ncia no tempo $t$.
*   $S_t$ √© a componente sazonal no tempo $t$, expressa como um √≠ndice (porcentagem) da tend√™ncia ou m√©dia.
*   $\epsilon_t$ √© o componente de erro aleat√≥rio no tempo $t$.

Para realizar a proje√ß√£o sazonalmente ajustada, a previs√£o da tend√™ncia √© multiplicada pelo √≠ndice sazonal correspondente, resultando em um ajuste proporcional √† magnitude da tend√™ncia.

> üí° **Exemplo Num√©rico:** Usando a mesma tend√™ncia $T_t = 50 + 2t$  e os seguintes √≠ndices sazonais: 1.1 para o primeiro trimestre, 1.05 para o segundo, 0.95 para o terceiro e 0.9 para o quarto, a proje√ß√£o sazonal para o quinto trimestre seria: $y_5 = (50 + 2\times5) \times 1.1 = 66$ e para o sexto trimestre, $y_6 = (50 + 2\times6) \times 1.05 = 65.1$. Note como a sazonalidade tem um efeito multiplicativo sobre a tend√™ncia.
>
> Vamos calcular as proje√ß√µes para os trimestres 7 e 8:
> $y_7 = (50 + 2 \times 7) \times 0.95 = 60.8$ e $y_8 = (50 + 2 \times 8) \times 0.9 = 61.2$
>
> E para o trimestre 9: $y_9 = (50 + 2 \times 9) \times 1.1 = 74.8$. Note que a sazonalidade aumenta a proje√ß√£o para o primeiro trimestre.

**Lema 1.4** *O produto dos √≠ndices sazonais em um modelo multiplicativo, ao longo de um ciclo sazonal completo, √© igual a 1.*

*Prova:*
I. Em um modelo multiplicativo, os √≠ndices sazonais s√£o fatores de escala da tend√™ncia.
II. Portanto, ao longo de um ciclo completo, o produto desses fatores deve ser igual a 1, para n√£o alterar a escala da s√©rie ao longo do ciclo.
III. Formalmente, se temos $n$ per√≠odos sazonais, o produto dos √≠ndices sazonais √© $\prod_{i=1}^{n} S_i = 1$.$\blacksquare$

> üí° **Exemplo Num√©rico:** No exemplo anterior, os √≠ndices sazonais s√£o 1.1, 1.05, 0.95 e 0.9. O produto desses √≠ndices √© $1.1 \times 1.05 \times 0.95 \times 0.9 = 0.999975 \approx 1$, demonstrando o Lema 1.4.

A escolha entre um modelo aditivo ou multiplicativo depende da natureza da sazonalidade e como ela interage com a tend√™ncia [^74].

### Integra√ß√£o com Regress√£o por M√≠nimos Quadrados
Tanto os modelos aditivos quanto os multiplicativos podem ser integrados com a regress√£o por m√≠nimos quadrados para modelar a componente de tend√™ncia, de acordo com o *Teorema 2.1*  [Teorema 2.1]. O processo geral envolve os seguintes passos [^75]:
1.  **C√°lculo dos √çndices Sazonais:** Determinar os √≠ndices sazonais para cada per√≠odo [^75]. Como explorado no cap√≠tulo anterior, a soma desses √≠ndices √© igual ao n√∫mero de per√≠odos no ciclo sazonal [Proposi√ß√£o 1].
2.  **Deseasonaliza√ß√£o:** Os dados originais s√£o ajustados para remover o componente sazonal, resultando em dados *deseasonalizados* [^74]. Em modelos multiplicativos, isso √© feito dividindo cada observa√ß√£o pelo √≠ndice sazonal correspondente. Em modelos aditivos, subtrai-se o √≠ndice sazonal correspondente [Lema 1.1, Lema 1.2].
3.  **Regress√£o por M√≠nimos Quadrados:** Um modelo de regress√£o √© aplicado aos dados *deseasonalizados* para modelar a tend√™ncia [Teorema 2]. Isto produz os coeficientes da tend√™ncia que ser√£o usados na previs√£o.
4.  **Proje√ß√£o da Tend√™ncia:** Os valores da tend√™ncia s√£o projetados para os per√≠odos futuros usando os par√¢metros da regress√£o linear.
5.  **Ajuste da Sazonalidade:** As proje√ß√µes da tend√™ncia s√£o ajustadas com os √≠ndices sazonais, aplicando o modelo aditivo (adi√ß√£o) ou multiplicativo (multiplica√ß√£o) [^75].

**Teorema 3.3** Ao aplicar a regress√£o por m√≠nimos quadrados (MQ) em dados com sazonalidade, as previs√µes finais, sejam usando modelo aditivo ou multiplicativo, podem ser expressas como um modelo linear generalizado com vari√°veis *dummy* que capturam tanto a tend√™ncia quanto a sazonalidade.

*Prova:*
I. Seja $y_t$ o valor observado no tempo $t$ e $x_t$ a vari√°vel independente (tempo). Sejam $D_{1,t}, \ldots, D_{n,t}$ $n$ vari√°veis *dummy* representando os per√≠odos sazonais.
II. Nos modelos aditivos, removemos a sazonalidade de $y_t$, obtendo $y_t^{des} = y_t - S_t$. Aplicamos regress√£o por MQ em $y_t^{des}$ para modelar a tend√™ncia, ou seja, $\hat{y}_t^{des} = \beta_0 + \beta_1 x_t$. Em seguida ajustamos a previs√£o adicionando a sazonalidade: $\hat{y}_t = \hat{y}_t^{des} + S_t$ o que √© equivalente a $y_t = \beta_0 + \beta_1 x_t + \sum_{i=1}^{n} \alpha_i D_{i,t} + \epsilon_t$.
III. Nos modelos multiplicativos, removemos a sazonalidade de $y_t$, obtendo  $y_t^{des} = y_t / S_t$. Aplicamos regress√£o por MQ em $y_t^{des}$ para modelar a tend√™ncia, ou seja, $\hat{y}_t^{des} = \beta_0 + \beta_1 x_t$. Em seguida ajustamos a previs√£o multiplicando pela sazonalidade: $\hat{y}_t = (\beta_0 + \beta_1 x_t) \times S_t$ o que √© equivalente a $y_t = (\beta_0 + \beta_1 x_t) \times (1 + \sum_{i=1}^{n} \alpha_i D_{i,t}) \times \epsilon_t$.
IV. Portanto, demonstrando que, com ou sem a etapa de *deseasonaliza√ß√£o* inicial, a combina√ß√£o de regress√£o por m√≠nimos quadrados com os √≠ndices sazonais pode ser expressa como um modelo linear generalizado que captura tanto a tend√™ncia quanto a sazonalidade. $\blacksquare$

> üí° **Exemplo Num√©rico:** Para ilustrar o Teorema 3.3, vamos usar dados trimestrais de vendas de uma loja ao longo de tr√™s anos, como no exemplo anterior, onde j√° calculamos os √≠ndices sazonais: Trimestre 1: 0.8; Trimestre 2: 1.2; Trimestre 3: 1.1; Trimestre 4: 0.9. Vamos mostrar um exemplo de previs√£o com o modelo multiplicativo.
>
> Suponha que os dados j√° *deseasonalizados* foram modelados com uma regress√£o linear que produz a seguinte linha de tend√™ncia: $T_t = 50 + 2t$ e que queremos realizar uma proje√ß√£o para o trimestre 13 (primeiro trimestre do quarto ano).
>
> *   **Abordagem de Decomposi√ß√£o:** Calculamos a tend√™ncia: $T_{13} = 50 + 2 \times 13 = 76$. Multiplicamos a tend√™ncia pelo √≠ndice sazonal do primeiro trimestre para obter a previs√£o sazonalmente ajustada: $76 \times 0.8 = 60.8$.
> *   **Abordagem com Vari√°veis Dummy:** Ajustamos um modelo de regress√£o linear que inclua a vari√°vel tempo e vari√°veis *dummy* para cada trimestre, exceto o primeiro (para evitar multicolinearidade). O modelo seria expresso como $y_t = \beta_0 + \beta_1 t + \beta_2 D_{2,t} + \beta_3 D_{3,t} + \beta_4 D_{4,t}$. Os coeficientes obtidos da regress√£o (para uma regress√£o com os dados originais) capturariam tanto a tend√™ncia linear ($\beta_0$ e $\beta_1$) quanto os ajustes sazonais ($\beta_2, \beta_3, \beta_4$), que equivalem aos √≠ndices sazonais, de forma que o valor predito para o trimestre 13 seria id√™ntico a 60.8. Ambos os m√©todos s√£o v√°lidos, e os resultados s√£o equivalentes.
>
> Para demonstrar, vamos supor que a regress√£o com vari√°veis dummy forneceu os seguintes coeficientes: $\beta_0 = 40$, $\beta_1 = 2$, $\beta_2 = 20$, $\beta_3 = 26$, $\beta_4 = 15$. Assim, a previs√£o para o trimestre 13 seria $y_{13} = 40 + 2 \times 13 + 0 + 0 + 0 = 66$, e este √© o valor da tend√™ncia. Para obter o efeito sazonal, podemos estimar que para o trimestre 1 os √≠ndices sazonais seriam obtidos atrav√©s da regress√£o com vari√°veis dummy como $S_1 = 1 + \alpha_1$, $S_2 = 1 + \alpha_2$, $S_3 = 1 + \alpha_3$, e $S_4 = 1 + \alpha_4$, sendo $\alpha_1 = 0$ (√≠ndice base), e $\alpha_2 = \beta_2 / (\beta_0 + \beta_1 t)$, $\alpha_3 = \beta_3 / (\beta_0 + \beta_1 t)$ e $\alpha_4 = \beta_4 / (\beta_0 + \beta_1 t)$. Os √≠ndices sazonais seriam, portanto, $S_1 = 1$, $S_2 = 1 + 20/66 = 1.30$, $S_3 = 1 + 26/66 = 1.39$ e $S_4 = 1 + 15/66 = 1.22$. Para obter o efeito sazonal para o trimestre 13, onde o √≠ndice sazonal seria $S_1=0.8$ (conforme o exemplo) o valor seria $66 \times 0.8 = 52.8$. Este valor √© ligeiramente diferente do c√°lculo da decomposi√ß√£o, pois a regress√£o com vari√°veis dummy estima os √≠ndices sazonais a partir dos dados originais, enquanto a decomposi√ß√£o os calcula a partir das m√©dias por per√≠odo.

**Teorema 3.4** *Modelos aditivos e multiplicativos s√£o equivalentes se o efeito da sazonalidade for muito pequeno.*

*Prova:*
I. Quando a varia√ß√£o sazonal √© pequena, podemos aproximar o √≠ndice sazonal $S_t$ do modelo multiplicativo por $1 + S_t'$, onde $S_t'$ √© um valor pr√≥ximo de zero.
II. Assim, o modelo multiplicativo $y_t = T_t \times S_t \times \epsilon_t$ se torna aproximadamente $y_t = T_t \times (1 + S_t') \times \epsilon_t = T_t + T_t S_t' + T_t \epsilon_t$.
III. Se a tend√™ncia $T_t$ n√£o varia muito ao longo do ciclo sazonal e $\epsilon_t$ tamb√©m √© pequeno, ent√£o $T_t S_t'$ pode ser visto como um desvio aditivo, similar ao modelo aditivo $y_t = T_t + S_t + \epsilon_t$.
IV. Ou seja, sob essa condi√ß√£o de pequena varia√ß√£o sazonal, ambos os modelos convergem para um comportamento similar, com a sazonalidade agindo como um efeito aditivo sobre a tend√™ncia. $\blacksquare$

> üí° **Exemplo Num√©rico:** Suponha que os √≠ndices sazonais em um modelo multiplicativo sejam: 1.01, 0.99, 1.02 e 0.98.  Nesse caso, $S_t'$ seria 0.01, -0.01, 0.02 e -0.02, respectivamente. Se a tend√™ncia em um certo ponto for $T_t=100$, o modelo multiplicativo resultaria em valores de 101, 99, 102 e 98, enquanto um modelo aditivo com √≠ndices 1, -1, 2 e -2 tamb√©m resultaria em valores pr√≥ximos (101, 99, 102 e 98). A diferen√ßa entre os dois modelos seria muito pequena nesse caso, confirmando o Teorema 3.4.

### Ajuste Sazonal na Previs√£o para M√∫ltiplos Per√≠odos
O ajuste sazonal desempenha um papel crucial na previs√£o de s√©ries temporais para m√∫ltiplos per√≠odos. A combina√ß√£o dos √≠ndices sazonais com modelos de regress√£o permite projetar a demanda para diversos per√≠odos futuros, garantindo que as previs√µes reflitam tanto a tend√™ncia quanto os padr√µes sazonais [^75]. As etapas incluem:
1.  **Proje√ß√£o da Tend√™ncia:** Utilizar a regress√£o por m√≠nimos quadrados ajustada aos dados *deseasonalizados* para projetar a tend√™ncia para os per√≠odos futuros.
2.  **Ajuste da Sazonalidade:** Ajustar os valores previstos da tend√™ncia utilizando os √≠ndices sazonais. No modelo multiplicativo, a proje√ß√£o da tend√™ncia √© multiplicada pelo √≠ndice sazonal correspondente; em modelos aditivos, o √≠ndice sazonal √© somado √† previs√£o da tend√™ncia.

√â importante notar que a vari√¢ncia da previs√£o aumenta com o n√∫mero de per√≠odos no futuro, especialmente em modelos aditivos, onde o erro tem efeito aditivo sobre a previs√£o (Lema 3.1).

> üí° **Exemplo Num√©rico:** Continuando com o exemplo anterior, vamos projetar as vendas para os pr√≥ximos dois anos (8 trimestres), usando tanto o modelo aditivo quanto o multiplicativo, e comparar os resultados.
>
> Suponha que a tend√™ncia seja dada por $T_t = 50 + 2t$, e os √≠ndices sazonais para o modelo aditivo sejam 10, 5, -5, -10, e para o modelo multiplicativo sejam 1.1, 1.05, 0.95, e 0.9.
>
> | Trimestre | Tend√™ncia ($T_t$) | Sazonal Aditivo | Previs√£o Aditiva | Sazonal Multiplicativo | Previs√£o Multiplicativa |
> |----------|------------------|-----------------|------------------|-----------------------|-----------------------|
> | 13       | 76               | 10              | 86               | 1.1                   | 83.6                 |
> | 14       | 78               | 5               | 83               | 1.05                  | 81.9                 |
> | 15       | 80               | -5              | 75               | 0.95                  | 76                   |
> | 16       | 82               | -10             | 72               | 0.9                   | 73.8                 |
> | 17       | 84               | 10              | 94               | 1.1                   | 92.4                 |
> | 18       | 86               | 5               | 91               | 1.05                  | 90.3                 |
> | 19       | 88               | -5              | 83               | 0.95                  | 83.6                 |
> | 20       | 90               | -10             | 80               | 0.9                   | 81                   |
>
> Observamos que ambos os modelos projetam um crescimento linear, mas o modelo multiplicativo amplifica os efeitos da sazonalidade quando a tend√™ncia aumenta.

**Lema 3.2** *Em modelos multiplicativos, a vari√¢ncia da previs√£o tamb√©m aumenta com o horizonte da proje√ß√£o, mas a vari√¢ncia √© proporcional ao quadrado da tend√™ncia projetada.*

*Prova:*
I. Em modelos multiplicativos, o erro $\epsilon_t$ tem um efeito multiplicativo sobre a previs√£o, ou seja, $\hat{y}_t = T_t \times S_t \times \epsilon_t$.
II. Se a vari√¢ncia de $\epsilon_t$ for $\sigma^2_\epsilon$, a vari√¢ncia da previs√£o $\hat{y}_t$ √© aproximadamente $\text{Var}(\hat{y}_t) = T_t^2 S_t^2 \sigma^2_\epsilon$.
III. Portanto, a vari√¢ncia da previs√£o aumenta com o quadrado da tend√™ncia projetada, indicando que a incerteza aumenta √† medida que se projeta para o futuro e que a tend√™ncia tamb√©m aumenta. $\blacksquare$

> üí° **Exemplo Num√©rico:** Suponha que a vari√¢ncia do erro $\epsilon_t$ seja 0.1. No modelo multiplicativo, se a tend√™ncia no per√≠odo 10 for $T_{10} = 70$ e o √≠ndice sazonal for $S_{10} = 1.1$, ent√£o a vari√¢ncia da previs√£o nesse per√≠odo seria aproximadamente $70^2 \times 1.1^2 \times 0.1 = 592.9$. Se a tend√™ncia em um per√≠odo futuro for $T_{20}=90$, a vari√¢ncia seria $90^2 \times 1.1^2 \times 0.1=980.1$. Isso mostra que a vari√¢ncia aumenta com o quadrado da tend√™ncia, conforme o Lema 3.2.

### Conclus√£o
A modelagem de s√©ries temporais que apresentam sazonalidade e tend√™ncia requer a combina√ß√£o de modelos de regress√£o com √≠ndices sazonais, que podem ser ajustados por modelos aditivos ou multiplicativos. A decomposi√ß√£o de s√©ries temporais atrav√©s da regress√£o por m√≠nimos quadrados e os √≠ndices sazonais oferece uma abordagem flex√≠vel para projetar a demanda futura, seja usando a regress√£o em dados *deseasonalizados* e ajustando as proje√ß√µes com os √≠ndices, ou atrav√©s de modelos de regress√£o com vari√°veis *dummy*. A escolha entre modelos aditivos e multiplicativos depende da natureza dos dados e do comportamento da sazonalidade. A combina√ß√£o dessas t√©cnicas possibilita a cria√ß√£o de previs√µes mais precisas e adaptadas a diferentes cen√°rios de demanda.

### Refer√™ncias
[^5]: Chapter 3 - Forecasting Demand, p. 58
[^58]: Chapter 3 - Forecasting Demand, p. 59
[^59]: Chapter 3 - Forecasting Demand, p. 59
[^60]: Chapter 3 - Forecasting Demand, p. 60
[^74]: Chapter 3 - Forecasting Demand, p. 74
[^75]: Chapter 3 - Forecasting Demand, p. 75
[Lema 1.1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Lema 1.1.
[Lema 1.2]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Lema 1.2.
[Proposi√ß√£o 1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Proposi√ß√£o 1.
[Teorema 2]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Teorema 2.
[Teorema 2.1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Teorema 2.1.
[Teorema 3.1]: See previous chapter on "Decomposi√ß√£o de S√©ries Temporais com Regress√£o por M√≠nimos Quadrados e √çndices Sazonais", Teorema 3.1.
<!-- END -->
