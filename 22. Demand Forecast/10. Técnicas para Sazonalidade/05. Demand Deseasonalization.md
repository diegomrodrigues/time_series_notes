## A Deseasonaliza√ß√£o de Dados em S√©ries Temporais: Isolando Tend√™ncias e Ciclos

### Introdu√ß√£o
Este cap√≠tulo aborda o conceito de **deseasonaliza√ß√£o** ou remo√ß√£o do padr√£o sazonal em *s√©ries temporais*, uma etapa fundamental na modelagem de dados que apresentam tanto sazonalidade quanto tend√™ncia [^74]. A *deseasonaliza√ß√£o* √© o processo de ajuste dos dados para retirar o componente sazonal, permitindo a identifica√ß√£o mais clara de outros padr√µes subjacentes, como tend√™ncias e ciclos [^74]. Este processo envolve o uso de √≠ndices sazonais para desagregar ou remover o efeito da sazonalidade dos dados, possibilitando uma an√°lise mais refinada das componentes restantes da s√©rie temporal. Este cap√≠tulo detalha como aplicar t√©cnicas de *deseasonaliza√ß√£o* e como o processo auxilia na modelagem e previs√£o de demanda.

### Deseasonaliza√ß√£o: Um Processo de Ajuste
A **deseasonaliza√ß√£o** √© uma t√©cnica de ajuste que tem como objetivo remover o padr√£o sazonal dos dados de uma s√©rie temporal [^74]. O objetivo √© isolar outros componentes importantes, como a tend√™ncia, que podem ser obscurecidos pelas varia√ß√µes regulares da sazonalidade. Como j√° discutido em cap√≠tulos anteriores, a sazonalidade √© um padr√£o recorrente e repetitivo que ocorre em intervalos regulares, como meses, trimestres ou esta√ß√µes do ano [^5, 58]. A *deseasonaliza√ß√£o* √© uma etapa pr√©via √† modelagem da tend√™ncia, pois remove a varia√ß√£o sazonal, permitindo que a componente de tend√™ncia seja modelada de forma mais precisa [^74].

> üí° **Revis√£o:** Em modelos *aditivos*, a sazonalidade √© representada como um desvio constante (positivo ou negativo) da tend√™ncia ou m√©dia. O valor observado √© dado por $y_t = T_t + S_t + \epsilon_t$, onde $T_t$ √© a tend√™ncia, $S_t$ √© a sazonalidade e $\epsilon_t$ o erro [Lema 1.1]. Em modelos *multiplicativos*, a sazonalidade √© expressa como uma porcentagem da tend√™ncia ou m√©dia. O valor observado √© dado por $y_t = T_t \times S_t \times \epsilon_t$ [Lema 1.2].

O processo de *deseasonaliza√ß√£o* envolve o uso de √≠ndices sazonais [^74]. Estes √≠ndices quantificam o impacto da sazonalidade em cada per√≠odo, permitindo que os dados sejam ajustados para remover esse efeito. A *deseasonaliza√ß√£o* permite que as varia√ß√µes da demanda ao longo do tempo sejam avaliadas sem a interfer√™ncia dos ciclos sazonais.

#### M√©todos de Deseasonaliza√ß√£o
A forma de realizar a *deseasonaliza√ß√£o* depende do modelo adotado para representar a sazonalidade:

1.  **Modelos Multiplicativos:**
    *   Neste caso, os dados s√£o ajustados dividindo cada valor da demanda pelo √≠ndice sazonal correspondente [^75]. O processo de *deseasonaliza√ß√£o* resulta em dados que representam as varia√ß√µes da demanda sem a influ√™ncia da sazonalidade. Formalmente, os dados *deseasonalizados* s√£o obtidos atrav√©s da seguinte express√£o:
        $$ y_t^{des} = \frac{y_t}{S_t}$$
        onde:
        *   $y_t^{des}$ √© o valor *deseasonalizado* no tempo $t$.
        *   $y_t$ √© o valor original no tempo $t$.
        *   $S_t$ √© o √≠ndice sazonal para o tempo $t$.
        Este processo resulta em uma s√©rie temporal que reflete a tend√™ncia e os componentes de erro, sem o efeito sazonal [^75].
2.  **Modelos Aditivos:**
    *   Em modelos aditivos, a *deseasonaliza√ß√£o* √© realizada subtraindo o √≠ndice sazonal correspondente de cada observa√ß√£o [Lema 1.1]. Formalmente, temos:
        $$ y_t^{des} = y_t - S_t$$
        onde:
        *   $y_t^{des}$ √© o valor *deseasonalizado* no tempo $t$.
        *   $y_t$ √© o valor original no tempo $t$.
        *   $S_t$ √© o √≠ndice sazonal para o tempo $t$.
        Com este processo, a componente de sazonalidade √© removida da s√©rie original, restando a componente de tend√™ncia e de erro [Lema 1.1].

> üí° **Exemplo Num√©rico:** Usando os dados de vendas trimestrais de uma loja de eletr√¥nicos e os √≠ndices sazonais calculados no cap√≠tulo anterior (Trimestre 1: 0.84; Trimestre 2: 1.32; Trimestre 3: 1.17; Trimestre 4: 0.67) vamos mostrar a *deseasonaliza√ß√£o*. Considere as vendas do primeiro trimestre do primeiro ano, que foram de 25 unidades, e que estamos usando um modelo multiplicativo.  O valor *deseasonalizado* ser√°: $25/0.84 = 29.76$. Se fosse um modelo aditivo, o √≠ndice sazonal (j√° obtido) seria -5 (ap√≥s remover a m√©dia) e o valor *deseasonalizado* seria $25 - (-5) = 30$.
>
> As vendas *deseasonalizadas* (multiplicativo) para os quatro trimestres do primeiro ano seriam:
>
> *   Trimestre 1: $25 / 0.84 = 29.76$
> *   Trimestre 2: $40 / 1.32 = 30.30$
> *   Trimestre 3: $35 / 1.17 = 29.91$
> *   Trimestre 4: $20 / 0.67 = 29.85$
>
> E os dados *deseasonalizados* (aditivo), supondo que as m√©dias foram removidas e os √≠ndices s√£o -5, 10, 2 e -7, seriam:
>
> *  Trimestre 1: $25 - (-5) = 30$
> *   Trimestre 2: $40 - 10 = 30$
> *   Trimestre 3: $35 - 2 = 33$
> *   Trimestre 4: $20 - (-7) = 27$
>
> Agora, vamos calcular a *deseasonaliza√ß√£o* para um segundo ano, usando os mesmos √≠ndices sazonais e os seguintes valores de vendas: Trimestre 1: 30, Trimestre 2: 45, Trimestre 3: 40, Trimestre 4: 22.
>
> *Deseasonaliza√ß√£o (multiplicativo):*
>  *   Trimestre 1: $30 / 0.84 = 35.71$
>  *   Trimestre 2: $45 / 1.32 = 34.09$
>  *   Trimestre 3: $40 / 1.17 = 34.19$
>  *   Trimestre 4: $22 / 0.67 = 32.84$
>
> *Deseasonaliza√ß√£o (aditivo):*
> *   Trimestre 1: $30 - (-5) = 35$
> *   Trimestre 2: $45 - 10 = 35$
> *   Trimestre 3: $40 - 2 = 38$
> *   Trimestre 4: $22 - (-7) = 29$
>
> Este exemplo mostra como os dados s√£o ajustados para remover a sazonalidade, seja por divis√£o (multiplicativo) ou subtra√ß√£o (aditivo). A escolha entre os m√©todos depende se a sazonalidade se expressa como uma propor√ß√£o da m√©dia ou como um desvio constante.

**Observa√ß√£o 1:** A escolha entre os m√©todos aditivo e multiplicativo √© essencial e deve ser baseada na natureza da sazonalidade. Se as flutua√ß√µes sazonais s√£o proporcionais ao n√≠vel da tend√™ncia (a amplitude da sazonalidade aumenta com a tend√™ncia), um modelo multiplicativo √© mais apropriado [^74]. Se as flutua√ß√µes sazonais s√£o mais ou menos constantes, um modelo aditivo √© mais adequado [^74, Lema 1.1, Lema 1.2].

**Proposi√ß√£o 1.1:** *A escolha correta entre modelos aditivos e multiplicativos tamb√©m pode ser auxiliada pela an√°lise da varia√ß√£o da s√©rie temporal. Se a vari√¢ncia dos res√≠duos (ap√≥s remo√ß√£o da tend√™ncia) se mant√©m aproximadamente constante ao longo do tempo, um modelo aditivo pode ser mais apropriado. Caso contr√°rio, um modelo multiplicativo pode ser prefer√≠vel, pois ele acomoda mudan√ßas na vari√¢ncia associadas √† tend√™ncia.*

*Prova:*
I. Em um modelo aditivo, assume-se que a vari√¢ncia do erro $\epsilon_t$ √© constante ao longo do tempo. Portanto, a vari√¢ncia dos res√≠duos ap√≥s a remo√ß√£o da tend√™ncia deve ser aproximadamente constante.
II. Em um modelo multiplicativo, a vari√¢ncia dos res√≠duos √© proporcional ao n√≠vel da tend√™ncia. Portanto, se a vari√¢ncia dos res√≠duos aumenta ou diminui junto com a tend√™ncia, o modelo multiplicativo √© mais apropriado.
III. A an√°lise da varia√ß√£o dos res√≠duos ajuda a validar a escolha do modelo e identificar potenciais inadequa√ß√µes. $\blacksquare$

> üí° **Exemplo Num√©rico:** Suponha que, ap√≥s remover a tend√™ncia de uma s√©rie temporal, os res√≠duos em per√≠odos de baixa demanda apresentem uma vari√¢ncia de 5, enquanto em per√≠odos de alta demanda a vari√¢ncia seja 20. Isso sugere que a vari√¢ncia dos res√≠duos n√£o √© constante, e, portanto, um modelo multiplicativo seria mais adequado para a *deseasonaliza√ß√£o*, pois ele modela a sazonalidade como uma porcentagem da tend√™ncia, que faz com que a vari√¢ncia do erro tamb√©m varie junto com a tend√™ncia. Se a vari√¢ncia dos res√≠duos ap√≥s a remo√ß√£o da tend√™ncia fosse consistentemente pr√≥xima de 8, um modelo aditivo seria mais adequado.

#### A Import√¢ncia da Deseasonaliza√ß√£o
A *deseasonaliza√ß√£o* √© crucial para a an√°lise de s√©ries temporais que apresentam padr√µes sazonais [^74]. Sem remover a sazonalidade, outros padr√µes, como a tend√™ncia e os ciclos, podem ser obscurecidos ou mal interpretados.
*   **Identifica√ß√£o da Tend√™ncia:** Ao remover a sazonalidade, torna-se poss√≠vel isolar a componente de tend√™ncia, revelando o movimento de longo prazo dos dados. Esta an√°lise √© essencial para compreender a dire√ß√£o geral da demanda ao longo do tempo.
*   **An√°lise de Ciclos:** A *deseasonaliza√ß√£o* tamb√©m facilita a identifica√ß√£o de padr√µes c√≠clicos, que s√£o varia√ß√µes nos dados que ocorrem em intervalos de v√°rios anos e que podem estar relacionados com fatores econ√¥micos, pol√≠ticos ou sociais [^59].
*   **Melhora na Acur√°cia da Previs√£o:** Ao modelar a tend√™ncia e os ciclos de forma mais precisa (ap√≥s remover a sazonalidade), as previs√µes futuras se tornam mais precisas e confi√°veis.
*   **Compara√ß√£o entre Per√≠odos:** A *deseasonaliza√ß√£o* permite comparar os dados de diferentes per√≠odos sazonais de forma mais justa, sem a influ√™ncia das varia√ß√µes sazonais. Por exemplo, ao analisar as vendas de uma loja em diferentes trimestres, a *deseasonaliza√ß√£o* possibilita comparar as vendas de diferentes trimestres sem a interfer√™ncia dos ciclos sazonais, revelando tend√™ncias subjacentes que podem ser exploradas.

> üí° **Exemplo Num√©rico:** Suponha que as vendas de uma loja de brinquedos mostrem um aumento nos √∫ltimos tr√™s anos, mas tamb√©m uma sazonalidade com pico de vendas em dezembro. Se compararmos os dados brutos de dezembro com os de janeiro, podemos concluir que a loja teve uma queda abrupta nas vendas. No entanto, se *deseasonalizarmos* os dados, poderemos ver que a tend√™ncia de crescimento continua, apesar do efeito sazonal de dezembro. A *deseasonaliza√ß√£o* permite identificar a tend√™ncia com mais clareza.
>
> Considere que a loja vendeu 100 brinquedos em janeiro, 120 em fevereiro, 150 em mar√ßo, e 400 em dezembro de um ano. Em janeiro do ano seguinte, vendeu 110 brinquedos. Uma compara√ß√£o direta indicaria uma queda nas vendas de dezembro para janeiro. Entretanto, ap√≥s a *deseasonaliza√ß√£o*, assumindo um √≠ndice sazonal de 0.8 em janeiro e 2.5 em dezembro (modelo multiplicativo), os valores *deseasonalizados* seriam 125 e 160, respectivamente. Ap√≥s a *deseasonaliza√ß√£o*, vemos que a tend√™ncia de crescimento da loja continua, mesmo com o efeito da sazonalidade.
>
> A *deseasonaliza√ß√£o* n√£o apenas remove os efeitos da sazonalidade para uma melhor modelagem da tend√™ncia, mas tamb√©m permite uma compara√ß√£o mais significativa entre os per√≠odos de diferentes sazonalidades, revelando a din√¢mica real da demanda.

#### Modelagem Ap√≥s a Deseasonaliza√ß√£o
Ap√≥s a *deseasonaliza√ß√£o*, a s√©rie temporal √© composta, principalmente, pela tend√™ncia, pelo ciclo e pelas varia√ß√µes aleat√≥rias [^59]. Com a sazonalidade removida, √© poss√≠vel aplicar modelos de regress√£o ou outras t√©cnicas de an√°lise para modelar os componentes restantes da s√©rie [Teorema 2].

> üí° **Exemplo Num√©rico:** Usando os dados *deseasonalizados* da loja de eletr√¥nicos (modelo multiplicativo) no exemplo anterior, e supondo que a vari√°vel independente √© o tempo (trimestre). Poder√≠amos ajustar um modelo de regress√£o linear aos dados para modelar a componente de tend√™ncia: $T_t = \beta_0 + \beta_1 t$, onde $t$ √© o n√∫mero do trimestre e $\beta_0$ e $\beta_1$ os par√¢metros estimados da regress√£o. O modelo linear estimado seria: $T_t = 29 + 1.5t$. Para um modelo aditivo, o modelo de regress√£o poderia ser similar, mas com par√¢metros diferentes: $T_t = 30 + 1.2t$.
>
> Para exemplificar, usando os valores *deseasonalizados* da loja no exemplo anterior, (29.76, 30.30, 29.91, 29.85) para o primeiro ano, e (35.71, 34.09, 34.19, 32.84) para o segundo ano, podemos ajustar um modelo de regress√£o linear:
>
> ```python
> import numpy as np
> from sklearn.linear_model import LinearRegression
>
> # Dados deseasonalizados
> deseasonalized_data = np.array([29.76, 30.30, 29.91, 29.85, 35.71, 34.09, 34.19, 32.84]).reshape(-1, 1)
> time = np.array(range(1, 9)).reshape(-1, 1)
>
> # Modelo de regress√£o linear
> model = LinearRegression()
> model.fit(time, deseasonalized_data)
>
> # Coeficientes da regress√£o
> beta_0 = model.intercept_[0]
> beta_1 = model.coef_[0][0]
>
> print(f"Intercepto (beta_0): {beta_0:.2f}")
> print(f"Inclina√ß√£o (beta_1): {beta_1:.2f}")
> ```
>
> Este c√≥digo calcula os par√¢metros do modelo de tend√™ncia. O intercepto ($\beta_0$) indica o n√≠vel da tend√™ncia no in√≠cio do per√≠odo, e a inclina√ß√£o ($\beta_1$) indica a taxa de crescimento da tend√™ncia. Se executarmos este c√≥digo, o modelo linear resultante ser√° pr√≥ximo de $T_t = 28.8 + 0.59t$.

**Teorema 4** *A regress√£o por m√≠nimos quadrados aplicada aos dados deseasonalizados produz estimativas n√£o viesadas da tend√™ncia, desde que o modelo de tend√™ncia seja adequado para os dados.*

*Prova:*
I. Seja $y_t$ o valor observado, $S_t$ o √≠ndice sazonal e $T_t$ a tend√™ncia verdadeira.
II. Em um modelo multiplicativo, a *deseasonaliza√ß√£o* produz $y_t^{des} = y_t / S_t$, de forma que  $y_t^{des} = T_t  \epsilon_t$, assumindo que a sazonalidade foi corretamente estimada.
III. Em um modelo aditivo, a *deseasonaliza√ß√£o* produz $y_t^{des} = y_t - S_t$, de forma que $y_t^{des} = T_t + \epsilon_t$.
IV. A regress√£o por m√≠nimos quadrados (MQ) minimiza o erro quadr√°tico m√©dio. Se o modelo de regress√£o para a componente de tend√™ncia √© adequado, os par√¢metros estimados da regress√£o ser√£o n√£o viesados (ou seja, sua m√©dia ser√° igual ao verdadeiro valor).
V. Portanto, se a s√©rie *deseasonalizada* cont√©m apenas a componente de tend√™ncia e erro, a regress√£o por m√≠nimos quadrados produz estimativas n√£o viesadas da tend√™ncia, contanto que o modelo seja adequado. $\blacksquare$

Este teorema enfatiza que, para modelos corretamente especificados, a *deseasonaliza√ß√£o* √© uma etapa importante, pois remove um vi√©s introduzido pela sazonalidade quando modelos de regress√£o s√£o usados.

**Teorema 4.1** *Sob as mesmas condi√ß√µes do Teorema 4, se os erros $\epsilon_t$ forem independentes e identicamente distribu√≠dos com m√©dia zero e vari√¢ncia constante, as estimativas obtidas pela regress√£o por m√≠nimos quadrados ser√£o as melhores estimativas lineares n√£o viesadas (BLUE) da tend√™ncia.*

*Prova:*
I. O Teorema 4 estabelece que a regress√£o por m√≠nimos quadrados produz estimativas n√£o viesadas da tend√™ncia, se o modelo estiver corretamente especificado.
II. O Teorema de Gauss-Markov afirma que, em um modelo de regress√£o linear, se os erros s√£o independentes, t√™m m√©dia zero e vari√¢ncia constante, as estimativas obtidas pelo m√©todo de m√≠nimos quadrados s√£o as melhores estimativas lineares n√£o viesadas (BLUE).
III. Como a *deseasonaliza√ß√£o* remove o componente sazonal, a s√©rie resultante cont√©m principalmente tend√™ncia e erro. Assim, ao aplicar a regress√£o por m√≠nimos quadrados aos dados *deseasonalizados*, se os erros s√£o independentes e identicamente distribu√≠dos (i.i.d.) com m√©dia zero e vari√¢ncia constante, as estimativas ser√£o BLUE. $\blacksquare$

Este teorema complementa o anterior, mostrando que, sob condi√ß√µes mais espec√≠ficas, a regress√£o por m√≠nimos quadrados n√£o s√≥ produz estimativas n√£o viesadas, mas tamb√©m as melhores poss√≠veis dentro da classe de estimadores lineares n√£o viesados.

### Combina√ß√£o com a Previs√£o de Demanda
A *deseasonaliza√ß√£o* √© uma etapa que auxilia a modelar a componente de tend√™ncia, mas para realizar proje√ß√µes de demanda futuras, √© necess√°rio reintroduzir o efeito sazonal atrav√©s do √≠ndice sazonal [^75]. Em modelos multiplicativos, a proje√ß√£o da tend√™ncia √© multiplicada pelo √≠ndice sazonal correspondente para obter a proje√ß√£o final da demanda [^75]. Em modelos aditivos, o √≠ndice sazonal √© adicionado √† proje√ß√£o da tend√™ncia [^74]. Este processo resulta em previs√µes que consideram tanto a tend√™ncia de longo prazo quanto as varia√ß√µes regulares da sazonalidade.

> üí° **Exemplo Num√©rico:** Utilizando a linha de tend√™ncia estimada $T_t = 29 + 1.5t$ nos dados *deseasonalizados* da loja de eletr√¥nicos (modelo multiplicativo) e os √≠ndices sazonais, podemos projetar as vendas para o pr√≥ximo ano. Para o primeiro trimestre do pr√≥ximo ano (trimestre 13), a previs√£o da tend√™ncia seria $T_{13} = 29 + 1.5 \times 13 = 48.5$. Ajustando pela sazonalidade, a proje√ß√£o da demanda seria: $48.5 \times 0.84 = 40.74$, usando o √≠ndice sazonal de 0.84 para o trimestre 1.
>
> Para um modelo aditivo, e usando uma tend√™ncia $T_t = 30 + 1.2t$ com √≠ndices sazonais de -5, 10, 2 e -7, a proje√ß√£o seria $T_{13} = 30 + 1.2 \times 13 = 45.6$. Ajustando pela sazonalidade, a proje√ß√£o seria $45.6 - 5 = 40.6$.
>
> Continuando o exemplo anterior, e usando a linha de tend√™ncia $T_t = 28.8 + 0.59t$, a proje√ß√£o para o primeiro trimestre do terceiro ano (trimestre 9) seria $T_9 = 28.8 + 0.59 \times 9 = 34.11$.
>  *   Para um modelo multiplicativo, e usando o √≠ndice sazonal de 0.84 para o trimestre 1, a previs√£o da demanda seria: $34.11 \times 0.84 = 28.65$.
>  *   Para um modelo aditivo, e um √≠ndice sazonal de -5, a previs√£o da demanda seria: $34.11 - 5 = 29.11$.
>
> Para o segundo trimestre (trimestre 10), $T_{10} = 28.8 + 0.59 \times 10 = 34.7$.
> * Para um modelo multiplicativo, usando o √≠ndice 1.32, a previs√£o da demanda seria: $34.7 \times 1.32 = 45.80$
> * Para um modelo aditivo, usando o √≠ndice 10, a previs√£o da demanda seria: $34.7 + 10 = 44.7$.
>
> As previs√µes s√£o ajustadas com base na sazonalidade, mostrando a import√¢ncia de reintroduzir o componente sazonal ap√≥s a modelagem da tend√™ncia.

### Conclus√£o
A *deseasonaliza√ß√£o* √© um processo indispens√°vel para analisar *s√©ries temporais* que apresentam sazonalidade e tend√™ncia. Ao remover o efeito sazonal dos dados, torna-se poss√≠vel identificar e modelar outros componentes importantes, como a tend√™ncia e os ciclos, levando a previs√µes mais precisas e a uma melhor compreens√£o dos fatores que influenciam a demanda. A escolha entre os m√©todos aditivo e multiplicativo depende da natureza da sazonalidade e como ela interage com a tend√™ncia. Ap√≥s a *deseasonaliza√ß√£o*, a modelagem da tend√™ncia √© realizada com regress√£o por m√≠nimos quadrados e, finalmente, os efeitos sazonais s√£o reintroduzidos nas proje√ß√µes de demanda futuras, permitindo a cria√ß√£o de modelos mais completos e robustos para a tomada de decis√µes.

### Refer√™ncias
[^5]: Chapter 3 - Forecasting Demand, p. 58
[^58]: Chapter 3 - Forecasting Demand, p. 59
[^59]: Chapter 3 - Forecasting Demand, p. 59
[^60]: Chapter 3 - Forecasting Demand, p. 60
[^74]: Chapter 3 - Forecasting Demand, p. 74
[^75]: Chapter 3 - Forecasting Demand, p. 75
[Lema 1.1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Lema 1.1.
[Lema 1.2]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Lema 1.2.
[Proposi√ß√£o 1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Proposi√ß√£o 1.
[Teorema 2]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Teorema 2.
[Teorema 2.1]: See previous chapter on "T√©cnicas para Sazonalidade em S√©ries Temporais", Teorema 2.1.
[Teorema 3.1]: See previous chapter on "Decomposi√ß√£o de S√©ries Temporais com Regress√£o por M√≠nimos Quadrados e √çndices Sazonais", Teorema 3.1.
<!-- END -->
