## Precis√£o da Previs√£o em Modelagem de S√©ries Temporais

### Introdu√ß√£o
Neste cap√≠tulo, expandimos nossa discuss√£o sobre t√©cnicas de previs√£o, concentrando-nos agora em como avaliar a precis√£o dessas previs√µes. Como vimos anteriormente, a modelagem de s√©ries temporais envolve a an√°lise de dados sequenciais ao longo do tempo para prever valores futuros [^5]. No entanto, nenhuma previs√£o √© perfeita e, portanto, √© crucial entender e quantificar a diferen√ßa entre os valores previstos e os valores reais. Esta se√ß√£o ir√° abordar a import√¢ncia da precis√£o da previs√£o e introduzir m√©tricas comuns usadas para quantificar os erros de previs√£o.

### Conceitos Fundamentais
A precis√£o da previs√£o √© um componente fundamental da an√°lise de s√©ries temporais, pois fornece insights sobre a efic√°cia de um determinado modelo. O erro de previs√£o, definido como a diferen√ßa entre a demanda real e a previs√£o [^9], √© um conceito essencial para avaliar o desempenho de um modelo. Matematicamente, este erro √© representado por:

$$ \text{Erro de Previs√£o} = \text{Demanda Real} - \text{Previs√£o} $$ [^9]

√â fundamental reconhecer que, como as previs√µes s√£o feitas para o futuro, n√£o podemos comparar previs√µes com dados reais imediatamente. Em vez disso, o erro √© computado no passado, usando dados hist√≥ricos, para verificar a adequa√ß√£o da abordagem de previs√£o utilizada [^10]. Este m√©todo de avalia√ß√£o *‚Äúforecasts of the past‚Äù* envolve formular previs√µes com base em um determinado modelo e compar√°-las com a demanda hist√≥rica real [^10].

#### Medidas de Erro de Previs√£o

V√°rias medidas s√£o usadas para avaliar a precis√£o da previs√£o, incluindo a m√©dia do desvio absoluto (MAD), o erro quadr√°tico m√©dio (MSE) e o erro m√©dio percentual absoluto (MAPE) [^10]:

1.  **M√©dia do Desvio Absoluto (MAD):** √â a m√©dia dos erros absolutos das previs√µes. O MAD fornece uma medida da magnitude dos erros, sem considerar sua dire√ß√£o (positivo ou negativo). A f√≥rmula para o MAD √© dada por:

    $$ \text{MAD} = \frac{\sum |\text{Demanda Real} - \text{Previs√£o}|}{n} $$ [^10]

    onde *n* √© o n√∫mero de per√≠odos inclu√≠dos no c√°lculo [^10]. Um MAD de 218,43, por exemplo, significa que as previs√µes do SMA com n=5 est√£o, em m√©dia, 218,43 unidades "acima ou abaixo" dos n√∫meros reais de visitas [^10].
   
    > üí° **Exemplo Num√©rico:** Considere a seguinte s√©rie temporal de demanda e suas respectivas previs√µes.
    >
    > | Per√≠odo | Demanda Real ($y_t$) | Previs√£o ($\hat{y}_t$) | |---|---|---| | 1 | 100 | 110 | | 2 | 120 | 115 | | 3 | 130 | 125 | | 4 | 150 | 140 | | 5 | 160 | 155 |
    >
    > O MAD √© calculado da seguinte forma:
    >
    > $\text{Step 1: Calcular os erros absolutos: }$
    >
    > $|100-110| = 10$
    > $|120-115| = 5$
    > $|130-125| = 5$
    > $|150-140| = 10$
    > $|160-155| = 5$
    >
    >
    > $\text{Step 2: Calcular a m√©dia dos erros absolutos: }$
    >
    > $\text{MAD} = \frac{10 + 5 + 5 + 10 + 5}{5} = \frac{35}{5} = 7$
    >
    > Isso significa que, em m√©dia, as previs√µes est√£o a 7 unidades da demanda real.

2.  **Erro Quadr√°tico M√©dio (MSE):** O MSE √© a m√©dia dos quadrados dos erros de previs√£o. Ao elevar ao quadrado os erros, o MSE penaliza erros maiores de forma mais significativa do que erros menores. A f√≥rmula para MSE √©:

    $$ \text{MSE} = \frac{\sum (\text{Demanda Real} - \text{Previs√£o})^2}{n} $$ [^12]

     O MSE, ao elevar os erros ao quadrado, aumenta a penaliza√ß√£o para erros maiores [^12].
     
    > üí° **Exemplo Num√©rico:** Usando os mesmos dados do exemplo anterior, o MSE √© calculado da seguinte forma:
    >
    > $\text{Step 1: Calcular os erros ao quadrado: }$
    >
    > $(100-110)^2 = (-10)^2 = 100$
    > $(120-115)^2 = (5)^2 = 25$
    > $(130-125)^2 = (5)^2 = 25$
    > $(150-140)^2 = (10)^2 = 100$
    > $(160-155)^2 = (5)^2 = 25$
    >
    >
    > $\text{Step 2: Calcular a m√©dia dos erros ao quadrado: }$
    >
    > $\text{MSE} = \frac{100 + 25 + 25 + 100 + 25}{5} = \frac{275}{5} = 55$
    >
    > O MSE √© 55, o que reflete a penaliza√ß√£o dos erros maiores em compara√ß√£o com o MAD, que era 7.
    
    
3.  **Erro M√©dio Percentual Absoluto (MAPE):** O MAPE expressa o erro como uma porcentagem da demanda real, resolvendo assim a quest√£o da depend√™ncia do volume no MAD e no MSE [^12]. O MAPE √© calculado como:

    $$ \text{MAPE} = \frac{\sum \left|\frac{\text{Demanda Real} - \text{Previs√£o}}{\text{Demanda Real}}\right|}{n} \times 100 $$ [^12]
    Um MAPE de 13,19%, por exemplo, indica que as previs√µes do modelo de suaviza√ß√£o exponencial com $\alpha$ = 0,4 est√£o, em m√©dia, 13,19% da demanda real [^12].

    > üí° **Exemplo Num√©rico:** Utilizando novamente os mesmos dados, o MAPE √© calculado como:
    >
    > $\text{Step 1: Calcular os erros percentuais absolutos: }$
    >
    > $|\frac{100-110}{100}| = |-\frac{10}{100}| = 0.10$
    > $|\frac{120-115}{120}| = |\frac{5}{120}| = 0.0417$
    > $|\frac{130-125}{130}| = |\frac{5}{130}| = 0.0385$
    > $|\frac{150-140}{150}| = |\frac{10}{150}| = 0.0667$
    > $|\frac{160-155}{160}| = |\frac{5}{160}| = 0.0313$
    >
    > $\text{Step 2: Calcular a m√©dia dos erros percentuais absolutos e multiplicar por 100: }$
    >
    > $\text{MAPE} = \frac{0.10 + 0.0417 + 0.0385 + 0.0667 + 0.0313}{5} \times 100 = \frac{0.2782}{5} \times 100 = 0.05564 \times 100 = 5.564\%$
    >
    >  O MAPE √© aproximadamente 5.564%, o que significa que, em m√©dia, as previs√µes est√£o cerca de 5.564% longe da demanda real.

    **Observa√ß√£o:** √â importante notar que o MAPE pode apresentar problemas quando a demanda real √© zero ou muito pr√≥xima de zero. Nesses casos, a divis√£o por um valor pr√≥ximo de zero pode resultar em um MAPE muito grande ou indefinido. Para lidar com essa limita√ß√£o, outras m√©tricas podem ser consideradas.

    **Teorema 1:** Para evitar as limita√ß√µes do MAPE em rela√ß√£o a demandas pr√≥ximas de zero, uma alternativa √© o Erro M√©dio Absoluto Escalonado (MASE), que normaliza o erro pelo erro de previs√£o de um modelo *na√Øve* (usualmente, o valor do per√≠odo anterior) aplicado aos dados de treinamento. O MASE √© dado por:
   
    $$ \text{MASE} = \frac{\frac{1}{n} \sum_{t=1}^{n} |y_t - \hat{y}_t|}{\frac{1}{n-1}\sum_{t=2}^{n}|y_t - y_{t-1}|} $$

     onde $y_t$ √© a demanda real no per√≠odo *t*, $\hat{y}_t$ √© a previs√£o para o per√≠odo *t* e *n* √© o n√∫mero de per√≠odos considerados. O denominador √© a m√©dia da diferen√ßa absoluta entre valores consecutivos da s√©rie temporal (o erro de previs√£o de um modelo *na√Øve*), e o numerador √© o MAD do modelo avaliado. Um MASE menor que 1 indica um modelo mais preciso que o modelo *na√Øve*.

    **Prova do Teorema 1:**

    I. O numerador da f√≥rmula MASE √© o MAD do modelo avaliado:
        $$ \text{Numerador} = \frac{1}{n} \sum_{t=1}^{n} |y_t - \hat{y}_t| $$
    
    II. O denominador √© o MAD de um modelo *na√Øve* que usa o valor do per√≠odo anterior como previs√£o:
        $$ \text{Denominador} = \frac{1}{n-1}\sum_{t=2}^{n}|y_t - y_{t-1}| $$
    
    III. A raz√£o entre o numerador e o denominador normaliza o erro do modelo pelo erro de um modelo *na√Øve*.
        $$ \text{MASE} = \frac{\text{Numerador}}{\text{Denominador}} = \frac{\frac{1}{n} \sum_{t=1}^{n} |y_t - \hat{y}_t|}{\frac{1}{n-1}\sum_{t=2}^{n}|y_t - y_{t-1}|} $$
    
    IV. Se o MASE √© menor que 1, isso implica que o numerador (erro do modelo) √© menor que o denominador (erro do modelo *na√Øve*), indicando que o modelo √© mais preciso que o modelo *na√Øve*.
    
   V. Portanto, o MASE serve como uma medida escalonada e comparativa de precis√£o. ‚ñ†

    > üí° **Exemplo Num√©rico:** Usando os mesmos dados dos exemplos anteriores, e adicionando um valor anterior para calcular o denominador do MASE, temos:
    >
    > | Per√≠odo | Demanda Real ($y_t$) | Previs√£o ($\hat{y}_t$) |
    > |---|---|---|
    > | 0 | 90| - |
    > | 1 | 100 | 110 |
    > | 2 | 120 | 115 |
    > | 3 | 130 | 125 |
    > | 4 | 150 | 140 |
    > | 5 | 160 | 155 |
    >
    >
    > $\text{Step 1: Calcular o numerador (MAD do modelo): }$
    >
    > J√° calculamos o MAD no primeiro exemplo, que √© 7. Logo, o numerador √© igual a 7.
    >
    > $\text{Step 2: Calcular o denominador (MAD do modelo naive): }$
    >
    > $|100-90| = 10$
    > $|120-100| = 20$
    > $|130-120| = 10$
    > $|150-130| = 20$
    > $|160-150| = 10$
    >
    > $\text{Denominador} = \frac{10 + 20 + 10 + 20 + 10}{5-1} = \frac{70}{4} = 17.5$
    >
    > $\text{Step 3: Calcular o MASE: }$
    >
    > $\text{MASE} = \frac{7}{17.5} \approx 0.4$
    >
    > Como o MASE √© menor que 1, nosso modelo √© mais preciso do que o modelo naive.

#### Escolhendo o Valor de  $\alpha$ em Suaviza√ß√£o Exponencial
No contexto da suaviza√ß√£o exponencial, a escolha do valor de $\alpha$ (a constante de suaviza√ß√£o) √© fundamental para a precis√£o da previs√£o. Um valor mais baixo de $\alpha$ minimiza o efeito de mudan√ßas de curto prazo, tornando o modelo mais est√°vel. Por outro lado, um valor mais alto de $\alpha$ torna o modelo mais responsivo a mudan√ßas recentes na demanda [^9].

#### M√©todos de Previs√£o com Ajuste de Tend√™ncia e Sazonalidade
√â importante lembrar que m√©todos de previs√£o, como suaviza√ß√£o exponencial, podem n√£o ser adequados quando existem padr√µes de tend√™ncia ou sazonalidade. Como visto anteriormente, o m√©todo de suaviza√ß√£o exponencial ajustado para tend√™ncia (TAES) adiciona um segundo componente de suaviza√ß√£o ($\beta$) para contabilizar a tend√™ncia [^15]. Para incorporar a sazonalidade, os √≠ndices sazonais s√£o frequentemente usados para ajustar a previs√£o geral [^19]. Decompor a s√©rie temporal utilizando modelos de regress√£o de m√≠nimos quadrados tamb√©m auxilia no tratamento de tend√™ncias e sazonalidade [^19].

**Proposi√ß√£o 1:** A decomposi√ß√£o de s√©ries temporais, como mencionado, pode ser realizada atrav√©s de v√°rios m√©todos. Uma t√©cnica comum √© a decomposi√ß√£o cl√°ssica, que assume que a s√©rie temporal √© uma combina√ß√£o aditiva ou multiplicativa de seus componentes: tend√™ncia (T), sazonalidade (S) e res√≠duo ou erro (R). A decomposi√ß√£o aditiva √© dada por:
$$ Y_t = T_t + S_t + R_t $$
enquanto a decomposi√ß√£o multiplicativa √©:
$$ Y_t = T_t \times S_t \times R_t $$
A escolha entre os dois modelos depende da natureza da s√©rie, com a decomposi√ß√£o aditiva sendo mais apropriada quando a amplitude da sazonalidade se mant√©m constante ao longo do tempo, e a multiplicativa quando a amplitude da sazonalidade aumenta (ou diminui) com a tend√™ncia.

**Prova da Proposi√ß√£o 1:**
I.  Na decomposi√ß√£o cl√°ssica, assume-se que uma s√©rie temporal $Y_t$ √© composta por tr√™s componentes: uma tend√™ncia ($T_t$), um componente sazonal ($S_t$) e um res√≠duo aleat√≥rio ($R_t$).

II. A decomposi√ß√£o aditiva assume que esses componentes se somam para formar a s√©rie original:
$$ Y_t = T_t + S_t + R_t $$

III. A decomposi√ß√£o multiplicativa assume que esses componentes se multiplicam para formar a s√©rie original:
$$ Y_t = T_t \times S_t \times R_t $$

IV. A adequa√ß√£o do modelo aditivo se d√° quando os componentes sazonais da s√©rie temporal t√™m amplitude aproximadamente constante ao longo do tempo, o que implica que o efeito sazonal √© adicionado de forma constante.

V. O modelo multiplicativo √© mais adequado quando a amplitude da sazonalidade aumenta ou diminui com a tend√™ncia. Isso indica que o efeito sazonal √© proporcional √† magnitude da tend√™ncia em cada per√≠odo.

VI. A escolha entre os dois modelos depende, portanto, do comportamento dos componentes sazonais em rela√ß√£o √† tend√™ncia ao longo do tempo, conforme descrito acima. ‚ñ†

    
#### Escolhendo o Melhor Modelo
A escolha do modelo de previs√£o apropriado depende da precis√£o desejada. O MAPE confirma que modelos com maior responsividade (como WMA com pesos 0,7 e 0,3 e suaviza√ß√£o exponencial com Œ± = 0,8) s√£o mais precisos para os dados hist√≥ricos em quest√£o [^12].
Um modelo com MAD baixo indica que, em m√©dia, as previs√µes est√£o mais pr√≥ximas da demanda real, enquanto um modelo com MSE baixo significa que est√° penalizando mais os erros maiores [^10, 12]. √â fundamental observar que a precis√£o dos m√©todos de previs√£o varia dependendo do contexto espec√≠fico [^23].

**Lema 1:**  A escolha da m√©trica de erro apropriada depende do objetivo da an√°lise. Se a preocupa√ß√£o principal √© entender a magnitude dos erros de previs√£o em unidades da vari√°vel, o MAD √© uma escolha adequada. Se a penaliza√ß√£o de erros maiores for importante, o MSE √© prefer√≠vel. Se o objetivo √© expressar o erro em termos percentuais e a demanda n√£o se aproxima de zero, o MAPE √© uma boa escolha. Em situa√ß√µes em que a demanda pode ser zero ou pr√≥xima a zero, o MASE pode ser mais adequado.

**Prova do Lema 1:**

I. O MAD (M√©dia do Desvio Absoluto) √© calculado como a m√©dia das diferen√ßas absolutas entre as previs√µes e os valores reais. Como ele usa diferen√ßas absolutas, ele fornece uma medida da magnitude m√©dia dos erros, sem considerar se as previs√µes s√£o muito altas ou muito baixas. Isso o torna uma m√©trica √∫til quando o objetivo principal √© entender o erro m√©dio em termos da unidade da vari√°vel.

II. O MSE (Erro Quadr√°tico M√©dio), por outro lado, eleva ao quadrado as diferen√ßas entre as previs√µes e os valores reais antes de calcular a m√©dia. Essa opera√ß√£o de eleva√ß√£o ao quadrado penaliza erros maiores de forma mais significativa do que erros menores. Assim, o MSE √© mais sens√≠vel a grandes erros e √© uma escolha mais adequada quando a prioridade √© minimizar a ocorr√™ncia de grandes erros.

III. O MAPE (Erro M√©dio Percentual Absoluto) calcula a m√©dia das diferen√ßas percentuais absolutas entre as previs√µes e os valores reais. √â uma m√©trica que expressa o erro em termos de porcentagem e √© particularmente √∫til quando o erro precisa ser medido em termos relativos ao valor real. No entanto, o MAPE pode ser problem√°tico quando os valores reais s√£o zero ou muito pr√≥ximos de zero, pois resulta em divis√£o por valores pr√≥ximos de zero, o que pode levar a valores de MAPE muito grandes ou indefinidos.

IV. O MASE (Erro M√©dio Absoluto Escalonado) √© projetado para resolver a limita√ß√£o do MAPE com valores reais pr√≥ximos de zero. Ele normaliza o erro pelo erro de previs√£o de um modelo *na√Øve*, que geralmente usa o valor do per√≠odo anterior como previs√£o. Se MASE √© menor que 1, isso significa que nosso modelo performa melhor do que o *na√Øve*, por isso ele √© uma boa alternativa se a demanda real estiver pr√≥xima de zero.

V. Portanto, a escolha da m√©trica correta depende do objetivo da an√°lise, e as propriedades de cada m√©trica apresentadas acima justificam as orienta√ß√µes estabelecidas. ‚ñ†

> üí° **Exemplo Comparativo:** Para ilustrar a import√¢ncia da escolha da m√©trica adequada, vamos comparar os erros de dois modelos de previs√£o usando os mesmos dados, e os resultados das m√©tricas s√£o apresentados na tabela abaixo:
>
> | Modelo | MAD | MSE | MAPE (%) | MASE |
> |---|---|---|---|---|
> | Modelo 1 | 7 | 55 | 5.56 | 0.4 |
> | Modelo 2 | 10 | 120 | 7.00 | 0.6 |
>
>
> O Modelo 1 tem um MAD menor, indicando que, em m√©dia, suas previs√µes est√£o mais pr√≥ximas dos valores reais em compara√ß√£o ao Modelo 2. O Modelo 1 tamb√©m tem um MSE menor, o que significa que ele penaliza erros maiores em menor grau que o Modelo 2. Al√©m disso, o Modelo 1 tem um MAPE menor, mostrando que o erro percentual em rela√ß√£o √† demanda √© menor do que no Modelo 2. O modelo 1 tamb√©m apresenta um MASE menor do que o modelo 2, indicando que √© mais preciso que o modelo *naive*. Nesse caso, todas as m√©tricas convergem para o mesmo resultado: o Modelo 1 √© mais preciso que o Modelo 2 para esses dados.
>
> A escolha da m√©trica deve se alinhar aos objetivos espec√≠ficos da an√°lise. Se o foco principal for minimizar a magnitude m√©dia do erro, o MAD √© a m√©trica adequada. Se a prioridade for minimizar grandes erros, o MSE √© mais apropriado. E se o erro precisar ser expresso em termos percentuais, o MAPE ou MASE s√£o adequados, com MASE sendo mais robusto em rela√ß√£o a valores de demanda iguais a zero.

### Conclus√£o
A precis√£o da previs√£o √© um aspecto cr√≠tico na an√°lise de s√©ries temporais. Este cap√≠tulo enfatizou a import√¢ncia de quantificar o erro de previs√£o e introduziu m√©tricas de avalia√ß√£o como MAD, MSE e MAPE [^10]. Al√©m disso, discutiu-se como ajustar as previs√µes para tend√™ncias e sazonalidades [^15, 19]. No contexto da tomada de decis√µes gerenciais, √© fundamental comparar a precis√£o dos diferentes modelos dispon√≠veis para escolher a abordagem mais adequada [^23]. No final, a capacidade de prever a demanda futura de forma precisa √© fundamental para o planejamento e aloca√ß√£o de recursos ideais [^23].

### Refer√™ncias
[^5]: *Time series models assume that past demand data are representative of future demand.*
[^9]: *Forecast error = Actual demand - Forecast.*
[^10]: *Because a forecast predicts future demand, we cannot compare it to actual demand. However, because we have assumed that historical demand is representative of future demand, we can formulate "forecasts of the past" using a particular model and compare those forecasts to historical demand.*
[^12]: *With both the MAD and MSE, the size of the deviations depends on the volume of the item being forecast. For example, if the demand is in thousands of units, the absolute and squared deviations could be quite large. The mean absolute percentage error (MAPE) remedies this problem by expressing the deviation as a percentage of the actual demand.*
[^15]: *Exponential smoothing (ES) is one of the most popular forecasting techniques. It is similar to a WMA technique in the sense that it assigns (a) a weight between 0 and 1 (called the "smoothing constant"), a, to the actual demand in the previous period and (b) a weight (1 ‚Äì a) to the exponential smoothing forecast for the previous period*
[^19]: *In a time series, seasonality is expressed as the amount of deviation between the actual demand values and the average value of the series.*
[^23]: *Forecasting demand is important to be able to plan and allocate the resources necessary to provide uninterrupted, quality customer service and avoid the excess costs arising from mismatched demand and supply.*
<!-- END -->
