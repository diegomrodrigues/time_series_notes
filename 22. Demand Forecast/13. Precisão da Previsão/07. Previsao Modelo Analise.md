## Avalia√ß√£o da Precis√£o da Previs√£o e Sele√ß√£o do Modelo √ìtimo

### Introdu√ß√£o
Em cap√≠tulos anteriores, foram introduzidos modelos de s√©ries temporais e discutidas m√©tricas para avaliar a precis√£o da previs√£o, como MAD, MSE e MAPE [^10, ^12]. Este cap√≠tulo aprofunda o tema, explorando a rela√ß√£o entre a minimiza√ß√£o do erro de previs√£o e a sele√ß√£o do modelo mais apropriado, e a introdu√ß√£o do Erro M√©dio Absoluto Escalonado (MASE) e da Raiz do Erro Quadr√°tico M√©dio (RMSE). O objetivo principal √© identificar como as m√©tricas de erro podem auxiliar na escolha do modelo de previs√£o ideal para uma determinada s√©rie temporal, abordando cen√°rios onde padr√µes como tend√™ncia e sazonalidade podem influenciar a escolha.

### Conceitos Fundamentais
A sele√ß√£o do melhor modelo de previs√£o √© um processo cr√≠tico que envolve a avalia√ß√£o cuidadosa das m√©tricas de erro. Como discutido anteriormente, o erro de previs√£o √© definido como a diferen√ßa entre a demanda real e a previs√£o [^9]:

$$ \text{Erro de Previs√£o} = \text{Demanda Real} - \text{Previs√£o} $$ [^9]

O objetivo central da modelagem de s√©ries temporais √© minimizar esses erros. Modelos mais precisos geralmente exibem erros menores, o que significa que suas previs√µes est√£o mais alinhadas com os valores reais. No entanto, a escolha da m√©trica de erro apropriada √© t√£o importante quanto a minimiza√ß√£o do erro, e a escolha depende das caracter√≠sticas e objetivos da an√°lise [^10, ^12].

#### O Modelo de Previs√£o com os Erros Mais Baixos
A escolha do modelo mais adequado para uma s√©rie temporal envolve a compara√ß√£o do desempenho de diferentes abordagens de previs√£o, o modelo que apresenta os menores erros em geral √© considerado o melhor para aquele conjunto de dados [^10].  Para avaliar a qualidade das previs√µes, utilizamos as seguintes m√©tricas de erro:

1.  **Desvio Absoluto M√©dio (MAD):** O MAD mede a m√©dia dos erros absolutos de previs√£o, fornecendo uma vis√£o da magnitude do erro em unidades absolutas [^10].
    $$ \text{MAD} = \frac{\sum |\text{Demanda Real} - \text{Previs√£o}|}{n} $$ [^10]

2.  **Erro Quadr√°tico M√©dio (MSE):** O MSE mede a m√©dia dos quadrados dos erros, penalizando erros maiores de forma mais significativa [^12].
    $$ \text{MSE} = \frac{\sum (\text{Demanda Real} - \text{Previs√£o})^2}{n} $$ [^12]
   
3.  **Raiz do Erro Quadr√°tico M√©dio (RMSE):** O RMSE √© a raiz quadrada do MSE, fornecendo uma interpreta√ß√£o na mesma unidade dos dados originais.
    
       $$ \text{RMSE} = \sqrt{\frac{\sum (\text{Demanda Real} - \text{Previs√£o})^2}{n}} $$

4.  **Erro Percentual Absoluto M√©dio (MAPE):** O MAPE expressa o erro como uma porcentagem da demanda real, contornando a depend√™ncia do volume do MAD e do MSE [^12].
    $$ \text{MAPE} = \frac{\sum \left|\frac{\text{Demanda Real} - \text{Previs√£o}}{\text{Demanda Real}}\right|}{n} \times 100 $$ [^12]

5. **Erro M√©dio Absoluto Escalonado (MASE):** O MASE compara o desempenho do modelo em rela√ß√£o a um modelo *naive*, com especial import√¢ncia quando a demanda pode ser pr√≥xima de zero.
    $$ \text{MASE} = \frac{\frac{1}{n} \sum_{t=1}^{n} |y_t - \hat{y}_t|}{\frac{1}{n-1}\sum_{t=2}^{n}|y_t - y_{t-1}|} $$
    onde $y_t$ √© a demanda real, $\hat{y}_t$ √© a previs√£o, e *n* √© o n√∫mero de per√≠odos [^1].
    
**Observa√ß√£o 5.1:** O denominador do MASE, $\frac{1}{n-1}\sum_{t=2}^{n}|y_t - y_{t-1}|$, representa o erro absoluto m√©dio de um modelo *naive*, que usa a observa√ß√£o mais recente como previs√£o. Em cen√°rios onde a s√©rie temporal n√£o apresenta varia√ß√µes significativas, o MASE pode assumir valores pr√≥ximos de zero, o que indica que o modelo *naive* tem um desempenho semelhante ao modelo testado.

> üí° **Exemplo Num√©rico:**
> Vamos considerar uma s√©rie temporal com os seguintes valores de demanda real e previs√µes para 5 per√≠odos:
>
> | Per√≠odo | Demanda Real ($y_t$) | Previs√£o ($\hat{y}_t$) |
> |---|---|---|
> | 1 | 10 | 12 |
> | 2 | 15 | 13 |
> | 3 | 20 | 18 |
> | 4 | 25 | 26 |
> | 5 | 30 | 28 |
>
> **C√°lculo do MAD:**
>
> $\text{MAD} = \frac{|10-12| + |15-13| + |20-18| + |25-26| + |30-28|}{5} = \frac{2+2+2+1+2}{5} = \frac{9}{5} = 1.8$
>
> **C√°lculo do MSE:**
>
> $\text{MSE} = \frac{(10-12)^2 + (15-13)^2 + (20-18)^2 + (25-26)^2 + (30-28)^2}{5} = \frac{4+4+4+1+4}{5} = \frac{17}{5} = 3.4$
>
> **C√°lculo do RMSE:**
>
> $\text{RMSE} = \sqrt{3.4} \approx 1.84$
>
> **C√°lculo do MAPE:**
>
> $\text{MAPE} = \frac{\left|\frac{10-12}{10}\right| + \left|\frac{15-13}{15}\right| + \left|\frac{20-18}{20}\right| + \left|\frac{25-26}{25}\right| + \left|\frac{30-28}{30}\right|}{5} \times 100 = \frac{0.2 + 0.133 + 0.1 + 0.04 + 0.066}{5} \times 100 = 0.1078 \times 100 \approx 10.78\%$
>
> **C√°lculo do MASE:**
>
> Primeiro, calculamos o erro absoluto m√©dio do modelo *naive*:
>
> $\text{Erro Naive} = \frac{|15-10| + |20-15| + |25-20| + |30-25|}{4} = \frac{5+5+5+5}{4} = \frac{20}{4} = 5$
>
> Agora, podemos calcular o MASE:
>
> $\text{MASE} = \frac{\frac{9}{5}}{5} = \frac{1.8}{5} = 0.36$
>
> Neste exemplo, podemos observar como as diferentes m√©tricas de erro capturam diferentes aspectos do desempenho do modelo de previs√£o. O MAD e o RMSE fornecem uma vis√£o da magnitude do erro, o MAPE o erro relativo, e o MASE o compara com um modelo *naive*.

#### A Import√¢ncia da Escolha da M√©trica de Erro
A escolha da m√©trica de erro apropriada depende do objetivo da an√°lise e das caracter√≠sticas dos dados. O MAD √© √∫til para entender a magnitude dos erros em termos absolutos; o MSE √© mais apropriado quando grandes erros s√£o indesej√°veis e devem ser penalizados mais fortemente; o RMSE expressa o erro na unidade original, e tamb√©m penaliza grandes erros; e o MAPE √© √∫til quando o erro relativo √© de maior interesse ou quando a magnitude da demanda varia entre diferentes per√≠odos [^10, ^12]. O MASE √© √∫til quando se deseja avaliar o modelo em compara√ß√£o com um modelo *naive*, especialmente quando a demanda pode ser pr√≥xima a zero. A escolha da m√©trica afeta diretamente a sele√ß√£o do modelo, dado que os modelos podem apresentar erros diferentes de acordo com as diferentes m√©tricas [^10, ^12].

**Lema 5.1:** A sele√ß√£o da m√©trica de erro apropriada depende dos objetivos da an√°lise e das propriedades da s√©rie temporal.
   
**Prova:**
I.  O MAD fornece uma vis√£o geral da magnitude do erro em unidades absolutas, sendo √∫til quando o foco principal √© entender o erro m√©dio das previs√µes [^10].
II. O MSE penaliza mais os erros maiores, sendo adequado quando esses erros devem ser evitados, ou seja, quando s√£o mais dispendiosos ou cr√≠ticos [^12].
III. O RMSE oferece uma interpreta√ß√£o do erro na mesma unidade dos dados originais, e tamb√©m penaliza grandes erros, como o MSE.
IV. O MAPE expressa o erro como uma porcentagem da demanda real, tornando-o √∫til para comparar a precis√£o em diferentes escalas de demanda [^12], mas pode apresentar problemas se a demanda real for pr√≥xima de zero.
V. O MASE compara o desempenho do modelo com um modelo *naive*, sendo √∫til em todos os casos, mas principalmente quando o MAPE pode gerar valores indefinidos devido a demandas pr√≥ximas a zero.
VI. Portanto, a escolha da m√©trica de erro depende dos objetivos da an√°lise e das propriedades dos dados, e uma abordagem de avalia√ß√£o completa deve considerar m√∫ltiplas m√©tricas de erro [^10, ^12]. $\blacksquare$

#### Impacto de Valores Pesados ou Altos de $\alpha$
Modelos como a m√©dia m√≥vel ponderada (WMA) e a suaviza√ß√£o exponencial utilizam par√¢metros como os pesos e o fator de suaviza√ß√£o $\alpha$ para ajustar a import√¢ncia dos dados mais recentes em rela√ß√£o aos dados mais antigos [^9].
Valores mais altos de  $\alpha$ na suaviza√ß√£o exponencial ou pesos maiores nos dados mais recentes na WMA d√£o mais √™nfase aos valores mais recentes na s√©rie temporal [^9]. Se tais valores levam a previs√µes mais precisas, √© prov√°vel que a s√©rie temporal apresente um padr√£o, como tend√™ncia ou sazonalidade. Um modelo que leve em considera√ß√£o explicitamente esses padr√µes pode ser mais apropriado para esses casos [^15, ^19].

> üí° **Exemplo Num√©rico:**
> Imagine que temos uma s√©rie temporal de vendas de um produto ao longo de 6 semanas:
>
> | Semana | Vendas Reais |
> |---|---|
> | 1 | 100 |
> | 2 | 110 |
> | 3 | 125 |
> | 4 | 145 |
> | 5 | 170 |
> | 6 | 200 |
>
> Vamos comparar dois modelos de suaviza√ß√£o exponencial simples (SES): um com $\alpha = 0.2$ e outro com $\alpha = 0.8$. As previs√µes s√£o geradas utilizando o valor inicial como o primeiro valor real, e as previs√µes seguintes s√£o calculadas utilizando a f√≥rmula da suaviza√ß√£o exponencial:
>
>  $\hat{y}_{t} = \alpha y_{t-1} + (1-\alpha)\hat{y}_{t-1}$
>
> | Semana | Vendas Reais | SES ($\alpha=0.2$) | SES ($\alpha=0.8$) |
> |---|---|---|---|
> | 1 | 100 | 100 | 100 |
> | 2 | 110 | 100 | 100 |
> | 3 | 125 | 102 | 108 |
> | 4 | 145 | 106.6 | 121 |
> | 5 | 170 | 114.3 | 140.8 |
> | 6 | 200 | 125.4 | 164.16 |
>
> Agora, calculamos o MAPE para cada modelo:
>
> MAPE $(\alpha=0.2) = \frac{|100-100|/100 + |110-100|/110 + |125-102|/125 + |145-106.6|/145 + |170-114.3|/170 + |200-125.4|/200 }{6} \times 100 \approx 18.59\%$
>
> MAPE $(\alpha=0.8) = \frac{|100-100|/100 + |110-100|/110 + |125-108|/125 + |145-121|/145 + |170-140.8|/170 + |200-164.16|/200 }{6} \times 100 \approx 9.94\%$
>
> O modelo com $\alpha = 0.8$ apresenta um MAPE menor, o que significa que ele se adapta melhor aos dados e que h√° um padr√£o de tend√™ncia, pois o modelo com maior $\alpha$ performa melhor. Isso sugere que os valores mais recentes t√™m mais influ√™ncia sobre as previs√µes futuras do que os valores mais antigos.
>
> A intui√ß√£o por tr√°s desse exemplo √© que um valor maior de  $\alpha$ na suaviza√ß√£o exponencial faz com que a previs√£o seja mais sens√≠vel √†s mudan√ßas recentes nos dados. Se a s√©rie temporal tem uma tend√™ncia, ou seja, um padr√£o crescente ou decrescente, os valores mais recentes devem ter mais peso. Isso √© o que acontece com $\alpha = 0.8$, enquanto com $\alpha = 0.2$ o modelo √© mais lento para se ajustar a novas mudan√ßas.

**Lema 5.2:** Se valores pesados ou altos de $\alpha$ resultam em previs√µes mais precisas, a s√©rie temporal provavelmente apresenta padr√µes de tend√™ncia ou sazonalidade.
**Prova:**
I. Valores pesados na WMA ou altos de $\alpha$ na suaviza√ß√£o exponencial d√£o mais peso aos dados recentes.
II. Se tais valores levam a melhores previs√µes, isso implica que a demanda recente cont√©m informa√ß√µes importantes sobre a demanda futura, enquanto os dados mais antigos s√£o menos relevantes.
III. A presen√ßa de tend√™ncia implica que os dados recentes s√£o, em geral, maiores ou menores do que os dados mais antigos, com um padr√£o de crescimento ou decl√≠nio ao longo do tempo.
IV. A presen√ßa de sazonalidade implica que os dados recentes s√£o maiores ou menores que os dados de per√≠odos similares, com um padr√£o c√≠clico que se repete.
V. Portanto, se as m√©tricas de erro mostram que modelos mais reativos aos dados recentes (com valores pesados ou altos de $\alpha$) s√£o melhores, ent√£o a s√©rie temporal provavelmente apresenta padr√µes de tend√™ncia ou sazonalidade [^15, ^19]. $\blacksquare$

#### Modelos Mais Apropriados para Tend√™ncia e Sazonalidade
Modelos como a m√©dia m√≥vel simples (SMA) e a suaviza√ß√£o exponencial simples (ES) n√£o s√£o capazes de capturar os efeitos de tend√™ncia e sazonalidade. Quando tais padr√µes est√£o presentes, modelos mais apropriados devem ser utilizados [^15, ^19].
1.  **Suaviza√ß√£o Exponencial com Ajuste de Tend√™ncia (TAES):** O TAES incorpora um segundo par√¢metro de suaviza√ß√£o  $\beta$ para ajustar a tend√™ncia na s√©rie temporal [^15].

2.  **Modelos Lineares com Decomposi√ß√£o Sazonal:** A decomposi√ß√£o de s√©ries temporais atrav√©s de modelos lineares como a regress√£o linear com ajuste sazonal √© outra abordagem √∫til, que envolve identificar e remover as componentes de tend√™ncia e sazonalidade da s√©rie temporal para que o modelo possa ser constru√≠do na s√©rie deseasonalizada [^19].

3.  **Modelos Auto-Regressivos Integrados de M√©dias M√≥veis (ARIMA):** Os modelos ARIMA s√£o uma classe de modelos de s√©ries temporais que podem acomodar tanto a tend√™ncia quanto a sazonalidade [^1]. Esses modelos t√™m a capacidade de capturar a autocorrela√ß√£o nos dados, e s√£o √∫teis em modelagem de s√©ries temporais.

**Corol√°rio 5.1:** Quando modelos mais reativos aos dados recentes (WMA com pesos maiores nos dados recentes ou suaviza√ß√£o exponencial com $\alpha$ alto) apresentam um desempenho melhor, modelos que levam em considera√ß√£o explicitamente a presen√ßa de tend√™ncia e sazonalidade podem gerar previs√µes mais precisas.

**Prova:**
I. Modelos reativos como WMA com maior peso em dados recentes e suaviza√ß√£o exponencial com $\alpha$ alto d√£o mais import√¢ncia aos dados mais recentes da s√©rie.
II. Se esses modelos s√£o mais precisos, significa que dados mais recentes cont√©m informa√ß√µes relevantes sobre a demanda futura, o que √© indicativo da presen√ßa de padr√µes temporais como tend√™ncia ou sazonalidade.
III. Modelos como a m√©dia m√≥vel simples (SMA) e a suaviza√ß√£o exponencial simples (ES) n√£o ajustam explicitamente esses padr√µes, o que resulta em um desempenho inferior.
IV. Modelos como TAES, regress√£o linear com ajuste sazonal e ARIMA levam em conta a tend√™ncia e a sazonalidade.

V. Portanto, quando modelos mais reativos s√£o mais precisos, modelos que modelam explicitamente a tend√™ncia e a sazonalidade podem ser mais apropriados, pois exploram esses padr√µes para gerar previs√µes mais precisas. $\blacksquare$

**Teorema 5.1** A sele√ß√£o do modelo ideal de previs√£o envolve a an√°lise comparativa de m√∫ltiplas m√©tricas de erro e a identifica√ß√£o de padr√µes na s√©rie temporal.
**Prova:**
I. A an√°lise de m√©tricas de erro como MAD, MSE, RMSE, MAPE e MASE fornece diferentes perspectivas sobre o desempenho do modelo. O MAD e o RMSE avaliam o erro em unidades absolutas, enquanto o MAPE oferece uma vis√£o relativa, e o MASE compara o desempenho do modelo com um modelo *naive*.
II. A compara√ß√£o do desempenho de diferentes modelos de previs√£o, usando as m√©tricas de erro, permite identificar o modelo que melhor se ajusta aos dados.
III. Modelos reativos a dados recentes podem indicar a presen√ßa de padr√µes temporais como tend√™ncia e sazonalidade, que podem ser melhor modelados por modelos espec√≠ficos, como TAES, modelos lineares com ajuste sazonal, e ARIMA.
IV. Portanto, a sele√ß√£o do modelo ideal envolve a compara√ß√£o de m√∫ltiplas m√©tricas de erro, a identifica√ß√£o de padr√µes, e a escolha do modelo mais apropriado para o caso em quest√£o. $\blacksquare$

> üí° **Exemplo Num√©rico:**
> Vamos supor que estamos analisando as vendas mensais de um produto em uma loja de varejo. Vamos comparar dois modelos: um modelo de suaviza√ß√£o exponencial simples com $\alpha = 0.2$ (modelo 1) e um modelo de suaviza√ß√£o exponencial simples com $\alpha = 0.8$ (modelo 2). Os dados s√£o para os meses 1 a 6:
>
> | M√™s | Demanda Real | Previs√£o (Modelo 1) | Previs√£o (Modelo 2) |
> |---|---|---|---|
> | 1 | 100 | 100 | 100|
> | 2 | 120 | 100 | 100|
> | 3 | 150 | 104 | 130|
> | 4 | 180 | 113.2 | 164|
> | 5 | 220 | 126.56 | 176.8|
> | 6 | 260 | 145.248 | 211.36|
>
> Vamos calcular o MAPE para cada modelo:
>
> $\text{Modelo 1: MAPE} = \frac{\left|\frac{100-100}{100}\right| + \left|\frac{120-100}{120}\right| + \left|\frac{150-104}{150}\right| + \left|\frac{180-113.2}{180}\right| + \left|\frac{220-126.56}{220}\right| + \left|\frac{260-145.248}{260}\right|}{6} \times 100 \approx 22.56\%$
> $\text{Modelo 2: MAPE} =  \frac{\left|\frac{100-100}{100}\right| + \left|\frac{120-100}{120}\right| + \left|\frac{150-130}{150}\right| + \left|\frac{180-164}{180}\right| + \left|\frac{220-176.8}{220}\right| + \left|\frac{260-211.36}{260}\right|}{6} \times 100 \approx 10.54\%$
>
> O Modelo 2 com  $\alpha = 0.8$ apresenta um MAPE menor, indicando que ele se ajusta melhor aos dados e, portanto, um padr√£o de tend√™ncia est√° presente. Nesse cen√°rio, a sugest√£o seria testar modelos como o TAES ou regress√£o linear com ajuste sazonal.

### Conclus√£o
Este cap√≠tulo destacou a import√¢ncia de selecionar o modelo de previs√£o com base na an√°lise de diferentes m√©tricas de erro e de como modelos mais reativos a dados recentes podem indicar a presen√ßa de padr√µes que requerem modelos que se ajustam a tend√™ncia ou sazonalidade. O MAD mede a magnitude do erro, o MSE penaliza grandes erros, o RMSE avalia o erro na unidade dos dados originais, o MAPE expressa o erro em termos relativos, e o MASE compara o desempenho com um modelo *naive*. A avalia√ß√£o da precis√£o da previs√£o √© essencial para a escolha do modelo mais adequado, e uma an√°lise abrangente deve considerar diversas m√©tricas de erro, levando em conta os objetivos da an√°lise e as propriedades da s√©rie temporal. A escolha da m√©trica e do modelo √© um passo crucial para garantir previs√µes precisas, o que √© fundamental para o planejamento eficiente e a aloca√ß√£o de recursos [^23].

### Refer√™ncias
[^1]: As refer√™ncias est√£o contidas nos t√≥picos anteriores.
[^5]: *Time series models assume that past demand data are representative of future demand.*
[^9]: *Forecast error = Actual demand - Forecast.*
[^10]: *Because a forecast predicts future demand, we cannot compare it to actual demand. However, because we have assumed that historical demand is representative of future demand, we can formulate "forecasts of the past" using a particular model and compare those forecasts to historical demand.*
[^12]: *With both the MAD and MSE, the size of the deviations depends on the volume of the item being forecast. For example, if the demand is in thousands of units, the absolute and squared deviations could be quite large. The mean absolute percentage error (MAPE) remedies this problem by expressing the deviation as a percentage of the actual demand.*
[^15]: *Exponential smoothing (ES) is one of the most popular forecasting techniques. It is similar to a WMA technique in the sense that it assigns (a) a weight between 0 and 1 (called the "smoothing constant"), a, to the actual demand in the previous period and (b) a weight (1 ‚Äì a) to the exponential smoothing forecast for the previous period*
[^19]: *In a time series, seasonality is expressed as the amount of deviation between the actual demand values and the average value of the series.*
[^23]: *Forecasting demand is important to be able to plan and allocate the resources necessary to provide uninterrupted, quality customer service and avoid the excess costs arising from mismatched demand and supply.*
<!-- END -->
