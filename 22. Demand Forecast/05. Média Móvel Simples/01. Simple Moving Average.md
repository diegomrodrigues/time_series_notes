## M√©dia M√≥vel Simples (SMA) e suas Propriedades em S√©ries Temporais

### Introdu√ß√£o
Este cap√≠tulo explora em profundidade a t√©cnica de **M√©dia M√≥vel Simples (SMA)**, uma ferramenta fundamental na an√°lise de s√©ries temporais, com foco em suas propriedades matem√°ticas, estabilidade, capacidade de resposta e aplica√ß√µes. A SMA √© um m√©todo intuitivo e amplamente utilizado para suavizar dados de s√©ries temporais e realizar previs√µes de curto prazo, sendo crucial em contextos onde a demanda √© vari√°vel [^1]. Expandindo o conceito apresentado anteriormente [^2], este cap√≠tulo visa fornecer uma compreens√£o abrangente da SMA para um p√∫blico com conhecimento avan√ßado em matem√°tica, modelos estat√≠sticos, otimiza√ß√£o e an√°lise de dados.

### Conceitos Fundamentais
A **M√©dia M√≥vel Simples (SMA)** √© uma t√©cnica de previs√£o que calcula a m√©dia da demanda ao longo de um determinado n√∫mero de per√≠odos passados para prever a demanda no pr√≥ximo per√≠odo [^1]. A ess√™ncia da SMA reside na sua capacidade de suavizar flutua√ß√µes irregulares em dados de s√©ries temporais, fornecendo uma vis√£o mais clara da tend√™ncia subjacente [^1]. Formalmente, a f√≥rmula para calcular uma SMA em um per√≠odo $t$ √© dada por:

$$
SMA_t = \frac{A_{t-1} + A_{t-2} + \ldots + A_{t-n}}{n}
$$

onde:
- $SMA_t$ representa a m√©dia m√≥vel simples no per√≠odo $t$.
- $A_{t-1}$, $A_{t-2}$, ..., $A_{t-n}$ s√£o os valores da demanda nos $n$ per√≠odos anteriores.
- $n$ √© o n√∫mero de per√≠odos inclu√≠dos no c√°lculo da m√©dia m√≥vel [^1].

> üí° **Exemplo Num√©rico:** Suponha que temos os seguintes dados de demanda para os √∫ltimos 5 dias: 20, 22, 25, 23, 28. Se quisermos calcular a SMA para os √∫ltimos 3 dias (n=3) para prever o pr√≥ximo dia, o c√°lculo seria:
>
>  $SMA_5 = \frac{25 + 23 + 28}{3} = \frac{76}{3} \approx 25.33$
>
>  Assim, a previs√£o para o pr√≥ximo per√≠odo (dia 6) seria de aproximadamente 25.33.

**Estabilidade e Responsividade**
Um aspecto crucial da SMA √© o equil√≠brio entre **estabilidade** e **responsividade** [^1]. A estabilidade refere-se √† capacidade do modelo de n√£o reagir excessivamente a flutua√ß√µes aleat√≥rias nos dados, enquanto a responsividade se refere √† sua habilidade de reagir rapidamente a mudan√ßas reais na demanda. A escolha do par√¢metro $n$, o n√∫mero de per√≠odos na m√©dia, influencia diretamente essas duas propriedades [^1].

**Efeito do N√∫mero de Per√≠odos (n)**
- **Aumento de n:** Ao aumentar o valor de $n$, o modelo torna-se mais est√°vel, pois a m√©dia √© calculada sobre um n√∫mero maior de per√≠odos. Isso suaviza as flutua√ß√µes irregulares, mas tamb√©m reduz a capacidade do modelo de reagir rapidamente a mudan√ßas de tend√™ncia [^1].
- **Diminui√ß√£o de n:** Por outro lado, ao diminuir $n$, o modelo torna-se mais responsivo, pois a m√©dia √© calculada sobre menos per√≠odos. Isso permite que o modelo se adapte rapidamente a mudan√ßas de tend√™ncia, mas tamb√©m aumenta a sensibilidade a flutua√ß√µes aleat√≥rias [^1].

> üí° **Exemplo Num√©rico:** Considere a seguinte s√©rie temporal: 10, 12, 15, 13, 16, 20, 22, 18, 25, 28. Vamos calcular as SMAs com n=3 e n=5:
>
>   **SMA com n=3:**
>   - SMA_4 = (15 + 13 + 16) / 3 = 14.67
>   - SMA_5 = (13 + 16 + 20) / 3 = 16.33
>   - SMA_6 = (16 + 20 + 22) / 3 = 19.33
>   - ...
>
>   **SMA com n=5:**
>   - SMA_6 = (10 + 12 + 15 + 13 + 16) / 5 = 13.2
>   - SMA_7 = (12 + 15 + 13 + 16 + 20) / 5 = 15.2
>   - SMA_8 = (15 + 13 + 16 + 20 + 22) / 5 = 17.2
>   - ...
>
>   Observamos que a SMA com n=3 (menor) reage mais rapidamente √†s mudan√ßas nos dados, enquanto a SMA com n=5 (maior) √© mais suave e est√°vel, mas menos responsiva a varia√ß√µes r√°pidas.

**An√°lise da Estabilidade por Frequ√™ncia de Resson√¢ncia**
A estabilidade de um modelo de m√©dia m√≥vel pode ser formalmente avaliada por meio da an√°lise de frequ√™ncia de resson√¢ncia [^2]. Ao considerar a SMA como um filtro linear, a resposta em frequ√™ncia do filtro pode ser analisada. A frequ√™ncia de resson√¢ncia, neste contexto, indicaria as frequ√™ncias em que o filtro amplifica ou atenua os sinais. Em uma SMA, frequ√™ncias mais altas, correspondentes a varia√ß√µes r√°pidas e aleat√≥rias, s√£o atenuadas devido √† natureza da m√©dia, enquanto frequ√™ncias mais baixas, correspondentes a tend√™ncias mais lentas, s√£o transmitidas sem tanta atenua√ß√£o. Este comportamento de filtro passa-baixa demonstra como a SMA estabiliza o modelo, suavizando componentes de alta frequ√™ncia.

**Lema 1**
A resposta em frequ√™ncia de um filtro de m√©dia m√≥vel simples de tamanho $n$ pode ser expressa como:

$$
H(f) = \frac{1}{n} \frac{\sin(\pi f n)}{\sin(\pi f)}e^{-j\pi f(n-1)}
$$

onde $f$ representa a frequ√™ncia normalizada entre 0 e 1, e $j$ √© a unidade imagin√°ria.

*Demonstra√ß√£o:*
A fun√ß√£o de transfer√™ncia da SMA √© dada pela transformada Z do kernel da m√©dia m√≥vel, que √© um pulso retangular de largura $n$ e amplitude 1/n. A transformada de Fourier deste pulso √© dada por uma fun√ß√£o sinc modificada e um termo de fase linear que representa um atraso de (n-1)/2 amostras. Ao substituir $z = e^{j2\pi f}$ na transformada Z, obtemos a resposta em frequ√™ncia $H(f)$.

I. A fun√ß√£o de transfer√™ncia de um filtro de m√©dia m√≥vel de tamanho $n$ no dom√≠nio do tempo √© dada por:
    $$ h[k] = \begin{cases} \frac{1}{n}, & 0 \leq k \leq n-1 \\ 0, & \text{caso contr√°rio} \end{cases} $$
    Isso representa um pulso retangular de amplitude $\frac{1}{n}$ com dura√ß√£o de $n$ amostras.

II. A transformada Z de $h[k]$ √© definida como:
    $$ H(z) = \sum_{k=-\infty}^{\infty} h[k]z^{-k} $$
    Substituindo os valores de $h[k]$:
    $$ H(z) = \sum_{k=0}^{n-1} \frac{1}{n}z^{-k} = \frac{1}{n} \sum_{k=0}^{n-1} (z^{-1})^k $$
    Esta √© a soma de uma s√©rie geom√©trica finita.

III. Utilizando a f√≥rmula para a soma de uma s√©rie geom√©trica $\sum_{k=0}^{n-1} r^k = \frac{1-r^n}{1-r}$, temos:
    $$ H(z) = \frac{1}{n} \frac{1 - (z^{-1})^n}{1 - z^{-1}} = \frac{1}{n} \frac{1 - z^{-n}}{1 - z^{-1}} $$

IV. Para obter a resposta em frequ√™ncia, substitu√≠mos $z = e^{j2\pi f}$:
    $$ H(f) = \frac{1}{n} \frac{1 - e^{-j2\pi f n}}{1 - e^{-j2\pi f}} $$

V. Multiplicamos o numerador e o denominador por $e^{j\pi f n}$ e $e^{j\pi f}$, respectivamente:
    $$ H(f) = \frac{1}{n} \frac{e^{j\pi f n} - e^{-j\pi f n}}{e^{j\pi f} - e^{-j\pi f}} \cdot \frac{e^{-j\pi f n}}{e^{-j\pi f}} = \frac{1}{n} \frac{2j\sin(\pi f n)}{2j\sin(\pi f)} e^{-j\pi f(n-1)} $$

VI. Simplificando, obtemos:
    $$ H(f) = \frac{1}{n} \frac{\sin(\pi f n)}{\sin(\pi f)}e^{-j\pi f(n-1)} $$
Portanto, a resposta em frequ√™ncia do filtro de m√©dia m√≥vel √© dada pela express√£o acima. ‚ñ†

> üí° **Exemplo Num√©rico:** Considere uma SMA com n=5. Vamos avaliar a magnitude da resposta em frequ√™ncia |H(f)| para algumas frequ√™ncias normalizadas (f)  usando a express√£o derivada no Lema 1:
>
> Para f=0.1:
> $|H(0.1)| = \left| \frac{1}{5} \frac{\sin(5\pi * 0.1)}{\sin(\pi * 0.1)} \right| = \left| \frac{1}{5} \frac{\sin(0.5\pi)}{\sin(0.1\pi)} \right| \approx  \left| \frac{1}{5} \frac{1}{0.309} \right| \approx 0.647$
>
> Para f=0.2:
> $|H(0.2)| = \left| \frac{1}{5} \frac{\sin(5\pi * 0.2)}{\sin(\pi * 0.2)} \right| = \left| \frac{1}{5} \frac{\sin(\pi)}{\sin(0.2\pi)} \right| = 0$
>
> Para f=0.3:
> $|H(0.3)| = \left| \frac{1}{5} \frac{\sin(5\pi * 0.3)}{\sin(\pi * 0.3)} \right| = \left| \frac{1}{5} \frac{\sin(1.5\pi)}{\sin(0.3\pi)} \right| \approx \left| \frac{1}{5} \frac{-1}{0.809} \right| \approx 0.247$
>
>
> Este exemplo mostra que a magnitude da resposta em frequ√™ncia da SMA diminui √† medida que a frequ√™ncia aumenta, indicando que ela atua como um filtro passa-baixa. Frequ√™ncias mais baixas (como f=0.1) s√£o menos atenuadas, enquanto frequ√™ncias mais altas (como f=0.3) s√£o mais atenuadas. A frequ√™ncia f=0.2 √© completamente atenuada no caso de n=5 devido √† fun√ß√£o seno no numerador.
>
>```mermaid
>graph LR
>    A["Frequ√™ncia (f)"] --> B("Magnitude da Resposta |H(f)|");
>    B --> C{"f=0.1: |H(f)| ~ 0.647"};
>    B --> D{"f=0.2: |H(f)| = 0"};
>    B --> E{"f=0.3: |H(f)| ~ 0.247"};
>```

**SMA e Espa√ßos de Hilbert**
No contexto de an√°lise de s√©ries temporais em espa√ßos de Hilbert, a opera√ß√£o de m√©dia m√≥vel pode ser vista como uma opera√ß√£o de **convolu√ß√£o**. Em espa√ßos de Hilbert, uma s√©rie temporal $x[n]$ pode ser representada como um vetor, e a opera√ß√£o da SMA pode ser implementada por uma convolu√ß√£o com um kernel $h[n]$, onde $h[n]$ √© um filtro de m√©dia m√≥vel com tamanho $n$. Matematicamente, a convolu√ß√£o √© dada por:

$$
y[n] = \sum_{k=-\infty}^{\infty} h[k]x[n-k]
$$

onde:
- $y[n]$ √© a s√©rie temporal suavizada pela SMA.
- $h[k]$ √© o filtro de m√©dia m√≥vel, que tem valores iguais a $1/n$ para $0 \leq k < n$ e 0 para outros valores.

Esta representa√ß√£o em espa√ßos de Hilbert permite analisar a **frequ√™ncia dos processos estoc√°sticos** subjacentes √† s√©rie temporal, utilizando ferramentas como a Transformada de Fourier. A an√°lise espectral da SMA como filtro de convolu√ß√£o em um espa√ßo de Hilbert demonstra a maneira pela qual a SMA suaviza as componentes de alta frequ√™ncia de uma s√©rie temporal.

**Proposi√ß√£o 1**
A Transformada de Fourier da sa√≠da $y[n]$ de uma SMA aplicada a uma s√©rie temporal $x[n]$ √© dada por:
$$
Y(f) = H(f)X(f)
$$
onde $X(f)$ e $Y(f)$ s√£o as transformadas de Fourier de $x[n]$ e $y[n]$, respectivamente, e $H(f)$ √© a resposta em frequ√™ncia do filtro SMA conforme definida no Lema 1.

*Demonstra√ß√£o:*
Esta proposi√ß√£o decorre diretamente da propriedade da convolu√ß√£o no dom√≠nio da frequ√™ncia. A convolu√ß√£o no dom√≠nio do tempo corresponde √† multiplica√ß√£o no dom√≠nio da frequ√™ncia. Portanto, se $y[n]$ √© obtido pela convolu√ß√£o de $x[n]$ com o kernel $h[n]$ da SMA, ent√£o a transformada de Fourier de $y[n]$, $Y(f)$, √© o produto da transformada de Fourier de $x[n]$, $X(f)$, com a transformada de Fourier de $h[n]$, que √© a resposta em frequ√™ncia $H(f)$ do filtro SMA.

I.  Seja $x[n]$ uma sequ√™ncia de entrada e $h[n]$ o kernel de um filtro de m√©dia m√≥vel. A sa√≠da $y[n]$ √© obtida pela convolu√ß√£o de $x[n]$ e $h[n]$:
     $$y[n] = \sum_{k=-\infty}^{\infty} h[k]x[n-k] = x[n] * h[n]$$

II.  Tomando a Transformada de Fourier de ambos os lados da equa√ß√£o, e usando a propriedade da Transformada de Fourier que afirma que a Transformada de Fourier da convolu√ß√£o de duas sequ√™ncias √© o produto das Transformadas de Fourier das sequ√™ncias:
    $$ \mathcal{F}\{y[n]\} = \mathcal{F}\{x[n] * h[n]\} = \mathcal{F}\{x[n]\} \cdot \mathcal{F}\{h[n]\} $$

III.  Denotando as Transformadas de Fourier de $x[n]$, $y[n]$ e $h[n]$ por $X(f)$, $Y(f)$ e $H(f)$, respectivamente, obtemos:
    $$Y(f) = X(f)H(f)$$
    Portanto, a Transformada de Fourier da sa√≠da $y[n]$ √© o produto da Transformada de Fourier da entrada $x[n]$ e da resposta em frequ√™ncia do filtro $h[n]$.
    
    ‚ñ†

> üí° **Exemplo Num√©rico:**  Suponha que temos uma s√©rie temporal discreta $x[n]$ e queremos aplicar uma SMA com n=3.  O kernel $h[n]$ seria [1/3, 1/3, 1/3]. A convolu√ß√£o no dom√≠nio do tempo seria:
>
>   $y[n] = \frac{1}{3}x[n] + \frac{1}{3}x[n-1] + \frac{1}{3}x[n-2]$
>
>   Se a transformada de Fourier de $x[n]$ fosse $X(f)$, ent√£o a transformada de Fourier da sa√≠da $Y(f)$ seria:
>
>   $Y(f) = H(f)X(f)$
>
>   Onde H(f) seria a resposta de frequ√™ncia da SMA com n=3, calculada como no Lema 1, que vai atenuar as altas frequ√™ncias de $X(f)$ em $Y(f)$.

**Corol√°rio 1.1**
A pot√™ncia do sinal de sa√≠da $y[n]$ numa determinada frequ√™ncia $f$ √© atenuada ou amplificada em rela√ß√£o √† pot√™ncia do sinal de entrada $x[n]$ nessa mesma frequ√™ncia, pelo fator $|H(f)|^2$.

*Demonstra√ß√£o:*
O corol√°rio segue diretamente da Proposi√ß√£o 1. Se a pot√™ncia do sinal em $f$ for proporcional a $|X(f)|^2$ para $x[n]$ e $|Y(f)|^2$ para $y[n]$, e como $Y(f) = H(f)X(f)$, ent√£o $|Y(f)|^2 = |H(f)|^2|X(f)|^2$. Portanto, a rela√ß√£o entre a pot√™ncia de sa√≠da e entrada na frequ√™ncia $f$ √© dada pelo quadrado da magnitude da resposta em frequ√™ncia do filtro SMA, $|H(f)|^2$.

I. Da Proposi√ß√£o 1, temos:
    $$Y(f) = H(f)X(f)$$

II. A pot√™ncia de um sinal no dom√≠nio da frequ√™ncia √© proporcional ao quadrado da magnitude da sua Transformada de Fourier. Portanto, a pot√™ncia do sinal de entrada na frequ√™ncia $f$ √© proporcional a $|X(f)|^2$ e a pot√™ncia do sinal de sa√≠da na frequ√™ncia $f$ √© proporcional a $|Y(f)|^2$.

III. Tomando a magnitude ao quadrado da equa√ß√£o em (I), temos:
    $$|Y(f)|^2 = |H(f)X(f)|^2 = |H(f)|^2 |X(f)|^2$$

IV.  Assim, a pot√™ncia do sinal de sa√≠da na frequ√™ncia $f$, $|Y(f)|^2$, √© igual √† pot√™ncia do sinal de entrada na frequ√™ncia $f$, $|X(f)|^2$, multiplicada pelo quadrado da magnitude da resposta em frequ√™ncia do filtro SMA, $|H(f)|^2$.
    
V. Portanto, a pot√™ncia do sinal de sa√≠da $y[n]$ em uma dada frequ√™ncia $f$ √© atenuada ou amplificada em rela√ß√£o √† pot√™ncia do sinal de entrada $x[n]$ nessa mesma frequ√™ncia, pelo fator $|H(f)|^2$. ‚ñ†

> üí° **Exemplo Num√©rico:** Usando o exemplo anterior onde calculamos |H(f)| para uma SMA com n=5, podemos agora avaliar como a pot√™ncia do sinal √© alterada em cada frequ√™ncia:
>
>   - Para f=0.1: $|H(0.1)|^2 \approx (0.647)^2 \approx 0.419$. Isso significa que a pot√™ncia do sinal na frequ√™ncia 0.1 √© reduzida para aproximadamente 41.9% de sua pot√™ncia original.
>
>  - Para f=0.2: $|H(0.2)|^2 = (0)^2 = 0$. A pot√™ncia do sinal na frequ√™ncia 0.2 √© completamente eliminada.
>
>  - Para f=0.3: $|H(0.3)|^2 \approx (0.247)^2 \approx 0.061$. A pot√™ncia do sinal na frequ√™ncia 0.3 √© reduzida para cerca de 6.1% de sua pot√™ncia original.
>
>  Este exemplo demonstra quantitativamente como as componentes de alta frequ√™ncia s√£o atenuadas pela SMA, enquanto as baixas frequ√™ncias s√£o menos afetadas.

**Aplica√ß√µes e Limita√ß√µes**
A SMA √© uma ferramenta √∫til para prever tend√™ncias de curto prazo e suavizar dados com flutua√ß√µes irregulares [^1]. No entanto, ela apresenta algumas limita√ß√µes:
- **Atraso:** A SMA tende a atrasar mudan√ßas de tend√™ncia, j√° que ela usa informa√ß√µes do passado [^1].
- **Pesos Iguais:** A SMA atribui pesos iguais a todos os pontos de dados dentro da janela de c√°lculo, o que pode n√£o ser apropriado em cen√°rios onde dados mais recentes devem ter maior influ√™ncia [^1].
- **Falta de Flexibilidade:** A capacidade de modular a responsividade √© limitada, apenas variando o n√∫mero de per√≠odos $n$ [^1].

**SMA Ponderada (WMA)**
Uma extens√£o da SMA que aborda a limita√ß√£o de pesos iguais √© a **M√©dia M√≥vel Ponderada (WMA)**. Na WMA, pesos diferentes s√£o atribu√≠dos aos pontos de dados dentro da janela de c√°lculo. Geralmente, pesos maiores s√£o atribu√≠dos aos dados mais recentes, dando mais import√¢ncia √† informa√ß√£o mais atualizada. A f√≥rmula da WMA √©:

$$
WMA_t = \frac{w_1 A_{t-1} + w_2 A_{t-2} + \ldots + w_n A_{t-n}}{w_1 + w_2 + \ldots + w_n}
$$

onde $w_1, w_2, ..., w_n$ s√£o os pesos atribu√≠dos a cada valor de demanda $A_{t-1}, A_{t-2}, ..., A_{t-n}$, respectivamente. Uma escolha comum √© usar pesos que diminuem linearmente com o tempo. A WMA permite maior flexibilidade no ajuste da responsividade do modelo a mudan√ßas recentes, em compara√ß√£o com a SMA.

> üí° **Exemplo Num√©rico:**  Usando os mesmos dados de demanda anteriores (20, 22, 25, 23, 28) para calcular a WMA com n=3, vamos atribuir pesos lineares decrescentes: w1=3, w2=2, e w3=1.
>
>  $WMA_5 = \frac{(3 * 28) + (2 * 23) + (1 * 25)}{3 + 2 + 1} = \frac{84 + 46 + 25}{6} = \frac{155}{6} \approx 25.83$
>
>  Comparando com o exemplo da SMA anterior (25.33), vemos que a WMA com pesos decrescentes d√° maior peso aos dados mais recentes, resultando em uma previs√£o ligeiramente maior. Isso torna o modelo mais responsivo √†s mudan√ßas recentes na demanda.

### Conclus√£o
A **M√©dia M√≥vel Simples (SMA)** √© uma t√©cnica fundamental na an√°lise de s√©ries temporais, oferecendo um m√©todo intuitivo para suavizar dados e realizar previs√µes de curto prazo. Compreender as propriedades de estabilidade, capacidade de resposta, e a representa√ß√£o matem√°tica como convolu√ß√£o em espa√ßos de Hilbert √© crucial para aplicar a SMA de forma eficaz. Ao considerar as limita√ß√µes e caracter√≠sticas dessa t√©cnica, √© poss√≠vel selecionar a abordagem mais adequada para diferentes contextos de an√°lise de dados. A an√°lise da frequ√™ncia de resson√¢ncia e o entendimento do comportamento da SMA como filtro passa-baixa, demonstram como esse modelo funciona para diminuir o ru√≠do de s√©ries temporais e suavizar as varia√ß√µes de dados.
A SMA, embora simples, fornece uma base s√≥lida para outras t√©cnicas mais avan√ßadas de modelagem de s√©ries temporais.

### Refer√™ncias
[^1]: [^1]
[^2]: [^2]
<!-- END -->
