## Proje√ß√£o de Tend√™ncia Linear
### Introdu√ß√£o
Em continuidade ao estudo das t√©cnicas de previs√£o de demanda, e como vimos anteriormente [^1, 2, 3, 4, 5, 6], abordamos agora a **proje√ß√£o de tend√™ncia linear**, uma t√©cnica quantitativa que utiliza a regress√£o para identificar uma rela√ß√£o linear entre a demanda e o tempo [^2]. Esta t√©cnica, parte do conjunto de **modelos de s√©ries temporais**, assume que a demanda, nossa *vari√°vel dependente*, pode ser expressa como uma fun√ß√£o linear do tempo, nossa *vari√°vel independente*.

### Conceitos Fundamentais
A **an√°lise de regress√£o linear** √© uma ferramenta estat√≠stica fundamental para modelar a rela√ß√£o entre vari√°veis, e se baseia em alguns conceitos chave:
- **Vari√°vel Dependente:** √â a vari√°vel que se busca prever ou explicar, neste caso, a demanda por um produto ou servi√ßo [^1].
- **Vari√°vel Independente:** √â a vari√°vel que se assume influenciar a vari√°vel dependente, aqui, o tempo, expresso em unidades como trimestres, meses ou anos [^1].
- **Rela√ß√£o Linear:** A regress√£o linear assume que a rela√ß√£o entre as vari√°veis dependente e independente pode ser aproximada por uma linha reta [^2].
- **M√©todo dos M√≠nimos Quadrados:** Este m√©todo √© usado para determinar os par√¢metros da linha reta (intercepto e inclina√ß√£o) que melhor se ajustam aos dados. Ele busca minimizar a soma dos quadrados das diferen√ßas entre os valores reais e os valores previstos da vari√°vel dependente [^2].

A **equa√ß√£o da linha de regress√£o linear** √© dada por:
$$ \hat{y} = a + bx $$
onde:
- $\hat{y}$ √© o valor previsto da demanda.
- $a$ √© o intercepto (o valor de $\hat{y}$ quando x √© zero).
- $b$ √© a inclina√ß√£o da linha (a mudan√ßa em $\hat{y}$ para cada mudan√ßa unit√°ria em x).
- $x$ √© o valor da vari√°vel independente (tempo).

Os valores de $a$ e $b$ s√£o calculados usando as seguintes f√≥rmulas:

$$ a = \bar{y} - b\bar{x} $$

$$ b = \frac{\sum xy - n \bar{x} \bar{y}}{\sum x^2 - n \bar{x}^2} $$

onde:
- $\bar{y}$ √© a m√©dia dos valores da vari√°vel dependente (demanda).
- $\bar{x}$ √© a m√©dia dos valores da vari√°vel independente (tempo).
- $n$ √© o n√∫mero de pontos de dados utilizados no c√°lculo.

> üí° **Exemplo Num√©rico:** Vamos supor que temos os seguintes dados de demanda para os √∫ltimos 5 meses:
>
> | M√™s (x) | Demanda (y) |
> |---------|-------------|
> | 1       | 120         |
> | 2       | 135         |
> | 3       | 150         |
> | 4       | 165         |
> | 5       | 180         |
>
> Para calcular $a$ e $b$, primeiro precisamos calcular $\bar{x}$, $\bar{y}$, $\sum xy$ e $\sum x^2$.
>
> $\bar{x} = (1+2+3+4+5)/5 = 3$
>
> $\bar{y} = (120+135+150+165+180)/5 = 150$
>
> $\sum xy = (1*120) + (2*135) + (3*150) + (4*165) + (5*180) = 2370$
>
> $\sum x^2 = 1^2 + 2^2 + 3^2 + 4^2 + 5^2 = 55$
>
> $n = 5$
>
> Agora, podemos calcular $b$:
>
> $b = \frac{2370 - (5 * 3 * 150)}{55 - (5 * 3^2)} = \frac{2370 - 2250}{55 - 45} = \frac{120}{10} = 12$
>
> E $a$:
>
> $a = 150 - (12 * 3) = 150 - 36 = 114$
>
> Portanto, a equa√ß√£o da linha de regress√£o √©:
>
> $\hat{y} = 114 + 12x$
>
> Isso significa que, para cada m√™s que passa, a demanda aumenta em m√©dia 12 unidades, com uma demanda base de 114 quando x √© zero (o que pode ser interpretado como a demanda base antes do per√≠odo analisado).

**Prova da f√≥rmula para o c√°lculo de 'b':**

Para encontrar o valor de $b$ que minimiza a soma dos quadrados dos res√≠duos, come√ßamos com a fun√ß√£o de custo $J$:

$$J = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2 = \sum_{i=1}^{n} (y_i - (a + bx_i))^2$$

I. Substitu√≠mos $a$ por $\bar{y} - b\bar{x}$ na equa√ß√£o de $J$:
$$J = \sum_{i=1}^{n} (y_i - (\bar{y} - b\bar{x} + bx_i))^2 = \sum_{i=1}^{n} (y_i - \bar{y} - b(x_i - \bar{x}))^2$$

II. Para encontrar o valor de $b$ que minimiza $J$, derivamos $J$ em rela√ß√£o a $b$ e igualamos a zero:
$$\frac{\partial J}{\partial b} = -2 \sum_{i=1}^{n} (y_i - \bar{y} - b(x_i - \bar{x}))(x_i - \bar{x}) = 0$$

III. Simplificamos a equa√ß√£o:
$$\sum_{i=1}^{n} (y_i - \bar{y})(x_i - \bar{x}) - b \sum_{i=1}^{n} (x_i - \bar{x})^2 = 0$$

IV. Isolamos $b$:
$$b \sum_{i=1}^{n} (x_i - \bar{x})^2 = \sum_{i=1}^{n} (y_i - \bar{y})(x_i - \bar{x})$$
$$b = \frac{\sum_{i=1}^{n} (y_i - \bar{y})(x_i - \bar{x})}{\sum_{i=1}^{n} (x_i - \bar{x})^2}$$

V. Expandindo os somat√≥rios e usando a propriedade $\sum_{i=1}^{n} x_i = n\bar{x}$, e $\sum_{i=1}^{n} y_i = n\bar{y}$, temos:
$$b = \frac{\sum_{i=1}^{n} x_iy_i - n\bar{x}\bar{y}}{\sum_{i=1}^{n} x_i^2 - n\bar{x}^2}$$

Portanto, a f√≥rmula para $b$ √© dada por:

$$ b = \frac{\sum xy - n \bar{x} \bar{y}}{\sum x^2 - n \bar{x}^2} $$
‚ñ†

**Prova da f√≥rmula para o c√°lculo de 'a':**
Para encontrar o valor de $a$, lembramos que a linha de regress√£o passa pelo ponto $(\bar{x}, \bar{y})$.

I. Substitu√≠mos $\bar{x}$ e $\bar{y}$ na equa√ß√£o da linha:
    $$\bar{y} = a + b\bar{x}$$
II. Isolamos $a$:
    $$a = \bar{y} - b\bar{x}$$
Portanto, a f√≥rmula para $a$ √© dada por:
$$a = \bar{y} - b\bar{x}$$
‚ñ†
**√â crucial notar que a regress√£o linear se baseia em certas suposi√ß√µes:**
1. **Linearidade**: A rela√ß√£o entre as vari√°veis dependente e independente deve ser linear [^2].
2. **Normalidade dos res√≠duos:** Os erros (res√≠duos) devem seguir uma distribui√ß√£o normal [^2].
3. **Homocedasticidade:** A vari√¢ncia dos res√≠duos deve ser constante ao longo dos valores da vari√°vel independente [^2].
4. **Independ√™ncia dos res√≠duos:** Os res√≠duos devem ser independentes uns dos outros [^2].

Estas suposi√ß√µes s√£o importantes para garantir a validade dos resultados obtidos atrav√©s da an√°lise de regress√£o linear [^2].

> üí° **Exemplo Num√©rico (Valida√ß√£o das Suposi√ß√µes):** Usando os dados do exemplo anterior, podemos verificar as suposi√ß√µes:
>
> 1.  **Linearidade:** Podemos plotar os dados (m√™s vs. demanda) e verificar se a rela√ß√£o parece linear. Al√©m disso, podemos analisar um gr√°fico de res√≠duos (diferen√ßa entre o valor real e o previsto) vs. tempo; se os res√≠duos n√£o apresentarem um padr√£o claro, ent√£o a suposi√ß√£o de linearidade √© adequada.
>
>     ```mermaid
>     graph LR
>         A[M√™s] --> B(Demanda);
>         A --> C(Res√≠duos);
>         C --> D(Tempo)
>     ```
>
> 2.  **Normalidade dos res√≠duos:** Ap√≥s calcular os res√≠duos, podemos construir um histograma ou um gr√°fico de probabilidade normal (Q-Q plot). Se o histograma se aproximar de uma distribui√ß√£o normal ou os pontos do Q-Q plot se alinharem em uma linha reta, a suposi√ß√£o de normalidade dos res√≠duos √© aceit√°vel.
>
> 3. **Homocedasticidade:** Em um gr√°fico dos res√≠duos vs. tempo (ou valores previstos), a vari√¢ncia dos res√≠duos deve ser aproximadamente constante. Se a dispers√£o dos res√≠duos aumentar ou diminuir com o tempo ou os valores previstos, ent√£o a suposi√ß√£o de homocedasticidade n√£o √© v√°lida e uma transforma√ß√£o nos dados ou um modelo diferente pode ser necess√°rio.
>
> 4. **Independ√™ncia dos res√≠duos:** Ao analisar os res√≠duos em sequ√™ncia, n√£o devem existir padr√µes de depend√™ncia. Por exemplo, se res√≠duos positivos s√£o seguidos por res√≠duos negativos ou vice-versa, ent√£o pode haver um problema de autocorrela√ß√£o, indicando que a suposi√ß√£o n√£o √© v√°lida.
>
>   Vamos calcular os res√≠duos do exemplo anterior e avali√°-los para entender o processo:
>
>   | M√™s (x) | Demanda (y) | Previs√£o (≈∑ = 114 + 12x) | Res√≠duo (y - ≈∑) |
>   |---------|-------------|-------------------------|-----------------|
>   | 1       | 120         | 126                     | -6              |
>   | 2       | 135         | 138                     | -3              |
>   | 3       | 150         | 150                     | 0               |
>   | 4       | 165         | 162                     | 3               |
>   | 5       | 180         | 174                     | 6               |
>
>   Se plotarmos um gr√°fico dos res√≠duos (-6, -3, 0, 3, 6) em rela√ß√£o ao tempo (1, 2, 3, 4, 5), podemos observar que n√£o h√° um padr√£o √≥bvio de crescimento ou decrescimento da dispers√£o, e o comportamento geral parece aleat√≥rio. Adicionalmente, uma avalia√ß√£o visual indica que os res√≠duos se encontram pr√≥ximos de zero, o que sugere um modelo razoavelmente adequado aos dados.

**Observa√ß√£o:** Uma maneira de verificar a adequa√ß√£o do modelo de regress√£o linear √© atrav√©s da an√°lise do coeficiente de determina√ß√£o ($R^2$). Este valor, que varia entre 0 e 1, indica a propor√ß√£o da vari√¢ncia da vari√°vel dependente que √© explicada pelo modelo. Um $R^2$ pr√≥ximo de 1 indica um bom ajuste do modelo aos dados.

> üí° **Exemplo Num√©rico ($R^2$):**  Para os dados do exemplo anterior, podemos calcular o $R^2$.
>
> Primeiro calculamos a soma total dos quadrados (SST): $SST = \sum(y_i - \bar{y})^2$
>
> $SST = (120-150)^2 + (135-150)^2 + (150-150)^2 + (165-150)^2 + (180-150)^2 = 900 + 225 + 0 + 225 + 900 = 2250$
>
> Depois calculamos a soma dos quadrados dos res√≠duos (SSE): $SSE = \sum(y_i - \hat{y}_i)^2$
>
> $SSE = (-6)^2 + (-3)^2 + 0^2 + 3^2 + 6^2 = 36 + 9 + 0 + 9 + 36 = 90$
>
> E ent√£o calculamos $R^2$:
>
> $R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{90}{2250} = 1 - 0.04 = 0.96$
>
> Um $R^2$ de 0.96 sugere que 96% da varia√ß√£o na demanda √© explicada pelo modelo de regress√£o linear, o que indica um bom ajuste do modelo aos dados.

A proje√ß√£o de tend√™ncia linear, ao contr√°rio de outras t√©cnicas como o *Simple Moving Average* (SMA) [^5], *Weighted Moving Average* (WMA) [^5] ou *Exponential Smoothing* (ES) [^6], permite prever a demanda para m√∫ltiplos per√≠odos futuros, j√° que n√£o depende do per√≠odo anterior como as outras t√©cnicas.

Apesar da sua vantagem de proje√ß√£o de longo prazo, a proje√ß√£o de tend√™ncia linear tem algumas limita√ß√µes. Principalmente a pressuposi√ß√£o de linearidade entre a demanda e o tempo, o que nem sempre reflete a realidade. Por isso a verifica√ß√£o das suposi√ß√µes da an√°lise de regress√£o √© importante para garantir a validade dos resultados. A linearidade deve ser verificada e modelos n√£o lineares devem ser utilizados quando essa pressuposi√ß√£o n√£o for v√°lida [^2].

**Teorema 1**
Se a suposi√ß√£o de linearidade n√£o for v√°lida, ou seja, se a rela√ß√£o entre a demanda e o tempo n√£o for linear, o uso da proje√ß√£o de tend√™ncia linear pode levar a previs√µes imprecisas. Nestes casos, modelos n√£o-lineares, como regress√£o polinomial ou modelos de s√©ries temporais que capturam padr√µes n√£o lineares, podem ser mais adequados.

**Lema 1**
A transforma√ß√£o de vari√°veis pode, por vezes, linearizar uma rela√ß√£o n√£o-linear entre a demanda e o tempo. Por exemplo, se a rela√ß√£o entre a demanda e o tempo for exponencial, a aplica√ß√£o da fun√ß√£o logar√≠tmica na vari√°vel dependente pode transformar a rela√ß√£o em uma forma linear, permitindo a aplica√ß√£o da regress√£o linear.

**Lema 1.1**
Se uma transforma√ß√£o logar√≠tmica da vari√°vel dependente, $y' = ln(y)$, resulta em uma rela√ß√£o linear com a vari√°vel independente $x$, ent√£o o modelo de regress√£o linear passa a ter a forma $\hat{y'} = a + bx$ e, ao retornarmos √† escala original, temos $\hat{y} = e^{a+bx}$. Este modelo exponencial agora pode ser usado para fazer previs√µes.

> üí° **Exemplo Num√©rico (Transforma√ß√£o Logar√≠tmica):** Suponha que a demanda cresce exponencialmente com o tempo e temos os seguintes dados:
>
> | M√™s (x) | Demanda (y) |
> |---------|-------------|
> | 1       | 10          |
> | 2       | 20          |
> | 3       | 40          |
> | 4       | 80          |
> | 5       | 160         |
>
> Se plotarmos esses dados, veremos que a rela√ß√£o n√£o √© linear. Vamos aplicar a transforma√ß√£o logar√≠tmica na vari√°vel dependente:
>
> | M√™s (x) | Demanda (y) | ln(y) = y'     |
> |---------|-------------|---------------|
> | 1       | 10          | 2.30          |
> | 2       | 20          | 2.99          |
> | 3       | 40          | 3.69          |
> | 4       | 80          | 4.38          |
> | 5       | 160         | 5.08          |
>
> Agora, calculamos a regress√£o linear usando $x$ e $y'$. Usando os mesmos c√°lculos do primeiro exemplo:
>
> $\bar{x} = 3$
> $\bar{y'} = 3.61$
> $\sum xy' = 65.85$
> $\sum x^2 = 55$
> $n = 5$
>
> $b = \frac{65.85 - (5*3*3.61)}{55 - (5 * 3^2)} = \frac{65.85 - 54.15}{10} = 1.17$
>
> $a = 3.61 - (1.17 * 3) = 3.61 - 3.51 = 0.10$
>
> Ent√£o $\hat{y'} = 0.10 + 1.17x$
>
> Voltando √† escala original:
>
> $\hat{y} = e^{0.10 + 1.17x}$
>
> Este modelo exponencial agora pode ser utilizado para fazer previs√µes. Por exemplo, para o m√™s 6, a previs√£o seria:
>
> $\hat{y} = e^{0.10 + 1.17*6} = e^{7.12} = 1235.57$ (aproximadamente)

**Prova de Lema 1.1**

I. Dado que $y' = ln(y)$, o modelo linear em termos de $y'$ √©:
   $$\hat{y'} = a + bx$$

II. Substituindo $y'$ por $ln(y)$, temos:
   $$ln(\hat{y}) = a + bx$$

III. Para encontrar $\hat{y}$, aplicamos a fun√ß√£o exponencial em ambos os lados da equa√ß√£o:
  $$\hat{y} = e^{a+bx}$$
  
Assim, mostramos que a transforma√ß√£o logar√≠tmica seguida pela aplica√ß√£o de regress√£o linear e a transforma√ß√£o de volta √† escala original resultam no modelo exponencial $\hat{y} = e^{a+bx}$.
‚ñ†

### Conclus√£o
A proje√ß√£o de tend√™ncia linear √© uma ferramenta poderosa para modelar e prever a demanda atrav√©s do tempo quando existe uma rela√ß√£o linear entre ambas vari√°veis. Apesar da sua aplica√ß√£o, e com as suposi√ß√µes necess√°rias validadas, √© importante lembrar que as proje√ß√µes feitas por esse m√©todo podem ser afetadas por fatores n√£o lineares ou por outras vari√°veis que n√£o s√£o o tempo.  Outras t√©cnicas de previs√£o e modelos com outros fatores que influenciam a demanda podem precisar ser utilizados para maior exatid√£o, como j√° vimos, e veremos em sequ√™ncia.

### Refer√™ncias
[^1]:  Chapter 3, p. 57
[^2]:  Chapter 3, p. 72
[^3]:  Chapter 3, p. 59
[^4]:  Chapter 3, p. 60
[^5]: Chapter 3, p. 61
[^6]: Chapter 3, p. 64
<!-- END -->
