## M√©dia M√≥vel Simples (SMA): Uma Abordagem para Suaviza√ß√£o de S√©ries Temporais
### Introdu√ß√£o
Como vimos anteriormente, a previs√£o de demanda √© fundamental para o planejamento e aloca√ß√£o de recursos em organiza√ß√µes de sa√∫de [^1]. Dentro das t√©cnicas de previs√£o de s√©ries temporais, a **m√©dia m√≥vel simples (SMA)** se destaca pela sua simplicidade e facilidade de implementa√ß√£o. Este m√©todo, em sua ess√™ncia, calcula a m√©dia da demanda em um n√∫mero espec√≠fico de per√≠odos anteriores para projetar a demanda no per√≠odo seguinte. A caracter√≠stica *‚Äúm√≥vel‚Äù* vem da forma como, √† medida que o tempo avan√ßa, cada novo ponto de dados √© inclu√≠do no c√°lculo, enquanto os pontos de dados mais antigos s√£o removidos, criando uma janela m√≥vel de observa√ß√µes para o c√°lculo da m√©dia.

### Conceitos Fundamentais
A **m√©dia m√≥vel simples (SMA)** √© uma t√©cnica de previs√£o que calcula a m√©dia da demanda em um n√∫mero espec√≠fico de per√≠odos anteriores para prever a demanda no pr√≥ximo per√≠odo [^3]. Diferente de outras t√©cnicas que ponderam dados de forma diferenciada, a SMA atribui pesos iguais a todos os per√≠odos considerados. O c√°lculo de uma SMA para um per√≠odo $t$, denotada como $SMA_t$, √© dado pela f√≥rmula:

$$ SMA_t = \frac{A_{t-1} + A_{t-2} + \dots + A_{t-n}}{n} $$

onde:

*   $SMA_t$ √© a m√©dia m√≥vel simples para o per√≠odo $t$.
*   $A_{t-1}, A_{t-2}, \ldots, A_{t-n}$ s√£o as demandas reais nos $n$ per√≠odos anteriores.
*   $n$ √© o n√∫mero de per√≠odos inclu√≠dos no c√°lculo da m√©dia, tamb√©m conhecido como *janela da m√©dia m√≥vel*.

Em ess√™ncia, a SMA calcula a m√©dia dos valores de demanda dos $n$ per√≠odos mais recentes. √Ä medida que um novo per√≠odo √© adicionado √† s√©rie temporal, a janela de observa√ß√µes "move-se" para frente, incluindo o novo dado e excluindo o mais antigo. Esta caracter√≠stica de "janela m√≥vel" √© a raz√£o para o nome da t√©cnica e permite que a m√©dia m√≥vel se adapte √†s varia√ß√µes temporais da demanda.

> üí° **Exemplo Num√©rico:** Vamos considerar uma s√©rie temporal de demanda mensal por um certo produto em um hospital. Suponha que temos os seguintes dados de demanda para os √∫ltimos cinco meses:
>
> *   M√™s 1: 100 unidades
> *   M√™s 2: 120 unidades
> *   M√™s 3: 130 unidades
> *   M√™s 4: 150 unidades
> *   M√™s 5: 140 unidades
>
> Se escolhermos uma SMA com uma janela de 3 meses ($n=3$), podemos calcular a previs√£o para o M√™s 6 da seguinte forma:
>
> $SMA_6 = \frac{A_5 + A_4 + A_3}{3} = \frac{140 + 150 + 130}{3} = \frac{420}{3} = 140$
>
> Isso significa que a previs√£o da demanda para o M√™s 6 √© de 140 unidades, com base na m√©dia dos tr√™s meses anteriores.
>
>  Para o m√™s 7, ter√≠amos:
> $SMA_7 = \frac{A_6 + A_5 + A_4}{3}$
>
>  Como n√£o temos o valor de A6, n√£o podemos calcular.
>
> Se escolhermos uma SMA com janela de 2 meses ($n=2$):
>
> $SMA_3 = \frac{A_2 + A_1}{2} = \frac{120 + 100}{2} = 110$
> $SMA_4 = \frac{A_3 + A_2}{2} = \frac{130 + 120}{2} = 125$
> $SMA_5 = \frac{A_4 + A_3}{2} = \frac{150 + 130}{2} = 140$
> $SMA_6 = \frac{A_5 + A_4}{2} = \frac{140 + 150}{2} = 145$

#### Escolha do tamanho da janela ($n$)
O tamanho da janela ($n$) na SMA √© um fator cr√≠tico que influencia diretamente o comportamento do modelo [^6]. Uma janela curta torna o modelo mais responsivo a mudan√ßas recentes, mas tamb√©m mais suscet√≠vel a flutua√ß√µes aleat√≥rias. Uma janela longa, por sua vez, suaviza mais os dados e torna o modelo mais est√°vel, mas tamb√©m menos responsivo a mudan√ßas abruptas na demanda [^6].

> üí° **Exemplo Num√©rico (Efeito do tamanho da janela):** Utilizando o mesmo conjunto de dados do exemplo anterior, vamos comparar o efeito de diferentes tamanhos de janela:
>
> *   **SMA com janela de 2 meses ($n=2$):**
>     $SMA_3 = \frac{120 + 100}{2} = 110$
>     $SMA_4 = \frac{130 + 120}{2} = 125$
>     $SMA_5 = \frac{150 + 130}{2} = 140$
>     $SMA_6 = \frac{140 + 150}{2} = 145$
>
> *   **SMA com janela de 4 meses ($n=4$):**
>     $SMA_5 = \frac{100 + 120 + 130 + 150}{4} = 125$
>
>     $SMA_6 = \frac{120 + 130 + 150 + 140}{4} = 135$
>
> Observamos que a SMA com janela de 2 meses varia mais que a janela de 4, refletindo as flutua√ß√µes nos dados, enquanto a janela de 4 suaviza mais, atrasando ligeiramente a resposta.
>
> Vamos adicionar mais um exemplo num√©rico utilizando um dataset gerado para visualizar melhor o efeito do tamanho da janela.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Gerando dados de demanda simulados com tend√™ncia
> np.random.seed(42)
> time = np.arange(1, 31)
> trend = 2 * time
> noise = np.random.normal(0, 10, 30)
> demand = trend + noise + 100
>
> # Fun√ß√£o para calcular SMA
> def simple_moving_average(data, window):
>     sma = np.convolve(data, np.ones(window), 'valid') / window
>     return np.concatenate((np.full(window-1, np.nan), sma))
>
> # Calculando SMA com diferentes janelas
> sma_2 = simple_moving_average(demand, 2)
> sma_5 = simple_moving_average(demand, 5)
> sma_10 = simple_moving_average(demand, 10)
>
> # Visualizando os resultados
> plt.figure(figsize=(10, 6))
> plt.plot(time, demand, label='Demanda Real', marker='o')
> plt.plot(time, sma_2, label='SMA (n=2)', linestyle='--')
> plt.plot(time, sma_5, label='SMA (n=5)', linestyle='--')
> plt.plot(time, sma_10, label='SMA (n=10)', linestyle='--')
> plt.xlabel('Tempo')
> plt.ylabel('Demanda')
> plt.title('Compara√ß√£o de SMA com Diferentes Tamanhos de Janela')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> Este c√≥digo gera um gr√°fico mostrando a demanda original juntamente com SMA calculados para janelas de tamanho 2, 5 e 10. √â poss√≠vel observar que SMA com janela menor (n=2) acompanha mais de perto as varia√ß√µes da demanda (mais responsiva), enquanto o SMA com janela maior (n=10) gera uma linha mais suave, suavizando mais o ru√≠do (mais est√°vel).

**Lema 1:** *O aumento do tamanho da janela ($n$) em uma SMA aumenta a estabilidade da previs√£o e diminui sua capacidade de resposta a mudan√ßas na demanda.*

**Prova:**
I. A estabilidade de uma previs√£o refere-se √† sua capacidade de minimizar o impacto de flutua√ß√µes aleat√≥rias e ru√≠do nos dados. A previs√£o de SMA √© calculada com uma m√©dia, o que suaviza os valores e diminui a varia√ß√£o de cada ponto de dados.
II. A capacidade de resposta, por outro lado, refere-se √† rapidez com que a previs√£o reage a mudan√ßas na tend√™ncia da demanda.
III. Na f√≥rmula da SMA, todos os pontos de dados t√™m o mesmo peso na m√©dia. Assim, cada ponto tem um peso de $\frac{1}{n}$. Ao aumentar o valor de $n$, os pesos diminuem e, consequentemente, as mudan√ßas nos dados de cada ponto de demanda s√£o menos representativas no c√°lculo da m√©dia, diminuindo a capacidade de resposta.
IV. Com uma janela grande ($n$ grande), um novo ponto de dados tem um peso relativamente pequeno, fazendo com que a m√©dia se mova lentamente e de forma mais est√°vel. Por outro lado, com uma janela pequena, o novo ponto de dados tem um peso maior e, assim, pode haver flutua√ß√µes maiores nas m√©dias, tornando a previs√£o mais responsiva.
V. Portanto, ao aumentar $n$, a estabilidade aumenta, mas a capacidade de resposta diminui, e vice-versa. ‚ñ†

**Lema 1.1:** *A vari√¢ncia da previs√£o da SMA diminui com o aumento do tamanho da janela ($n$).*
**Prova:**
I. A vari√¢ncia de um conjunto de dados mede o qu√£o dispersos est√£o esses dados em rela√ß√£o √† sua m√©dia.
II. A previs√£o da SMA √© uma m√©dia dos valores de demanda em uma janela de tamanho n.
III. Pela propriedade da vari√¢ncia de uma m√©dia, se $X_1, X_2, \ldots, X_n$ s√£o vari√°veis aleat√≥rias independentes com a mesma vari√¢ncia $\sigma^2$, ent√£o a vari√¢ncia de sua m√©dia $\bar{X} = \frac{1}{n} \sum_{i=1}^n X_i$ √© dada por $Var(\bar{X}) = \frac{\sigma^2}{n}$.
IV. Em um cen√°rio simplificado onde assumimos que os valores de demanda dentro da janela da SMA s√£o vari√°veis aleat√≥rias independentes com vari√¢ncia aproximadamente constante, ao aumentarmos n, a vari√¢ncia da previs√£o diminui.
V. Assim, o aumento do tamanho da janela da SMA reduz a varia√ß√£o da m√©dia, tornando a previs√£o mais est√°vel e menos suscet√≠vel a flutua√ß√µes aleat√≥rias, o que confirma que a varia√ß√£o da previs√£o da SMA diminui com o aumento de $n$. ‚ñ†

#### Particularidades e Limita√ß√µes
1.  **Necessidade de dados hist√≥ricos:**  A SMA requer um n√∫mero m√≠nimo de per√≠odos anteriores para realizar a previs√£o.  Para uma janela de tamanho $n$, √© preciso pelo menos $n$ pontos de dados anteriores para calcular uma previs√£o [^5]. Assim, as primeiras previs√µes n√£o podem ser calculadas at√© que essa quantidade m√≠nima de dados esteja dispon√≠vel.
2.  **Pesos iguais:** A SMA atribui pesos iguais a todos os dados dentro da janela, o que pode n√£o ser apropriado se os dados mais recentes forem mais relevantes para a previs√£o. Dados mais antigos tem a mesma import√¢ncia que dados mais recentes [^3].
3.  **Atraso na resposta:**  A SMA tende a apresentar atraso na resposta a mudan√ßas abruptas na demanda, uma vez que a m√©dia √© calculada sobre os dados passados [^5]. Em especial, quando h√° uma tend√™ncia (aumento ou diminui√ß√£o sistem√°tica), a SMA tende a subestimar ou sobrestimar a previs√£o.
4.  **N√£o considera sazonalidade:** A SMA na sua forma b√°sica n√£o consegue capturar padr√µes de sazonalidade na s√©rie temporal. N√£o leva em considera√ß√£o repeti√ß√µes que podem ocorrer em certos momentos do ano.
5. **Escolha da janela**: A defini√ß√£o da janela pode ser dif√≠cil. Escolher uma janela muito pequena faz com que as previs√µes sejam inst√°veis e escolhas com uma janela grande podem fazer com que o modelo demore a reagir a mudan√ßas na tend√™ncia da demanda.

**Proposi√ß√£o 1**: *Em uma s√©rie temporal com tend√™ncia, a m√©dia m√≥vel simples (SMA) tende a atrasar a previs√£o em rela√ß√£o √† tend√™ncia real.*

**Prova:**

I. Em uma s√©rie temporal com tend√™ncia, os dados de demanda mostram um padr√£o consistente de aumento ou diminui√ß√£o ao longo do tempo.
II. A m√©dia m√≥vel (SMA) calcula a m√©dia dos valores da demanda de um n√∫mero fixo de per√≠odos anteriores.
III. Quando h√° uma tend√™ncia ascendente, cada ponto de dados da s√©rie temporal √© maior que os dados passados. A m√©dia calcula um valor menor que o ponto mais recente, atrasando a previs√£o em rela√ß√£o √† tend√™ncia real.
IV. Da mesma forma, quando h√° uma tend√™ncia descendente, cada ponto de dados da s√©rie temporal √© menor que os dados passados. A m√©dia calcula um valor maior que o ponto mais recente, novamente atrasando a previs√£o em rela√ß√£o √† tend√™ncia real.
V. O atraso ocorre porque a SMA atribui pesos iguais a todos os per√≠odos dentro da janela. Isso significa que os dados mais antigos, que s√£o menores na tend√™ncia ascendente (e maiores na descendente), afetam a m√©dia da mesma forma que os dados mais recentes e consequentemente, atrasam a previs√£o. ‚ñ†

**Proposi√ß√£o 1.1:** *O atraso na previs√£o da SMA em uma s√©rie temporal com tend√™ncia aumenta com o aumento do tamanho da janela ($n$).*

**Prova:**
I. Como demonstrado na Proposi√ß√£o 1, a SMA atrasa a previs√£o em s√©ries temporais com tend√™ncia.
II. O atraso surge da atribui√ß√£o de pesos iguais a todos os per√≠odos dentro da janela, incluindo valores passados, os quais, em presen√ßa de tend√™ncia, ser√£o sistematicamente menores (tend√™ncia ascendente) ou maiores (tend√™ncia descendente) do que os valores mais recentes.
III. Ao aumentar o tamanho da janela $n$, a quantidade de valores passados na m√©dia tamb√©m aumenta, fazendo com que a diferen√ßa entre a m√©dia e o valor mais recente se torne maior.
IV. O aumento da diferen√ßa implica em um maior atraso da previs√£o, visto que a m√©dia se distancia cada vez mais do valor corrente na dire√ß√£o contr√°ria da tend√™ncia, fazendo com que a previs√£o se afaste mais do ponto correto.
V. Portanto, ao aumentar o tamanho da janela $n$, o atraso da previs√£o em rela√ß√£o √† tend√™ncia real tende a aumentar. ‚ñ†

#### Compara√ß√£o com a Suaviza√ß√£o Exponencial
A m√©dia m√≥vel simples (SMA) e a suaviza√ß√£o exponencial (ES) s√£o t√©cnicas de previs√£o de s√©ries temporais, mas existem diferen√ßas importantes entre elas:
1.  **Pondera√ß√£o dos dados:** A SMA atribui pesos iguais a todos os per√≠odos dentro da janela, enquanto a suaviza√ß√£o exponencial atribui pesos decrescentes exponencialmente, dando mais import√¢ncia aos dados mais recentes [^3].
2.  **Hist√≥rico de dados:** A SMA considera apenas o n√∫mero de per√≠odos especificado, enquanto a suaviza√ß√£o exponencial considera todos os dados hist√≥ricos, atribuindo pesos que diminuem de forma exponencial [^5].
3. **Resposta a Mudan√ßas na Demanda:** A suaviza√ß√£o exponencial √© mais responsiva a mudan√ßas recentes na demanda devido ao maior peso nos dados mais recentes. Por outro lado, a SMA, devido aos pesos iguais em sua janela de observa√ß√£o, n√£o reage t√£o rapidamente [^5].
4.  **Suaviza√ß√£o de Ru√≠do:** A SMA suaviza os dados, reduzindo o impacto de ru√≠dos aleat√≥rios, enquanto a suaviza√ß√£o exponencial tamb√©m suaviza, mas a quantidade de suaviza√ß√£o depende do valor de $\alpha$ [^5].
5. **Facilidade de implementa√ß√£o**: A SMA √© mais simples de entender e implementar do que a suaviza√ß√£o exponencial, que requer um ajuste da constante $\alpha$.

> üí° **Exemplo Num√©rico (Compara√ß√£o com ES):** Vamos comparar a SMA com janela de 3 per√≠odos com a suaviza√ß√£o exponencial (ES) com $\alpha = 0.4$. Suponhamos que temos os seguintes dados de demanda:
>
> *   $A_1$: 100
> *   $A_2$: 120
> *   $A_3$: 130
> *   $A_4$: 150
> *   $A_5$: 140
> *  $ES_1 = 100$
>
> Calculando as SMA (3 per√≠odos) e as ES:
> *   $SMA_4 = \frac{130 + 120 + 100}{3} = 116.67$
> *   $SMA_5 = \frac{150 + 130 + 120}{3} = 133.33$
> * $SMA_6 = \frac{140 + 150 + 130}{3} = 140$
> *   $ES_2 = 0.4 \times 100 + 0.6 \times 100 = 100$
> *   $ES_3 = 0.4 \times 120 + 0.6 \times 100 = 108$
> *   $ES_4 = 0.4 \times 130 + 0.6 \times 108 = 116.8$
> *   $ES_5 = 0.4 \times 150 + 0.6 \times 116.8 = 129.08$
> *   $ES_6 = 0.4 \times 140 + 0.6 \times 129.08 = 133.45$
>
> Observe como as m√©dias m√≥veis respondem de forma similar √†s suaviza√ß√µes exponenciais, mas s√£o mais simples de calcular. A escolha de qual m√©todo usar vai depender dos dados e da necessidade de capacidade de resposta do modelo.
>
> ```python
> import numpy as np
> import matplotlib.pyplot as plt
>
> # Dados de demanda
> demand = np.array([100, 120, 130, 150, 140, 160, 170, 180, 190, 200])
> time = np.arange(1, len(demand) + 1)
>
> # Fun√ß√£o para calcular SMA
> def simple_moving_average(data, window):
>     sma = np.convolve(data, np.ones(window), 'valid') / window
>     return np.concatenate((np.full(window-1, np.nan), sma))
>
> # Fun√ß√£o para calcular Suaviza√ß√£o Exponencial Simples
> def exponential_smoothing(data, alpha):
>     es = np.zeros_like(data, dtype=float)
>     es[0] = data[0]
>     for i in range(1, len(data)):
>        es[i] = alpha * data[i] + (1 - alpha) * es[i-1]
>     return es
>
> # Calculando SMA com janela de 3
> sma_3 = simple_moving_average(demand, 3)
>
> # Calculando ES com alpha = 0.4
> es_04 = exponential_smoothing(demand, 0.4)
>
> # Visualizando os resultados
> plt.figure(figsize=(10, 6))
> plt.plot(time, demand, label='Demanda Real', marker='o')
> plt.plot(time, sma_3, label='SMA (n=3)', linestyle='--')
> plt.plot(time, es_04, label='ES (Œ±=0.4)', linestyle='--')
> plt.xlabel('Tempo')
> plt.ylabel('Demanda')
> plt.title('Compara√ß√£o de SMA e Suaviza√ß√£o Exponencial')
> plt.legend()
> plt.grid(True)
> plt.show()
> ```
>
> O c√≥digo acima plota um gr√°fico que compara o desempenho da SMA com janela de 3 e a suaviza√ß√£o exponencial com alpha = 0.4. Podemos observar como ambos os m√©todos suavizam os dados e como a suaviza√ß√£o exponencial acompanha mais as mudan√ßas na demanda. SMA tende a atrasar, como j√° visto nas proposi√ß√µes anteriores.

### Conclus√£o
A m√©dia m√≥vel simples (SMA) √© uma t√©cnica de previs√£o de s√©ries temporais amplamente utilizada devido √† sua simplicidade e facilidade de implementa√ß√£o. Ao calcular a m√©dia da demanda em um n√∫mero espec√≠fico de per√≠odos anteriores, a SMA suaviza o ru√≠do aleat√≥rio nos dados e revela padr√µes de demanda subjacentes. No entanto, √© importante ter em mente suas limita√ß√µes, como a atribui√ß√£o de pesos iguais a todos os per√≠odos, o atraso na resposta a mudan√ßas abruptas e a dificuldade para modelar tend√™ncias e sazonalidade. A escolha do tamanho da janela √© crucial e deve ser feita com base nas caracter√≠sticas dos dados e na necessidade de estabilidade e capacidade de resposta da previs√£o. Em situa√ß√µes que demandam maior capacidade de resposta ou tratamento mais adequado de tend√™ncias, outras t√©cnicas mais sofisticadas, como a suaviza√ß√£o exponencial ou modelos de regress√£o, podem ser mais apropriadas.

### Refer√™ncias
[^1]: Cap√≠tulo 3, Introdu√ß√£o e Objetivos de Aprendizagem
[^3]: Cap√≠tulo 3, Forecasting Demand
[^5]: Cap√≠tulo 3, Time Series Models
[^6]: Cap√≠tulo 3, Simple Moving Average
<!-- END -->
