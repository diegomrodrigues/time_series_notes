## Previs√µes Est√°veis e Responsivas: Um Ato de Equil√≠brio

### Introdu√ß√£o
Como vimos anteriormente, a previs√£o de demanda √© um desafio inerente, dada a variabilidade inerente nos dados. A escolha de um modelo de previs√£o adequado envolve a considera√ß√£o cuidadosa de v√°rios fatores, incluindo a natureza dos dados, o horizonte de tempo da previs√£o e os trade-offs entre **estabilidade** e **responsividade** [^5]. Este t√≥pico aprofunda esses conceitos e sua import√¢ncia na modelagem de previs√£o, construindo sobre a base de modelos de s√©ries temporais apresentados anteriormente.

### Conceitos Fundamentais
A **estabilidade** de uma previs√£o refere-se √† sua capacidade de n√£o reagir excessivamente a flutua√ß√µes aleat√≥rias nos dados. Em outras palavras, uma previs√£o est√°vel √© aquela que n√£o muda drasticamente em resposta a pequenas varia√ß√µes nos dados de entrada. Por outro lado, a **responsividade** de uma previs√£o √© sua capacidade de reagir rapidamente a mudan√ßas reais na demanda [^6]. Um modelo de previs√£o altamente responsivo ser√° capaz de capturar mudan√ßas nos padr√µes de demanda com mais rapidez, mas pode tamb√©m ser mais suscet√≠vel a flutua√ß√µes aleat√≥rias.

O desafio reside em que as a√ß√µes necess√°rias para tornar uma previs√£o mais responsiva tamb√©m diminuem sua estabilidade, e vice-versa [^6]. Isso cria um equil√≠brio que os previsores devem navegar. A necessidade de previs√µes est√°veis √© crucial em setores onde a variabilidade pode levar a decis√µes err√¥neas, como a necessidade de ajustar a capacidade com base na demanda percebida [^6]. Por exemplo, se o n√∫mero de pacientes visitando o departamento de emerg√™ncia (ED) √© 120 em 1¬∫ de setembro, 97 em 2 de setembro, e 85 em 3 de setembro, pode ser tentador concluir que a demanda est√° caindo e ajustar a capacidade de acordo. No entanto, essas mudan√ßas podem refletir flutua√ß√µes aleat√≥rias e n√£o indicar uma tend√™ncia real [^6]. Uma previs√£o que seja muito sens√≠vel a essas flutua√ß√µes pode levar a decis√µes err√¥neas e dispendiosas.

> üí° **Exemplo Num√©rico:** Imagine que temos os seguintes dados de demanda di√°ria de pacientes em um pronto-socorro durante 5 dias: `[120, 97, 85, 110, 105]`. Se usarmos uma previs√£o ing√™nua (naive), que simplesmente usa o valor do dia anterior como previs√£o, ter√≠amos as seguintes previs√µes para os dias 2 a 6: `[120, 97, 85, 110, 105]`. Observe que a previs√£o para o dia 2 √© 120 (o valor do dia 1), para o dia 3 √© 97 (o valor do dia 2), e assim por diante. Essa previs√£o √© altamente responsiva, mas tamb√©m muito inst√°vel, pois varia muito de um dia para o outro.
>
> ```mermaid
>  graph LR
>      A[Dia 1: 120] --> B(Dia 2: 97);
>      B --> C(Dia 3: 85);
>      C --> D(Dia 4: 110);
>      D --> E(Dia 5: 105);
>      E --> F(Previs√£o Dia 6: 105);
>
>  style A fill:#f9f,stroke:#333,stroke-width:2px
>  style F fill:#ccf,stroke:#333,stroke-width:2px
> ```
>

Por outro lado, a capacidade de uma previs√£o de ser responsiva √© fundamental para setores que s√£o impactados por mudan√ßas repentinas no mercado ou na demanda [^6]. Por exemplo, a introdu√ß√£o de um novo medicamento antidepressivo pode reduzir rapidamente a demanda por medicamentos mais antigos [^6]. Em tais situa√ß√µes, um modelo de previs√£o deve reagir a essas mudan√ßas na demanda o mais r√°pido poss√≠vel.

A abordagem ing√™nua (na√Øve), por exemplo, assume que a demanda no pr√≥ximo per√≠odo ser√° igual √† demanda no per√≠odo atual [^6]. Embora essa abordagem seja simples e de baixo custo, √© inerentemente muito responsiva a flutua√ß√µes aleat√≥rias, o que a torna impratic√°vel para fins de planejamento [^6].  Por outro lado, m√©todos de m√©dia m√≥vel suavizam as varia√ß√µes aleat√≥rias e, portanto, s√£o mais est√°veis. No entanto, essa estabilidade pode vir √† custa da capacidade de reagir rapidamente a mudan√ßas reais na demanda.

> üí° **Exemplo Num√©rico:** Usando o mesmo conjunto de dados `[120, 97, 85, 110, 105]`, podemos calcular uma m√©dia m√≥vel simples de 3 per√≠odos. Para o dia 4, a previs√£o seria a m√©dia dos dias 1, 2 e 3:  $\frac{120 + 97 + 85}{3} = 100.67$. Para o dia 5, a previs√£o seria a m√©dia dos dias 2, 3 e 4: $\frac{97 + 85 + 110}{3} = 97.33$. A m√©dia m√≥vel √© mais est√°vel, mas tamb√©m responde mais lentamente a mudan√ßas reais na demanda.
>
>  ```python
> import numpy as np
>
> data = np.array([120, 97, 85, 110, 105])
> window_size = 3
>
> moving_averages = []
> for i in range(window_size -1 , len(data)):
>    window = data[i - window_size + 1 : i+1]
>    moving_average = np.mean(window)
>    moving_averages.append(moving_average)
> print(f"Moving averages: {moving_averages}")
>  ```
>
>  Isso demonstra que a m√©dia m√≥vel suaviza os dados, o que resulta em previs√µes mais est√°veis, embora menos responsivas √†s flutua√ß√µes di√°rias.
>

Modelos como m√©dias m√≥veis ponderadas (WMA) e suaviza√ß√£o exponencial tentam equilibrar a estabilidade e a responsividade ao introduzir pesos ou constantes de suaviza√ß√£o, que podem ser ajustadas para aumentar ou diminuir a responsividade [^6]. Um peso ou constante de suaviza√ß√£o maior enfatiza a demanda mais recente, aumentando a responsividade da previs√£o, enquanto um peso ou constante menor resulta em uma previs√£o mais est√°vel [^6].

**Proposi√ß√£o 1** Formalmente, considere uma s√©rie temporal $\{y_t\}$, e seja $\hat{y}_{t+1}$ a previs√£o para o instante $t+1$. Podemos definir a sensibilidade de uma previs√£o em um instante $t$ como a varia√ß√£o na previs√£o com rela√ß√£o a uma varia√ß√£o na observa√ß√£o mais recente. Isso pode ser expresso como $\frac{\partial \hat{y}_{t+1}}{\partial y_t}$. Modelos com valores absolutos altos nessa derivada podem ser considerados mais responsivos. A estabilidade, em contrapartida, pode ser vista como a taxa de mudan√ßa da previs√£o com rela√ß√£o ao tempo, ou seja, $\frac{\partial \hat{y}_{t+1}}{\partial t}$, com valores pequenos indicando alta estabilidade.
_Proof:_
I. Seja $\{y_t\}$ uma s√©rie temporal e $\hat{y}_{t+1}$ a previs√£o para o instante $t+1$.
II. A sensibilidade da previs√£o em rela√ß√£o √† √∫ltima observa√ß√£o √© dada pela derivada parcial de $\hat{y}_{t+1}$ em rela√ß√£o a $y_t$, isto √©, $\frac{\partial \hat{y}_{t+1}}{\partial y_t}$. Um valor alto dessa derivada implica que a previs√£o muda consideravelmente com pequenas mudan√ßas na observa√ß√£o mais recente, indicando alta responsividade.
III. A estabilidade da previs√£o √© a taxa de mudan√ßa da previs√£o ao longo do tempo, expressa como a derivada parcial de $\hat{y}_{t+1}$ em rela√ß√£o a $t$, ou seja, $\frac{\partial \hat{y}_{t+1}}{\partial t}$. Um valor pequeno indica que a previs√£o muda lentamente com o tempo, denotando alta estabilidade.
IV. Portanto, a Proposi√ß√£o 1 estabeleceu uma forma formal para quantificar a responsividade atrav√©s de $\frac{\partial \hat{y}_{t+1}}{\partial y_t}$ e a estabilidade atrav√©s de $\frac{\partial \hat{y}_{t+1}}{\partial t}$.
‚ñ†

A escolha entre estabilidade e responsividade √© uma quest√£o de julgamento e experi√™ncia [^6]. N√£o existe uma resposta √∫nica e ideal, pois a melhor escolha depende do contexto espec√≠fico e do objetivo da previs√£o. O importante √© que o previsor entenda os trade-offs entre esses dois fatores e seja capaz de equilibr√°-los de forma eficaz.

Um ponto essencial apresentado anteriormente √© o conceito de erro de previs√£o [^9]. Este √© o desvio entre o valor real e o previsto da demanda. Um modelo de previs√£o eficaz, portanto, √© aquele que minimiza esse erro. No entanto, a forma como esse erro √© tratado √© importante. A estabilidade visa reduzir o impacto das flutua√ß√µes aleat√≥rias, enquanto a responsividade visa garantir que o modelo se ajuste a mudan√ßas reais no padr√£o de demanda. Uma avalia√ß√£o cuidadosa do erro de previs√£o ajudar√° a entender quais modelos s√£o mais adequados para um determinado conjunto de dados.

**Lema 1**  A avalia√ß√£o do erro de previs√£o, conforme mencionado, √© fundamental. Uma m√©trica comum √© o Erro M√©dio Absoluto (MAE), dado por $MAE = \frac{1}{n} \sum_{t=1}^n |y_t - \hat{y}_t|$, onde $y_t$ √© a demanda real e $\hat{y}_t$ √© a previs√£o no instante $t$, e $n$ √© o n√∫mero de per√≠odos. Outra m√©trica importante √© o Erro Quadr√°tico M√©dio (MSE), definido como $MSE = \frac{1}{n} \sum_{t=1}^n (y_t - \hat{y}_t)^2$.  O MSE penaliza erros maiores de maneira mais severa, o que √© √∫til para avaliar modelos com diferentes distribui√ß√µes de erro.
_Proof:_
I. Seja $y_t$ a demanda real no instante $t$ e $\hat{y}_t$ a previs√£o no mesmo instante.
II. O Erro M√©dio Absoluto (MAE) √© definido como a m√©dia das magnitudes dos erros absolutos, calculado como $MAE = \frac{1}{n} \sum_{t=1}^n |y_t - \hat{y}_t|$, onde $n$ √© o n√∫mero de per√≠odos. Essa m√©trica fornece uma medida do erro m√©dio sem penalizar erros maiores.
III. O Erro Quadr√°tico M√©dio (MSE) √© definido como a m√©dia dos quadrados dos erros, calculado como $MSE = \frac{1}{n} \sum_{t=1}^n (y_t - \hat{y}_t)^2$. Essa m√©trica penaliza erros maiores mais severamente do que o MAE.
IV. O Lema 1 estabeleceu, assim, as defini√ß√µes de duas m√©tricas comuns para quantificar a magnitude dos erros de previs√£o: o MAE, que √© o erro m√©dio absoluto, e o MSE, que penaliza erros maiores de forma mais severa devido √† sua natureza quadr√°tica.
‚ñ†

> üí° **Exemplo Num√©rico:** Usando o nosso conjunto de dados de demanda `[120, 97, 85, 110, 105]` e as previs√µes naive `[120, 97, 85, 110, 105]` para os dias 1 a 5 respectivamente (note que a previs√£o naive para o dia 1 pode ser qualquer valor, aqui usaremos o valor real de 120), podemos calcular o MAE e o MSE. Dado que a previs√£o naive para o dia 1 √© 120 e a demanda real foi 120, o erro √© 0. Os erros para os outros dias s√£o, respectivamente: |97-120|=23, |85-97|=12, |110-85|=25, e |105-110|=5.
>
> Para calcular o MAE:
> $\text{MAE} = \frac{0 + 23 + 12 + 25 + 5}{5} = \frac{65}{5} = 13$
>
> Para calcular o MSE:
> $\text{MSE} = \frac{0^2 + 23^2 + 12^2 + 25^2 + 5^2}{5} = \frac{0 + 529 + 144 + 625 + 25}{5} = \frac{1323}{5} = 264.6$
>
>
> ```python
> import numpy as np
>
> actual_values = np.array([120, 97, 85, 110, 105])
> naive_predictions = np.array([120, 120, 97, 85, 110])
>
> absolute_errors = np.abs(actual_values[1:] - naive_predictions[1:])
> mae = np.mean(absolute_errors)
>
> squared_errors = (actual_values[1:] - naive_predictions[1:]) ** 2
> mse = np.mean(squared_errors)
>
> print(f"MAE: {mae}")
> print(f"MSE: {mse}")
>
>
> ```
> Observe que o MSE √© muito maior que o MAE devido √† natureza quadr√°tica do c√°lculo, o que penaliza erros maiores de forma mais severa.

**Corol√°rio 1.1** A escolha entre MAE e MSE como m√©trica de avalia√ß√£o de previs√£o depende dos objetivos da an√°lise. Se todos os erros s√£o igualmente indesej√°veis, o MAE √© uma boa escolha. Se, por outro lado, erros grandes s√£o considerados mais prejudiciais do que um conjunto de erros pequenos, o MSE √© prefer√≠vel. Isso ocorre devido ao comportamento quadr√°tico do MSE, que amplifica o impacto de grandes erros.
_Proof:_
I. Se todos os erros s√£o igualmente importantes, o MAE √© uma m√©trica de erro apropriada, pois calcula a m√©dia das diferen√ßas absolutas, sem favorecer erros maiores ou menores.
II. Se os erros maiores s√£o considerados mais prejudiciais, o MSE √© prefer√≠vel devido √† sua natureza quadr√°tica. O MSE eleva ao quadrado os erros, resultando em penalidades mais altas para erros maiores em compara√ß√£o com erros menores.
III. Como o MSE amplifica o impacto dos grandes erros, ele √© mais adequado para cen√°rios onde esses erros devem ser evitados a todo custo.
IV. Portanto, a escolha entre MAE e MSE depende do contexto espec√≠fico do problema de previs√£o e das consequ√™ncias dos erros de diferentes magnitudes.
‚ñ†

> üí° **Exemplo Comparativo:** Para ilustrar a diferen√ßa na penalidade entre MAE e MSE, vamos considerar dois cen√°rios hipot√©ticos. No cen√°rio A, temos erros de previs√£o de `[2, 2, 2, 2, 2]`. No cen√°rio B, temos erros de `[0, 0, 0, 0, 10]`.
>
> Para o cen√°rio A:
> $\text{MAE}_A = \frac{2+2+2+2+2}{5} = 2$
> $\text{MSE}_A = \frac{2^2+2^2+2^2+2^2+2^2}{5} = \frac{20}{5} = 4$
>
> Para o cen√°rio B:
> $\text{MAE}_B = \frac{0+0+0+0+10}{5} = 2$
> $\text{MSE}_B = \frac{0^2+0^2+0^2+0^2+10^2}{5} = \frac{100}{5} = 20$
>
> Observe que ambos os cen√°rios t√™m o mesmo MAE (2), mas o MSE √© muito maior para o cen√°rio B (20) devido a um erro grande. Isso demonstra como o MSE √© mais sens√≠vel a outliers e penaliza erros maiores de forma mais severa, enquanto o MAE trata todos os erros de forma igual.
>
> | M√©todo    | Erros                | MAE | MSE |
> |-----------|---------------------|-----|-----|
> | Cen√°rio A | `[2, 2, 2, 2, 2]`    | 2   | 4   |
> | Cen√°rio B | `[0, 0, 0, 0, 10]`   | 2   | 20  |
>
> Este exemplo destaca como a escolha entre MAE e MSE impacta a avalia√ß√£o do modelo de previs√£o, dependendo se os grandes erros devem ser mais penalizados ou n√£o.
>

### Conclus√£o
Em conclus√£o, a busca por um modelo de previs√£o ideal envolve o equil√≠brio entre **estabilidade** e **responsividade** [^6]. A estabilidade √© necess√°ria para evitar rea√ß√µes excessivas a flutua√ß√µes aleat√≥rias, enquanto a responsividade √© necess√°ria para se adaptar √†s mudan√ßas reais na demanda [^6]. A escolha da t√©cnica de previs√£o apropriada envolve um compromisso entre esses dois fatores. O julgamento e a experi√™ncia do previsor s√£o essenciais para navegar neste trade-off e para selecionar o m√©todo de previs√£o mais adequado. A compreens√£o das for√ßas e limita√ß√µes de cada m√©todo e a aten√ß√£o ao erro de previs√£o, permitir√£o que decis√µes mais informadas sejam tomadas para fins de planejamento. Este conhecimento √© um componente cr√≠tico na an√°lise de s√©ries temporais, levando √† tomada de decis√µes mais eficazes na gest√£o da demanda.

### Refer√™ncias
[^5]:  *Chapter 3 emphasized the importance of formulating strategies in each functional area. One critical element shaping strategies is projected demand for healthcare services.*
[^6]: *Forecasts must be both stable and responsive. This is a balancing act because the actions required to make a forecast more responsive decrease its stability and vice versa. It all comes down to the forecaster's judgment and experience in deciding whether the change in demand is real or whether it is a simple "blip."*
[^9]: *The techniques covered so far have produced different forecasts for January of year 4. Which forecast is likely to be more accurate? Forecast accuracy is determined by how closely the forecast matches the actual demand. Any deviation from the actual demand is a forecast error (Box 3.5): Forecast error = Actual demand - Forecast.*
<!-- END -->
