## PrevisÃµes EstÃ¡veis e Responsivas: Um Ato de EquilÃ­brio

### IntroduÃ§Ã£o
Como vimos anteriormente, a previsÃ£o de demanda Ã© um desafio inerente, dada a variabilidade inerente nos dados. A escolha de um modelo de previsÃ£o adequado envolve a consideraÃ§Ã£o cuidadosa de vÃ¡rios fatores, incluindo a natureza dos dados, o horizonte de tempo da previsÃ£o e os trade-offs entre **estabilidade** e **responsividade** [^5]. Este tÃ³pico aprofunda esses conceitos e sua importÃ¢ncia na modelagem de previsÃ£o, construindo sobre a base de modelos de sÃ©ries temporais apresentados anteriormente.

### Conceitos Fundamentais
A **estabilidade** de uma previsÃ£o refere-se Ã  sua capacidade de nÃ£o reagir excessivamente a flutuaÃ§Ãµes aleatÃ³rias nos dados. Em outras palavras, uma previsÃ£o estÃ¡vel Ã© aquela que nÃ£o muda drasticamente em resposta a pequenas variaÃ§Ãµes nos dados de entrada. Por outro lado, a **responsividade** de uma previsÃ£o Ã© sua capacidade de reagir rapidamente a mudanÃ§as reais na demanda [^6]. Um modelo de previsÃ£o altamente responsivo serÃ¡ capaz de capturar mudanÃ§as nos padrÃµes de demanda com mais rapidez, mas pode tambÃ©m ser mais suscetÃ­vel a flutuaÃ§Ãµes aleatÃ³rias.

O desafio reside em que as aÃ§Ãµes necessÃ¡rias para tornar uma previsÃ£o mais responsiva tambÃ©m diminuem sua estabilidade, e vice-versa [^6]. Isso cria um equilÃ­brio que os previsores devem navegar. A necessidade de previsÃµes estÃ¡veis Ã© crucial em setores onde a variabilidade pode levar a decisÃµes errÃ´neas, como a necessidade de ajustar a capacidade com base na demanda percebida [^6]. Por exemplo, se o nÃºmero de pacientes visitando o departamento de emergÃªncia (ED) Ã© 120 em 1Âº de setembro, 97 em 2 de setembro, e 85 em 3 de setembro, pode ser tentador concluir que a demanda estÃ¡ caindo e ajustar a capacidade de acordo. No entanto, essas mudanÃ§as podem refletir flutuaÃ§Ãµes aleatÃ³rias e nÃ£o indicar uma tendÃªncia real [^6]. Uma previsÃ£o que seja muito sensÃ­vel a essas flutuaÃ§Ãµes pode levar a decisÃµes errÃ´neas e dispendiosas.

> ðŸ’¡ **Exemplo NumÃ©rico:** Imagine que temos os seguintes dados de demanda diÃ¡ria de pacientes em um pronto-socorro durante 5 dias: `[120, 97, 85, 110, 105]`. Se usarmos uma previsÃ£o ingÃªnua (naive), que simplesmente usa o valor do dia anterior como previsÃ£o, terÃ­amos as seguintes previsÃµes para os dias 2 a 6: `[120, 97, 85, 110, 105]`. Observe que a previsÃ£o para o dia 2 Ã© 120 (o valor do dia 1), para o dia 3 Ã© 97 (o valor do dia 2), e assim por diante. Essa previsÃ£o Ã© altamente responsiva, mas tambÃ©m muito instÃ¡vel, pois varia muito de um dia para o outro.
>
> ```mermaid
>  graph LR
>      A[Dia 1: 120] --> B(Dia 2: 97);
>      B --> C(Dia 3: 85);
>      C --> D(Dia 4: 110);
>      D --> E(Dia 5: 105);
>      E --> F(PrevisÃ£o Dia 6: 105);
>
>  style A fill:#f9f,stroke:#333,stroke-width:2px
>  style F fill:#ccf,stroke:#333,stroke-width:2px
> ```
>

Por outro lado, a capacidade de uma previsÃ£o de ser responsiva Ã© fundamental para setores que sÃ£o impactados por mudanÃ§as repentinas no mercado ou na demanda [^6]. Por exemplo, a introduÃ§Ã£o de um novo medicamento antidepressivo pode reduzir rapidamente a demanda por medicamentos mais antigos [^6]. Em tais situaÃ§Ãµes, um modelo de previsÃ£o deve reagir a essas mudanÃ§as na demanda o mais rÃ¡pido possÃ­vel.

A abordagem ingÃªnua (naÃ¯ve), por exemplo, assume que a demanda no prÃ³ximo perÃ­odo serÃ¡ igual Ã  demanda no perÃ­odo atual [^6]. Embora essa abordagem seja simples e de baixo custo, Ã© inerentemente muito responsiva a flutuaÃ§Ãµes aleatÃ³rias, o que a torna impraticÃ¡vel para fins de planejamento [^6].  Por outro lado, mÃ©todos de mÃ©dia mÃ³vel suavizam as variaÃ§Ãµes aleatÃ³rias e, portanto, sÃ£o mais estÃ¡veis. No entanto, essa estabilidade pode vir Ã  custa da capacidade de reagir rapidamente a mudanÃ§as reais na demanda.

> ðŸ’¡ **Exemplo NumÃ©rico:** Usando o mesmo conjunto de dados `[120, 97, 85, 110, 105]`, podemos calcular uma mÃ©dia mÃ³vel simples de 3 perÃ­odos. Para o dia 4, a previsÃ£o seria a mÃ©dia dos dias 1, 2 e 3:  $\frac{120 + 97 + 85}{3} = 100.67$. Para o dia 5, a previsÃ£o seria a mÃ©dia dos dias 2, 3 e 4: $\frac{97 + 85 + 110}{3} = 97.33$. A mÃ©dia mÃ³vel Ã© mais estÃ¡vel, mas tambÃ©m responde mais lentamente a mudanÃ§as reais na demanda.
>
>  ```python
> import numpy as np
>
> data = np.array([120, 97, 85, 110, 105])
> window_size = 3
>
> moving_averages = []
> for i in range(window_size -1 , len(data)):
>    window = data[i - window_size + 1 : i+1]
>    moving_average = np.mean(window)
>    moving_averages.append(moving_average)
> print(f"Moving averages: {moving_averages}")
>  ```
>
>  Isso demonstra que a mÃ©dia mÃ³vel suaviza os dados, o que resulta em previsÃµes mais estÃ¡veis, embora menos responsivas Ã s flutuaÃ§Ãµes diÃ¡rias.
>

Modelos como mÃ©dias mÃ³veis ponderadas (WMA) e suavizaÃ§Ã£o exponencial tentam equilibrar a estabilidade e a responsividade ao introduzir pesos ou constantes de suavizaÃ§Ã£o, que podem ser ajustadas para aumentar ou diminuir a responsividade [^6]. Um peso ou constante de suavizaÃ§Ã£o maior enfatiza a demanda mais recente, aumentando a responsividade da previsÃ£o, enquanto um peso ou constante menor resulta em uma previsÃ£o mais estÃ¡vel [^6].

**ProposiÃ§Ã£o 1** Formalmente, considere uma sÃ©rie temporal $\{y_t\}$, e seja $\hat{y}_{t+1}$ a previsÃ£o para o instante $t+1$. Podemos definir a sensibilidade de uma previsÃ£o em um instante $t$ como a variaÃ§Ã£o na previsÃ£o com relaÃ§Ã£o a uma variaÃ§Ã£o na observaÃ§Ã£o mais recente. Isso pode ser expresso como $\frac{\partial \hat{y}_{t+1}}{\partial y_t}$. Modelos com valores absolutos altos nessa derivada podem ser considerados mais responsivos. A estabilidade, em contrapartida, pode ser vista como a taxa de mudanÃ§a da previsÃ£o com relaÃ§Ã£o ao tempo, ou seja, $\frac{\partial \hat{y}_{t+1}}{\partial t}$, com valores pequenos indicando alta estabilidade.
_Proof:_
I. Seja $\{y_t\}$ uma sÃ©rie temporal e $\hat{y}_{t+1}$ a previsÃ£o para o instante $t+1$.
II. A sensibilidade da previsÃ£o em relaÃ§Ã£o Ã  Ãºltima observaÃ§Ã£o Ã© dada pela derivada parcial de $\hat{y}_{t+1}$ em relaÃ§Ã£o a $y_t$, isto Ã©, $\frac{\partial \hat{y}_{t+1}}{\partial y_t}$. Um valor alto dessa derivada implica que a previsÃ£o muda consideravelmente com pequenas mudanÃ§as na observaÃ§Ã£o mais recente, indicando alta responsividade.
III. A estabilidade da previsÃ£o Ã© a taxa de mudanÃ§a da previsÃ£o ao longo do tempo, expressa como a derivada parcial de $\hat{y}_{t+1}$ em relaÃ§Ã£o a $t$, ou seja, $\frac{\partial \hat{y}_{t+1}}{\partial t}$. Um valor pequeno indica que a previsÃ£o muda lentamente com o tempo, denotando alta estabilidade.
IV. Portanto, a ProposiÃ§Ã£o 1 estabeleceu uma forma formal para quantificar a responsividade atravÃ©s de $\frac{\partial \hat{y}_{t+1}}{\partial y_t}$ e a estabilidade atravÃ©s de $\frac{\partial \hat{y}_{t+1}}{\partial t}$.
â– 

A escolha entre estabilidade e responsividade Ã© uma questÃ£o de julgamento e experiÃªncia [^6]. NÃ£o existe uma resposta Ãºnica e ideal, pois a melhor escolha depende do contexto especÃ­fico e do objetivo da previsÃ£o. O importante Ã© que o previsor entenda os trade-offs entre esses dois fatores e seja capaz de equilibrÃ¡-los de forma eficaz.

Um ponto essencial apresentado anteriormente Ã© o conceito de erro de previsÃ£o [^9]. Este Ã© o desvio entre o valor real e o previsto da demanda. Um modelo de previsÃ£o eficaz, portanto, Ã© aquele que minimiza esse erro. No entanto, a forma como esse erro Ã© tratado Ã© importante. A estabilidade visa reduzir o impacto das flutuaÃ§Ãµes aleatÃ³rias, enquanto a responsividade visa garantir que o modelo se ajuste a mudanÃ§as reais no padrÃ£o de demanda. Uma avaliaÃ§Ã£o cuidadosa do erro de previsÃ£o ajudarÃ¡ a entender quais modelos sÃ£o mais adequados para um determinado conjunto de dados.

**Lema 1**  A avaliaÃ§Ã£o do erro de previsÃ£o, conforme mencionado, Ã© fundamental. Uma mÃ©trica comum Ã© o Erro MÃ©dio Absoluto (MAE), dado por $MAE = \frac{1}{n} \sum_{t=1}^n |y_t - \hat{y}_t|$, onde $y_t$ Ã© a demanda real e $\hat{y}_t$ Ã© a previsÃ£o no instante $t$, e $n$ Ã© o nÃºmero de perÃ­odos. Outra mÃ©trica importante Ã© o Erro QuadrÃ¡tico MÃ©dio (MSE), definido como $MSE = \frac{1}{n} \sum_{t=1}^n (y_t - \hat{y}_t)^2$.  O MSE penaliza erros maiores de maneira mais severa, o que Ã© Ãºtil para avaliar modelos com diferentes distribuiÃ§Ãµes de erro.
_Proof:_
I. Seja $y_t$ a demanda real no instante $t$ e $\hat{y}_t$ a previsÃ£o no mesmo instante.
II. O Erro MÃ©dio Absoluto (MAE) Ã© definido como a mÃ©dia das magnitudes dos erros absolutos, calculado como $MAE = \frac{1}{n} \sum_{t=1}^n |y_t - \hat{y}_t|$, onde $n$ Ã© o nÃºmero de perÃ­odos. Essa mÃ©trica fornece uma medida do erro mÃ©dio sem penalizar erros maiores.
III. O Erro QuadrÃ¡tico MÃ©dio (MSE) Ã© definido como a mÃ©dia dos quadrados dos erros, calculado como $MSE = \frac{1}{n} \sum_{t=1}^n (y_t - \hat{y}_t)^2$. Essa mÃ©trica penaliza erros maiores mais severamente do que o MAE.
IV. O Lema 1 estabeleceu, assim, as definiÃ§Ãµes de duas mÃ©tricas comuns para quantificar a magnitude dos erros de previsÃ£o: o MAE, que Ã© o erro mÃ©dio absoluto, e o MSE, que penaliza erros maiores de forma mais severa devido Ã  sua natureza quadrÃ¡tica.
â– 

> ðŸ’¡ **Exemplo NumÃ©rico:** Usando o nosso conjunto de dados de demanda `[120, 97, 85, 110, 105]` e as previsÃµes naive `[120, 97, 85, 110, 105]` para os dias 1 a 5 respectivamente (note que a previsÃ£o naive para o dia 1 pode ser qualquer valor, aqui usaremos o valor real de 120), podemos calcular o MAE e o MSE. Dado que a previsÃ£o naive para o dia 1 Ã© 120 e a demanda real foi 120, o erro Ã© 0. Os erros para os outros dias sÃ£o, respectivamente: |97-120|=23, |85-97|=12, |110-85|=25, e |105-110|=5.
>
> Para calcular o MAE:
> $\text{MAE} = \frac{0 + 23 + 12 + 25 + 5}{5} = \frac{65}{5} = 13$
>
> Para calcular o MSE:
> $\text{MSE} = \frac{0^2 + 23^2 + 12^2 + 25^2 + 5^2}{5} = \frac{0 + 529 + 144 + 625 + 25}{5} = \frac{1323}{5} = 264.6$
>
>
> ```python
> import numpy as np
>
> actual_values = np.array([120, 97, 85, 110, 105])
> naive_predictions = np.array([120, 120, 97, 85, 110])
>
> absolute_errors = np.abs(actual_values[1:] - naive_predictions[1:])
> mae = np.mean(absolute_errors)
>
> squared_errors = (actual_values[1:] - naive_predictions[1:]) ** 2
> mse = np.mean(squared_errors)
>
> print(f"MAE: {mae}")
> print(f"MSE: {mse}")
>
>
> ```
> Observe que o MSE Ã© muito maior que o MAE devido Ã  natureza quadrÃ¡tica do cÃ¡lculo, o que penaliza erros maiores de forma mais severa.

**CorolÃ¡rio 1.1** A escolha entre MAE e MSE como mÃ©trica de avaliaÃ§Ã£o de previsÃ£o depende dos objetivos da anÃ¡lise. Se todos os erros sÃ£o igualmente indesejÃ¡veis, o MAE Ã© uma boa escolha. Se, por outro lado, erros grandes sÃ£o considerados mais prejudiciais do que um conjunto de erros pequenos, o MSE Ã© preferÃ­vel. Isso ocorre devido ao comportamento quadrÃ¡tico do MSE, que amplifica o impacto de grandes erros.
_Proof:_
I. Se todos os erros sÃ£o igualmente importantes, o MAE Ã© uma mÃ©trica de erro apropriada, pois calcula a mÃ©dia das diferenÃ§as absolutas, sem favorecer erros maiores ou menores.
II. Se os erros maiores sÃ£o considerados mais prejudiciais, o MSE Ã© preferÃ­vel devido Ã  sua natureza quadrÃ¡tica. O MSE eleva ao quadrado os erros, resultando em penalidades mais altas para erros maiores em comparaÃ§Ã£o com erros menores.
III. Como o MSE amplifica o impacto dos grandes erros, ele Ã© mais adequado para cenÃ¡rios onde esses erros devem ser evitados a todo custo.
IV. Portanto, a escolha entre MAE e MSE depende do contexto especÃ­fico do problema de previsÃ£o e das consequÃªncias dos erros de diferentes magnitudes.
â– 

> ðŸ’¡ **Exemplo Comparativo:** Para ilustrar a diferenÃ§a na penalidade entre MAE e MSE, vamos considerar dois cenÃ¡rios hipotÃ©ticos. No cenÃ¡rio A, temos erros de previsÃ£o de `[2, 2, 2, 2, 2]`. No cenÃ¡rio B, temos erros de `[0, 0, 0, 0, 10]`.
>
> Para o cenÃ¡rio A:
> $\text{MAE}_A = \frac{2+2+2+2+2}{5} = 2$
> $\text{MSE}_A = \frac{2^2+2^2+2^2+2^2+2^2}{5} = \frac{20}{5} = 4$
>
> Para o cenÃ¡rio B:
> $\text{MAE}_B = \frac{0+0+0+0+10}{5} = 2$
> $\text{MSE}_B = \frac{0^2+0^2+0^2+0^2+10^2}{5} = \frac{100}{5} = 20$
>
> Observe que ambos os cenÃ¡rios tÃªm o mesmo MAE (2), mas o MSE Ã© muito maior para o cenÃ¡rio B (20) devido a um erro grande. Isso demonstra como o MSE Ã© mais sensÃ­vel a outliers e penaliza erros maiores de forma mais severa, enquanto o MAE trata todos os erros de forma igual.
>
> | MÃ©todo    | Erros                | MAE | MSE |
> |-----------|---------------------|-----|-----|
> | CenÃ¡rio A | `[2, 2, 2, 2, 2]`    | 2   | 4   |
> | CenÃ¡rio B | `[0, 0, 0, 0, 10]`   | 2   | 20  |
>
> Este exemplo destaca como a escolha entre MAE e MSE impacta a avaliaÃ§Ã£o do modelo de previsÃ£o, dependendo se os grandes erros devem ser mais penalizados ou nÃ£o.
>

### ConclusÃ£o
Em conclusÃ£o, a busca por um modelo de previsÃ£o ideal envolve o equilÃ­brio entre **estabilidade** e **responsividade** [^6]. A estabilidade Ã© necessÃ¡ria para evitar reaÃ§Ãµes excessivas a flutuaÃ§Ãµes aleatÃ³rias, enquanto a responsividade Ã© necessÃ¡ria para se adaptar Ã s mudanÃ§as reais na demanda [^6]. A escolha da tÃ©cnica de previsÃ£o apropriada envolve um compromisso entre esses dois fatores. O julgamento e a experiÃªncia do previsor sÃ£o essenciais para navegar neste trade-off e para selecionar o mÃ©todo de previsÃ£o mais adequado. A compreensÃ£o das forÃ§as e limitaÃ§Ãµes de cada mÃ©todo e a atenÃ§Ã£o ao erro de previsÃ£o, permitirÃ£o que decisÃµes mais informadas sejam tomadas para fins de planejamento. Este conhecimento Ã© um componente crÃ­tico na anÃ¡lise de sÃ©ries temporais, levando Ã  tomada de decisÃµes mais eficazes na gestÃ£o da demanda.

### ReferÃªncias
[^5]:  *Chapter 3 emphasized the importance of formulating strategies in each functional area. One critical element shaping strategies is projected demand for healthcare services.*
[^6]: *Forecasts must be both stable and responsive. This is a balancing act because the actions required to make a forecast more responsive decrease its stability and vice versa. It all comes down to the forecaster's judgment and experience in deciding whether the change in demand is real or whether it is a simple "blip."*
[^9]: *The techniques covered so far have produced different forecasts for January of year 4. Which forecast is likely to be more accurate? Forecast accuracy is determined by how closely the forecast matches the actual demand. Any deviation from the actual demand is a forecast error (Box 3.5): Forecast error = Actual demand - Forecast.*
<!-- END -->
