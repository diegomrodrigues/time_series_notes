## A Din√¢mica da Responsividade na Previs√£o de Demanda

### Introdu√ß√£o
Em continuidade √† discuss√£o sobre a import√¢ncia do equil√≠brio entre estabilidade e responsividade na modelagem de previs√£o, e explorando o impacto das varia√ß√µes aleat√≥rias na estabilidade da previs√£o [^6], este cap√≠tulo aborda especificamente o conceito de **responsividade** e sua import√¢ncia cr√≠tica na adapta√ß√£o a mudan√ßas din√¢micas no mercado e na demanda. Como vimos anteriormente, modelos est√°veis s√£o essenciais para evitar rea√ß√µes excessivas ao ru√≠do [^6]. No entanto, a estabilidade n√£o deve vir √† custa da responsividade, e esta deve ser incorporada no modelo de previs√£o para que ele possa capturar padr√µes de demanda em r√°pida evolu√ß√£o.

### Conceitos Fundamentais
A **responsividade**, em um contexto de previs√£o de demanda, refere-se √† capacidade de um modelo de reagir prontamente a mudan√ßas genu√≠nas e persistentes nos n√≠veis de demanda [^6].  Ao contr√°rio das flutua√ß√µes aleat√≥rias, que s√£o irregulares e imprevis√≠veis, as mudan√ßas reais na demanda refletem altera√ß√µes nas condi√ß√µes de mercado, prefer√™ncias dos consumidores, eventos sazonais, lan√ßamentos de produtos, entre outros. Modelos com alta responsividade s√£o capazes de capturar tais altera√ß√µes de forma eficaz, adaptando suas previs√µes de acordo com os novos padr√µes de demanda, conforme mencionado anteriormente [^6].

Como j√° discutido, um dos principais desafios na previs√£o de demanda reside no fato de que a capacidade de resposta e a estabilidade s√£o frequentemente trade-offs [^6]. Modelos altamente responsivos tendem a ser mais sens√≠veis a ru√≠dos aleat√≥rios, o que diminui sua estabilidade [^6]. Por outro lado, modelos mais est√°veis podem demorar mais para capturar mudan√ßas genu√≠nas na demanda, o que pode levar a previs√µes desatualizadas e, consequentemente, decis√µes de gest√£o incorretas. O objetivo, portanto, √© projetar modelos que possam alcan√ßar o equil√≠brio apropriado entre esses dois fatores, ajustando-se de forma flex√≠vel ao cen√°rio de demanda.

> üí° **Exemplo Num√©rico:** Suponha que um novo produto seja lan√ßado no mercado e, ap√≥s algum tempo, sua demanda aumente acentuadamente. Um modelo de previs√£o altamente responsivo seria capaz de detectar essa mudan√ßa e ajustar suas previs√µes para cima. Por outro lado, um modelo menos responsivo pode demorar para capturar essa mudan√ßa, o que leva a subestimar a demanda, a falta de produtos, e perda de vendas.
>
> ```python
> import numpy as np
> import pandas as pd
>
> data = np.array([50, 55, 60, 58, 62, 90, 100, 105, 110, 115])
> series = pd.Series(data)
> sma_3 = series.rolling(window = 3).mean().dropna()
> naive_forecast = series.shift(1).dropna()
>
> print(f"Naive forecasts: {naive_forecast.to_list()}")
> print(f"SMA-3 forecasts: {sma_3.to_list()}")
> ```
> O exemplo num√©rico mostra que o modelo ing√™nuo reage imediatamente a mudan√ßas na demanda, demonstrando maior responsividade. O modelo SMA-3, por outro lado, ajusta suas previs√µes mais lentamente.

Modelos de previs√£o com par√¢metros ajust√°veis, como suaviza√ß√£o exponencial e m√©dia m√≥vel ponderada (WMA), oferecem a flexibilidade de ajustar a responsividade [^6]. O par√¢metro de suaviza√ß√£o exponencial $\alpha$, por exemplo, controla a import√¢ncia dada aos dados de demanda mais recentes em compara√ß√£o com as previs√µes passadas [^6]. Um $\alpha$ alto (pr√≥ximo de 1) torna o modelo mais sens√≠vel √†s mudan√ßas recentes, enquanto um $\alpha$ baixo (pr√≥ximo de 0) resulta em uma previs√£o mais est√°vel que √© menos sens√≠vel √†s varia√ß√µes [^6]. Da mesma forma, nos modelos WMA, os pesos atribu√≠dos √†s observa√ß√µes mais recentes t√™m um papel fundamental na determina√ß√£o da capacidade de resposta do modelo, sendo que pesos maiores em dados mais recentes tornam o modelo mais responsivo e vice versa.

> üí° **Exemplo Num√©rico:** Usando os mesmos dados do exemplo anterior,  `[50, 55, 60, 58, 62, 90, 100, 105, 110, 115]`, podemos comparar os resultados de um modelo de suaviza√ß√£o exponencial com diferentes valores de $\alpha$. Um valor de $\alpha$ maior far√° com que o modelo reaja mais rapidamente a mudan√ßas na demanda, mas tamb√©m poder√° torn√°-lo mais suscet√≠vel a flutua√ß√µes aleat√≥rias. Um valor de $\alpha$ menor ter√° o efeito oposto.
> ```python
> import numpy as np
>
> def exponential_smoothing(data, alpha):
>  forecasts = [data[0]]
>  for i in range(1, len(data)):
>    forecast = alpha * data[i-1] + (1 - alpha) * forecasts[-1]
>    forecasts.append(forecast)
>  return forecasts
>
> data = np.array([50, 55, 60, 58, 62, 90, 100, 105, 110, 115])
> alpha_high = 0.8
> alpha_low = 0.2
>
> forecasts_high = exponential_smoothing(data, alpha_high)
> forecasts_low = exponential_smoothing(data, alpha_low)
>
> print(f"ES (alpha=0.8): {forecasts_high}")
> print(f"ES (alpha=0.2): {forecasts_low}")
> ```
> As listas `ES (alpha=0.8)` e `ES (alpha=0.2)` demonstram o impacto do valor de $\alpha$. $\alpha$ = 0.8 torna a previs√£o mais responsiva, enquanto $\alpha$ = 0.2 torna a previs√£o mais est√°vel.

Modelos de tend√™ncia e sazonalidade tamb√©m desempenham um papel importante na responsividade [^10]. Modelos de s√©ries temporais que consideram tend√™ncias e padr√µes sazonais s√£o mais propensos a capturar e reagir a essas mudan√ßas ao longo do tempo. Por exemplo, a demanda de um produto pode aumentar gradualmente com o tempo (tend√™ncia) ou apresentar picos recorrentes em determinados per√≠odos do ano (sazonalidade). A capacidade do modelo de entender e incorporar esses padr√µes √© essencial para fornecer previs√µes precisas que podem se adaptar a essas flutua√ß√µes na demanda. Modelos como o alisamento exponencial ajustado por tend√™ncia e a decomposi√ß√£o de s√©ries temporais usam tais informa√ß√µes.

> üí° **Exemplo Num√©rico:** Vamos considerar uma s√©rie temporal com tend√™ncia e sazonalidade, e comparar um modelo de m√©dia m√≥vel (SMA-3) com um modelo de alisamento exponencial ajustado por tend√™ncia (TAES).
>
>  ```python
> import numpy as np
> import pandas as pd
>
> def trend_adjusted_exponential_smoothing(data, alpha, beta, initial_forecast, initial_trend):
>   forecasts = [initial_forecast]
>   trends = [initial_trend]
>   for i in range(1, len(data)):
>     forecast = alpha * data[i-1] + (1-alpha)*(forecasts[-1] + trends[-1])
>     trend = beta * (forecast - forecasts[-1]) + (1 - beta) * trends[-1]
>     forecasts.append(forecast)
>     trends.append(trend)
>   return forecasts
>
> data = np.array([100, 105, 110, 115, 120, 110, 115, 120, 125, 130, 120, 125])
> series = pd.Series(data)
> sma_3 = series.rolling(window = 3).mean().dropna()
> alpha = 0.7
> beta = 0.3
> taes_forecasts = trend_adjusted_exponential_smoothing(data, alpha, beta, data[0], 1)
> print(f"SMA-3 forecasts: {sma_3.to_list()}")
> print(f"TAES forecasts: {taes_forecasts}")
> ```
> As listas `SMA-3 forecasts` e `TAES forecasts` mostram como o modelo TAES incorpora informa√ß√µes sobre a tend√™ncia nos dados, resultando em previs√µes que acompanham melhor a tend√™ncia observada do que as previs√µes da m√©dia m√≥vel.

A avalia√ß√£o de um modelo de previs√£o, como j√° vimos, envolve o c√°lculo do erro de previs√£o [^9]. √â importante monitorar os erros de previs√£o para determinar se um modelo est√° reagindo adequadamente √†s mudan√ßas na demanda. Em outras palavras, o modelo n√£o pode ser muito responsivo a flutua√ß√µes aleat√≥rias e, ao mesmo tempo, deve conseguir detectar e reagir prontamente a mudan√ßas persistentes na demanda. Modelos com erros maiores e vieses consistentes podem indicar que n√£o s√£o responsivos o suficiente a mudan√ßas na demanda ou que n√£o s√£o capazes de isolar ru√≠do de sinal.

**Lema 3** A avalia√ß√£o do erro de previs√£o para determinar a responsividade de um modelo pode ser realizada atrav√©s do monitoramento do vi√©s, definido como a m√©dia dos erros de previs√£o, bem como atrav√©s da an√°lise da autocorrela√ß√£o dos erros, como descrito anteriormente [^9]. Um modelo altamente responsivo geralmente produzir√° uma baixa autocorrela√ß√£o dos erros, indicando que o modelo est√° capturando a maioria dos padr√µes de demanda e n√£o est√° perdendo tend√™ncias. Um vi√©s constante, seja positivo ou negativo, nos erros do modelo indica que o modelo n√£o est√° respondendo adequadamente a essas tend√™ncias ou padr√µes.
_Proof:_
I. Seja $e_t$ o erro de previs√£o no tempo $t$, definido como $e_t = y_t - \hat{y}_t$, onde $y_t$ √© a demanda real e $\hat{y}_t$ √© a previs√£o no tempo $t$.
II. O vi√©s √© a m√©dia dos erros de previs√£o, dado por $\text{Bias} = \frac{1}{n} \sum_{t=1}^n e_t$. Um vi√©s significativo indica que o modelo est√° consistentemente subestimando (vi√©s positivo) ou superestimando (vi√©s negativo) a demanda, o que pode indicar que n√£o est√° reagindo adequadamente a mudan√ßas na demanda.
III. A autocorrela√ß√£o dos erros, $Corr(e_t, e_{t-k})$, como visto anteriormente, mede a rela√ß√£o entre o erro no tempo $t$ e o erro nos per√≠odos anteriores $t-k$.
IV. Um modelo altamente responsivo deve produzir erros com baixa autocorrela√ß√£o, o que significa que os erros em per√≠odos sucessivos s√£o aleat√≥rios, e o modelo consegue capturar as tend√™ncias e padr√µes da demanda. A autocorrela√ß√£o significa que o modelo est√° perdendo informa√ß√µes de per√≠odos anteriores e n√£o est√° reagindo a mudan√ßas recentes na demanda.
V. Portanto, o Lema 3 formalizou que a avalia√ß√£o da responsividade pode ser feita atrav√©s do vi√©s e da autocorrela√ß√£o, com um vi√©s pr√≥ximo de zero e baixas autocorrela√ß√µes sendo indicativos de um modelo bem ajustado que reage adequadamente a mudan√ßas na demanda.
‚ñ†

> üí° **Exemplo Num√©rico:** Para mostrar como as m√©tricas de vi√©s e autocorrela√ß√£o podem ser usadas para avaliar a responsividade, vamos usar um conjunto de dados com uma mudan√ßa repentina na demanda: `[100, 102, 104, 106, 108, 150, 152, 154, 156, 158]`. Vamos comparar um modelo ing√™nuo e um modelo de alisamento exponencial.
> ```python
> import numpy as np
> import pandas as pd
>
> data = np.array([100, 102, 104, 106, 108, 150, 152, 154, 156, 158])
>
>
> series = pd.Series(data)
>
> def exponential_smoothing(data, alpha):
>    forecasts = [data[0]]
>    for i in range(1, len(data)):
>      forecast = alpha * data[i - 1] + (1 - alpha) * forecasts[-1]
>      forecasts.append(forecast)
>    return forecasts
>
> naive_forecast = series.shift(1).dropna()
> alpha = 0.7
> es_forecasts = exponential_smoothing(data, alpha)
>
> naive_errors = data[1:] - naive_forecast
> es_errors = data[1:] - es_forecasts[1:]
>
> naive_bias = np.mean(naive_errors)
> es_bias = np.mean(es_errors)
>
>
> naive_errors_series = pd.Series(naive_errors)
> es_errors_series = pd.Series(es_errors)
>
> naive_acf = naive_errors_series.autocorr()
> es_acf = es_errors_series.autocorr()
>
> print(f"Naive bias: {naive_bias:.2f}")
> print(f"ES bias: {es_bias:.2f}")
> print(f"Naive errors ACF: {naive_acf}")
> print(f"ES errors ACF: {es_acf}")
> ```
> Os resultados mostram que o modelo ing√™nuo tem um vi√©s maior (subestimando a demanda) e uma autocorrela√ß√£o mais alta, mostrando que ele n√£o se adapta bem √† mudan√ßa, enquanto o modelo ES tem vi√©s menor e erros menos autocorrrelacionados, indicando que ele reage melhor √† mudan√ßa.
>
> **Proposi√ß√£o 2.1.1** A velocidade com que um modelo de previs√£o reage a uma mudan√ßa na demanda √© inversamente proporcional √† estabilidade do modelo. Um modelo altamente responsivo (menor estabilidade) reagir√° rapidamente a uma mudan√ßa, enquanto um modelo est√°vel (menor responsividade) demorar√° mais tempo para incorporar as mudan√ßas na demanda.
>
> _Proof:_
> I. Um modelo com alta estabilidade se ajusta lentamente a mudan√ßas na demanda devido √† sua natureza de suaviza√ß√£o e peso dado √†s informa√ß√µes passadas. Isso significa que a previs√£o em $t+1$, $\hat{y}_{t+1}$, √© uma combina√ß√£o de informa√ß√µes do passado, em sua maior parte, com pouco peso para o valor mais recente, $y_t$.
> II. Por outro lado, um modelo altamente responsivo se ajusta rapidamente √†s mudan√ßas na demanda, atribuindo um peso maior √†s informa√ß√µes mais recentes. Em termos de derivadas, para uma resposta r√°pida √© necess√°rio um grande $\frac{\partial \hat{y}_{t+1}}{\partial y_t}$ (alta sensibilidade).
> III. Conforme demonstrado em proposi√ß√£o anterior, a estabilidade √© inversamente proporcional √† sensibilidade, com modelos de m√©dia m√≥vel sendo mais est√°veis com maior n√∫mero de per√≠odos e suaviza√ß√£o exponencial com par√¢metros de suaviza√ß√£o menores.
> IV. Portanto, a proposi√ß√£o 2.1.1 estabeleceu formalmente que modelos de previs√£o com maior estabilidade reagem mais lentamente a mudan√ßas na demanda, enquanto modelos com maior capacidade de resposta, menor estabilidade, reagem mais rapidamente a essas mudan√ßas.
> ‚ñ†

**Teorema 3.1.** A responsividade de um modelo de previs√£o pode ser adaptada dinamicamente ao longo do tempo atrav√©s de t√©cnicas de _adaptive forecasting_. Modelos adaptativos ajustam seus par√¢metros, como o $\alpha$ no alisamento exponencial, em resposta a mudan√ßas na demanda, permitindo que o modelo se torne mais ou menos responsivo conforme a necessidade.
_Proof:_
I. Em modelos de suaviza√ß√£o exponencial, o par√¢metro $\alpha$ controla a import√¢ncia dada √†s observa√ß√µes mais recentes. Um valor fixo de $\alpha$ resulta em uma responsividade constante ao longo do tempo.
II. T√©cnicas de _adaptive forecasting_ introduzem mecanismos para alterar dinamicamente o valor de $\alpha$ com base no desempenho do modelo, comumente utilizando o erro de previs√£o.
III. Por exemplo, se o modelo est√° subestimando consistentemente a demanda (vi√©s positivo), o $\alpha$ pode ser aumentado, tornando o modelo mais responsivo √†s mudan√ßas.
IV. Analogamente, se o modelo apresenta erros aleat√≥rios e altos, sem um vi√©s consistente, o $\alpha$ pode ser reduzido para dar mais peso √†s previs√µes anteriores, aumentando a estabilidade.
V. Essas adapta√ß√µes din√¢micas permitem que o modelo equilibre responsividade e estabilidade ao longo do tempo, e essa capacidade √© formalizada no Teorema 3.1.
‚ñ†

> üí° **Exemplo Num√©rico:** Para demonstrar como a responsividade pode ser adaptada dinamicamente, vamos criar um modelo de suaviza√ß√£o exponencial que ajuste o valor de $\alpha$ com base no erro de previs√£o. Se o erro for grande, o $\alpha$ aumenta para que o modelo responda mais rapidamente e, se o erro for baixo, o $\alpha$ diminui para que o modelo se torne mais est√°vel.
> ```python
> import numpy as np
>
> def adaptive_exponential_smoothing(data, initial_alpha, error_threshold):
>  forecasts = [data[0]]
>  alpha = initial_alpha
>  alphas = [alpha]
>  for i in range(1, len(data)):
>    forecast = alpha * data[i-1] + (1 - alpha) * forecasts[-1]
>    error = data[i] - forecast
>    if abs(error) > error_threshold:
>      alpha = min(1, alpha + 0.1) # Increase alpha if error is large
>    else:
>        alpha = max(0, alpha - 0.1) # decrease if error is small
>    forecasts.append(forecast)
>    alphas.append(alpha)
>  return forecasts, alphas
>
> data = np.array([50, 55, 60, 58, 62, 90, 100, 105, 110, 115])
> initial_alpha = 0.5
> error_threshold = 5
>
> forecasts, alphas = adaptive_exponential_smoothing(data, initial_alpha, error_threshold)
>
> print(f"Adaptive ES forecasts: {forecasts}")
> print(f"Adaptive alphas: {alphas}")
> ```
> A lista `Adaptive ES forecasts` mostra como o modelo se adapta √† mudan√ßa, enquanto a lista `Adaptive alphas` mostra como o $\alpha$ se ajusta dinamicamente, tornando o modelo mais responsivo quando a demanda aumenta e mais est√°vel quando a demanda se estabiliza.

**Lema 3.1.** A janela temporal usada em modelos de m√©dia m√≥vel (SMA) tamb√©m afeta a responsividade do modelo. Janelas menores tornam o modelo mais responsivo, enquanto janelas maiores aumentam a estabilidade.
_Proof:_
I. Em um modelo SMA, a previs√£o √© calculada como a m√©dia das √∫ltimas $n$ observa√ß√µes. Uma janela temporal menor, com $n$ pequeno, atribui maior peso aos dados mais recentes.
II. Quando uma mudan√ßa na demanda ocorre, os dados mais recentes refletem essa mudan√ßa mais rapidamente. Portanto, o modelo SMA com janela menor reagir√° mais r√°pido a essa mudan√ßa.
III. Uma janela maior, por outro lado, dilui o impacto das mudan√ßas recentes ao incluir mais observa√ß√µes do passado. Assim, o modelo se torna mais est√°vel, reagindo mais lentamente a altera√ß√µes na demanda.
IV. Assim, o Lema 3.1 formaliza a rela√ß√£o inversa entre o tamanho da janela em um modelo SMA e a sua capacidade de resposta, sendo poss√≠vel ajustar a capacidade de resposta alterando o tamanho da janela, uma forma simples de ajustar dinamicamente a capacidade de resposta dos modelos.
‚ñ†

**Proposi√ß√£o 3.1.1.** Em modelos de s√©ries temporais, a inclus√£o de componentes de tend√™ncia e sazonalidade aumenta a responsividade do modelo a padr√µes sistem√°ticos na demanda. Modelos que consideram esses componentes s√£o capazes de antecipar e reagir a mudan√ßas na demanda devido a tend√™ncias ou varia√ß√µes sazonais.
_Proof:_
I. Modelos que n√£o consideram tend√™ncias, por exemplo, modelos de suaviza√ß√£o exponencial simples, tratam mudan√ßas na demanda como ru√≠do, atrasando a resposta a tend√™ncias. Modelos que consideram a tend√™ncia, por outro lado, identificam e incorporam a tend√™ncia, ajustando a previs√£o de acordo com a tend√™ncia observada.
II. Da mesma forma, modelos que n√£o consideram sazonalidade falham em antecipar picos e vales na demanda, enquanto modelos com componentes sazonais adaptam as previs√µes a padr√µes sazonais.
III. Ao separar e modelar os componentes de tend√™ncia e sazonalidade, o modelo pode antecipar e responder a padr√µes sistem√°ticos na demanda, aumentando a responsividade em compara√ß√£o com modelos que n√£o consideram esses componentes.
IV. Portanto, a Proposi√ß√£o 3.1.1 estabelece formalmente que modelos que incluem componentes de tend√™ncia e sazonalidade s√£o mais responsivos a padr√µes sistem√°ticos na demanda do que modelos que n√£o consideram esses padr√µes.
‚ñ†

### Conclus√£o
Em resumo, a **responsividade** √© um componente essencial de um modelo de previs√£o eficaz, permitindo que ele se ajuste rapidamente a mudan√ßas genu√≠nas e persistentes na demanda [^6]. √â fundamental entender o trade-off entre estabilidade e responsividade e ajustar os modelos de previs√£o de forma adequada ao contexto espec√≠fico. O monitoramento do vi√©s e da autocorrela√ß√£o dos erros de previs√£o e o ajuste dos par√¢metros dos modelos, como as constantes de suaviza√ß√£o nos modelos exponenciais e os pesos nos modelos WMA, s√£o etapas importantes para garantir que o modelo seja capaz de capturar tanto a estabilidade e a responsividade necess√°rias para produzir previs√µes precisas. Um modelo de previs√£o bem ajustado, que consiga conciliar estabilidade com responsividade, permitir√° √†s organiza√ß√µes tomarem decis√µes mais eficazes em resposta a condi√ß√µes de mercado din√¢micas.

### Refer√™ncias
[^6]: *Forecasts must be both stable and responsive. This is a balancing act because the actions required to make a forecast more responsive decrease its stability and vice versa. It all comes down to the forecaster's judgment and experience in deciding whether the change in demand is real or whether it is a simple "blip."*
[^9]: *The techniques covered so far have produced different forecasts for January of year 4. Which forecast is likely to be more accurate? Forecast accuracy is determined by how closely the forecast matches the actual demand. Any deviation from the actual demand is a forecast error (Box 3.5): Forecast error = Actual demand - Forecast.*
[^10]:  *In order to reproduce the patterns of past data in our projections, we must break down the time series into its components. The four components of a time series are a trend, a cycle, seasonality, and an irregular movement (Figure 3.1).*
<!-- END -->
