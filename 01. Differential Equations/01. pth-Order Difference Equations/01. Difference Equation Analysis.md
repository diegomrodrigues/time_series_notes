## Equa√ß√µes de Diferen√ßa de Ordem $p$: Generaliza√ß√£o e An√°lise Detalhada

### Introdu√ß√£o
Como vimos anteriormente, as equa√ß√µes de diferen√ßa de primeira ordem descrevem a evolu√ß√£o de uma vari√°vel ao longo do tempo, relacionando seu valor atual com seu valor anterior e uma vari√°vel de entrada. Expandindo o conceito apresentado, este cap√≠tulo foca em **equa√ß√µes de diferen√ßa de ordem $p$**, uma generaliza√ß√£o que permite que o valor atual de uma vari√°vel dependa de v√°rios de seus valores passados, al√©m da entrada atual [^7]. Essa formula√ß√£o mais geral √© essencial para modelar processos din√¢micos complexos. Exploraremos a representa√ß√£o vetorial dessas equa√ß√µes, a an√°lise de seus multiplicadores din√¢micos e a estabilidade do sistema.

### Conceitos Fundamentais
Uma **equa√ß√£o de diferen√ßa linear de ordem $p$** √© definida como [^7]:
$$ y_t = \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + w_t $$
onde $y_t$ √© o valor da vari√°vel no tempo $t$, $w_t$ √© a vari√°vel de entrada no tempo $t$, e $\phi_1, \phi_2, \dots, \phi_p$ s√£o os coeficientes que determinam a influ√™ncia dos valores passados de $y$ em seu valor atual. Essa formula√ß√£o generaliza a equa√ß√£o de primeira ordem [^1], permitindo modelar depend√™ncias temporais mais complexas.

> üí° **Exemplo Num√©rico:** Considere uma equa√ß√£o de diferen√ßa de segunda ordem (p=2) que modela o comportamento de uma a√ß√£o:
> $$y_t = 1.2y_{t-1} - 0.4y_{t-2} + w_t$$
> Aqui, o valor da a√ß√£o no tempo $t$ ($y_t$) depende do valor da a√ß√£o no tempo $t-1$ ($y_{t-1}$) e no tempo $t-2$ ($y_{t-2}$), com pesos de 1.2 e -0.4, respectivamente, e uma entrada externa $w_t$ (por exemplo, not√≠cias do mercado).

Para facilitar a an√°lise, podemos reescrever essa equa√ß√£o de ordem $p$ como um **sistema de primeira ordem** em um vetor [^7]. Definimos o vetor $\xi_t$ como:

$$ \xi_t = \begin{bmatrix} y_t \\ y_{t-1} \\ y_{t-2} \\ \vdots \\ y_{t-p+1} \end{bmatrix} $$

Este vetor cont√©m os $p$ valores passados de $y$ relevantes para a equa√ß√£o. A equa√ß√£o de diferen√ßa de ordem $p$ pode ser reescrita na forma de um sistema vetorial de primeira ordem:

$$ \xi_t = F \xi_{t-1} + v_t $$

onde $F$ √© uma matriz $p \times p$ que descreve a din√¢mica do sistema e $v_t$ √© um vetor que cont√©m a entrada $w_t$:

$$ F = \begin{bmatrix} \phi_1 & \phi_2 & \phi_3 & \dots & \phi_{p-1} & \phi_p \\ 1 & 0 & 0 & \dots & 0 & 0 \\ 0 & 1 & 0 & \dots & 0 & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \dots & 1 & 0 \end{bmatrix}, \quad v_t = \begin{bmatrix} w_t \\ 0 \\ 0 \\ \vdots \\ 0 \end{bmatrix} $$

A primeira linha da matriz $F$ cont√©m os coeficientes da equa√ß√£o de ordem $p$ e as linhas subsequentes garantem que os elementos do vetor $\xi_t$ sejam os lags apropriados de $y$.

> üí° **Exemplo Num√©rico (Cont.):** Para o exemplo da a√ß√£o, a representa√ß√£o vetorial seria:
> $$\xi_t = \begin{bmatrix} y_t \\ y_{t-1} \end{bmatrix}$$
> e o sistema de primeira ordem ficaria:
> $$\begin{bmatrix} y_t \\ y_{t-1} \end{bmatrix} = \begin{bmatrix} 1.2 & -0.4 \\ 1 & 0 \end{bmatrix} \begin{bmatrix} y_{t-1} \\ y_{t-2} \end{bmatrix} + \begin{bmatrix} w_t \\ 0 \end{bmatrix}$$
> Aqui, $F$ √© a matriz $\begin{bmatrix} 1.2 & -0.4 \\ 1 & 0 \end{bmatrix}$ e $v_t$ √© o vetor $\begin{bmatrix} w_t \\ 0 \end{bmatrix}$.

A vantagem de representar a equa√ß√£o de diferen√ßa dessa forma √© que ela nos permite aplicar as mesmas t√©cnicas de an√°lise que usamos para equa√ß√µes de primeira ordem. Em particular, o **multiplicador din√¢mico** para este sistema pode ser encontrado usando a mesma l√≥gica desenvolvida na se√ß√£o anterior, resultando em [^8, ^9, ^10, ^11]:

$$ \frac{\partial y_{t+j}}{\partial w_t} = f_{11}^{(j)} $$

onde $f_{11}^{(j)}$ representa o elemento (1,1) da matriz $F^j$. Essa formula√ß√£o nos permite analisar como uma mudan√ßa na entrada $w$ afeta a sa√≠da $y$ em diferentes pontos do tempo.

**Lema 1**
A matriz F acima √© a matriz companheira do polin√¥mio caracter√≠stico $ \lambda^p - \phi_1\lambda^{p-1} - \phi_2\lambda^{p-2} - \dots - \phi_{p-1}\lambda - \phi_p $.

*Proof*. Expandindo o determinante  $|F - \lambda I|$ pela primeira linha, obtemos o polin√¥mio caracter√≠stico, que √© o mesmo resultado da equa√ß√£o:
$$ \lambda^p - \phi_1\lambda^{p-1} - \phi_2\lambda^{p-2} - \dots - \phi_{p-1}\lambda - \phi_p = 0 $$
Portanto a matriz F √© uma matriz companheira.
‚ñ†

Como vimos anteriormente na an√°lise de equa√ß√µes de primeira ordem, os **autovalores** da matriz $F$ desempenham um papel crucial na determina√ß√£o do comportamento din√¢mico do sistema [^10]. Para encontrar os autovalores ($\lambda$) de $F$, resolvemos a equa√ß√£o caracter√≠stica [^10]:

$$ |F - \lambda I| = 0 $$

que √© equivalente a:
$$ \lambda^p - \phi_1\lambda^{p-1} - \phi_2\lambda^{p-2} - \dots - \phi_{p-1}\lambda - \phi_p = 0 $$

As ra√≠zes ($\lambda_1, \lambda_2, \dots, \lambda_p$) desta equa√ß√£o s√£o os autovalores da matriz $F$. Quando os autovalores s√£o distintos, podemos usar a decomposi√ß√£o espectral da matriz $F$ para obter uma express√£o expl√≠cita para o multiplicador din√¢mico [^11]:
$$ \frac{\partial y_{t+j}}{\partial w_t} = \sum_{i=1}^p c_i \lambda_i^j  $$

onde os coeficientes $c_i$ s√£o constantes que dependem dos autovalores de $F$ [^12]. Este resultado mostra que o multiplicador din√¢mico para sistemas de ordem $p$ √© uma combina√ß√£o linear de exponenciais e/ou senoides, cujas taxas de crescimento ou decaimento s√£o determinadas pelos autovalores da matriz $F$. Em particular, se todos os autovalores tiverem magnitude menor que 1, a resposta do sistema a um choque ser√° est√°vel; caso contr√°rio, ser√° inst√°vel [^13].

> üí° **Exemplo Num√©rico (Cont.):** Para o exemplo da a√ß√£o, vamos calcular os autovalores da matriz F:
> $$ F = \begin{bmatrix} 1.2 & -0.4 \\ 1 & 0 \end{bmatrix} $$
> A equa√ß√£o caracter√≠stica √©:
> $$ |F - \lambda I| = \begin{vmatrix} 1.2 - \lambda & -0.4 \\ 1 & -\lambda \end{vmatrix} = (1.2 - \lambda)(-\lambda) - (-0.4)(1) = \lambda^2 - 1.2\lambda + 0.4 = 0 $$
> Resolvendo esta equa√ß√£o quadr√°tica, obtemos:
> $$\lambda = \frac{1.2 \pm \sqrt{1.2^2 - 4(1)(0.4)}}{2} = \frac{1.2 \pm \sqrt{1.44 - 1.6}}{2} = \frac{1.2 \pm \sqrt{-0.16}}{2} = \frac{1.2 \pm 0.4i}{2} = 0.6 \pm 0.2i $$
> Os autovalores s√£o complexos conjugados, $\lambda_1 = 0.6 + 0.2i$ e $\lambda_2 = 0.6 - 0.2i$. O m√≥dulo de ambos os autovalores √© $\sqrt{0.6^2 + 0.2^2} = \sqrt{0.36 + 0.04} = \sqrt{0.4} \approx 0.632 < 1$. Portanto, o sistema √© est√°vel.

**Lema 1.1** (Forma Alternativa para o Multiplicador Din√¢mico)
Quando os autovalores da matriz $F$ s√£o distintos, o multiplicador din√¢mico tamb√©m pode ser expresso como:
$$ \frac{\partial y_{t+j}}{\partial w_t} =  [1, 0, \dots, 0] F^j \begin{bmatrix} 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix} $$
*Proof*.
I. Seja $e_1$ o vetor coluna $[1, 0, \dots, 0]^T$.
II. Da defini√ß√£o de $\xi_t$, temos que $y_{t+j}$ √© o primeiro elemento de $\xi_{t+j}$.
III. Temos tamb√©m que $\xi_{t+j} = F^j \xi_t + \sum_{k=0}^{j-1} F^k v_{t+j-k-1}$.
IV. Assim, $\frac{\partial \xi_{t+j}}{\partial w_t} = F^j \frac{\partial \xi_{t}}{\partial w_t} = F^j e_1$.
V. Portanto, o primeiro elemento desse vetor √© dado por $e_1^T F^j e_1$, que √© o elemento (1,1) da matriz $F^j$, e coincide com a express√£o original do multiplicador din√¢mico.
‚ñ†

Quando os autovalores n√£o s√£o distintos, a matriz $F$ precisa ser escrita usando a forma de Jordan [^18]. Nestes casos, o multiplicador din√¢mico envolve termos da forma $j^k \lambda^j$, onde $k$ √© menor que a multiplicidade do autovalor $\lambda$ [^19].

**Teorema 1** (Estabilidade do Sistema)
Um sistema de equa√ß√£o de diferen√ßa linear de ordem $p$ √© est√°vel (i.e., a resposta a um choque decai ao longo do tempo) se, e somente se, todos os autovalores da matriz $F$ tiverem magnitude estritamente menor que 1.

*Proof*.
I. O multiplicador din√¢mico √© expresso em termos de autovalores $\lambda_i$ e suas pot√™ncias.
II. Se todos os $|\lambda_i| < 1$, ent√£o $\lambda_i^j$ ir√° para zero quando $j$ tende para infinito.
III. Portanto, o sistema √© est√°vel.
IV. Caso contr√°rio, se pelo menos um $|\lambda_i| \geq 1$, ent√£o a resposta n√£o converge para zero.
‚ñ†

**Lema 1.2** (Condi√ß√£o Suficiente para Estabilidade)
Se $\sum_{i=1}^p |\phi_i| < 1$, ent√£o todos os autovalores da matriz $F$ t√™m magnitude menor que 1.
*Proof*.
I. Seja $\lambda$ um autovalor qualquer da matriz $F$. Ent√£o, a partir da equa√ß√£o caracter√≠stica, temos que $\lambda^p = \phi_1\lambda^{p-1} + \phi_2\lambda^{p-2} + \dots + \phi_p$.
II. Tomando o m√≥dulo dos dois lados da equa√ß√£o,
$$|\lambda|^p = |\phi_1\lambda^{p-1} + \phi_2\lambda^{p-2} + \dots + \phi_p|$$
III. Usando a desigualdade triangular
$$|\lambda|^p \leq |\phi_1||\lambda|^{p-1} + |\phi_2||\lambda|^{p-2} + \dots + |\phi_p|$$
IV. Dividindo por $|\lambda|^{p-1}$ (assumindo $|\lambda| \neq 0$)
$$|\lambda| \leq |\phi_1| + |\phi_2|\frac{1}{|\lambda|} + \dots + |\phi_p|\frac{1}{|\lambda|^{p-1}}$$
V. Se $|\lambda| \geq 1$, ent√£o $\frac{1}{|\lambda|^k} \leq 1$. Portanto
$$|\lambda| \leq |\phi_1| + |\phi_2| + \dots + |\phi_p|$$
VI. Se $\sum_{i=1}^p |\phi_i| < 1$, temos que $|\lambda| < 1$.
‚ñ†

**Corol√°rio 1.1**
Se a soma dos valores absolutos dos coeficientes de uma equa√ß√£o de diferen√ßa linear de ordem $p$ √© menor que 1, ou seja, $\sum_{i=1}^p |\phi_i| < 1$, ent√£o o sistema √© est√°vel.

*Proof*.  Imediato do Lema 1.2 e do Teorema 1.
‚ñ†
> üí° **Exemplo Num√©rico:** Considere a equa√ß√£o $y_t = 0.5y_{t-1} + 0.3y_{t-2} + w_t$. Aqui, $\phi_1 = 0.5$ e $\phi_2 = 0.3$. A soma dos valores absolutos dos coeficientes √© $|0.5| + |0.3| = 0.8 < 1$. Pelo Corol√°rio 1.1, este sistema √© est√°vel.

Al√©m disso, a an√°lise do **efeito de longo prazo** e do **valor presente**  de uma mudan√ßa em $w$ tamb√©m se estende para as equa√ß√µes de ordem $p$ [^20]. O efeito de longo prazo em $y$ de uma mudan√ßa permanente em $w$ √© dado por:

$$ \lim_{j\to\infty} \sum_{k=0}^j \frac{\partial y_{t+k}}{\partial w_t} = \frac{1}{1 - \phi_1 - \phi_2 - \dots - \phi_p} $$

e o efeito no valor presente descontado de uma mudan√ßa transit√≥ria em $w$ √© dado por:

$$ \sum_{j=0}^\infty \beta^j \frac{\partial y_{t+j}}{\partial w_t} = \frac{1}{1 - \phi_1\beta - \phi_2\beta^2 - \dots - \phi_p\beta^p} $$

desde que os autovalores de $F$ sejam todos menores que $\beta^{-1}$ em m√≥dulo.

> üí° **Exemplo Num√©rico (Cont.):** Voltando ao exemplo da a√ß√£o com $y_t = 1.2y_{t-1} - 0.4y_{t-2} + w_t$, o efeito de longo prazo de uma mudan√ßa permanente em $w$ √©:
> $$ \frac{1}{1 - 1.2 - (-0.4)} = \frac{1}{1 - 1.2 + 0.4} = \frac{1}{0.2} = 5 $$
> Uma mudan√ßa permanente em $w$ levar√° a uma mudan√ßa de 5 vezes esse valor em $y$ no longo prazo.
>
> Se o fator de desconto for $\beta = 0.9$, o efeito no valor presente de uma mudan√ßa transit√≥ria em $w$ √©:
> $$ \frac{1}{1 - 1.2(0.9) - (-0.4)(0.9)^2} = \frac{1}{1 - 1.08 + 0.324} = \frac{1}{0.244} \approx 4.098 $$

**Proposi√ß√£o 2**
O efeito de longo prazo de uma mudan√ßa permanente em $w$ em $y$ √© finito se, e somente se, a soma dos coeficientes  $\phi_i$ for diferente de 1.

*Proof*.
I. O efeito de longo prazo √© dado por $\frac{1}{1 - \phi_1 - \phi_2 - \dots - \phi_p}$.
II. Esta express√£o √© finita se, e somente se, o denominador for diferente de zero, ou seja, $1 - \phi_1 - \phi_2 - \dots - \phi_p \neq 0$.
III. Isso √© equivalente a $\phi_1 + \phi_2 + \dots + \phi_p \neq 1$.
‚ñ†

**Proposi√ß√£o 2.1**
Se o sistema √© est√°vel, ent√£o o efeito de longo prazo de uma mudan√ßa permanente em $w$ em $y$ √© finito.

*Proof*.
I. Se o sistema √© est√°vel, ent√£o todos os autovalores de $F$ t√™m magnitude menor que 1.
II. Pelo Teorema 1, os autovalores s√£o as ra√≠zes da equa√ß√£o $\lambda^p - \phi_1\lambda^{p-1} - \phi_2\lambda^{p-2} - \dots - \phi_{p-1}\lambda - \phi_p = 0$.
III. Substituindo $\lambda = 1$ nesta equa√ß√£o, obtemos $1 - \phi_1 - \phi_2 - \dots - \phi_p \neq 0$ (se fosse igual a zero, ent√£o $\lambda=1$ seria uma raiz, e o sistema seria inst√°vel).
IV. Pela Proposi√ß√£o 2, o efeito de longo prazo √© finito.
‚ñ†

**Lema 2.1**
O denominador da express√£o do efeito de longo prazo, $1 - \phi_1 - \phi_2 - \dots - \phi_p$, √© igual a  $|I - F|$, onde $I$ √© a matriz identidade de ordem $p$.

*Proof*.
I. Considere a matriz $I-F$:
$$ I - F = \begin{bmatrix} 1-\phi_1 & -\phi_2 & -\phi_3 & \dots & -\phi_{p-1} & -\phi_p \\ -1 & 1 & 0 & \dots & 0 & 0 \\ 0 & -1 & 1 & \dots & 0 & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & 0 & \dots & -1 & 1 \end{bmatrix} $$
II. O determinante dessa matriz pode ser calculado expandindo-o pela √∫ltima linha sucessivamente. Expandindo pela √∫ltima linha, obtemos um determinante (p-1) x (p-1), com uma matriz similar, exceto pelo elemento (p-1, p-1) que agora √© 1.
III. Expandindo esse determinante pela pen√∫ltima linha e repetindo esse processo, vamos obtendo 1 na diagonal principal da matriz resultante, mas os elementos $-\phi_i$ da primeira linha da matriz original se mant√™m.
IV. Assim, ap√≥s $p$-1 expans√µes, o resultado √©:
$$|I-F| = (1-\phi_1) + (-\phi_2)(-1) + (-\phi_3)(-1)^2 + \dots + (-\phi_p)(-1)^{p-1} = 1 - \phi_1 - \phi_2 - \dots - \phi_p$$
V. Portanto, $|I-F| = 1 - \phi_1 - \phi_2 - \dots - \phi_p$.
‚ñ†

### Conclus√£o
Neste cap√≠tulo, expandimos nossa an√°lise de equa√ß√µes de diferen√ßa, abordando as **equa√ß√µes de ordem $p$**, que generalizam as de primeira ordem ao permitir que o valor atual de uma vari√°vel dependa de m√∫ltiplos valores passados [^7]. A representa√ß√£o vetorial dessas equa√ß√µes simplifica a an√°lise, possibilitando o uso de t√©cnicas de √°lgebra linear para o estudo de multiplicadores din√¢micos e estabilidade [^7, ^8]. Os autovalores da matriz $F$ desempenham um papel central na determina√ß√£o do comportamento do sistema, com o multiplicador din√¢mico expresso em termos dos autovalores e suas pot√™ncias [^10, ^11, ^12]. As conclus√µes de longo prazo e os efeitos sobre o valor presente de mudan√ßas em $w$ seguem as mesmas l√≥gicas das equa√ß√µes de primeira ordem, generalizando os resultados obtidos anteriormente [^20].

### Refer√™ncias
[^1]: Se√ß√£o 1.1 do texto original.
[^7]: Se√ß√£o 1.2 do texto original.
[^8]:  Equa√ß√£o 1.2.11 do texto original.
[^9]: Se√ß√£o 1.2 do texto original
[^10]: Se√ß√£o 1.2 do texto original
[^11]: Equa√ß√£o 1.2.19 do texto original.
[^12]: Equa√ß√£o 1.2.20 e 1.2.21 do texto original.
[^13]: Se√ß√£o 1.2 do texto original.
[^18]: Se√ß√£o 1.2 do texto original.
[^19]: Se√ß√£o 1.2 do texto original.
[^20]: Se√ß√£o 1.2 do texto original.
<!-- END -->
